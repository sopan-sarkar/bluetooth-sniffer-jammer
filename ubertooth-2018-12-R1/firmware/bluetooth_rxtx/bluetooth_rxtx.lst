ARM GAS  /tmp/ccLwKaeN.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 4
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"bluetooth_rxtx.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.reverse8,"ax",%progbits
  16              		.align	1
  17              		.syntax unified
  18              		.thumb
  19              		.thumb_func
  20              		.fpu softvfp
  22              	reverse8:
  23              	.LFB16:
  24              		.file 1 "bluetooth_rxtx.c"
   1:bluetooth_rxtx.c **** /*
   2:bluetooth_rxtx.c ****  * Copyright 2010-2013 Michael Ossmann
   3:bluetooth_rxtx.c ****  * Copyright 2011-2013 Dominic Spill
   4:bluetooth_rxtx.c ****  *
   5:bluetooth_rxtx.c ****  * This file is part of Project Ubertooth.
   6:bluetooth_rxtx.c ****  *
   7:bluetooth_rxtx.c ****  * This program is free software; you can redistribute it and/or modify
   8:bluetooth_rxtx.c ****  * it under the terms of the GNU General Public License as published by
   9:bluetooth_rxtx.c ****  * the Free Software Foundation; either version 2, or (at your option)
  10:bluetooth_rxtx.c ****  * any later version.
  11:bluetooth_rxtx.c ****  *
  12:bluetooth_rxtx.c ****  * This program is distributed in the hope that it will be useful,
  13:bluetooth_rxtx.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  14:bluetooth_rxtx.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  15:bluetooth_rxtx.c ****  * GNU General Public License for more details.
  16:bluetooth_rxtx.c ****  *
  17:bluetooth_rxtx.c ****  * You should have received a copy of the GNU General Public License
  18:bluetooth_rxtx.c ****  * along with this program; see the file COPYING.  If not, write to
  19:bluetooth_rxtx.c ****  * the Free Software Foundation, Inc., 51 Franklin Street,
  20:bluetooth_rxtx.c ****  * Boston, MA 02110-1301, USA.
  21:bluetooth_rxtx.c ****  */
  22:bluetooth_rxtx.c **** 
  23:bluetooth_rxtx.c **** #include <string.h>
  24:bluetooth_rxtx.c **** 
  25:bluetooth_rxtx.c **** #include "ubertooth.h"
  26:bluetooth_rxtx.c **** #include "ubertooth_usb.h"
  27:bluetooth_rxtx.c **** #include "ubertooth_interface.h"
  28:bluetooth_rxtx.c **** #include "ubertooth_rssi.h"
  29:bluetooth_rxtx.c **** #include "ubertooth_cs.h"
  30:bluetooth_rxtx.c **** #include "ubertooth_dma.h"
  31:bluetooth_rxtx.c **** #include "ubertooth_clock.h"
  32:bluetooth_rxtx.c **** #include "bluetooth.h"
  33:bluetooth_rxtx.c **** #include "bluetooth_le.h"
  34:bluetooth_rxtx.c **** #include "cc2400_rangetest.h"
ARM GAS  /tmp/ccLwKaeN.s 			page 2


  35:bluetooth_rxtx.c **** #include "ego.h"
  36:bluetooth_rxtx.c **** #include "debug_uart.h"
  37:bluetooth_rxtx.c **** 
  38:bluetooth_rxtx.c **** #define MIN(x,y)	((x)<(y)?(x):(y))
  39:bluetooth_rxtx.c **** #define MAX(x,y)	((x)>(y)?(x):(y))
  40:bluetooth_rxtx.c **** 
  41:bluetooth_rxtx.c **** /* build info */
  42:bluetooth_rxtx.c **** const char compile_info[] =
  43:bluetooth_rxtx.c **** 	"ubertooth " GIT_REVISION " (" COMPILE_BY "@" COMPILE_HOST ") " TIMESTAMP;
  44:bluetooth_rxtx.c **** 
  45:bluetooth_rxtx.c **** /* hopping stuff */
  46:bluetooth_rxtx.c **** volatile uint8_t  hop_mode = HOP_NONE;
  47:bluetooth_rxtx.c **** volatile uint8_t  do_hop = 0;                  // set by timer interrupt
  48:bluetooth_rxtx.c **** volatile uint16_t channel = 2408; //sopan
  49:bluetooth_rxtx.c **** volatile uint16_t hop_direct_channel = 0;      // for hopping directly to a channel
  50:bluetooth_rxtx.c **** volatile uint16_t hop_timeout = 158;
  51:bluetooth_rxtx.c **** volatile uint16_t requested_channel = 0;
  52:bluetooth_rxtx.c **** volatile uint16_t le_adv_channel = 2402;
  53:bluetooth_rxtx.c **** volatile int      cancel_follow = 0;
  54:bluetooth_rxtx.c **** 
  55:bluetooth_rxtx.c **** /* bulk USB stuff */
  56:bluetooth_rxtx.c **** volatile uint8_t  idle_buf_clkn_high = 0;
  57:bluetooth_rxtx.c **** volatile uint32_t idle_buf_clk100ns = 0;
  58:bluetooth_rxtx.c **** volatile uint16_t idle_buf_channel = 0;
  59:bluetooth_rxtx.c **** volatile uint8_t  dma_discard = 0;
  60:bluetooth_rxtx.c **** volatile uint8_t  status = 0;
  61:bluetooth_rxtx.c **** 
  62:bluetooth_rxtx.c **** /* operation mode */
  63:bluetooth_rxtx.c **** volatile uint8_t mode = MODE_IDLE;
  64:bluetooth_rxtx.c **** volatile uint8_t requested_mode = MODE_IDLE;
  65:bluetooth_rxtx.c **** volatile uint8_t jam_mode = JAM_NONE;
  66:bluetooth_rxtx.c **** volatile uint8_t ego_mode = EGO_FOLLOW;
  67:bluetooth_rxtx.c **** 
  68:bluetooth_rxtx.c **** volatile uint8_t modulation = MOD_BT_BASIC_RATE;
  69:bluetooth_rxtx.c **** 
  70:bluetooth_rxtx.c **** /* specan stuff */
  71:bluetooth_rxtx.c **** volatile uint16_t low_freq = 2400;
  72:bluetooth_rxtx.c **** volatile uint16_t high_freq = 2483;
  73:bluetooth_rxtx.c **** volatile int8_t rssi_threshold = -30;  // -54dBm - 30 = -84dBm
  74:bluetooth_rxtx.c **** 
  75:bluetooth_rxtx.c **** /* This is specific to BLE scanning in connected state */
  76:bluetooth_rxtx.c **** static uint16_t eindex = 0;
  77:bluetooth_rxtx.c **** static uint16_t time_array1[16]; // Array that saves time of appearance of the BLE connection in th
  78:bluetooth_rxtx.c **** static uint16_t time_array2[16];
  79:bluetooth_rxtx.c **** static uint16_t time_array3[16];
  80:bluetooth_rxtx.c **** static u8 count1, count2, count3, sync_count = 0; // Some variables used for counting and and maint
  81:bluetooth_rxtx.c **** u8 idx1 = 0; // channel index to start sniffing to
  82:bluetooth_rxtx.c **** u8 idx2 = 1; // channel index to jump next from idx1
  83:bluetooth_rxtx.c **** u8 idx3 = 2; // channel index to jump next from idx2
  84:bluetooth_rxtx.c **** 
  85:bluetooth_rxtx.c **** // Used for getting channel map
  86:bluetooth_rxtx.c **** //static uint16_t ch_map_hopped[37], remapped_ch[37];
  87:bluetooth_rxtx.c **** static u8 mapped = 0;
  88:bluetooth_rxtx.c **** //static u8 total_channel = 0;
  89:bluetooth_rxtx.c **** static u8 ch_count1 = 0;
  90:bluetooth_rxtx.c **** //static u8 hopping_channel, channel_hopped = 0;
  91:bluetooth_rxtx.c **** //static u8 do_count = 1;
ARM GAS  /tmp/ccLwKaeN.s 			page 3


  92:bluetooth_rxtx.c **** //u16 time1, index1 = 0;
  93:bluetooth_rxtx.c **** //static u8 remapped = 0;
  94:bluetooth_rxtx.c **** volatile uint8_t  do_transmit = 0;
  95:bluetooth_rxtx.c **** 
  96:bluetooth_rxtx.c **** 
  97:bluetooth_rxtx.c **** /* Generic TX stuff */
  98:bluetooth_rxtx.c **** generic_tx_packet tx_pkt;
  99:bluetooth_rxtx.c **** 
 100:bluetooth_rxtx.c **** /* le slave stuff */
 101:bluetooth_rxtx.c **** uint8_t slave_mac_address[6] = { 0, };
 102:bluetooth_rxtx.c **** uint8_t le_adv_data[LE_ADV_MAX_LEN] = { 0x02, 0x01, 0x05 };
 103:bluetooth_rxtx.c **** unsigned le_adv_len = 3;
 104:bluetooth_rxtx.c **** 
 105:bluetooth_rxtx.c **** le_state_t le = {
 106:bluetooth_rxtx.c **** 	.access_address = 0x8e89bed6,           // advertising channel access address
 107:bluetooth_rxtx.c **** 	.synch = 0x6b7d,                        // bit-reversed adv channel AA
 108:bluetooth_rxtx.c **** 	.syncl = 0x9171,
 109:bluetooth_rxtx.c **** 	.crc_init  = 0x555555,                  // advertising channel CRCInit
 110:bluetooth_rxtx.c **** 	.crc_init_reversed = 0xAAAAAA,
 111:bluetooth_rxtx.c **** 	.crc_verify = 0,
 112:bluetooth_rxtx.c **** 
 113:bluetooth_rxtx.c **** 	.link_state = LINK_INACTIVE,
 114:bluetooth_rxtx.c **** 	.conn_epoch = 0,
 115:bluetooth_rxtx.c **** 	.do_follow = 1,
 116:bluetooth_rxtx.c **** 	.target_set = 0,
 117:bluetooth_rxtx.c **** 	.last_packet = 0,
 118:bluetooth_rxtx.c **** };
 119:bluetooth_rxtx.c **** 
 120:bluetooth_rxtx.c **** le_channel_remapping_t pending_remapping, remapping;
 121:bluetooth_rxtx.c **** 
 122:bluetooth_rxtx.c **** typedef struct _le_promisc_active_aa_t {
 123:bluetooth_rxtx.c **** 	u32 aa;
 124:bluetooth_rxtx.c **** 	int count;
 125:bluetooth_rxtx.c **** } le_promisc_active_aa_t;
 126:bluetooth_rxtx.c **** 
 127:bluetooth_rxtx.c **** typedef struct _le_promisc_state_t {
 128:bluetooth_rxtx.c **** 	// LFU cache of recently seen AA's
 129:bluetooth_rxtx.c **** 	le_promisc_active_aa_t active_aa[32];
 130:bluetooth_rxtx.c **** 
 131:bluetooth_rxtx.c **** 	// recovering hop interval
 132:bluetooth_rxtx.c **** 	u32 smallest_hop_interval;
 133:bluetooth_rxtx.c **** 	int consec_intervals;
 134:bluetooth_rxtx.c **** } le_promisc_state_t;
 135:bluetooth_rxtx.c **** le_promisc_state_t le_promisc;
 136:bluetooth_rxtx.c **** #define AA_LIST_SIZE (int)(sizeof(le_promisc.active_aa) / sizeof(le_promisc_active_aa_t))
 137:bluetooth_rxtx.c **** 
 138:bluetooth_rxtx.c **** /* LE jamming */
 139:bluetooth_rxtx.c **** #define JAM_COUNT_DEFAULT 40
 140:bluetooth_rxtx.c **** int le_jam_count = 0;
 141:bluetooth_rxtx.c **** 
 142:bluetooth_rxtx.c **** /* set LE access address */
 143:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa);
 144:bluetooth_rxtx.c **** 
 145:bluetooth_rxtx.c **** typedef int (*data_cb_t)(char *);
 146:bluetooth_rxtx.c **** data_cb_t data_cb = NULL;
 147:bluetooth_rxtx.c **** 
 148:bluetooth_rxtx.c **** typedef void (*packet_cb_t)(u8 *);
ARM GAS  /tmp/ccLwKaeN.s 			page 4


 149:bluetooth_rxtx.c **** packet_cb_t packet_cb = NULL;
 150:bluetooth_rxtx.c **** 
 151:bluetooth_rxtx.c **** /* Unpacked symbol buffers (two rxbufs) */
 152:bluetooth_rxtx.c **** char unpacked[DMA_SIZE*8*2];
 153:bluetooth_rxtx.c **** 
 154:bluetooth_rxtx.c **** static int enqueue(uint8_t type, uint8_t* buf)
 155:bluetooth_rxtx.c **** {
 156:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 157:bluetooth_rxtx.c **** 
 158:bluetooth_rxtx.c **** 	/* fail if queue is full */
 159:bluetooth_rxtx.c **** 	if (f == NULL) {
 160:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 161:bluetooth_rxtx.c **** 		return 0;
 162:bluetooth_rxtx.c **** 	}
 163:bluetooth_rxtx.c **** 
 164:bluetooth_rxtx.c **** 	f->pkt_type = type;
 165:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 166:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 167:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 168:bluetooth_rxtx.c **** 	} else {
 169:bluetooth_rxtx.c **** 		f->clkn_high = idle_buf_clkn_high;
 170:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 171:bluetooth_rxtx.c **** 		f->channel = (uint8_t)((idle_buf_channel - 2402) & 0xff);
 172:bluetooth_rxtx.c **** 		f->rssi_min = rssi_min;
 173:bluetooth_rxtx.c **** 		f->rssi_max = rssi_max;
 174:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_get_avg(idle_buf_channel);
 175:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 176:bluetooth_rxtx.c **** 	}
 177:bluetooth_rxtx.c **** 
 178:bluetooth_rxtx.c **** 	memcpy(f->data, buf, DMA_SIZE);
 179:bluetooth_rxtx.c **** 
 180:bluetooth_rxtx.c **** 	f->status = status;
 181:bluetooth_rxtx.c **** 	status = 0;
 182:bluetooth_rxtx.c **** 
 183:bluetooth_rxtx.c **** 	return 1;
 184:bluetooth_rxtx.c **** }
 185:bluetooth_rxtx.c **** 
 186:bluetooth_rxtx.c **** int enqueue_with_ts(uint8_t type, uint8_t* buf, uint32_t ts)
 187:bluetooth_rxtx.c **** {
 188:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 189:bluetooth_rxtx.c **** 
 190:bluetooth_rxtx.c **** 	/* fail if queue is full */
 191:bluetooth_rxtx.c **** 	if (f == NULL) {
 192:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 193:bluetooth_rxtx.c **** 		return 0;
 194:bluetooth_rxtx.c **** 	}
 195:bluetooth_rxtx.c **** 
 196:bluetooth_rxtx.c **** 	f->pkt_type = type;
 197:bluetooth_rxtx.c **** 
 198:bluetooth_rxtx.c **** 	f->clkn_high = 0;
 199:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 200:bluetooth_rxtx.c **** 
 201:bluetooth_rxtx.c **** 	f->channel = (uint8_t)((channel - 2402) & 0xff);
 202:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 203:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 204:bluetooth_rxtx.c **** 
 205:bluetooth_rxtx.c **** 	memcpy(f->data, buf, DMA_SIZE);
ARM GAS  /tmp/ccLwKaeN.s 			page 5


 206:bluetooth_rxtx.c **** 
 207:bluetooth_rxtx.c **** 	f->status = status;
 208:bluetooth_rxtx.c **** 	status = 0;
 209:bluetooth_rxtx.c **** 
 210:bluetooth_rxtx.c **** 	return 1;
 211:bluetooth_rxtx.c **** }
 212:bluetooth_rxtx.c **** 
 213:bluetooth_rxtx.c **** static int vendor_request_handler(uint8_t request, uint16_t* request_params, uint8_t* data, int* da
 214:bluetooth_rxtx.c **** {
 215:bluetooth_rxtx.c **** 	uint32_t clock;
 216:bluetooth_rxtx.c **** 	size_t length; // string length
 217:bluetooth_rxtx.c **** 	usb_pkt_rx* p = NULL;
 218:bluetooth_rxtx.c **** 	uint16_t reg_val;
 219:bluetooth_rxtx.c **** 	uint8_t i;
 220:bluetooth_rxtx.c **** 	unsigned data_in_len = request_params[2];
 221:bluetooth_rxtx.c **** 
 222:bluetooth_rxtx.c **** 	switch (request) {
 223:bluetooth_rxtx.c **** 
 224:bluetooth_rxtx.c **** 	case UBERTOOTH_PING:
 225:bluetooth_rxtx.c **** 		*data_len = 0;
 226:bluetooth_rxtx.c **** 		break;
 227:bluetooth_rxtx.c **** 
 228:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_SYMBOLS:
 229:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_SYMBOLS;
 230:bluetooth_rxtx.c **** 		*data_len = 0;
 231:bluetooth_rxtx.c **** 		break;
 232:bluetooth_rxtx.c **** 
 233:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_SYMBOLS:
 234:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
 235:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_SYMBOLS;
 236:bluetooth_rxtx.c **** 		*data_len = 0;
 237:bluetooth_rxtx.c **** 		break;
 238:bluetooth_rxtx.c **** 
 239:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_USRLED:
 240:bluetooth_rxtx.c **** 		data[0] = (USRLED) ? 1 : 0;
 241:bluetooth_rxtx.c **** 		*data_len = 1;
 242:bluetooth_rxtx.c **** 		break;
 243:bluetooth_rxtx.c **** 
 244:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_USRLED:
 245:bluetooth_rxtx.c **** 		if (request_params[0])
 246:bluetooth_rxtx.c **** 			USRLED_SET;
 247:bluetooth_rxtx.c **** 		else
 248:bluetooth_rxtx.c **** 			USRLED_CLR;
 249:bluetooth_rxtx.c **** 		break;
 250:bluetooth_rxtx.c **** 
 251:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_RXLED:
 252:bluetooth_rxtx.c **** 		data[0] = (RXLED) ? 1 : 0;
 253:bluetooth_rxtx.c **** 		*data_len = 1;
 254:bluetooth_rxtx.c **** 		break;
 255:bluetooth_rxtx.c **** 
 256:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_RXLED:
 257:bluetooth_rxtx.c **** 		if (request_params[0])
 258:bluetooth_rxtx.c **** 			RXLED_SET;
 259:bluetooth_rxtx.c **** 		else
 260:bluetooth_rxtx.c **** 			RXLED_CLR;
 261:bluetooth_rxtx.c **** 		break;
 262:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccLwKaeN.s 			page 6


 263:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_TXLED:
 264:bluetooth_rxtx.c **** 		data[0] = (TXLED) ? 1 : 0;
 265:bluetooth_rxtx.c **** 		*data_len = 1;
 266:bluetooth_rxtx.c **** 		break;
 267:bluetooth_rxtx.c **** 
 268:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_TXLED:
 269:bluetooth_rxtx.c **** 		if (request_params[0])
 270:bluetooth_rxtx.c **** 			TXLED_SET;
 271:bluetooth_rxtx.c **** 		else
 272:bluetooth_rxtx.c **** 			TXLED_CLR;
 273:bluetooth_rxtx.c **** 		break;
 274:bluetooth_rxtx.c **** 
 275:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_1V8:
 276:bluetooth_rxtx.c **** 		data[0] = (CC1V8) ? 1 : 0;
 277:bluetooth_rxtx.c **** 		*data_len = 1;
 278:bluetooth_rxtx.c **** 		break;
 279:bluetooth_rxtx.c **** 
 280:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_1V8:
 281:bluetooth_rxtx.c **** 		if (request_params[0])
 282:bluetooth_rxtx.c **** 			CC1V8_SET;
 283:bluetooth_rxtx.c **** 		else
 284:bluetooth_rxtx.c **** 			CC1V8_CLR;
 285:bluetooth_rxtx.c **** 		break;
 286:bluetooth_rxtx.c **** 
 287:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PARTNUM:
 288:bluetooth_rxtx.c **** 		get_part_num(data, data_len);
 289:bluetooth_rxtx.c **** 		break;
 290:bluetooth_rxtx.c **** 
 291:bluetooth_rxtx.c **** 	case UBERTOOTH_RESET:
 292:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 293:bluetooth_rxtx.c **** 		break;
 294:bluetooth_rxtx.c **** 
 295:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SERIAL:
 296:bluetooth_rxtx.c **** 		get_device_serial(data, data_len);
 297:bluetooth_rxtx.c **** 		break;
 298:bluetooth_rxtx.c **** 
 299:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 300:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PAEN:
 301:bluetooth_rxtx.c **** 		data[0] = (PAEN) ? 1 : 0;
 302:bluetooth_rxtx.c **** 		*data_len = 1;
 303:bluetooth_rxtx.c **** 		break;
 304:bluetooth_rxtx.c **** 
 305:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PAEN:
 306:bluetooth_rxtx.c **** 		if (request_params[0])
 307:bluetooth_rxtx.c **** 			PAEN_SET;
 308:bluetooth_rxtx.c **** 		else
 309:bluetooth_rxtx.c **** 			PAEN_CLR;
 310:bluetooth_rxtx.c **** 		break;
 311:bluetooth_rxtx.c **** 
 312:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_HGM:
 313:bluetooth_rxtx.c **** 		data[0] = (HGM) ? 1 : 0;
 314:bluetooth_rxtx.c **** 		*data_len = 1;
 315:bluetooth_rxtx.c **** 		break;
 316:bluetooth_rxtx.c **** 
 317:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_HGM:
 318:bluetooth_rxtx.c **** 		if (request_params[0])
 319:bluetooth_rxtx.c **** 			HGM_SET;
ARM GAS  /tmp/ccLwKaeN.s 			page 7


 320:bluetooth_rxtx.c **** 		else
 321:bluetooth_rxtx.c **** 			HGM_CLR;
 322:bluetooth_rxtx.c **** 		break;
 323:bluetooth_rxtx.c **** #endif
 324:bluetooth_rxtx.c **** 
 325:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 326:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_TEST:
 327:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_TEST;
 328:bluetooth_rxtx.c **** 		break;
 329:bluetooth_rxtx.c **** 
 330:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PALEVEL:
 331:bluetooth_rxtx.c **** 		data[0] = cc2400_get(FREND) & 0x7;
 332:bluetooth_rxtx.c **** 		*data_len = 1;
 333:bluetooth_rxtx.c **** 		break;
 334:bluetooth_rxtx.c **** 
 335:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PALEVEL:
 336:bluetooth_rxtx.c **** 		if( request_params[0] < 8 ) {
 337:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 338:bluetooth_rxtx.c **** 		} else {
 339:bluetooth_rxtx.c **** 			return 0;
 340:bluetooth_rxtx.c **** 		}
 341:bluetooth_rxtx.c **** 		break;
 342:bluetooth_rxtx.c **** 
 343:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_TEST:
 344:bluetooth_rxtx.c **** 		requested_mode = MODE_RANGE_TEST;
 345:bluetooth_rxtx.c **** 		break;
 346:bluetooth_rxtx.c **** 
 347:bluetooth_rxtx.c **** 	case UBERTOOTH_REPEATER:
 348:bluetooth_rxtx.c **** 		requested_mode = MODE_REPEATER;
 349:bluetooth_rxtx.c **** 		break;
 350:bluetooth_rxtx.c **** #endif
 351:bluetooth_rxtx.c **** 
 352:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_CHECK:
 353:bluetooth_rxtx.c **** 		data[0] = rr.valid;
 354:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 355:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 356:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 357:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
 358:bluetooth_rxtx.c **** 		*data_len = 5;
 359:bluetooth_rxtx.c **** 		break;
 360:bluetooth_rxtx.c **** 
 361:bluetooth_rxtx.c **** 	case UBERTOOTH_STOP:
 362:bluetooth_rxtx.c **** 		requested_mode = MODE_IDLE;
 363:bluetooth_rxtx.c **** 		break;
 364:bluetooth_rxtx.c **** 
 365:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_MOD:
 366:bluetooth_rxtx.c **** 		data[0] = modulation;
 367:bluetooth_rxtx.c **** 		*data_len = 1;
 368:bluetooth_rxtx.c **** 		break;
 369:bluetooth_rxtx.c **** 
 370:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_MOD:
 371:bluetooth_rxtx.c **** 		modulation = request_params[0];
 372:bluetooth_rxtx.c **** 		break;
 373:bluetooth_rxtx.c **** 
 374:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CHANNEL:
 375:bluetooth_rxtx.c **** 		data[0] = channel & 0xFF;
 376:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
ARM GAS  /tmp/ccLwKaeN.s 			page 8


 377:bluetooth_rxtx.c **** 		*data_len = 2;
 378:bluetooth_rxtx.c **** 		break;
 379:bluetooth_rxtx.c **** 
 380:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CHANNEL:
 381:bluetooth_rxtx.c **** 		requested_channel = request_params[0];
 382:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 383:bluetooth_rxtx.c **** 		if (requested_channel > MAX_FREQ) {
 384:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 385:bluetooth_rxtx.c **** 			requested_channel = 2402;
 386:bluetooth_rxtx.c **** 		}
 387:bluetooth_rxtx.c **** 		/* fixed channel mode, can be outside bluetooth band */
 388:bluetooth_rxtx.c **** 		else {
 389:bluetooth_rxtx.c **** 			hop_mode = HOP_NONE;
 390:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 391:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 392:bluetooth_rxtx.c **** 		}
 393:bluetooth_rxtx.c **** 
 394:bluetooth_rxtx.c **** 		le_adv_channel = requested_channel;
 395:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 396:bluetooth_rxtx.c **** 			channel = requested_channel;
 397:bluetooth_rxtx.c **** 			requested_channel = 0;
 398:bluetooth_rxtx.c **** 
 399:bluetooth_rxtx.c **** 			/* CS threshold is mode-dependent. Update it after
 400:bluetooth_rxtx.c **** 			 * possible mode change. TODO - kludgy. */
 401:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set(channel);
 402:bluetooth_rxtx.c **** 		}
 403:bluetooth_rxtx.c **** 		break;
 404:bluetooth_rxtx.c **** 
 405:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ISP:
 406:bluetooth_rxtx.c **** 		set_isp();
 407:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 408:bluetooth_rxtx.c **** 		break;
 409:bluetooth_rxtx.c **** 
 410:bluetooth_rxtx.c **** 	case UBERTOOTH_FLASH:
 411:bluetooth_rxtx.c **** 		bootloader_ctrl = DFU_MODE;
 412:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 413:bluetooth_rxtx.c **** 		break;
 414:bluetooth_rxtx.c **** 
 415:bluetooth_rxtx.c **** 	case UBERTOOTH_SPECAN:
 416:bluetooth_rxtx.c **** 		if (request_params[0] < 2049 || request_params[0] > 3072 ||
 417:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 418:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 419:bluetooth_rxtx.c **** 			return 0;
 420:bluetooth_rxtx.c **** 		low_freq = request_params[0];
 421:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 422:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 423:bluetooth_rxtx.c **** 		*data_len = 0;
 424:bluetooth_rxtx.c **** 		break;
 425:bluetooth_rxtx.c **** 
 426:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_GENERIC:
 427:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_GENERIC;
 428:bluetooth_rxtx.c **** 		*data_len = 0;
 429:bluetooth_rxtx.c **** 		break;
 430:bluetooth_rxtx.c **** 
 431:bluetooth_rxtx.c **** 	case UBERTOOTH_LED_SPECAN:
 432:bluetooth_rxtx.c **** 		if (request_params[0] > 256)
 433:bluetooth_rxtx.c **** 			return 0;
ARM GAS  /tmp/ccLwKaeN.s 			page 9


 434:bluetooth_rxtx.c **** 		rssi_threshold = 54 - request_params[0];
 435:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 436:bluetooth_rxtx.c **** 		*data_len = 0;
 437:bluetooth_rxtx.c **** 		break;
 438:bluetooth_rxtx.c **** 
 439:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_REV_NUM:
 440:bluetooth_rxtx.c **** 		data[0] = 0x00;
 441:bluetooth_rxtx.c **** 		data[1] = 0x00;
 442:bluetooth_rxtx.c **** 
 443:bluetooth_rxtx.c **** 		length = (u8)strlen(GIT_REVISION);
 444:bluetooth_rxtx.c **** 		data[2] = length;
 445:bluetooth_rxtx.c **** 
 446:bluetooth_rxtx.c **** 		memcpy(&data[3], GIT_REVISION, length);
 447:bluetooth_rxtx.c **** 
 448:bluetooth_rxtx.c **** 		*data_len = 2 + 1 + length;
 449:bluetooth_rxtx.c **** 		break;
 450:bluetooth_rxtx.c **** 
 451:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_COMPILE_INFO:
 452:bluetooth_rxtx.c **** 		length = (u8)strlen(compile_info);
 453:bluetooth_rxtx.c **** 		data[0] = length;
 454:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 455:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 456:bluetooth_rxtx.c **** 		break;
 457:bluetooth_rxtx.c **** 
 458:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_BOARD_ID:
 459:bluetooth_rxtx.c **** 		data[0] = BOARD_ID;
 460:bluetooth_rxtx.c **** 		*data_len = 1;
 461:bluetooth_rxtx.c **** 		break;
 462:bluetooth_rxtx.c **** 
 463:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_SQUELCH:
 464:bluetooth_rxtx.c **** 		cs_threshold_req = (int8_t)request_params[0];
 465:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 466:bluetooth_rxtx.c **** 		break;
 467:bluetooth_rxtx.c **** 
 468:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SQUELCH:
 469:bluetooth_rxtx.c **** 		data[0] = cs_threshold_req;
 470:bluetooth_rxtx.c **** 		*data_len = 1;
 471:bluetooth_rxtx.c **** 		break;
 472:bluetooth_rxtx.c **** 
 473:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_BDADDR:
 474:bluetooth_rxtx.c **** 		target.address = 0;
 475:bluetooth_rxtx.c **** 		target.syncword = 0;
 476:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 477:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 478:bluetooth_rxtx.c **** 		}
 479:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 480:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 481:bluetooth_rxtx.c **** 		}
 482:bluetooth_rxtx.c **** 		precalc();
 483:bluetooth_rxtx.c **** 		break;
 484:bluetooth_rxtx.c **** 
 485:bluetooth_rxtx.c **** 	case UBERTOOTH_START_HOPPING:
 486:bluetooth_rxtx.c **** 		clkn_offset = 0;
 487:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 488:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 489:bluetooth_rxtx.c **** 			clkn_offset |= data[i];
 490:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccLwKaeN.s 			page 10


 491:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
 492:bluetooth_rxtx.c **** 		dma_discard = 1;
 493:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 494:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 495:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 496:bluetooth_rxtx.c **** 		break;
 497:bluetooth_rxtx.c **** 
 498:bluetooth_rxtx.c **** 	case UBERTOOTH_AFH:
 499:bluetooth_rxtx.c **** 		hop_mode = HOP_AFH;
 500:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 501:bluetooth_rxtx.c **** 
 502:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 503:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 504:bluetooth_rxtx.c **** 		}
 505:bluetooth_rxtx.c **** 		used_channels = 0;
 506:bluetooth_rxtx.c **** 		afh_enabled = 1;
 507:bluetooth_rxtx.c **** 		break;
 508:bluetooth_rxtx.c **** 
 509:bluetooth_rxtx.c **** 	case UBERTOOTH_HOP:
 510:bluetooth_rxtx.c **** 		do_hop = 1;
 511:bluetooth_rxtx.c **** 		break;
 512:bluetooth_rxtx.c **** 
 513:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CLOCK:
 514:bluetooth_rxtx.c **** 		clock = data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24;
 515:bluetooth_rxtx.c **** 		clkn = clock;
 516:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 517:bluetooth_rxtx.c **** 		break;
 518:bluetooth_rxtx.c **** 
 519:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_AFHMAP:
 520:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 521:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 522:bluetooth_rxtx.c **** 		}
 523:bluetooth_rxtx.c **** 		afh_enabled = 1;
 524:bluetooth_rxtx.c **** 		*data_len = 10;
 525:bluetooth_rxtx.c **** 		break;
 526:bluetooth_rxtx.c **** 
 527:bluetooth_rxtx.c **** 	case UBERTOOTH_CLEAR_AFHMAP:
 528:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 529:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 530:bluetooth_rxtx.c **** 		}
 531:bluetooth_rxtx.c **** 		afh_enabled = 0;
 532:bluetooth_rxtx.c **** 		*data_len = 10;
 533:bluetooth_rxtx.c **** 		break;
 534:bluetooth_rxtx.c **** 
 535:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CLOCK:
 536:bluetooth_rxtx.c **** 		clock = clkn;
 537:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 538:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 539:bluetooth_rxtx.c **** 		}
 540:bluetooth_rxtx.c **** 		*data_len = 4;
 541:bluetooth_rxtx.c **** 		break;
 542:bluetooth_rxtx.c **** 
 543:bluetooth_rxtx.c **** 	case UBERTOOTH_TRIM_CLOCK:
 544:bluetooth_rxtx.c **** 		clk100ns_offset = (data[0] << 8) | (data[1] << 0);
 545:bluetooth_rxtx.c **** 		break;
 546:bluetooth_rxtx.c **** 
 547:bluetooth_rxtx.c **** 	case UBERTOOTH_FIX_CLOCK_DRIFT:
ARM GAS  /tmp/ccLwKaeN.s 			page 11


 548:bluetooth_rxtx.c **** 		clk_drift_ppm += (int16_t)(data[0] << 8) | (data[1] << 0);
 549:bluetooth_rxtx.c **** 
 550:bluetooth_rxtx.c **** 		// Too slow
 551:bluetooth_rxtx.c **** 		if (clk_drift_ppm < 0) {
 552:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / (uint16_t)(-clk_drift_ppm);
 553:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 554:bluetooth_rxtx.c **** 		}
 555:bluetooth_rxtx.c **** 		// Too fast
 556:bluetooth_rxtx.c **** 		else if (clk_drift_ppm > 0) {
 557:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / clk_drift_ppm;
 558:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 559:bluetooth_rxtx.c **** 		}
 560:bluetooth_rxtx.c **** 		// Don't trim
 561:bluetooth_rxtx.c **** 		else {
 562:bluetooth_rxtx.c **** 			clk_drift_correction = 0;
 563:bluetooth_rxtx.c **** 			clkn_next_drift_fix = 0;
 564:bluetooth_rxtx.c **** 		}
 565:bluetooth_rxtx.c **** 
 566:bluetooth_rxtx.c **** 		break;
 567:bluetooth_rxtx.c **** 
 568:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SNIFFING:
 569:bluetooth_rxtx.c **** 		le.do_follow = request_params[0];
 570:bluetooth_rxtx.c **** 		*data_len = 0;
 571:bluetooth_rxtx.c **** 
 572:bluetooth_rxtx.c **** 		do_hop = 0;
 573:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 574:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 575:bluetooth_rxtx.c **** 
 576:bluetooth_rxtx.c **** 		usb_queue_init();
 577:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 578:bluetooth_rxtx.c **** 		break;
 579:bluetooth_rxtx.c **** 
 580:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_ACCESS_ADDRESS:
 581:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 582:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 583:bluetooth_rxtx.c **** 		}
 584:bluetooth_rxtx.c **** 		*data_len = 4;
 585:bluetooth_rxtx.c **** 		break;
 586:bluetooth_rxtx.c **** 
 587:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ACCESS_ADDRESS:
 588:bluetooth_rxtx.c **** 		le_set_access_address(data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24);
 589:bluetooth_rxtx.c **** 		le.target_set = 1;
 590:bluetooth_rxtx.c **** 		debug_printf("AA set\n");
 591:bluetooth_rxtx.c **** 		break;
 592:bluetooth_rxtx.c **** // Sopan Sarkar
 593:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_HOP_INTERVAL:
 594:bluetooth_rxtx.c **** 		le.conn_interval = (data[0] | data[1] << 8);
 595:bluetooth_rxtx.c **** 		debug_printf("Hop interval set: %d\n", le.conn_interval);
 596:bluetooth_rxtx.c **** 		break;
 597:bluetooth_rxtx.c **** 
 598:bluetooth_rxtx.c **** ///////////////////////////////////////////
 599:bluetooth_rxtx.c **** 
 600:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING:
 601:bluetooth_rxtx.c **** 		// do something! just don't commit anything here
 602:bluetooth_rxtx.c **** 		break;
 603:bluetooth_rxtx.c **** 
 604:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING_REPLY:
ARM GAS  /tmp/ccLwKaeN.s 			page 12


 605:bluetooth_rxtx.c **** 		// after you do something, tell me what you did!
 606:bluetooth_rxtx.c **** 		// don't commit here please
 607:bluetooth_rxtx.c **** 		data[0] = 0x13;
 608:bluetooth_rxtx.c **** 		data[1] = 0x37;
 609:bluetooth_rxtx.c **** 		*data_len = 2;
 610:bluetooth_rxtx.c **** 		break;
 611:bluetooth_rxtx.c **** 
 612:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CRC_VERIFY:
 613:bluetooth_rxtx.c **** 		data[0] = le.crc_verify ? 1 : 0;
 614:bluetooth_rxtx.c **** 		*data_len = 1;
 615:bluetooth_rxtx.c **** 		break;
 616:bluetooth_rxtx.c **** 
 617:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CRC_VERIFY:
 618:bluetooth_rxtx.c **** 		le.crc_verify = request_params[0] ? 1 : 0;
 619:bluetooth_rxtx.c **** 		break;
 620:bluetooth_rxtx.c **** 
 621:bluetooth_rxtx.c **** 	case UBERTOOTH_POLL:
 622:bluetooth_rxtx.c **** 		p = dequeue();
 623:bluetooth_rxtx.c **** 		if (p != NULL) {
 624:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 625:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
 626:bluetooth_rxtx.c **** 		} else {
 627:bluetooth_rxtx.c **** 			data[0] = 0;
 628:bluetooth_rxtx.c **** 			*data_len = 1;
 629:bluetooth_rxtx.c **** 		}
 630:bluetooth_rxtx.c **** 		break;
 631:bluetooth_rxtx.c **** 
 632:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_PROMISC:
 633:bluetooth_rxtx.c **** 		*data_len = 0;
 634:bluetooth_rxtx.c **** 
 635:bluetooth_rxtx.c **** 		hop_mode = HOP_NONE;
 636:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 637:bluetooth_rxtx.c **** 
 638:bluetooth_rxtx.c **** 		usb_queue_init();
 639:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 640:bluetooth_rxtx.c **** 		break;
 641:bluetooth_rxtx.c **** 
 642:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_REGISTER:
 643:bluetooth_rxtx.c **** 		reg_val = cc2400_get(request_params[0]);
 644:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
 645:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 646:bluetooth_rxtx.c **** 		*data_len = 2;
 647:bluetooth_rxtx.c **** 		break;
 648:bluetooth_rxtx.c **** 
 649:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTER:
 650:bluetooth_rxtx.c **** 		cc2400_set(request_params[0] & 0xff, request_params[1]);
 651:bluetooth_rxtx.c **** 		break;
 652:bluetooth_rxtx.c **** 
 653:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTERS:
 654:bluetooth_rxtx.c **** 		for(i=0; i<request_params[0]; i++) {
 655:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 656:bluetooth_rxtx.c **** 			cc2400_set(data[i*3], reg_val);
 657:bluetooth_rxtx.c **** 		}
 658:bluetooth_rxtx.c **** 		break;
 659:bluetooth_rxtx.c **** 
 660:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_ALL_REGISTERS:
 661:bluetooth_rxtx.c **** 		#define MAX_READ_REG 0x2d
ARM GAS  /tmp/ccLwKaeN.s 			page 13


 662:bluetooth_rxtx.c **** 		for(i=0; i<=MAX_READ_REG; i++) {
 663:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 664:bluetooth_rxtx.c **** 			data[i*3] = i;
 665:bluetooth_rxtx.c **** 			data[(i*3)+1] = (reg_val >> 8) & 0xff;
 666:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 667:bluetooth_rxtx.c **** 		}
 668:bluetooth_rxtx.c **** 		*data_len = MAX_READ_REG*3;
 669:bluetooth_rxtx.c **** 		break;
 670:bluetooth_rxtx.c **** 
 671:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_GENERIC_PACKET:
 672:bluetooth_rxtx.c **** 		i = 7 + data[6];
 673:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 674:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 675:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_GENERIC;
 676:bluetooth_rxtx.c **** 		*data_len = 0;
 677:bluetooth_rxtx.c **** 		break;
 678:bluetooth_rxtx.c **** 
 679:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE:
 680:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, 6);
 681:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 682:bluetooth_rxtx.c **** 		break;
 683:bluetooth_rxtx.c **** // Sopan Sarkar
 684:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_TRANSMIT:
 685:bluetooth_rxtx.c **** 		debug_printf("Transmitting on index: %d\n", data[0]);
 686:bluetooth_rxtx.c **** 		le.channel_idx = data[0];
 687:bluetooth_rxtx.c **** 		channel = btle_channel_index_to_phys(le.channel_idx);
 688:bluetooth_rxtx.c **** 		hop_mode = HOP_TX_LE;
 689:bluetooth_rxtx.c **** 		le.interval_timer = le.conn_interval;
 690:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_TRANSMIT_LE;
 691:bluetooth_rxtx.c **** 		break;
 692:bluetooth_rxtx.c **** ////////////////////////////
 693:bluetooth_rxtx.c **** 	case UBERTOOTH_LE_SET_ADV_DATA:
 694:bluetooth_rxtx.c **** 		// make sure the data fits in our buffer
 695:bluetooth_rxtx.c **** 		if (data_in_len > LE_ADV_MAX_LEN)
 696:bluetooth_rxtx.c **** 			return 0;
 697:bluetooth_rxtx.c **** 		le_adv_len = data_in_len;
 698:bluetooth_rxtx.c **** 		memcpy(le_adv_data, data, le_adv_len);
 699:bluetooth_rxtx.c **** 		break;
 700:bluetooth_rxtx.c **** 
 701:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SET_TARGET:
 702:bluetooth_rxtx.c **** 		// Addresses appear in packets in reverse-octet order.
 703:bluetooth_rxtx.c **** 		// Store the target address in reverse order so that we can do a simple memcmp later
 704:bluetooth_rxtx.c **** 		if (data[6] > 48) {
 705:bluetooth_rxtx.c **** 			return 0; // invalid mask
 706:bluetooth_rxtx.c **** 		}
 707:bluetooth_rxtx.c **** 		else if (data[6] == 0) {
 708:bluetooth_rxtx.c **** 			le.target_set = 0;
 709:bluetooth_rxtx.c **** 			memset(le.target, 0, 6);
 710:bluetooth_rxtx.c **** 			memset(le.target_mask, 0, 6);
 711:bluetooth_rxtx.c **** 		} else {
 712:bluetooth_rxtx.c **** 			unsigned last;
 713:bluetooth_rxtx.c **** 
 714:bluetooth_rxtx.c **** 			for (i = 0; i < 6; ++i)
 715:bluetooth_rxtx.c **** 				le.target[i] = data[5-i];
 716:bluetooth_rxtx.c **** 
 717:bluetooth_rxtx.c **** 			// compute mask
 718:bluetooth_rxtx.c **** 			memset(le.target_mask, 0, 6);
ARM GAS  /tmp/ccLwKaeN.s 			page 14


 719:bluetooth_rxtx.c **** 			for (i = 5; data[6] > 8; --i, data[6] -= 8) {
 720:bluetooth_rxtx.c **** 				le.target_mask[i] = 0xff;
 721:bluetooth_rxtx.c **** 			}
 722:bluetooth_rxtx.c **** 			last = i;
 723:bluetooth_rxtx.c **** 
 724:bluetooth_rxtx.c **** 			if (data[6] > 0) {
 725:bluetooth_rxtx.c **** 				uint8_t final_byte = 0;
 726:bluetooth_rxtx.c **** 				for (i = 0; i < data[6]; ++i) {
 727:bluetooth_rxtx.c **** 					final_byte >>= 1;
 728:bluetooth_rxtx.c **** 					final_byte |= 0b10000000;
 729:bluetooth_rxtx.c **** 				}
 730:bluetooth_rxtx.c **** 				le.target_mask[last] = final_byte;
 731:bluetooth_rxtx.c **** 			}
 732:bluetooth_rxtx.c **** 
 733:bluetooth_rxtx.c **** 			// in case the user specifies a bad mask
 734:bluetooth_rxtx.c **** 			for (i = 0; i < 5; ++i)
 735:bluetooth_rxtx.c **** 				le.target[i] &= le.target_mask[i];
 736:bluetooth_rxtx.c **** 
 737:bluetooth_rxtx.c **** 			le.target_set = 1;
 738:bluetooth_rxtx.c **** 		}
 739:bluetooth_rxtx.c **** 		break;
 740:bluetooth_rxtx.c **** 
 741:bluetooth_rxtx.c **** 	case UBERTOOTH_CANCEL_FOLLOW:
 742:bluetooth_rxtx.c **** 		// cancel following an active connection
 743:bluetooth_rxtx.c **** 		cancel_follow = 1;
 744:bluetooth_rxtx.c **** 		break;
 745:bluetooth_rxtx.c **** 
 746:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 747:bluetooth_rxtx.c **** 	case UBERTOOTH_JAM_MODE:
 748:bluetooth_rxtx.c **** 		jam_mode = request_params[0];
 749:bluetooth_rxtx.c **** 		break;
 750:bluetooth_rxtx.c **** #endif
 751:bluetooth_rxtx.c **** 
 752:bluetooth_rxtx.c **** 	case UBERTOOTH_EGO:
 753:bluetooth_rxtx.c **** #ifndef TX_ENABLE
 754:bluetooth_rxtx.c **** 		if (ego_mode == EGO_JAM)
 755:bluetooth_rxtx.c **** 			return 0;
 756:bluetooth_rxtx.c **** #endif
 757:bluetooth_rxtx.c **** 		requested_mode = MODE_EGO;
 758:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
 759:bluetooth_rxtx.c **** 		break;
 760:bluetooth_rxtx.c **** 
 761:bluetooth_rxtx.c **** 	default:
 762:bluetooth_rxtx.c **** 		return 0;
 763:bluetooth_rxtx.c **** 	}
 764:bluetooth_rxtx.c **** 	return 1;
 765:bluetooth_rxtx.c **** }
 766:bluetooth_rxtx.c **** 
 767:bluetooth_rxtx.c **** /* Update CLKN. */
 768:bluetooth_rxtx.c **** void TIMER0_IRQHandler()
 769:bluetooth_rxtx.c **** {
 770:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 771:bluetooth_rxtx.c **** 
 772:bluetooth_rxtx.c **** 		clkn += clkn_offset + 1;
 773:bluetooth_rxtx.c **** 		clkn_offset = 0;
 774:bluetooth_rxtx.c **** 
 775:bluetooth_rxtx.c **** 		uint32_t le_clk = (clkn - le.conn_epoch) & 0x03;
ARM GAS  /tmp/ccLwKaeN.s 			page 15


 776:bluetooth_rxtx.c **** 
 777:bluetooth_rxtx.c **** 		/* Trigger hop based on mode */
 778:bluetooth_rxtx.c **** 
 779:bluetooth_rxtx.c **** 		/* NONE or SWEEP -> 25 Hz */
 780:bluetooth_rxtx.c **** 		if (hop_mode == HOP_NONE || hop_mode == HOP_SWEEP) {
 781:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 782:bluetooth_rxtx.c **** 				do_hop = 1;
 783:bluetooth_rxtx.c **** 		}
 784:bluetooth_rxtx.c **** 		/* BLUETOOTH -> 1600 Hz */
 785:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BLUETOOTH) {
 786:bluetooth_rxtx.c **** 			if ((clkn & 0x1) == 0)
 787:bluetooth_rxtx.c **** 				do_hop = 1;
 788:bluetooth_rxtx.c **** 		}
 789:bluetooth_rxtx.c **** 		/* BLUETOOTH Low Energy -> 7.5ms - 4.0s in multiples of 1.25 ms */
 790:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BTLE) {
 791:bluetooth_rxtx.c **** 			// Only hop if connected
 792:bluetooth_rxtx.c **** 			if (le.link_state == LINK_CONNECTED && le_clk == 0) {
 793:bluetooth_rxtx.c **** 				--le.interval_timer;
 794:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 795:bluetooth_rxtx.c **** 					do_hop = 1;
 796:bluetooth_rxtx.c **** 					++le.conn_count;
 797:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 798:bluetooth_rxtx.c **** 				} else {
 799:bluetooth_rxtx.c **** 					TXLED_CLR; // hack!
 800:bluetooth_rxtx.c **** 				}
 801:bluetooth_rxtx.c **** 			}
 802:bluetooth_rxtx.c **** 		}
 803:bluetooth_rxtx.c **** //////////////////////////////////// Sopan Sarkar
 804:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_TX_LE) {
 805:bluetooth_rxtx.c **** 			// Only hop if connected
 806:bluetooth_rxtx.c **** 			if (le_clk == 0) {
 807:bluetooth_rxtx.c **** 				--le.interval_timer;
 808:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 809:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 810:bluetooth_rxtx.c **** 					do_transmit = 1;
 811:bluetooth_rxtx.c **** 				} else {
 812:bluetooth_rxtx.c **** 					TXLED_CLR; // hack!
 813:bluetooth_rxtx.c **** 				}
 814:bluetooth_rxtx.c **** 			}
 815:bluetooth_rxtx.c **** 		}
 816:bluetooth_rxtx.c **** ////////////////////////////////////////////////
 817:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_AFH) {
 818:bluetooth_rxtx.c **** 			if( (last_hop + hop_timeout) == clkn ) {
 819:bluetooth_rxtx.c **** 				do_hop = 1;
 820:bluetooth_rxtx.c **** 			}
 821:bluetooth_rxtx.c **** 		}
 822:bluetooth_rxtx.c **** 
 823:bluetooth_rxtx.c **** 		// Fix linear clock drift deviation
 824:bluetooth_rxtx.c **** 		if(clkn_next_drift_fix != 0 && clk100ns_offset == 0) {
 825:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 826:bluetooth_rxtx.c **** 
 827:bluetooth_rxtx.c **** 				// Too fast
 828:bluetooth_rxtx.c **** 				if(clk_drift_ppm >= 0) {
 829:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
 830:bluetooth_rxtx.c **** 				}
 831:bluetooth_rxtx.c **** 
 832:bluetooth_rxtx.c **** 				// Too slow
ARM GAS  /tmp/ccLwKaeN.s 			page 16


 833:bluetooth_rxtx.c **** 				else {
 834:bluetooth_rxtx.c **** 					clk100ns_offset = 6249;
 835:bluetooth_rxtx.c **** 				}
 836:bluetooth_rxtx.c **** 				clkn_last_drift_fix = clkn;
 837:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 838:bluetooth_rxtx.c **** 			}
 839:bluetooth_rxtx.c **** 		}
 840:bluetooth_rxtx.c **** 
 841:bluetooth_rxtx.c **** 		// Negative clock correction
 842:bluetooth_rxtx.c **** 		if(clk100ns_offset > 3124)
 843:bluetooth_rxtx.c **** 			clkn += 2;
 844:bluetooth_rxtx.c **** 
 845:bluetooth_rxtx.c **** 		T0MR0 = 3124 + clk100ns_offset;
 846:bluetooth_rxtx.c **** 		clk100ns_offset = 0;
 847:bluetooth_rxtx.c **** 
 848:bluetooth_rxtx.c **** 		/* Ack interrupt */
 849:bluetooth_rxtx.c **** 		T0IR = TIR_MR0_Interrupt;
 850:bluetooth_rxtx.c **** 	}
 851:bluetooth_rxtx.c **** }
 852:bluetooth_rxtx.c **** 
 853:bluetooth_rxtx.c **** /* EINT3 handler is also defined in ubertooth.c for TC13BADGE. */
 854:bluetooth_rxtx.c **** #ifndef TC13BADGE
 855:bluetooth_rxtx.c **** void EINT3_IRQHandler()
 856:bluetooth_rxtx.c **** {
 857:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 858:bluetooth_rxtx.c **** 	IO2IntClr   = PIN_GIO6; // clear interrupt
 859:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;           // enable SPI
 860:bluetooth_rxtx.c **** 	cs_trigger  = 1;        // signal trigger
 861:bluetooth_rxtx.c **** 	if (hop_mode == HOP_BLUETOOTH)
 862:bluetooth_rxtx.c **** 		dma_discard = 0;
 863:bluetooth_rxtx.c **** 
 864:bluetooth_rxtx.c **** }
 865:bluetooth_rxtx.c **** #endif // TC13BADGE
 866:bluetooth_rxtx.c **** 
 867:bluetooth_rxtx.c **** /*
 868:bluetooth_rxtx.c ****  * Sleep (busy wait) for 'millis' milliseconds
 869:bluetooth_rxtx.c ****  * Needs clkn. Be sure to call clkn_init() before using it.
 870:bluetooth_rxtx.c ****  */
 871:bluetooth_rxtx.c **** static void msleep(uint32_t millis)
 872:bluetooth_rxtx.c **** {
 873:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
 874:bluetooth_rxtx.c **** 	uint32_t stop_at = now + millis * 10000 / 3125; // millis -> clkn ticks
 875:bluetooth_rxtx.c **** 
 876:bluetooth_rxtx.c **** 	// handle clkn overflow
 877:bluetooth_rxtx.c **** 	if (stop_at >= ((uint32_t)1<<28)) {
 878:bluetooth_rxtx.c **** 		stop_at -= ((uint32_t)1<<28);
 879:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) >= now || (clkn & 0xffffff) < stop_at);
 880:bluetooth_rxtx.c **** 	} else {
 881:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) < stop_at);
 882:bluetooth_rxtx.c **** 	}
 883:bluetooth_rxtx.c **** }
 884:bluetooth_rxtx.c **** 
 885:bluetooth_rxtx.c **** void legacy_DMA_IRQHandler();
 886:bluetooth_rxtx.c **** void le_DMA_IRQHandler();
 887:bluetooth_rxtx.c **** void DMA_IRQHandler(void) {
 888:bluetooth_rxtx.c **** 	if (mode == MODE_BT_FOLLOW_LE)
 889:bluetooth_rxtx.c **** 		le_DMA_IRQHandler();
ARM GAS  /tmp/ccLwKaeN.s 			page 17


 890:bluetooth_rxtx.c **** 	else
 891:bluetooth_rxtx.c **** 		legacy_DMA_IRQHandler();
 892:bluetooth_rxtx.c **** 
 893:bluetooth_rxtx.c **** 	// DMA channel 7: debug UART
 894:bluetooth_rxtx.c **** 	if (DMACIntStat & (1 << 7)) {
 895:bluetooth_rxtx.c **** 		// TC -- DMA completed, unset flag so another printf can occur
 896:bluetooth_rxtx.c **** 		if (DMACIntTCStat & (1 << 7)) {
 897:bluetooth_rxtx.c **** 			DMACIntTCClear = (1 << 7);
 898:bluetooth_rxtx.c **** 			debug_dma_active = 0;
 899:bluetooth_rxtx.c **** 		}
 900:bluetooth_rxtx.c **** 		// error -- blow up
 901:bluetooth_rxtx.c **** 		if (DMACIntErrStat & (1 << 7)) {
 902:bluetooth_rxtx.c **** 			DMACIntErrClr = (1 << 7);
 903:bluetooth_rxtx.c **** 			// FIXME do something better here
 904:bluetooth_rxtx.c **** 			USRLED_SET;
 905:bluetooth_rxtx.c **** 			while (1) { }
 906:bluetooth_rxtx.c **** 		}
 907:bluetooth_rxtx.c **** 	}
 908:bluetooth_rxtx.c **** }
 909:bluetooth_rxtx.c **** 
 910:bluetooth_rxtx.c **** void legacy_DMA_IRQHandler()
 911:bluetooth_rxtx.c **** {
 912:bluetooth_rxtx.c **** 
 913:bluetooth_rxtx.c **** 	if ( mode == MODE_RX_SYMBOLS
 914:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW
 915:bluetooth_rxtx.c **** 	   || mode == MODE_SPECAN
 916:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW_LE
 917:bluetooth_rxtx.c **** 	   || mode == MODE_BT_PROMISC_LE
 918:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE
 919:bluetooth_rxtx.c **** 	   || mode == MODE_RX_GENERIC)
 920:bluetooth_rxtx.c **** 	{
 921:bluetooth_rxtx.c **** 		/* interrupt on channel 0 */
 922:bluetooth_rxtx.c **** 		if (DMACIntStat & (1 << 0)) {
 923:bluetooth_rxtx.c **** 			if (DMACIntTCStat & (1 << 0)) {
 924:bluetooth_rxtx.c **** 				DMACIntTCClear = (1 << 0);
 925:bluetooth_rxtx.c **** 
 926:bluetooth_rxtx.c **** 				if (hop_mode == HOP_BLUETOOTH)
 927:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 928:bluetooth_rxtx.c **** 
 929:bluetooth_rxtx.c **** 				idle_buf_clk100ns  = CLK100NS;
 930:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 931:bluetooth_rxtx.c **** 				idle_buf_channel   = channel;
 932:bluetooth_rxtx.c **** 
 933:bluetooth_rxtx.c **** 				/* Keep buffer swapping in sync with DMA. */
 934:bluetooth_rxtx.c **** 				volatile uint8_t* tmp = active_rxbuf;
 935:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 936:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 937:bluetooth_rxtx.c **** 
 938:bluetooth_rxtx.c **** 				++rx_tc;
 939:bluetooth_rxtx.c **** 			}
 940:bluetooth_rxtx.c **** 			if (DMACIntErrStat & (1 << 0)) {
 941:bluetooth_rxtx.c **** 				DMACIntErrClr = (1 << 0);
 942:bluetooth_rxtx.c **** 				++rx_err;
 943:bluetooth_rxtx.c **** 			}
 944:bluetooth_rxtx.c **** 		}
 945:bluetooth_rxtx.c **** 	}
 946:bluetooth_rxtx.c **** }
ARM GAS  /tmp/ccLwKaeN.s 			page 18


 947:bluetooth_rxtx.c **** 
 948:bluetooth_rxtx.c **** static void cc2400_idle()
 949:bluetooth_rxtx.c **** {
 950:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 951:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 952:bluetooth_rxtx.c **** 
 953:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 954:bluetooth_rxtx.c **** 	PAEN_CLR;
 955:bluetooth_rxtx.c **** 	HGM_CLR;
 956:bluetooth_rxtx.c **** #endif
 957:bluetooth_rxtx.c **** 
 958:bluetooth_rxtx.c **** 	RXLED_CLR;
 959:bluetooth_rxtx.c **** 	TXLED_CLR;
 960:bluetooth_rxtx.c **** 	USRLED_CLR;
 961:bluetooth_rxtx.c **** 
 962:bluetooth_rxtx.c **** 	clkn_stop();
 963:bluetooth_rxtx.c **** 	dio_ssp_stop();
 964:bluetooth_rxtx.c **** 	cs_reset();
 965:bluetooth_rxtx.c **** 	rssi_reset();
 966:bluetooth_rxtx.c **** 
 967:bluetooth_rxtx.c **** 	/* hopping stuff */
 968:bluetooth_rxtx.c **** 	hop_mode = HOP_NONE;
 969:bluetooth_rxtx.c **** 	do_hop = 0;
 970:bluetooth_rxtx.c **** 	channel = 2441;
 971:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 972:bluetooth_rxtx.c **** 	hop_timeout = 158;
 973:bluetooth_rxtx.c **** 	requested_channel = 0;
 974:bluetooth_rxtx.c **** 	le_adv_channel = 2402;
 975:bluetooth_rxtx.c **** 
 976:bluetooth_rxtx.c **** 
 977:bluetooth_rxtx.c **** 	/* bulk USB stuff */
 978:bluetooth_rxtx.c **** 	idle_buf_clkn_high = 0;
 979:bluetooth_rxtx.c **** 	idle_buf_clk100ns = 0;
 980:bluetooth_rxtx.c **** 	idle_buf_channel = 0;
 981:bluetooth_rxtx.c **** 	dma_discard = 0;
 982:bluetooth_rxtx.c **** 	status = 0;
 983:bluetooth_rxtx.c **** 
 984:bluetooth_rxtx.c **** 	/* operation mode */
 985:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 986:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 987:bluetooth_rxtx.c **** 	jam_mode = JAM_NONE;
 988:bluetooth_rxtx.c **** 	ego_mode = EGO_FOLLOW;
 989:bluetooth_rxtx.c **** 
 990:bluetooth_rxtx.c **** 	modulation = MOD_BT_BASIC_RATE;
 991:bluetooth_rxtx.c **** 
 992:bluetooth_rxtx.c **** 	/* specan stuff */
 993:bluetooth_rxtx.c **** 	low_freq = 2400;
 994:bluetooth_rxtx.c **** 	high_freq = 2483;
 995:bluetooth_rxtx.c **** 	rssi_threshold = -30;
 996:bluetooth_rxtx.c **** 
 997:bluetooth_rxtx.c **** 	target.address = 0;
 998:bluetooth_rxtx.c **** 	target.syncword = 0;
 999:bluetooth_rxtx.c **** }
1000:bluetooth_rxtx.c **** 
1001:bluetooth_rxtx.c **** /* start un-buffered rx */
1002:bluetooth_rxtx.c **** static void cc2400_rx()
1003:bluetooth_rxtx.c **** {
ARM GAS  /tmp/ccLwKaeN.s 			page 19


1004:bluetooth_rxtx.c **** 	u16 mdmctrl = 0;
1005:bluetooth_rxtx.c **** 
1006:bluetooth_rxtx.c **** 	if((modulation == MOD_BT_BASIC_RATE) || (modulation == MOD_BT_LOW_ENERGY)) {
1007:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
1008:bluetooth_rxtx.c **** 			mdmctrl = 0x0029; // 160 kHz frequency deviation
1009:bluetooth_rxtx.c **** 		} else if (modulation == MOD_BT_LOW_ENERGY) {
1010:bluetooth_rxtx.c **** 			mdmctrl = 0x0040; // 250 kHz frequency deviation
1011:bluetooth_rxtx.c **** 		}
1012:bluetooth_rxtx.c **** 		cc2400_set(MANAND,  0x7fff);
1013:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
1014:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG
1015:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
1016:bluetooth_rxtx.c **** 		// 0 00 00 0 010 00 0 00 0 1
1017:bluetooth_rxtx.c **** 		//      |  | |   |  +--------> CRC off
1018:bluetooth_rxtx.c **** 		//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1019:bluetooth_rxtx.c **** 		//      |  | +---------------> 2 preamble bytes of 01010101
1020:bluetooth_rxtx.c **** 		//      |  +-----------------> not packet mode
1021:bluetooth_rxtx.c **** 			//      +--------------------> un-buffered mode
1022:bluetooth_rxtx.c **** 		cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
1023:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, mdmctrl);
1024:bluetooth_rxtx.c **** 	}
1025:bluetooth_rxtx.c **** 
1026:bluetooth_rxtx.c **** 	// Set up CS register
1027:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set(channel);
1028:bluetooth_rxtx.c **** 
1029:bluetooth_rxtx.c **** 	clkn_start();
1030:bluetooth_rxtx.c **** 
1031:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1032:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1033:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1034:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
1035:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1036:bluetooth_rxtx.c **** 	PAEN_SET;
1037:bluetooth_rxtx.c **** 	HGM_SET;
1038:bluetooth_rxtx.c **** #endif
1039:bluetooth_rxtx.c **** }
1040:bluetooth_rxtx.c **** 
1041:bluetooth_rxtx.c **** /* start un-buffered rx */
1042:bluetooth_rxtx.c **** static void cc2400_rx_sync(u32 sync)
1043:bluetooth_rxtx.c **** {
1044:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
1045:bluetooth_rxtx.c **** 
1046:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
1047:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
1048:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
1049:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
1050:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
1051:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
1052:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 0 preamble bytes of 01010101
1053:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
1054:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
1055:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 0
1056:bluetooth_rxtx.c **** 
1057:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
1058:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
1059:bluetooth_rxtx.c **** 		grmdm = 0x0561; // un-buffered mode, packet w/ sync word detection
1060:bluetooth_rxtx.c **** 		// 0 00 00 1 010 11 0 00 0 1
ARM GAS  /tmp/ccLwKaeN.s 			page 20


1061:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
1062:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
1063:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 2 preamble bytes of 01010101
1064:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
1065:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
1066:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 0
1067:bluetooth_rxtx.c **** 
1068:bluetooth_rxtx.c **** 	} else {
1069:bluetooth_rxtx.c **** 		/* oops */
1070:bluetooth_rxtx.c **** 		return;
1071:bluetooth_rxtx.c **** 	}
1072:bluetooth_rxtx.c **** 
1073:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1074:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
1075:bluetooth_rxtx.c **** 
1076:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x124b);
1077:bluetooth_rxtx.c **** 	// 1      2      4b
1078:bluetooth_rxtx.c **** 	// 00 0 1 0 0 10 01001011
1079:bluetooth_rxtx.c **** 	//    | | | | |  +---------> AFC_DELTA = ??
1080:bluetooth_rxtx.c **** 	//    | | | | +------------> AFC settling = 4 pairs (8 bit preamble)
1081:bluetooth_rxtx.c **** 	//    | | | +--------------> no AFC adjust on packet
1082:bluetooth_rxtx.c **** 	//    | | +----------------> do not invert data
1083:bluetooth_rxtx.c **** 	//    | +------------------> TX IF freq 1 0Hz
1084:bluetooth_rxtx.c **** 	//    +--------------------> PRNG off
1085:bluetooth_rxtx.c **** 	//
1086:bluetooth_rxtx.c **** 	// ref: CC2400 datasheet page 67
1087:bluetooth_rxtx.c **** 	// AFC settling explained page 41/42
1088:bluetooth_rxtx.c **** 
1089:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   grmdm);
1090:bluetooth_rxtx.c **** 
1091:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
1092:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
1093:bluetooth_rxtx.c **** 
1094:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
1095:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
1096:bluetooth_rxtx.c **** 
1097:bluetooth_rxtx.c **** 	// Set up CS register
1098:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set(channel);
1099:bluetooth_rxtx.c **** 
1100:bluetooth_rxtx.c **** 	clkn_start();
1101:bluetooth_rxtx.c **** 
1102:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1103:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1104:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1105:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
1106:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1107:bluetooth_rxtx.c **** 	PAEN_SET;
1108:bluetooth_rxtx.c **** 	HGM_SET;
1109:bluetooth_rxtx.c **** #endif
1110:bluetooth_rxtx.c **** }
1111:bluetooth_rxtx.c **** 
1112:bluetooth_rxtx.c **** /* start buffered tx */
1113:bluetooth_rxtx.c **** static void cc2400_tx_sync(uint32_t sync)
1114:bluetooth_rxtx.c **** {
1115:bluetooth_rxtx.c **** #ifdef TX_ENABLE
1116:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
1117:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
ARM GAS  /tmp/ccLwKaeN.s 			page 21


1118:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1119:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
1120:bluetooth_rxtx.c **** 
1121:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1122:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1123:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1124:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 1582310468 8 MSB bits of SYNC_WORD
1125:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1126:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1127:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1128:bluetooth_rxtx.c **** 
1129:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
1130:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
1131:bluetooth_rxtx.c **** 
1132:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel);
1133:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1134:bluetooth_rxtx.c **** 
1135:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
1136:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
1137:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
1138:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1139:bluetooth_rxtx.c **** 	} else {
1140:bluetooth_rxtx.c **** 		/* oops */
1141:bluetooth_rxtx.c **** 		return;
1142:bluetooth_rxtx.c **** 	}
1143:bluetooth_rxtx.c **** 
1144:bluetooth_rxtx.c **** 	clkn_start();
1145:bluetooth_rxtx.c **** 
1146:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1147:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1148:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1149:bluetooth_rxtx.c **** 
1150:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1151:bluetooth_rxtx.c **** 	PAEN_SET;
1152:bluetooth_rxtx.c **** #endif
1153:bluetooth_rxtx.c **** 
1154:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1155:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1156:bluetooth_rxtx.c **** 
1157:bluetooth_rxtx.c **** #endif
1158:bluetooth_rxtx.c **** }
1159:bluetooth_rxtx.c **** 
1160:bluetooth_rxtx.c **** /*
1161:bluetooth_rxtx.c ****  * Transmit a BTLE packet with the specified access address.
1162:bluetooth_rxtx.c ****  *
1163:bluetooth_rxtx.c ****  * All modulation parameters are set within this function. The data
1164:bluetooth_rxtx.c ****  * should not be pre-whitened, but the CRC should be calculated and
1165:bluetooth_rxtx.c ****  * included in the data length.
1166:bluetooth_rxtx.c ****  *
1167:bluetooth_rxtx.c ****  * FIXME: Total packet len must be <= 32 bytes for Reasons. Longer
1168:bluetooth_rxtx.c ****  * packets will be quietly truncated.
1169:bluetooth_rxtx.c ****  */
1170:bluetooth_rxtx.c **** void le_transmit(u32 aa, u8 len, u8 *data)
1171:bluetooth_rxtx.c **** {
1172:bluetooth_rxtx.c **** 	unsigned i, j;
1173:bluetooth_rxtx.c **** 	int bit;
1174:bluetooth_rxtx.c **** 	u8 txbuf[32];
ARM GAS  /tmp/ccLwKaeN.s 			page 22


1175:bluetooth_rxtx.c **** 	u8 byte;
1176:bluetooth_rxtx.c **** 	uint32_t sync = rbit(aa);
1177:bluetooth_rxtx.c **** 
1178:bluetooth_rxtx.c **** 	// lol
1179:bluetooth_rxtx.c **** 	if (len > 32)
1180:bluetooth_rxtx.c **** 		len = 32;
1181:bluetooth_rxtx.c **** 
1182:bluetooth_rxtx.c **** 	// whiten the data and copy it into the txbuf
1183:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(channel)];
1184:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
1185:bluetooth_rxtx.c **** 		byte = data[i];
1186:bluetooth_rxtx.c **** 		txbuf[i] = 0;
1187:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
1188:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
1189:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
1190:bluetooth_rxtx.c **** 			byte >>= 1;
1191:bluetooth_rxtx.c **** 			txbuf[i] |= bit << (7 - j);
1192:bluetooth_rxtx.c **** 		}
1193:bluetooth_rxtx.c **** 	}
1194:bluetooth_rxtx.c **** 
1195:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
1196:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1197:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1198:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
1199:bluetooth_rxtx.c **** 
1200:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0ce1);
1201:bluetooth_rxtx.c **** 	// 0 00 01 1 001 11 0 00 0 1
1202:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1203:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: all 32 bits of SYNC_WORD
1204:bluetooth_rxtx.c **** 	//      |  | +---------------> 1 preamble byte of 01010101
1205:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1206:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1207:bluetooth_rxtx.c **** 
1208:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel);
1209:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1210:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1211:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
1212:bluetooth_rxtx.c **** 
1213:bluetooth_rxtx.c **** 	// set sync word to bit-reversed AA
1214:bluetooth_rxtx.c **** 
1215:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
1216:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
1217:bluetooth_rxtx.c **** 
1218:bluetooth_rxtx.c **** 	// turn on the radio
1219:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1220:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1221:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1222:bluetooth_rxtx.c **** 	TXLED_SET;
1223:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1224:bluetooth_rxtx.c **** 	PAEN_SET;
1225:bluetooth_rxtx.c **** #endif
1226:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1227:bluetooth_rxtx.c **** 
1228:bluetooth_rxtx.c **** 	// copy the packet to the FIFO and strobe STX
1229:bluetooth_rxtx.c **** 	cc2400_fifo_write(len, txbuf);
1230:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1231:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccLwKaeN.s 			page 23


1232:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1233:bluetooth_rxtx.c **** 	TXLED_CLR;
1234:bluetooth_rxtx.c **** 
1235:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
1236:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
1237:bluetooth_rxtx.c **** 
1238:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1239:bluetooth_rxtx.c **** 	PAEN_CLR;
1240:bluetooth_rxtx.c **** #endif
1241:bluetooth_rxtx.c **** }
1242:bluetooth_rxtx.c **** 
1243:bluetooth_rxtx.c **** void le_jam(void) {
1244:bluetooth_rxtx.c **** #ifdef TX_ENABLE
1245:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1246:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1247:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
1248:bluetooth_rxtx.c **** 
1249:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1250:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1251:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1252:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1253:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1254:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1255:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1256:bluetooth_rxtx.c **** 
1257:bluetooth_rxtx.c **** 	// cc2400_set(FSDIV,   channel);
1258:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1259:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1260:bluetooth_rxtx.c **** 
1261:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1262:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1263:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1264:bluetooth_rxtx.c **** 	TXLED_SET;
1265:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1266:bluetooth_rxtx.c **** 	PAEN_SET;
1267:bluetooth_rxtx.c **** #endif
1268:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1269:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1270:bluetooth_rxtx.c **** #endif
1271:bluetooth_rxtx.c **** }
1272:bluetooth_rxtx.c **** 
1273:bluetooth_rxtx.c **** /* TODO - return whether hop happened, or should caller have to keep
1274:bluetooth_rxtx.c ****  * track of this? */
1275:bluetooth_rxtx.c **** void hop(void)
1276:bluetooth_rxtx.c **** {   
1277:bluetooth_rxtx.c ****     //static count = 0;
1278:bluetooth_rxtx.c **** 	do_hop = 0;
1279:bluetooth_rxtx.c **** 	last_hop = clkn;
1280:bluetooth_rxtx.c **** 
1281:bluetooth_rxtx.c **** 	// No hopping, if channel is set correctly, do nothing
1282:bluetooth_rxtx.c **** 	if (hop_mode == HOP_NONE) {
1283:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
1284:bluetooth_rxtx.c **** 			return;
1285:bluetooth_rxtx.c **** 	}
1286:bluetooth_rxtx.c **** 	/* Slow sweep (100 hops/sec)
1287:bluetooth_rxtx.c **** 	 * only hop to currently used channels if AFH is enabled
1288:bluetooth_rxtx.c **** 	 */
ARM GAS  /tmp/ccLwKaeN.s 			page 24


1289:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_SWEEP) {
1290:bluetooth_rxtx.c **** 		do {
1291:bluetooth_rxtx.c **** 			channel += 32;
1292:bluetooth_rxtx.c **** 			if (channel > 2480)
1293:bluetooth_rxtx.c **** 				channel -= 79;
1294:bluetooth_rxtx.c **** 		} while ( used_channels != 0 && afh_enabled && !( afh_map[(channel-2402)/8] & 0x1<<((channel-2402
1295:bluetooth_rxtx.c **** 	}
1296:bluetooth_rxtx.c **** 
1297:bluetooth_rxtx.c **** 	/* AFH detection
1298:bluetooth_rxtx.c **** 	 * only hop to currently unused channesl
1299:bluetooth_rxtx.c **** 	 */
1300:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_AFH) {
1301:bluetooth_rxtx.c **** 		do {
1302:bluetooth_rxtx.c **** 			channel += 32;
1303:bluetooth_rxtx.c **** 			if (channel > 2480)
1304:bluetooth_rxtx.c **** 				channel -= 79;
1305:bluetooth_rxtx.c **** 		} while( used_channels != 79 && (afh_map[(channel-2402)/8] & 0x1<<((channel-2402)%8)) );
1306:bluetooth_rxtx.c **** 	}
1307:bluetooth_rxtx.c **** 
1308:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BLUETOOTH) {
1309:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
1310:bluetooth_rxtx.c **** 	}
1311:bluetooth_rxtx.c **** 	//Sopan Sarkar
1312:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BTLE) {
1313:bluetooth_rxtx.c **** 		if(mapped == 1){
1314:bluetooth_rxtx.c **** 			le.channel_idx = le_map_channel(le.channel_idx, &remapping);
1315:bluetooth_rxtx.c **** 			//debug_printf("Current index: %d\n", le.channel_idx);
1316:bluetooth_rxtx.c **** 			channel = btle_next_hop(&le);
1317:bluetooth_rxtx.c **** 			u8 nxt_idx = le_map_channel(le.channel_idx, &remapping);
1318:bluetooth_rxtx.c **** 			debug_printf("Next index: %d\n", nxt_idx);
1319:bluetooth_rxtx.c **** 			le_promisc_state(4, &nxt_idx, 1);
1320:bluetooth_rxtx.c **** 		}
1321:bluetooth_rxtx.c **** 		else{
1322:bluetooth_rxtx.c **** 			channel = btle_next_hop(&le);
1323:bluetooth_rxtx.c **** 		}
1324:bluetooth_rxtx.c **** 
1325:bluetooth_rxtx.c **** 	}
1326:bluetooth_rxtx.c **** 
1327:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_DIRECT) {
1328:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
1329:bluetooth_rxtx.c **** 	}
1330:bluetooth_rxtx.c **** 	/* IDLE mode, but leave amp on, so don't call cc2400_idle(). */
1331:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
1332:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1333:bluetooth_rxtx.c **** 
1334:bluetooth_rxtx.c **** 	/* Retune */
1335:bluetooth_rxtx.c **** 	if(mode == MODE_TX_SYMBOLS)
1336:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
1337:bluetooth_rxtx.c **** 	else
1338:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel - 1);
1339:bluetooth_rxtx.c **** 
1340:bluetooth_rxtx.c **** 	/* Update CS register if hopping.  */
1341:bluetooth_rxtx.c **** 	if (hop_mode > 0) {
1342:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
1343:bluetooth_rxtx.c **** 	}
1344:bluetooth_rxtx.c **** 
1345:bluetooth_rxtx.c **** 	/* Wait for lock */
ARM GAS  /tmp/ccLwKaeN.s 			page 25


1346:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1347:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1348:bluetooth_rxtx.c **** 
1349:bluetooth_rxtx.c **** 	dma_discard = 1;
1350:bluetooth_rxtx.c **** 
1351:bluetooth_rxtx.c **** 	if(mode == MODE_TX_SYMBOLS)
1352:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
1353:bluetooth_rxtx.c **** 	else
1354:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
1355:bluetooth_rxtx.c **** }
1356:bluetooth_rxtx.c **** 
1357:bluetooth_rxtx.c **** /* Bluetooth packet monitoring */
1358:bluetooth_rxtx.c **** void bt_stream_rx()
1359:bluetooth_rxtx.c **** {
1360:bluetooth_rxtx.c **** 	int8_t rssi;
1361:bluetooth_rxtx.c **** 	int8_t rssi_at_trigger;
1362:bluetooth_rxtx.c **** 
1363:bluetooth_rxtx.c **** 	RXLED_CLR;
1364:bluetooth_rxtx.c **** 
1365:bluetooth_rxtx.c **** 	usb_queue_init();
1366:bluetooth_rxtx.c **** 	dio_ssp_init();
1367:bluetooth_rxtx.c **** 	dma_init_rx_symbols();
1368:bluetooth_rxtx.c **** 	dio_ssp_start();
1369:bluetooth_rxtx.c **** 
1370:bluetooth_rxtx.c **** 	cc2400_rx();
1371:bluetooth_rxtx.c **** 
1372:bluetooth_rxtx.c **** 	cs_trigger_enable();
1373:bluetooth_rxtx.c **** 
1374:bluetooth_rxtx.c **** 	while ( requested_mode == MODE_RX_SYMBOLS || requested_mode == MODE_BT_FOLLOW )
1375:bluetooth_rxtx.c **** 	{
1376:bluetooth_rxtx.c **** 
1377:bluetooth_rxtx.c **** 		RXLED_CLR;
1378:bluetooth_rxtx.c **** 
1379:bluetooth_rxtx.c **** 		/* Wait for DMA transfer. TODO - need more work on
1380:bluetooth_rxtx.c **** 		 * RSSI. Should send RSSI indications to host even
1381:bluetooth_rxtx.c **** 		 * when not transferring data. That would also keep
1382:bluetooth_rxtx.c **** 		 * the USB stream going. This loop runs 50-80 times
1383:bluetooth_rxtx.c **** 		 * while waiting for DMA, but RSSI sampling does not
1384:bluetooth_rxtx.c **** 		 * cover all the symbols in a DMA transfer. Can not do
1385:bluetooth_rxtx.c **** 		 * RSSI sampling in CS interrupt, but could log time
1386:bluetooth_rxtx.c **** 		 * at multiple trigger points there. The MAX() below
1387:bluetooth_rxtx.c **** 		 * helps with statistics in the case that cs_trigger
1388:bluetooth_rxtx.c **** 		 * happened before the loop started. */
1389:bluetooth_rxtx.c **** 		rssi_reset();
1390:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
1391:bluetooth_rxtx.c **** 		while (!rx_tc) {
1392:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1393:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
1394:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
1395:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
1396:bluetooth_rxtx.c **** 			}
1397:bluetooth_rxtx.c **** 			rssi_add(rssi);
1398:bluetooth_rxtx.c **** 
1399:bluetooth_rxtx.c **** 			handle_usb(clkn);
1400:bluetooth_rxtx.c **** 
1401:bluetooth_rxtx.c **** 			/* If timer says time to hop, do it. */
1402:bluetooth_rxtx.c **** 			if (do_hop) {
ARM GAS  /tmp/ccLwKaeN.s 			page 26


1403:bluetooth_rxtx.c **** 				hop();
1404:bluetooth_rxtx.c **** 			} else {
1405:bluetooth_rxtx.c **** 				TXLED_CLR;
1406:bluetooth_rxtx.c **** 			}
1407:bluetooth_rxtx.c **** 			/* TODO - set per-channel carrier sense threshold.
1408:bluetooth_rxtx.c **** 			 * Set by firmware or host. */
1409:bluetooth_rxtx.c **** 		}
1410:bluetooth_rxtx.c **** 
1411:bluetooth_rxtx.c **** 		RXLED_SET;
1412:bluetooth_rxtx.c **** 
1413:bluetooth_rxtx.c **** 		if (rx_err) {
1414:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1415:bluetooth_rxtx.c **** 		}
1416:bluetooth_rxtx.c **** 
1417:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1418:bluetooth_rxtx.c **** 		if (rx_tc > 1)
1419:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
1420:bluetooth_rxtx.c **** 
1421:bluetooth_rxtx.c **** 		if (dma_discard) {
1422:bluetooth_rxtx.c **** 			status |= DISCARD;
1423:bluetooth_rxtx.c **** 			dma_discard = 0;
1424:bluetooth_rxtx.c **** 		}
1425:bluetooth_rxtx.c **** 
1426:bluetooth_rxtx.c **** 		rssi_iir_update(channel);
1427:bluetooth_rxtx.c **** 
1428:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1429:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1430:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1431:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1432:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
1433:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
1434:bluetooth_rxtx.c **** 			cs_trigger = 0;
1435:bluetooth_rxtx.c **** 		}
1436:bluetooth_rxtx.c **** 
1437:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
1438:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
1439:bluetooth_rxtx.c **** 		}
1440:bluetooth_rxtx.c **** 
1441:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, (uint8_t*)idle_rxbuf);
1442:bluetooth_rxtx.c **** 
1443:bluetooth_rxtx.c **** 		handle_usb(clkn);
1444:bluetooth_rxtx.c **** 		rx_tc = 0;
1445:bluetooth_rxtx.c **** 		rx_err = 0;
1446:bluetooth_rxtx.c **** 	}
1447:bluetooth_rxtx.c **** 
1448:bluetooth_rxtx.c **** 	dio_ssp_stop();
1449:bluetooth_rxtx.c **** 	cs_trigger_disable();
1450:bluetooth_rxtx.c **** }
1451:bluetooth_rxtx.c **** 
1452:bluetooth_rxtx.c **** static uint8_t reverse8(uint8_t data)
1453:bluetooth_rxtx.c **** {
  25              		.loc 1 1453 0
  26              		.cfi_startproc
  27              		@ args = 0, pretend = 0, frame = 0
  28              		@ frame_needed = 0, uses_anonymous_args = 0
  29              	.LVL0:
  30 0000 10B5     		push	{r4, lr}
ARM GAS  /tmp/ccLwKaeN.s 			page 27


  31              		.cfi_def_cfa_offset 8
  32              		.cfi_offset 4, -8
  33              		.cfi_offset 14, -4
  34              	.LVL1:
  35              	.LBB6:
1454:bluetooth_rxtx.c **** 	uint8_t reversed = 0;
1455:bluetooth_rxtx.c **** 
1456:bluetooth_rxtx.c **** 	for(size_t i=0; i<8; i++)
  36              		.loc 1 1456 0
  37 0002 0023     		movs	r3, #0
  38              	.LBE6:
1454:bluetooth_rxtx.c **** 	uint8_t reversed = 0;
  39              		.loc 1 1454 0
  40 0004 1A46     		mov	r2, r3
  41              	.LVL2:
  42              	.L2:
  43              	.LBB7:
1457:bluetooth_rxtx.c **** 	{
1458:bluetooth_rxtx.c **** 		reversed |= ((data >> i) & 0x01) << (7-i);
  44              		.loc 1 1458 0 discriminator 3
  45 0006 40FA03F1 		asr	r1, r0, r3
  46 000a C3F10704 		rsb	r4, r3, #7
  47 000e 01F00101 		and	r1, r1, #1
  48 0012 A140     		lsls	r1, r1, r4
1456:bluetooth_rxtx.c **** 	{
  49              		.loc 1 1456 0 discriminator 3
  50 0014 0133     		adds	r3, r3, #1
  51              	.LVL3:
  52              		.loc 1 1458 0 discriminator 3
  53 0016 0A43     		orrs	r2, r2, r1
  54              	.LVL4:
1456:bluetooth_rxtx.c **** 	{
  55              		.loc 1 1456 0 discriminator 3
  56 0018 082B     		cmp	r3, #8
  57              		.loc 1 1458 0 discriminator 3
  58 001a D2B2     		uxtb	r2, r2
  59              	.LVL5:
1456:bluetooth_rxtx.c **** 	{
  60              		.loc 1 1456 0 discriminator 3
  61 001c F3D1     		bne	.L2
  62              	.LBE7:
1459:bluetooth_rxtx.c **** 	}
1460:bluetooth_rxtx.c **** 
1461:bluetooth_rxtx.c **** 	return reversed;
1462:bluetooth_rxtx.c **** }
  63              		.loc 1 1462 0
  64 001e 1046     		mov	r0, r2
  65              	.LVL6:
  66 0020 10BD     		pop	{r4, pc}
  67              		.cfi_endproc
  68              	.LFE16:
  70              		.section	.text.le_set_access_address,"ax",%progbits
  71              		.align	1
  72              		.syntax unified
  73              		.thumb
  74              		.thumb_func
  75              		.fpu softvfp
ARM GAS  /tmp/ccLwKaeN.s 			page 28


  77              	le_set_access_address:
  78              	.LFB19:
1463:bluetooth_rxtx.c **** 
1464:bluetooth_rxtx.c **** static uint16_t reverse16(uint16_t data)
1465:bluetooth_rxtx.c **** {
1466:bluetooth_rxtx.c **** 	uint16_t reversed = 0;
1467:bluetooth_rxtx.c **** 
1468:bluetooth_rxtx.c **** 	for(size_t i=0; i<16; i++)
1469:bluetooth_rxtx.c **** 	{
1470:bluetooth_rxtx.c **** 		reversed |= ((data >> i) & 0x01) << (15-i);
1471:bluetooth_rxtx.c **** 	}
1472:bluetooth_rxtx.c **** 
1473:bluetooth_rxtx.c **** 	return reversed;
1474:bluetooth_rxtx.c **** }
1475:bluetooth_rxtx.c **** 
1476:bluetooth_rxtx.c **** /*
1477:bluetooth_rxtx.c ****  * Transmit a BTBR packet with the specified access code.
1478:bluetooth_rxtx.c ****  *
1479:bluetooth_rxtx.c ****  * All modulation parameters are set within this function.
1480:bluetooth_rxtx.c ****  */
1481:bluetooth_rxtx.c **** void br_transmit()
1482:bluetooth_rxtx.c **** {
1483:bluetooth_rxtx.c **** 	uint16_t gio_save;
1484:bluetooth_rxtx.c **** 
1485:bluetooth_rxtx.c **** 	uint32_t clkn_saved = 0;
1486:bluetooth_rxtx.c **** 
1487:bluetooth_rxtx.c **** 	uint16_t preamble = (target.syncword & 1) == 1 ? 0x5555 : 0xaaaa;
1488:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
1489:bluetooth_rxtx.c **** 
1490:bluetooth_rxtx.c **** 	uint8_t data[16] = {
1491:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
1492:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
1493:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 16) & 0xFF),
1494:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 24) & 0xFF),
1495:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 32) & 0xFF),
1496:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 40) & 0xFF),
1497:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 48) & 0xFF),
1498:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 56) & 0xFF),
1499:bluetooth_rxtx.c **** 		reverse8(trailer),
1500:bluetooth_rxtx.c **** 		reverse8(0x77),
1501:bluetooth_rxtx.c **** 		reverse8(0x66),
1502:bluetooth_rxtx.c **** 		reverse8(0x55),
1503:bluetooth_rxtx.c **** 		reverse8(0x44),
1504:bluetooth_rxtx.c **** 		reverse8(0x33),
1505:bluetooth_rxtx.c **** 		reverse8(0x22),
1506:bluetooth_rxtx.c **** 		reverse8(0x11)
1507:bluetooth_rxtx.c **** 	};
1508:bluetooth_rxtx.c **** 
1509:bluetooth_rxtx.c **** 	cc2400_tx_sync(reverse16(preamble));
1510:bluetooth_rxtx.c **** 
1511:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
1512:bluetooth_rxtx.c **** 
1513:bluetooth_rxtx.c **** 	// set GIO to FIFO_FULL
1514:bluetooth_rxtx.c **** 	gio_save = cc2400_get(IOCFG);
1515:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
1516:bluetooth_rxtx.c **** 
1517:bluetooth_rxtx.c **** 	while ( requested_mode == MODE_TX_SYMBOLS )
ARM GAS  /tmp/ccLwKaeN.s 			page 29


1518:bluetooth_rxtx.c **** 	{
1519:bluetooth_rxtx.c **** 
1520:bluetooth_rxtx.c **** 		while ((clkn >> 1) == (clkn_saved >> 1) || T0TC < 2250) {
1521:bluetooth_rxtx.c **** 
1522:bluetooth_rxtx.c **** 			// If timer says time to hop, do it.
1523:bluetooth_rxtx.c **** 			if (do_hop) {
1524:bluetooth_rxtx.c **** 				hop();
1525:bluetooth_rxtx.c **** 			}
1526:bluetooth_rxtx.c **** 		}
1527:bluetooth_rxtx.c **** 
1528:bluetooth_rxtx.c **** 		clkn_saved = clkn;
1529:bluetooth_rxtx.c **** 
1530:bluetooth_rxtx.c **** 		TXLED_SET;
1531:bluetooth_rxtx.c **** 
1532:bluetooth_rxtx.c **** 		cc2400_fifo_write(16, data);
1533:bluetooth_rxtx.c **** 
1534:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1535:bluetooth_rxtx.c **** 		TXLED_CLR;
1536:bluetooth_rxtx.c **** 
1537:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
1538:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
1539:bluetooth_rxtx.c **** 
1540:bluetooth_rxtx.c **** 		while (!(cc2400_status() & XOSC16M_STABLE));
1541:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1542:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
1543:bluetooth_rxtx.c **** 
1544:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1545:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
1546:bluetooth_rxtx.c **** 
1547:bluetooth_rxtx.c **** 		handle_usb(clkn);
1548:bluetooth_rxtx.c **** 	}
1549:bluetooth_rxtx.c **** 
1550:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1551:bluetooth_rxtx.c **** 	PAEN_CLR;
1552:bluetooth_rxtx.c **** #endif
1553:bluetooth_rxtx.c **** 
1554:bluetooth_rxtx.c **** 	// reset GIO
1555:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, gio_save);
1556:bluetooth_rxtx.c **** }
1557:bluetooth_rxtx.c **** 
1558:bluetooth_rxtx.c **** /* set LE access address */
1559:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa) {
  79              		.loc 1 1559 0
  80              		.cfi_startproc
  81              		@ args = 0, pretend = 0, frame = 0
  82              		@ frame_needed = 0, uses_anonymous_args = 0
  83              	.LVL7:
  84 0000 10B5     		push	{r4, lr}
  85              		.cfi_def_cfa_offset 8
  86              		.cfi_offset 4, -8
  87              		.cfi_offset 14, -4
1560:bluetooth_rxtx.c **** 	u32 aa_rev;
1561:bluetooth_rxtx.c **** 
1562:bluetooth_rxtx.c **** 	le.access_address = aa;
  88              		.loc 1 1562 0
  89 0002 044C     		ldr	r4, .L5
  90 0004 2060     		str	r0, [r4]
ARM GAS  /tmp/ccLwKaeN.s 			page 30


1563:bluetooth_rxtx.c **** 	aa_rev = rbit(aa);
  91              		.loc 1 1563 0
  92 0006 FFF7FEFF 		bl	rbit
  93              	.LVL8:
1564:bluetooth_rxtx.c **** 	le.syncl = aa_rev & 0xffff;
  94              		.loc 1 1564 0
  95 000a E080     		strh	r0, [r4, #6]	@ movhi
1565:bluetooth_rxtx.c **** 	le.synch = aa_rev >> 16;
  96              		.loc 1 1565 0
  97 000c 000C     		lsrs	r0, r0, #16
  98              	.LVL9:
  99 000e A080     		strh	r0, [r4, #4]	@ movhi
 100 0010 10BD     		pop	{r4, pc}
 101              	.L6:
 102 0012 00BF     		.align	2
 103              	.L5:
 104 0014 00000000 		.word	.LANCHOR0
 105              		.cfi_endproc
 106              	.LFE19:
 108              		.section	.text.cc2400_rx,"ax",%progbits
 109              		.align	1
 110              		.syntax unified
 111              		.thumb
 112              		.thumb_func
 113              		.fpu softvfp
 115              	cc2400_rx:
 116              	.LFB9:
1003:bluetooth_rxtx.c **** 	u16 mdmctrl = 0;
 117              		.loc 1 1003 0
 118              		.cfi_startproc
 119              		@ args = 0, pretend = 0, frame = 0
 120              		@ frame_needed = 0, uses_anonymous_args = 0
 121 0000 38B5     		push	{r3, r4, r5, lr}
 122              		.cfi_def_cfa_offset 16
 123              		.cfi_offset 3, -16
 124              		.cfi_offset 4, -12
 125              		.cfi_offset 5, -8
 126              		.cfi_offset 14, -4
 127              	.LVL10:
1006:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
 128              		.loc 1 1006 0
 129 0002 264B     		ldr	r3, .L22
 130 0004 264C     		ldr	r4, .L22+4
 131 0006 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 132 0008 12B1     		cbz	r2, .L8
1006:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
 133              		.loc 1 1006 0 is_stmt 0 discriminator 1
 134 000a 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 135 000c 012A     		cmp	r2, #1
 136 000e 26D1     		bne	.L9
 137              	.L8:
1007:bluetooth_rxtx.c **** 			mdmctrl = 0x0029; // 160 kHz frequency deviation
 138              		.loc 1 1007 0 is_stmt 1
 139 0010 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 140 0012 002A     		cmp	r2, #0
 141 0014 3FD0     		beq	.L13
1009:bluetooth_rxtx.c **** 			mdmctrl = 0x0040; // 250 kHz frequency deviation
ARM GAS  /tmp/ccLwKaeN.s 			page 31


 142              		.loc 1 1009 0
 143 0016 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
1010:bluetooth_rxtx.c **** 		}
 144              		.loc 1 1010 0
 145 0018 012B     		cmp	r3, #1
 146 001a 14BF     		ite	ne
 147 001c 0025     		movne	r5, #0
 148 001e 4025     		moveq	r5, #64
 149              	.L10:
 150              	.LVL11:
1012:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
 151              		.loc 1 1012 0
 152 0020 47F6FF71 		movw	r1, #32767
 153 0024 0D20     		movs	r0, #13
 154 0026 FFF7FEFF 		bl	cc2400_set
 155              	.LVL12:
1013:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG
 156              		.loc 1 1013 0
 157 002a 42F62231 		movw	r1, #11042
 158 002e 1220     		movs	r0, #18
 159 0030 FFF7FEFF 		bl	cc2400_set
 160              	.LVL13:
1014:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 161              		.loc 1 1014 0
 162 0034 41F24B31 		movw	r1, #4939
 163 0038 1420     		movs	r0, #20
 164 003a FFF7FEFF 		bl	cc2400_set
 165              	.LVL14:
1015:bluetooth_rxtx.c **** 		// 0 00 00 0 010 00 0 00 0 1
 166              		.loc 1 1015 0
 167 003e 40F20111 		movw	r1, #257
 168 0042 2020     		movs	r0, #32
 169 0044 FFF7FEFF 		bl	cc2400_set
 170              	.LVL15:
1022:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, mdmctrl);
 171              		.loc 1 1022 0
 172 0048 B4F84C10 		ldrh	r1, [r4, #76]
 173 004c 0220     		movs	r0, #2
 174 004e 0139     		subs	r1, r1, #1
 175 0050 89B2     		uxth	r1, r1
 176 0052 FFF7FEFF 		bl	cc2400_set
 177              	.LVL16:
1023:bluetooth_rxtx.c **** 	}
 178              		.loc 1 1023 0
 179 0056 2946     		mov	r1, r5
 180 0058 0320     		movs	r0, #3
 181 005a FFF7FEFF 		bl	cc2400_set
 182              	.LVL17:
 183              	.L9:
1027:bluetooth_rxtx.c **** 
 184              		.loc 1 1027 0
 185 005e B4F84C00 		ldrh	r0, [r4, #76]
 186 0062 80B2     		uxth	r0, r0
 187 0064 FFF7FEFF 		bl	cs_threshold_calc_and_set
 188              	.LVL18:
1029:bluetooth_rxtx.c **** 
 189              		.loc 1 1029 0
ARM GAS  /tmp/ccLwKaeN.s 			page 32


 190 0068 FFF7FEFF 		bl	clkn_start
 191              	.LVL19:
 192              	.L11:
1031:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 193              		.loc 1 1031 0 discriminator 1
 194 006c FFF7FEFF 		bl	cc2400_status
 195              	.LVL20:
 196 0070 4206     		lsls	r2, r0, #25
 197 0072 FBD5     		bpl	.L11
1032:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 198              		.loc 1 1032 0
 199 0074 6120     		movs	r0, #97
 200 0076 FFF7FEFF 		bl	cc2400_strobe
 201              	.LVL21:
 202              	.L12:
1033:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 203              		.loc 1 1033 0 discriminator 1
 204 007a FFF7FEFF 		bl	cc2400_status
 205              	.LVL22:
 206 007e 4307     		lsls	r3, r0, #29
 207 0080 FBD5     		bpl	.L12
1034:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 208              		.loc 1 1034 0
 209 0082 6220     		movs	r0, #98
 210 0084 FFF7FEFF 		bl	cc2400_strobe
 211              	.LVL23:
1036:bluetooth_rxtx.c **** 	HGM_SET;
 212              		.loc 1 1036 0
 213 0088 8022     		movs	r2, #128
 214 008a 064B     		ldr	r3, .L22+8
 215 008c 1A60     		str	r2, [r3]
1037:bluetooth_rxtx.c **** #endif
 216              		.loc 1 1037 0
 217 008e 4FF48072 		mov	r2, #256
 218 0092 1A60     		str	r2, [r3]
 219 0094 38BD     		pop	{r3, r4, r5, pc}
 220              	.LVL24:
 221              	.L13:
1008:bluetooth_rxtx.c **** 		} else if (modulation == MOD_BT_LOW_ENERGY) {
 222              		.loc 1 1008 0
 223 0096 2925     		movs	r5, #41
 224 0098 C2E7     		b	.L10
 225              	.L23:
 226 009a 00BF     		.align	2
 227              	.L22:
 228 009c 00000000 		.word	.LANCHOR1
 229 00a0 00000000 		.word	.LANCHOR0
 230 00a4 58C00920 		.word	537509976
 231              		.cfi_endproc
 232              	.LFE9:
 234              		.section	.text.cc2400_rx_sync,"ax",%progbits
 235              		.align	1
 236              		.syntax unified
 237              		.thumb
 238              		.thumb_func
 239              		.fpu softvfp
 241              	cc2400_rx_sync:
ARM GAS  /tmp/ccLwKaeN.s 			page 33


 242              	.LFB10:
1043:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 243              		.loc 1 1043 0
 244              		.cfi_startproc
 245              		@ args = 0, pretend = 0, frame = 0
 246              		@ frame_needed = 0, uses_anonymous_args = 0
 247              	.LVL25:
 248 0000 70B5     		push	{r4, r5, r6, lr}
 249              		.cfi_def_cfa_offset 16
 250              		.cfi_offset 4, -16
 251              		.cfi_offset 5, -12
 252              		.cfi_offset 6, -8
 253              		.cfi_offset 14, -4
1046:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 254              		.loc 1 1046 0
 255 0002 294B     		ldr	r3, .L34
1043:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 256              		.loc 1 1043 0
 257 0004 0446     		mov	r4, r0
1046:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 258              		.loc 1 1046 0
 259 0006 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 260 0008 002A     		cmp	r2, #0
 261 000a 48D0     		beq	.L29
1057:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
 262              		.loc 1 1057 0
 263 000c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 264 000e 012B     		cmp	r3, #1
 265 0010 44D1     		bne	.L24
1058:bluetooth_rxtx.c **** 		grmdm = 0x0561; // un-buffered mode, packet w/ sync word detection
 266              		.loc 1 1058 0
 267 0012 4025     		movs	r5, #64
1059:bluetooth_rxtx.c **** 		// 0 00 00 1 010 11 0 00 0 1
 268              		.loc 1 1059 0
 269 0014 40F26156 		movw	r6, #1377
 270              	.L25:
 271              	.LVL26:
1073:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 272              		.loc 1 1073 0
 273 0018 47F6FF71 		movw	r1, #32767
 274 001c 0D20     		movs	r0, #13
 275              	.LVL27:
 276 001e FFF7FEFF 		bl	cc2400_set
 277              	.LVL28:
1074:bluetooth_rxtx.c **** 
 278              		.loc 1 1074 0
 279 0022 42F62231 		movw	r1, #11042
 280 0026 1220     		movs	r0, #18
 281 0028 FFF7FEFF 		bl	cc2400_set
 282              	.LVL29:
1076:bluetooth_rxtx.c **** 	// 1      2      4b
 283              		.loc 1 1076 0
 284 002c 41F24B21 		movw	r1, #4683
 285 0030 1420     		movs	r0, #20
 286 0032 FFF7FEFF 		bl	cc2400_set
 287              	.LVL30:
1089:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccLwKaeN.s 			page 34


 288              		.loc 1 1089 0
 289 0036 3146     		mov	r1, r6
 290 0038 2020     		movs	r0, #32
 291 003a FFF7FEFF 		bl	cc2400_set
 292              	.LVL31:
1091:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 293              		.loc 1 1091 0
 294 003e A1B2     		uxth	r1, r4
 295 0040 2C20     		movs	r0, #44
 296 0042 FFF7FEFF 		bl	cc2400_set
 297              	.LVL32:
1092:bluetooth_rxtx.c **** 
 298              		.loc 1 1092 0
 299 0046 210C     		lsrs	r1, r4, #16
1094:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 300              		.loc 1 1094 0
 301 0048 184C     		ldr	r4, .L34+4
 302              	.LVL33:
1092:bluetooth_rxtx.c **** 
 303              		.loc 1 1092 0
 304 004a 2D20     		movs	r0, #45
 305 004c FFF7FEFF 		bl	cc2400_set
 306              	.LVL34:
1094:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 307              		.loc 1 1094 0
 308 0050 B4F84C10 		ldrh	r1, [r4, #76]
 309 0054 0220     		movs	r0, #2
 310 0056 0139     		subs	r1, r1, #1
 311 0058 89B2     		uxth	r1, r1
 312 005a FFF7FEFF 		bl	cc2400_set
 313              	.LVL35:
1095:bluetooth_rxtx.c **** 
 314              		.loc 1 1095 0
 315 005e 2946     		mov	r1, r5
 316 0060 0320     		movs	r0, #3
 317 0062 FFF7FEFF 		bl	cc2400_set
 318              	.LVL36:
1098:bluetooth_rxtx.c **** 
 319              		.loc 1 1098 0
 320 0066 B4F84C00 		ldrh	r0, [r4, #76]
 321 006a 80B2     		uxth	r0, r0
 322 006c FFF7FEFF 		bl	cs_threshold_calc_and_set
 323              	.LVL37:
1100:bluetooth_rxtx.c **** 
 324              		.loc 1 1100 0
 325 0070 FFF7FEFF 		bl	clkn_start
 326              	.LVL38:
 327              	.L27:
1102:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 328              		.loc 1 1102 0 discriminator 1
 329 0074 FFF7FEFF 		bl	cc2400_status
 330              	.LVL39:
 331 0078 4206     		lsls	r2, r0, #25
 332 007a FBD5     		bpl	.L27
1103:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 333              		.loc 1 1103 0
 334 007c 6120     		movs	r0, #97
ARM GAS  /tmp/ccLwKaeN.s 			page 35


 335 007e FFF7FEFF 		bl	cc2400_strobe
 336              	.LVL40:
 337              	.L28:
1104:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 338              		.loc 1 1104 0 discriminator 1
 339 0082 FFF7FEFF 		bl	cc2400_status
 340              	.LVL41:
 341 0086 4307     		lsls	r3, r0, #29
 342 0088 FBD5     		bpl	.L28
1105:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 343              		.loc 1 1105 0
 344 008a 6220     		movs	r0, #98
 345 008c FFF7FEFF 		bl	cc2400_strobe
 346              	.LVL42:
1107:bluetooth_rxtx.c **** 	HGM_SET;
 347              		.loc 1 1107 0
 348 0090 8022     		movs	r2, #128
 349 0092 074B     		ldr	r3, .L34+8
 350 0094 1A60     		str	r2, [r3]
1108:bluetooth_rxtx.c **** #endif
 351              		.loc 1 1108 0
 352 0096 4FF48072 		mov	r2, #256
 353 009a 1A60     		str	r2, [r3]
 354              	.LVL43:
 355              	.L24:
 356 009c 70BD     		pop	{r4, r5, r6, pc}
 357              	.LVL44:
 358              	.L29:
1047:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
 359              		.loc 1 1047 0
 360 009e 2925     		movs	r5, #41
1048:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
 361              		.loc 1 1048 0
 362 00a0 40F26146 		movw	r6, #1121
 363 00a4 B8E7     		b	.L25
 364              	.L35:
 365 00a6 00BF     		.align	2
 366              	.L34:
 367 00a8 00000000 		.word	.LANCHOR1
 368 00ac 00000000 		.word	.LANCHOR0
 369 00b0 58C00920 		.word	537509976
 370              		.cfi_endproc
 371              	.LFE10:
 373              		.section	.text.enqueue,"ax",%progbits
 374              		.align	1
 375              		.syntax unified
 376              		.thumb
 377              		.thumb_func
 378              		.fpu softvfp
 380              	enqueue:
 381              	.LFB0:
 155:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 382              		.loc 1 155 0
 383              		.cfi_startproc
 384              		@ args = 0, pretend = 0, frame = 0
 385              		@ frame_needed = 0, uses_anonymous_args = 0
 386              	.LVL45:
ARM GAS  /tmp/ccLwKaeN.s 			page 36


 387 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 388              		.cfi_def_cfa_offset 24
 389              		.cfi_offset 3, -24
 390              		.cfi_offset 4, -20
 391              		.cfi_offset 5, -16
 392              		.cfi_offset 6, -12
 393              		.cfi_offset 7, -8
 394              		.cfi_offset 14, -4
 155:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 395              		.loc 1 155 0
 396 0002 0746     		mov	r7, r0
 397 0004 0E46     		mov	r6, r1
 156:bluetooth_rxtx.c **** 
 398              		.loc 1 156 0
 399 0006 FFF7FEFF 		bl	usb_enqueue
 400              	.LVL46:
 401 000a 1D4D     		ldr	r5, .L41
 159:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 402              		.loc 1 159 0
 403 000c 0446     		mov	r4, r0
 404 000e 20B9     		cbnz	r0, .L37
 160:bluetooth_rxtx.c **** 		return 0;
 405              		.loc 1 160 0
 406 0010 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 407 0012 43F00403 		orr	r3, r3, #4
 408 0016 6B70     		strb	r3, [r5, #1]
 161:bluetooth_rxtx.c **** 	}
 409              		.loc 1 161 0
 410 0018 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 411              	.LVL47:
 412              	.L37:
 165:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 413              		.loc 1 165 0
 414 001a 042F     		cmp	r7, #4
 164:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 415              		.loc 1 164 0
 416 001c 0770     		strb	r7, [r0]
 165:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 417              		.loc 1 165 0
 418 001e 19D1     		bne	.L39
 167:bluetooth_rxtx.c **** 	} else {
 419              		.loc 1 167 0
 420 0020 40F63541 		movw	r1, #3125
 166:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 421              		.loc 1 166 0
 422 0024 174A     		ldr	r2, .L41+4
 423 0026 1368     		ldr	r3, [r2]
 424 0028 1B0D     		lsrs	r3, r3, #20
 425 002a C370     		strb	r3, [r0, #3]
 167:bluetooth_rxtx.c **** 	} else {
 426              		.loc 1 167 0
 427 002c 1368     		ldr	r3, [r2]
 428 002e 164A     		ldr	r2, .L41+8
 429 0030 C3F31303 		ubfx	r3, r3, #0, #20
 430 0034 1268     		ldr	r2, [r2]
 431 0036 01FB0323 		mla	r3, r1, r3, r2
 432 003a 4360     		str	r3, [r0, #4]
ARM GAS  /tmp/ccLwKaeN.s 			page 37


 433              	.LVL48:
 434              	.L40:
 178:bluetooth_rxtx.c **** 
 435              		.loc 1 178 0
 436 003c 3222     		movs	r2, #50
 437 003e 3146     		mov	r1, r6
 438 0040 04F10E00 		add	r0, r4, #14
 439 0044 FFF7FEFF 		bl	memcpy
 440              	.LVL49:
 180:bluetooth_rxtx.c **** 	status = 0;
 441              		.loc 1 180 0
 442 0048 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 183:bluetooth_rxtx.c **** }
 443              		.loc 1 183 0
 444 004a 0120     		movs	r0, #1
 180:bluetooth_rxtx.c **** 	status = 0;
 445              		.loc 1 180 0
 446 004c 6370     		strb	r3, [r4, #1]
 181:bluetooth_rxtx.c **** 
 447              		.loc 1 181 0
 448 004e 0023     		movs	r3, #0
 449 0050 6B70     		strb	r3, [r5, #1]
 184:bluetooth_rxtx.c **** 
 450              		.loc 1 184 0
 451 0052 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 452              	.LVL50:
 453              	.L39:
 169:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 454              		.loc 1 169 0
 455 0054 AB78     		ldrb	r3, [r5, #2]	@ zero_extendqisi2
 456 0056 C370     		strb	r3, [r0, #3]
 170:bluetooth_rxtx.c **** 		f->channel = (uint8_t)((idle_buf_channel - 2402) & 0xff);
 457              		.loc 1 170 0
 458 0058 6B68     		ldr	r3, [r5, #4]
 459 005a 4360     		str	r3, [r0, #4]
 171:bluetooth_rxtx.c **** 		f->rssi_min = rssi_min;
 460              		.loc 1 171 0
 461 005c 2B89     		ldrh	r3, [r5, #8]
 462 005e 623B     		subs	r3, r3, #98
 463 0060 8370     		strb	r3, [r0, #2]
 172:bluetooth_rxtx.c **** 		f->rssi_max = rssi_max;
 464              		.loc 1 172 0
 465 0062 0A4B     		ldr	r3, .L41+12
 466 0064 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 467 0066 4372     		strb	r3, [r0, #9]
 173:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_get_avg(idle_buf_channel);
 468              		.loc 1 173 0
 469 0068 094B     		ldr	r3, .L41+16
 470 006a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 471 006c 0372     		strb	r3, [r0, #8]
 174:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 472              		.loc 1 174 0
 473 006e 2889     		ldrh	r0, [r5, #8]
 474              	.LVL51:
 475 0070 80B2     		uxth	r0, r0
 476 0072 FFF7FEFF 		bl	rssi_get_avg
 477              	.LVL52:
ARM GAS  /tmp/ccLwKaeN.s 			page 38


 175:bluetooth_rxtx.c **** 	}
 478              		.loc 1 175 0
 479 0076 074B     		ldr	r3, .L41+20
 174:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 480              		.loc 1 174 0
 481 0078 A072     		strb	r0, [r4, #10]
 175:bluetooth_rxtx.c **** 	}
 482              		.loc 1 175 0
 483 007a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 484 007c E372     		strb	r3, [r4, #11]
 485 007e DDE7     		b	.L40
 486              	.L42:
 487              		.align	2
 488              	.L41:
 489 0080 00000000 		.word	.LANCHOR1
 490 0084 00000000 		.word	clkn
 491 0088 08400040 		.word	1073758216
 492 008c 00000000 		.word	rssi_min
 493 0090 00000000 		.word	rssi_max
 494 0094 00000000 		.word	rssi_count
 495              		.cfi_endproc
 496              	.LFE0:
 498              		.section	.text.cc2400_idle,"ax",%progbits
 499              		.align	1
 500              		.syntax unified
 501              		.thumb
 502              		.thumb_func
 503              		.fpu softvfp
 505              	cc2400_idle:
 506              	.LFB8:
 949:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 507              		.loc 1 949 0
 508              		.cfi_startproc
 509              		@ args = 0, pretend = 0, frame = 0
 510              		@ frame_needed = 0, uses_anonymous_args = 0
 511 0000 10B5     		push	{r4, lr}
 512              		.cfi_def_cfa_offset 8
 513              		.cfi_offset 4, -8
 514              		.cfi_offset 14, -4
 950:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 515              		.loc 1 950 0
 516 0002 6420     		movs	r0, #100
 517 0004 FFF7FEFF 		bl	cc2400_strobe
 518              	.LVL53:
 519              	.L44:
 951:bluetooth_rxtx.c **** 
 520              		.loc 1 951 0 discriminator 1
 521 0008 FFF7FEFF 		bl	cc2400_status
 522              	.LVL54:
 523 000c 10F00404 		ands	r4, r0, #4
 524 0010 FAD1     		bne	.L44
 954:bluetooth_rxtx.c **** 	HGM_CLR;
 525              		.loc 1 954 0
 526 0012 8022     		movs	r2, #128
 527 0014 214B     		ldr	r3, .L46
 958:bluetooth_rxtx.c **** 	TXLED_CLR;
 528              		.loc 1 958 0
ARM GAS  /tmp/ccLwKaeN.s 			page 39


 529 0016 1021     		movs	r1, #16
 954:bluetooth_rxtx.c **** 	HGM_CLR;
 530              		.loc 1 954 0
 531 0018 1A60     		str	r2, [r3]
 955:bluetooth_rxtx.c **** #endif
 532              		.loc 1 955 0
 533 001a 4FF48072 		mov	r2, #256
 534 001e 1A60     		str	r2, [r3]
 958:bluetooth_rxtx.c **** 	TXLED_CLR;
 535              		.loc 1 958 0
 536 0020 43F8201C 		str	r1, [r3, #-32]
 959:bluetooth_rxtx.c **** 	USRLED_CLR;
 537              		.loc 1 959 0
 538 0024 43F8202C 		str	r2, [r3, #-32]
 960:bluetooth_rxtx.c **** 
 539              		.loc 1 960 0
 540 0028 0222     		movs	r2, #2
 541 002a 43F8202C 		str	r2, [r3, #-32]
 962:bluetooth_rxtx.c **** 	dio_ssp_stop();
 542              		.loc 1 962 0
 543 002e FFF7FEFF 		bl	clkn_stop
 544              	.LVL55:
 963:bluetooth_rxtx.c **** 	cs_reset();
 545              		.loc 1 963 0
 546 0032 FFF7FEFF 		bl	dio_ssp_stop
 547              	.LVL56:
 964:bluetooth_rxtx.c **** 	rssi_reset();
 548              		.loc 1 964 0
 549 0036 FFF7FEFF 		bl	cs_reset
 550              	.LVL57:
 965:bluetooth_rxtx.c **** 
 551              		.loc 1 965 0
 552 003a FFF7FEFF 		bl	rssi_reset
 553              	.LVL58:
 970:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 554              		.loc 1 970 0
 555 003e 40F68911 		movw	r1, #2441
 968:bluetooth_rxtx.c **** 	do_hop = 0;
 556              		.loc 1 968 0
 557 0042 174B     		ldr	r3, .L46+4
 970:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 558              		.loc 1 970 0
 559 0044 174A     		ldr	r2, .L46+8
 968:bluetooth_rxtx.c **** 	do_hop = 0;
 560              		.loc 1 968 0
 561 0046 9C72     		strb	r4, [r3, #10]
 969:bluetooth_rxtx.c **** 	channel = 2441;
 562              		.loc 1 969 0
 563 0048 DC72     		strb	r4, [r3, #11]
 970:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 564              		.loc 1 970 0
 565 004a A2F84C10 		strh	r1, [r2, #76]	@ movhi
 972:bluetooth_rxtx.c **** 	requested_channel = 0;
 566              		.loc 1 972 0
 567 004e 9E21     		movs	r1, #158
 971:bluetooth_rxtx.c **** 	hop_timeout = 158;
 568              		.loc 1 971 0
ARM GAS  /tmp/ccLwKaeN.s 			page 40


 569 0050 9C81     		strh	r4, [r3, #12]	@ movhi
 972:bluetooth_rxtx.c **** 	requested_channel = 0;
 570              		.loc 1 972 0
 571 0052 A2F84E10 		strh	r1, [r2, #78]	@ movhi
 974:bluetooth_rxtx.c **** 
 572              		.loc 1 974 0
 573 0056 40F66211 		movw	r1, #2402
 973:bluetooth_rxtx.c **** 	le_adv_channel = 2402;
 574              		.loc 1 973 0
 575 005a DC81     		strh	r4, [r3, #14]	@ movhi
 974:bluetooth_rxtx.c **** 
 576              		.loc 1 974 0
 577 005c A2F85010 		strh	r1, [r2, #80]	@ movhi
 978:bluetooth_rxtx.c **** 	idle_buf_clk100ns = 0;
 578              		.loc 1 978 0
 579 0060 9C70     		strb	r4, [r3, #2]
 979:bluetooth_rxtx.c **** 	idle_buf_channel = 0;
 580              		.loc 1 979 0
 581 0062 5C60     		str	r4, [r3, #4]
 980:bluetooth_rxtx.c **** 	dma_discard = 0;
 582              		.loc 1 980 0
 583 0064 1C81     		strh	r4, [r3, #8]	@ movhi
 981:bluetooth_rxtx.c **** 	status = 0;
 584              		.loc 1 981 0
 585 0066 1C74     		strb	r4, [r3, #16]
 982:bluetooth_rxtx.c **** 
 586              		.loc 1 982 0
 587 0068 5C70     		strb	r4, [r3, #1]
 985:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 588              		.loc 1 985 0
 589 006a 5C74     		strb	r4, [r3, #17]
 986:bluetooth_rxtx.c **** 	jam_mode = JAM_NONE;
 590              		.loc 1 986 0
 591 006c 9C74     		strb	r4, [r3, #18]
 987:bluetooth_rxtx.c **** 	ego_mode = EGO_FOLLOW;
 592              		.loc 1 987 0
 593 006e DC74     		strb	r4, [r3, #19]
 988:bluetooth_rxtx.c **** 
 594              		.loc 1 988 0
 595 0070 1C75     		strb	r4, [r3, #20]
 990:bluetooth_rxtx.c **** 
 596              		.loc 1 990 0
 597 0072 1C70     		strb	r4, [r3]
 993:bluetooth_rxtx.c **** 	high_freq = 2483;
 598              		.loc 1 993 0
 599 0074 4FF41663 		mov	r3, #2400
 600 0078 A2F85230 		strh	r3, [r2, #82]	@ movhi
 994:bluetooth_rxtx.c **** 	rssi_threshold = -30;
 601              		.loc 1 994 0
 602 007c 40F6B313 		movw	r3, #2483
 603 0080 A2F85430 		strh	r3, [r2, #84]	@ movhi
 995:bluetooth_rxtx.c **** 
 604              		.loc 1 995 0
 605 0084 E223     		movs	r3, #226
 997:bluetooth_rxtx.c **** 	target.syncword = 0;
 606              		.loc 1 997 0
 607 0086 0020     		movs	r0, #0
ARM GAS  /tmp/ccLwKaeN.s 			page 41


 608 0088 0021     		movs	r1, #0
 995:bluetooth_rxtx.c **** 
 609              		.loc 1 995 0
 610 008a 82F85630 		strb	r3, [r2, #86]
 997:bluetooth_rxtx.c **** 	target.syncword = 0;
 611              		.loc 1 997 0
 612 008e 064B     		ldr	r3, .L46+12
 613 0090 C3E90001 		strd	r0, [r3]
 998:bluetooth_rxtx.c **** }
 614              		.loc 1 998 0
 615 0094 C3E90201 		strd	r0, [r3, #8]
 616 0098 10BD     		pop	{r4, pc}
 617              	.L47:
 618 009a 00BF     		.align	2
 619              	.L46:
 620 009c 5CC00920 		.word	537509980
 621 00a0 00000000 		.word	.LANCHOR1
 622 00a4 00000000 		.word	.LANCHOR0
 623 00a8 00000000 		.word	target
 624              		.cfi_endproc
 625              	.LFE8:
 627              		.section	.text.cb_follow_le,"ax",%progbits
 628              		.align	1
 629              		.global	cb_follow_le
 630              		.syntax unified
 631              		.thumb
 632              		.thumb_func
 633              		.fpu softvfp
 635              	cb_follow_le:
 636              	.LFB24:
1566:bluetooth_rxtx.c **** }
1567:bluetooth_rxtx.c **** 
1568:bluetooth_rxtx.c **** /* reset le state, called by bt_generic_le and bt_follow_le() */
1569:bluetooth_rxtx.c **** void reset_le() {
1570:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
1571:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;               // advertising channel CRCInit
1572:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
1573:bluetooth_rxtx.c **** 	le.crc_verify = 0;
1574:bluetooth_rxtx.c **** 	le.last_packet = 0;
1575:bluetooth_rxtx.c **** 
1576:bluetooth_rxtx.c **** 	le.link_state = LINK_INACTIVE;
1577:bluetooth_rxtx.c **** 
1578:bluetooth_rxtx.c **** 	le.channel_idx = 0;
1579:bluetooth_rxtx.c **** 	le.channel_increment = 0;
1580:bluetooth_rxtx.c **** 
1581:bluetooth_rxtx.c **** 	le.conn_epoch = 0;
1582:bluetooth_rxtx.c **** 	le.interval_timer = 0;
1583:bluetooth_rxtx.c **** 	le.conn_interval = 0;
1584:bluetooth_rxtx.c **** 	le.conn_interval = 0;
1585:bluetooth_rxtx.c **** 	le.conn_count = 0;
1586:bluetooth_rxtx.c **** 
1587:bluetooth_rxtx.c **** 	le.win_size = 0;
1588:bluetooth_rxtx.c **** 	le.win_offset = 0;
1589:bluetooth_rxtx.c **** 
1590:bluetooth_rxtx.c **** 	le.update_pending = 0;
1591:bluetooth_rxtx.c ****     // channel_map_update_pending = 0;
1592:bluetooth_rxtx.c ****     // channel_map_update_instant = 0;
ARM GAS  /tmp/ccLwKaeN.s 			page 42


1593:bluetooth_rxtx.c **** 	le.update_instant = 0;
1594:bluetooth_rxtx.c **** 	le.interval_update = 0;
1595:bluetooth_rxtx.c **** 	le.win_size_update = 0;
1596:bluetooth_rxtx.c **** 	le.win_offset_update = 0;
1597:bluetooth_rxtx.c **** 
1598:bluetooth_rxtx.c **** 	do_hop = 0;
1599:bluetooth_rxtx.c **** }
1600:bluetooth_rxtx.c **** 
1601:bluetooth_rxtx.c **** // reset LE Promisc state
1602:bluetooth_rxtx.c **** void reset_le_promisc(void) {
1603:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
1604:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
1605:bluetooth_rxtx.c **** }
1606:bluetooth_rxtx.c **** 
1607:bluetooth_rxtx.c **** /* generic le mode */
1608:bluetooth_rxtx.c **** void bt_generic_le(u8 active_mode)
1609:bluetooth_rxtx.c **** {
1610:bluetooth_rxtx.c **** 	u8 hold;
1611:bluetooth_rxtx.c ****   
1612:bluetooth_rxtx.c **** 	int i, j;
1613:bluetooth_rxtx.c **** 	int8_t rssi, rssi_at_trigger;
1614:bluetooth_rxtx.c **** 
1615:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1616:bluetooth_rxtx.c **** 	mode = active_mode;
1617:bluetooth_rxtx.c **** 
1618:bluetooth_rxtx.c **** 	reset_le();
1619:bluetooth_rxtx.c **** 
1620:bluetooth_rxtx.c **** 	// enable USB interrupts
1621:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1622:bluetooth_rxtx.c **** 
1623:bluetooth_rxtx.c **** 	RXLED_CLR;
1624:bluetooth_rxtx.c **** 
1625:bluetooth_rxtx.c **** 	usb_queue_init();
1626:bluetooth_rxtx.c **** 	dio_ssp_init();
1627:bluetooth_rxtx.c **** 	dma_init_rx_symbols();
1628:bluetooth_rxtx.c **** 	dio_ssp_start();
1629:bluetooth_rxtx.c **** 	cc2400_rx();
1630:bluetooth_rxtx.c **** 
1631:bluetooth_rxtx.c **** 	cs_trigger_enable();
1632:bluetooth_rxtx.c **** 
1633:bluetooth_rxtx.c **** 	hold = 0;
1634:bluetooth_rxtx.c **** 
1635:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1636:bluetooth_rxtx.c **** 
1637:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1638:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1639:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1640:bluetooth_rxtx.c **** 
1641:bluetooth_rxtx.c **** 			/* Retune */
1642:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1643:bluetooth_rxtx.c **** 
1644:bluetooth_rxtx.c **** 			/* Wait for lock */
1645:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1646:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1647:bluetooth_rxtx.c **** 
1648:bluetooth_rxtx.c **** 			/* RX mode */
1649:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
ARM GAS  /tmp/ccLwKaeN.s 			page 43


1650:bluetooth_rxtx.c **** 
1651:bluetooth_rxtx.c **** 			requested_channel = 0;
1652:bluetooth_rxtx.c **** 		}
1653:bluetooth_rxtx.c **** 
1654:bluetooth_rxtx.c **** 		if (do_hop) {
1655:bluetooth_rxtx.c **** 			hop();
1656:bluetooth_rxtx.c **** 		} else {
1657:bluetooth_rxtx.c **** 			TXLED_CLR;
1658:bluetooth_rxtx.c **** 		}
1659:bluetooth_rxtx.c **** 
1660:bluetooth_rxtx.c **** 		RXLED_CLR;
1661:bluetooth_rxtx.c **** 
1662:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1663:bluetooth_rxtx.c **** 		rssi_reset();
1664:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
1665:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
1666:bluetooth_rxtx.c **** 		{
1667:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1668:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
1669:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
1670:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
1671:bluetooth_rxtx.c **** 			}
1672:bluetooth_rxtx.c **** 			rssi_add(rssi);
1673:bluetooth_rxtx.c **** 		}
1674:bluetooth_rxtx.c **** 
1675:bluetooth_rxtx.c **** 		if (rx_err) {
1676:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1677:bluetooth_rxtx.c **** 		}
1678:bluetooth_rxtx.c **** 
1679:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1680:bluetooth_rxtx.c **** 		if (!rx_tc)
1681:bluetooth_rxtx.c **** 			goto rx_continue;
1682:bluetooth_rxtx.c **** 
1683:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1684:bluetooth_rxtx.c **** 		if (rx_tc > 1)
1685:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
1686:bluetooth_rxtx.c **** 
1687:bluetooth_rxtx.c **** 		rssi_iir_update(channel);
1688:bluetooth_rxtx.c **** 
1689:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1690:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1691:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1692:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1693:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
1694:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
1695:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
1696:bluetooth_rxtx.c **** 			cs_trigger = 0;
1697:bluetooth_rxtx.c **** 		}
1698:bluetooth_rxtx.c **** 
1699:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
1700:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
1701:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
1702:bluetooth_rxtx.c **** 		}
1703:bluetooth_rxtx.c **** 
1704:bluetooth_rxtx.c **** 		/* Hold expired? Ignore data. */
1705:bluetooth_rxtx.c **** 		if (hold == 0) {
1706:bluetooth_rxtx.c **** 			goto rx_continue;
ARM GAS  /tmp/ccLwKaeN.s 			page 44


1707:bluetooth_rxtx.c **** 		}
1708:bluetooth_rxtx.c **** 		hold--;
1709:bluetooth_rxtx.c **** 
1710:bluetooth_rxtx.c **** 		// copy the previously unpacked symbols to the front of the buffer
1711:bluetooth_rxtx.c **** 		memcpy(unpacked, unpacked + DMA_SIZE*8, DMA_SIZE*8);
1712:bluetooth_rxtx.c **** 
1713:bluetooth_rxtx.c **** 		// unpack the new packet to the end of the buffer
1714:bluetooth_rxtx.c **** 		for (i = 0; i < DMA_SIZE; ++i) {
1715:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
1716:bluetooth_rxtx.c **** 			for (j = 0; j < 8; ++j) {
1717:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
1718:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
1719:bluetooth_rxtx.c **** 			}
1720:bluetooth_rxtx.c **** 		}
1721:bluetooth_rxtx.c **** 
1722:bluetooth_rxtx.c **** 		int ret = data_cb(unpacked);
1723:bluetooth_rxtx.c **** 		if (!ret) break;
1724:bluetooth_rxtx.c **** 
1725:bluetooth_rxtx.c **** 	rx_continue:
1726:bluetooth_rxtx.c **** 		rx_tc = 0;
1727:bluetooth_rxtx.c **** 		rx_err = 0;
1728:bluetooth_rxtx.c **** 	}
1729:bluetooth_rxtx.c **** 
1730:bluetooth_rxtx.c **** 	// disable USB interrupts
1731:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
1732:bluetooth_rxtx.c **** 
1733:bluetooth_rxtx.c **** 	// reset the radio completely
1734:bluetooth_rxtx.c **** 	cc2400_idle();
1735:bluetooth_rxtx.c **** 	dio_ssp_stop();
1736:bluetooth_rxtx.c **** 	cs_trigger_disable();
1737:bluetooth_rxtx.c **** 
1738:bluetooth_rxtx.c **** }
1739:bluetooth_rxtx.c **** 
1740:bluetooth_rxtx.c **** 
1741:bluetooth_rxtx.c **** void bt_le_sync(u8 active_mode)
1742:bluetooth_rxtx.c **** {
1743:bluetooth_rxtx.c **** 	int i;
1744:bluetooth_rxtx.c **** 	int8_t rssi;
1745:bluetooth_rxtx.c **** 	static int restart_jamming = 0;
1746:bluetooth_rxtx.c **** 
1747:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1748:bluetooth_rxtx.c **** 	mode = active_mode;
1749:bluetooth_rxtx.c **** 
1750:bluetooth_rxtx.c **** 	le.link_state = LINK_LISTENING;
1751:bluetooth_rxtx.c **** 
1752:bluetooth_rxtx.c **** 	// enable USB interrupts
1753:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1754:bluetooth_rxtx.c **** 
1755:bluetooth_rxtx.c **** 	RXLED_CLR;
1756:bluetooth_rxtx.c **** 
1757:bluetooth_rxtx.c **** 	usb_queue_init();
1758:bluetooth_rxtx.c **** 	dio_ssp_init();
1759:bluetooth_rxtx.c **** 	dma_init_le();
1760:bluetooth_rxtx.c **** 	dio_ssp_start();
1761:bluetooth_rxtx.c **** 
1762:bluetooth_rxtx.c **** 	cc2400_rx_sync(rbit(le.access_address)); // bit-reversed access address
1763:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccLwKaeN.s 			page 45


1764:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1765:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1766:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1767:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1768:bluetooth_rxtx.c **** 
1769:bluetooth_rxtx.c **** 			/* Retune */
1770:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1771:bluetooth_rxtx.c **** 
1772:bluetooth_rxtx.c **** 			/* Wait for lock */
1773:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1774:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1775:bluetooth_rxtx.c **** 
1776:bluetooth_rxtx.c **** 			/* RX mode */
1777:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1778:bluetooth_rxtx.c **** 
1779:bluetooth_rxtx.c **** 			requested_channel = 0;
1780:bluetooth_rxtx.c **** 		}
1781:bluetooth_rxtx.c **** 
1782:bluetooth_rxtx.c **** 		RXLED_CLR;
1783:bluetooth_rxtx.c **** 
1784:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1785:bluetooth_rxtx.c **** 		rssi_reset();
1786:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)
1787:bluetooth_rxtx.c **** 			;
1788:bluetooth_rxtx.c **** 
1789:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1790:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
1791:bluetooth_rxtx.c **** 
1792:bluetooth_rxtx.c **** 		if (requested_mode != active_mode) {
1793:bluetooth_rxtx.c **** 			goto cleanup;
1794:bluetooth_rxtx.c **** 		}
1795:bluetooth_rxtx.c **** 
1796:bluetooth_rxtx.c **** 		if (rx_err) {
1797:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1798:bluetooth_rxtx.c **** 		}
1799:bluetooth_rxtx.c **** 
1800:bluetooth_rxtx.c **** 		if (do_hop)
1801:bluetooth_rxtx.c **** 			goto rx_flush;
1802:bluetooth_rxtx.c **** 
1803:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1804:bluetooth_rxtx.c **** 		if (!rx_tc)
1805:bluetooth_rxtx.c **** 			continue;
1806:bluetooth_rxtx.c **** 
1807:bluetooth_rxtx.c **** 		/////////////////////
1808:bluetooth_rxtx.c **** 		// process the packet
1809:bluetooth_rxtx.c **** 
1810:bluetooth_rxtx.c **** 		uint32_t packet[48/4+1] = { 0, };
1811:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
1812:bluetooth_rxtx.c **** 		packet[0] = le.access_address;
1813:bluetooth_rxtx.c **** 
1814:bluetooth_rxtx.c **** 		const uint32_t *whit = whitening_word[btle_channel_index(channel)];
1815:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
1816:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
1817:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
1818:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
1819:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
1820:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
ARM GAS  /tmp/ccLwKaeN.s 			page 46


1821:bluetooth_rxtx.c **** 		}
1822:bluetooth_rxtx.c **** 
1823:bluetooth_rxtx.c **** 		unsigned len = (p[5] & 0x3f) + 2;
1824:bluetooth_rxtx.c **** 		if (len > 39)
1825:bluetooth_rxtx.c **** 			goto rx_flush;
1826:bluetooth_rxtx.c **** 
1827:bluetooth_rxtx.c **** 		// transfer the minimum number of bytes from the CC2400
1828:bluetooth_rxtx.c **** 		// this allows us enough time to resume RX for subsequent packets on the same channel
1829:bluetooth_rxtx.c **** 		unsigned total_transfers = ((len + 3) + 4 - 1) / 4;
1830:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
1831:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
1832:bluetooth_rxtx.c **** 				;
1833:bluetooth_rxtx.c **** 		} else { // max transfers? just wait till DMA's done
1834:bluetooth_rxtx.c **** 			while (DMACC0Config & DMACCxConfig_E && rx_err == 0)
1835:bluetooth_rxtx.c **** 				;
1836:bluetooth_rxtx.c **** 		}
1837:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
1838:bluetooth_rxtx.c **** 
1839:bluetooth_rxtx.c **** 		// strobe SFSON to allow the resync to occur while we process the packet
1840:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1841:bluetooth_rxtx.c **** 
1842:bluetooth_rxtx.c **** 		// unwhiten the rest of the packet
1843:bluetooth_rxtx.c **** 		for (i = 4; i < 44; i += 4) {
1844:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
1845:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
1846:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
1847:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
1848:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
1849:bluetooth_rxtx.c **** 		}
1850:bluetooth_rxtx.c **** 
1851:bluetooth_rxtx.c **** 		if (le.crc_verify) {
1852:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
1853:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
1854:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
1855:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
1856:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
1857:bluetooth_rxtx.c **** 				goto rx_flush;
1858:bluetooth_rxtx.c **** 		}
1859:bluetooth_rxtx.c **** 
1860:bluetooth_rxtx.c **** 
1861:bluetooth_rxtx.c **** 		RXLED_SET;
1862:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
1863:bluetooth_rxtx.c ****         if(btle_channel_index(channel) == idx3){
1864:bluetooth_rxtx.c ****             count3++;  
1865:bluetooth_rxtx.c ****             if(count3 > count2-1){
1866:bluetooth_rxtx.c ****                 count3 = 0;
1867:bluetooth_rxtx.c ****             }      
1868:bluetooth_rxtx.c ****         }
1869:bluetooth_rxtx.c **** 		// disable USB interrupts while we tpacketouch USB data structures
1870:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
1871:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
1872:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
1873:bluetooth_rxtx.c **** 
1874:bluetooth_rxtx.c **** 		le.last_packet = CLK100NS;
1875:bluetooth_rxtx.c **** 
1876:bluetooth_rxtx.c **** 	rx_flush:
1877:bluetooth_rxtx.c **** 		// this might happen twice, but it's safe to do so
ARM GAS  /tmp/ccLwKaeN.s 			page 47


1878:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1879:bluetooth_rxtx.c **** 
1880:bluetooth_rxtx.c **** 		// flush any excess bytes from the SSP's buffer
1881:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
1882:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
1883:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
1884:bluetooth_rxtx.c **** 		}
1885:bluetooth_rxtx.c **** 
1886:bluetooth_rxtx.c **** 		// timeout - FIXME this is an ugly hack
1887:bluetooth_rxtx.c **** 		u32 now = CLK100NS;
1888:bluetooth_rxtx.c **** 		if (now < le.last_packet)
1889:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
1890:bluetooth_rxtx.c **** 		if  ( // timeout
1891:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
1892:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
1893:bluetooth_rxtx.c **** 			// jam finished
1894:bluetooth_rxtx.c **** 			|| (le_jam_count == 1)
1895:bluetooth_rxtx.c **** 			)
1896:bluetooth_rxtx.c **** 		{
1897:bluetooth_rxtx.c **** 			reset_le();
1898:bluetooth_rxtx.c **** 			le_jam_count = 0;
1899:bluetooth_rxtx.c **** 			TXLED_CLR;
1900:bluetooth_rxtx.c **** 
1901:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
1902:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
1903:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
1904:bluetooth_rxtx.c **** 				goto cleanup;
1905:bluetooth_rxtx.c **** 			}
1906:bluetooth_rxtx.c **** 
1907:bluetooth_rxtx.c **** 			// go back to promisc if the connection dies
1908:bluetooth_rxtx.c **** 			if (active_mode == MODE_BT_PROMISC_LE)
1909:bluetooth_rxtx.c **** 				goto cleanup;
1910:bluetooth_rxtx.c **** 
1911:bluetooth_rxtx.c **** 			le.link_state = LINK_LISTENING;
1912:bluetooth_rxtx.c **** 
1913:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1914:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
1915:bluetooth_rxtx.c **** 
1916:bluetooth_rxtx.c **** 			/* Retune */
1917:bluetooth_rxtx.c **** 			channel = le_adv_channel != 0 ? le_adv_channel : 2402;
1918:bluetooth_rxtx.c **** 			restart_jamming = 1;
1919:bluetooth_rxtx.c **** 		}
1920:bluetooth_rxtx.c **** 
1921:bluetooth_rxtx.c **** 		cc2400_set(SYNCL, le.syncl);
1922:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
1923:bluetooth_rxtx.c **** 
1924:bluetooth_rxtx.c **** 		if (do_hop)
1925:bluetooth_rxtx.c **** 			hop();
1926:bluetooth_rxtx.c **** 
1927:bluetooth_rxtx.c **** 		//  you can jam but you keep turning off the light 
1928:bluetooth_rxtx.c **** 		if (le_jam_count > 0) {
1929:bluetooth_rxtx.c **** 			le_jam();
1930:bluetooth_rxtx.c **** 			--le_jam_count;
1931:bluetooth_rxtx.c **** 		} else {
1932:bluetooth_rxtx.c **** 			/* RX mode */
1933:bluetooth_rxtx.c **** 			dma_init_le();
1934:bluetooth_rxtx.c **** 			dio_ssp_start();
ARM GAS  /tmp/ccLwKaeN.s 			page 48


1935:bluetooth_rxtx.c **** 
1936:bluetooth_rxtx.c **** 			if (restart_jamming) {
1937:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
1938:bluetooth_rxtx.c **** 				restart_jamming = 0;
1939:bluetooth_rxtx.c **** 			} else {
1940:bluetooth_rxtx.c **** 				// wait till we're in FSLOCK before strobing RX
1941:bluetooth_rxtx.c **** 				while (!(cc2400_status() & FS_LOCK));
1942:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
1943:bluetooth_rxtx.c **** 			}
1944:bluetooth_rxtx.c **** 		}
1945:bluetooth_rxtx.c **** 
1946:bluetooth_rxtx.c **** 		rx_tc = 0;
1947:bluetooth_rxtx.c **** 		rx_err = 0;
1948:bluetooth_rxtx.c **** 	}
1949:bluetooth_rxtx.c **** 
1950:bluetooth_rxtx.c **** cleanup:
1951:bluetooth_rxtx.c **** 
1952:bluetooth_rxtx.c **** 	// disable USB interrupts
1953:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
1954:bluetooth_rxtx.c **** 
1955:bluetooth_rxtx.c **** 	// reset the radio completely
1956:bluetooth_rxtx.c **** 	cc2400_idle();
1957:bluetooth_rxtx.c **** 	dio_ssp_stop();
1958:bluetooth_rxtx.c **** 	cs_trigger_disable();
1959:bluetooth_rxtx.c **** }
1960:bluetooth_rxtx.c **** 
1961:bluetooth_rxtx.c **** 
1962:bluetooth_rxtx.c **** 
1963:bluetooth_rxtx.c **** /* low energy connection following
1964:bluetooth_rxtx.c ****  * follows a known AA around */
1965:bluetooth_rxtx.c **** int cb_follow_le() {
 637              		.loc 1 1965 0
 638              		.cfi_startproc
 639              		@ args = 0, pretend = 0, frame = 0
 640              		@ frame_needed = 0, uses_anonymous_args = 0
 641 0000 2DE9F84F 		push	{r3, r4, r5, r6, r7, r8, r9, r10, fp, lr}
 642              		.cfi_def_cfa_offset 40
 643              		.cfi_offset 3, -40
 644              		.cfi_offset 4, -36
 645              		.cfi_offset 5, -32
 646              		.cfi_offset 6, -28
 647              		.cfi_offset 7, -24
 648              		.cfi_offset 8, -20
 649              		.cfi_offset 9, -16
 650              		.cfi_offset 10, -12
 651              		.cfi_offset 11, -8
 652              		.cfi_offset 14, -4
1966:bluetooth_rxtx.c **** 	int i, j, k;
1967:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(channel)];
 653              		.loc 1 1967 0
 654 0004 3C4D     		ldr	r5, .L68
 655 0006 3D4C     		ldr	r4, .L68+4
 656 0008 B5F84C00 		ldrh	r0, [r5, #76]
 657 000c 80B2     		uxth	r0, r0
 658 000e FFF7FEFF 		bl	btle_channel_index
 659              	.LVL59:
1968:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccLwKaeN.s 			page 49


1969:bluetooth_rxtx.c **** 	u32 access_address = 0;
 660              		.loc 1 1969 0
 661 0012 0022     		movs	r2, #0
1967:bluetooth_rxtx.c **** 
 662              		.loc 1 1967 0
 663 0014 215C     		ldrb	r1, [r4, r0]	@ zero_extendqisi2
 664              	.LVL60:
 665 0016 2846     		mov	r0, r5
1970:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
1971:bluetooth_rxtx.c **** 		access_address >>= 1;
1972:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
 666              		.loc 1 1972 0
 667 0018 394D     		ldr	r5, .L68+8
1970:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 668              		.loc 1 1970 0
 669 001a 1346     		mov	r3, r2
 670 001c A646     		mov	lr, r4
 671 001e AC46     		mov	ip, r5
 672              	.LVL61:
 673              	.L49:
 674              		.loc 1 1972 0 discriminator 3
 675 0020 5C5D     		ldrb	r4, [r3, r5]	@ zero_extendqisi2
1970:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 676              		.loc 1 1970 0 discriminator 3
 677 0022 0133     		adds	r3, r3, #1
 678              		.loc 1 1972 0 discriminator 3
 679 0024 E407     		lsls	r4, r4, #31
1970:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 680              		.loc 1 1970 0 discriminator 3
 681 0026 1F2B     		cmp	r3, #31
 682              		.loc 1 1972 0 discriminator 3
 683 0028 44EA5202 		orr	r2, r4, r2, lsr #1
 684              	.LVL62:
1970:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 685              		.loc 1 1970 0 discriminator 3
 686 002c F8D1     		bne	.L49
1973:bluetooth_rxtx.c **** 	}
1974:bluetooth_rxtx.c **** 
1975:bluetooth_rxtx.c **** 	for (i = 31; i < DMA_SIZE * 8 + 32; i++) {
1976:bluetooth_rxtx.c **** 		access_address >>= 1;
1977:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
1978:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 687              		.loc 1 1978 0
 688 002e 0568     		ldr	r5, [r0]
 689              	.L60:
 690              	.LVL63:
1977:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 691              		.loc 1 1977 0
 692 0030 1CF80340 		ldrb	r4, [ip, r3]	@ zero_extendqisi2
 693 0034 E407     		lsls	r4, r4, #31
 694 0036 44EA5202 		orr	r2, r4, r2, lsr #1
 695              	.LVL64:
 696              		.loc 1 1978 0
 697 003a AA42     		cmp	r2, r5
 698 003c 56D1     		bne	.L66
 699              	.LBB8:
1979:bluetooth_rxtx.c **** 			for (j = 0; j < 46; ++j) {
ARM GAS  /tmp/ccLwKaeN.s 			page 50


1980:bluetooth_rxtx.c **** 				u8 byte = 0;
1981:bluetooth_rxtx.c **** 				for (k = 0; k < 8; k++) {
1982:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
1983:bluetooth_rxtx.c **** 					if (offset >= DMA_SIZE*8*2) break;
1984:bluetooth_rxtx.c **** 					int bit = unpacked[offset];
1985:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
1986:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
1987:bluetooth_rxtx.c **** 						idx = (idx + 1) % sizeof(whitening);
1988:bluetooth_rxtx.c **** 					}
1989:bluetooth_rxtx.c **** 					byte |= bit << k;
1990:bluetooth_rxtx.c **** 				}
1991:bluetooth_rxtx.c **** 				idle_rxbuf[j] = byte;
 700              		.loc 1 1991 0
 701 003e 314E     		ldr	r6, .L68+12
 702              	.LBE8:
 703 0040 0024     		movs	r4, #0
 704              	.LBB13:
 705              	.LBB9:
1987:bluetooth_rxtx.c **** 					}
 706              		.loc 1 1987 0
 707 0042 4FF07F09 		mov	r9, #127
 708 0046 3546     		mov	r5, r6
 709              	.LVL65:
 710              	.L55:
 711              	.LBE9:
 712              	.LBE13:
1970:bluetooth_rxtx.c **** 		access_address >>= 1;
 713              		.loc 1 1970 0
 714 0048 4FF0000A 		mov	r10, #0
 715 004c 5746     		mov	r7, r10
 716 004e 03EBC408 		add	r8, r3, r4, lsl #3
 717              	.LVL66:
 718              	.L54:
 719              	.LBB14:
 720              	.LBB10:
1984:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 721              		.loc 1 1984 0
 722 0052 07EB0802 		add	r2, r7, r8
 723 0056 6244     		add	r2, r2, ip
1985:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 724              		.loc 1 1985 0
 725 0058 032C     		cmp	r4, #3
1984:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 726              		.loc 1 1984 0
 727 005a 12F81F2C 		ldrb	r2, [r2, #-31]	@ zero_extendqisi2
 728              	.LVL67:
1985:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 729              		.loc 1 1985 0
 730 005e 0CDD     		ble	.L53
1986:bluetooth_rxtx.c **** 						idx = (idx + 1) % sizeof(whitening);
 731              		.loc 1 1986 0
 732 0060 0EEB010B 		add	fp, lr, r1
 733 0064 9BF828B0 		ldrb	fp, [fp, #40]	@ zero_extendqisi2
1987:bluetooth_rxtx.c **** 					}
 734              		.loc 1 1987 0
 735 0068 0131     		adds	r1, r1, #1
 736              	.LVL68:
ARM GAS  /tmp/ccLwKaeN.s 			page 51


1986:bluetooth_rxtx.c **** 						idx = (idx + 1) % sizeof(whitening);
 737              		.loc 1 1986 0
 738 006a 82EA0B02 		eor	r2, r2, fp
 739              	.LVL69:
1987:bluetooth_rxtx.c **** 					}
 740              		.loc 1 1987 0
 741 006e B1FBF9FB 		udiv	fp, r1, r9
 742 0072 CBEBCB1B 		rsb	fp, fp, fp, lsl #7
 743 0076 A1EB0B01 		sub	r1, r1, fp
 744              	.LVL70:
 745              	.L53:
1989:bluetooth_rxtx.c **** 				}
 746              		.loc 1 1989 0 discriminator 2
 747 007a BA40     		lsls	r2, r2, r7
 748              	.LVL71:
 749              	.LBE10:
1981:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 750              		.loc 1 1981 0 discriminator 2
 751 007c 0137     		adds	r7, r7, #1
 752              	.LVL72:
 753              	.LBB11:
1989:bluetooth_rxtx.c **** 				}
 754              		.loc 1 1989 0 discriminator 2
 755 007e 42EA0A02 		orr	r2, r2, r10
 756              	.LBE11:
1981:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 757              		.loc 1 1981 0 discriminator 2
 758 0082 082F     		cmp	r7, #8
 759              	.LBB12:
1989:bluetooth_rxtx.c **** 				}
 760              		.loc 1 1989 0 discriminator 2
 761 0084 5FFA82FA 		uxtb	r10, r2
 762              	.LVL73:
 763              	.LBE12:
1981:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 764              		.loc 1 1981 0 discriminator 2
 765 0088 E3D1     		bne	.L54
 766              		.loc 1 1991 0 discriminator 2
 767 008a 3268     		ldr	r2, [r6]
 768 008c 02F804A0 		strb	r10, [r2, r4]
 769              	.LBE14:
1979:bluetooth_rxtx.c **** 				u8 byte = 0;
 770              		.loc 1 1979 0 discriminator 2
 771 0090 0134     		adds	r4, r4, #1
 772              	.LVL74:
 773 0092 2E2C     		cmp	r4, #46
 774 0094 D8D1     		bne	.L55
1992:bluetooth_rxtx.c **** 			}
1993:bluetooth_rxtx.c **** 
1994:bluetooth_rxtx.c **** 			// verify CRC
1995:bluetooth_rxtx.c **** 			if (le.crc_verify) {
 775              		.loc 1 1995 0
 776 0096 0369     		ldr	r3, [r0, #16]
 777 0098 6BB9     		cbnz	r3, .L57
 778              	.LVL75:
 779              	.L59:
1996:bluetooth_rxtx.c **** 				int len		 = (idle_rxbuf[5] & 0x3f) + 2;
ARM GAS  /tmp/ccLwKaeN.s 			page 52


1997:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
1998:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
1999:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
2000:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
2001:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
2002:bluetooth_rxtx.c **** 					break;
2003:bluetooth_rxtx.c **** 			}
2004:bluetooth_rxtx.c **** 
2005:bluetooth_rxtx.c **** 			// send to PC
2006:bluetooth_rxtx.c **** 			enqueue(LE_PACKET, (uint8_t*)idle_rxbuf);
 780              		.loc 1 2006 0
 781 009a 2968     		ldr	r1, [r5]
 782 009c 0120     		movs	r0, #1
 783 009e FFF7FEFF 		bl	enqueue
 784              	.LVL76:
2007:bluetooth_rxtx.c **** 			RXLED_SET;
 785              		.loc 1 2007 0
 786 00a2 1022     		movs	r2, #16
 787 00a4 184B     		ldr	r3, .L68+16
 788 00a6 1A60     		str	r2, [r3]
2008:bluetooth_rxtx.c **** 
2009:bluetooth_rxtx.c **** 			packet_cb((uint8_t*)idle_rxbuf);
 789              		.loc 1 2009 0
 790 00a8 184B     		ldr	r3, .L68+20
 791 00aa 2868     		ldr	r0, [r5]
 792 00ac 9B69     		ldr	r3, [r3, #24]
 793 00ae 9847     		blx	r3
 794              	.LVL77:
 795              	.L58:
2010:bluetooth_rxtx.c **** 
2011:bluetooth_rxtx.c **** 			break;
2012:bluetooth_rxtx.c **** 		}
2013:bluetooth_rxtx.c **** 	}
2014:bluetooth_rxtx.c **** 
2015:bluetooth_rxtx.c **** 	return 1;
2016:bluetooth_rxtx.c **** }
 796              		.loc 1 2016 0
 797 00b0 0120     		movs	r0, #1
 798 00b2 BDE8F88F 		pop	{r3, r4, r5, r6, r7, r8, r9, r10, fp, pc}
 799              	.LVL78:
 800              	.L57:
 801              	.LBB15:
1996:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
 802              		.loc 1 1996 0
 803 00b6 3368     		ldr	r3, [r6]
1997:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 804              		.loc 1 1997 0
 805 00b8 C068     		ldr	r0, [r0, #12]
1996:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
 806              		.loc 1 1996 0
 807 00ba 5C79     		ldrb	r4, [r3, #5]	@ zero_extendqisi2
 808              	.LVL79:
1997:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 809              		.loc 1 1997 0
 810 00bc 3168     		ldr	r1, [r6]
 811              	.LVL80:
1996:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
ARM GAS  /tmp/ccLwKaeN.s 			page 53


 812              		.loc 1 1996 0
 813 00be 04F03F04 		and	r4, r4, #63
 814              	.LVL81:
1997:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 815              		.loc 1 1997 0
 816 00c2 A21C     		adds	r2, r4, #2
 817              	.LVL82:
 818 00c4 0431     		adds	r1, r1, #4
 819 00c6 FFF7FEFF 		bl	btle_crcgen_lut
 820              	.LVL83:
1998:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
 821              		.loc 1 1998 0
 822 00ca 3268     		ldr	r2, [r6]
 823 00cc 04F10803 		add	r3, r4, #8
 824 00d0 D15C     		ldrb	r1, [r2, r3]	@ zero_extendqisi2
1999:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
 825              		.loc 1 1999 0
 826 00d2 3268     		ldr	r2, [r6]
 827 00d4 E31D     		adds	r3, r4, #7
 828 00d6 D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
2000:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 829              		.loc 1 2000 0
 830 00d8 3268     		ldr	r2, [r6]
 831 00da 0634     		adds	r4, r4, #6
 832              	.LVL84:
 833 00dc 125D     		ldrb	r2, [r2, r4]	@ zero_extendqisi2
 834              	.LVL85:
1999:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
 835              		.loc 1 1999 0
 836 00de 1B02     		lsls	r3, r3, #8
 837              	.LVL86:
 838 00e0 43EA0143 		orr	r3, r3, r1, lsl #16
2000:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 839              		.loc 1 2000 0
 840 00e4 1343     		orrs	r3, r3, r2
2001:bluetooth_rxtx.c **** 					break;
 841              		.loc 1 2001 0
 842 00e6 9842     		cmp	r0, r3
 843 00e8 E2D1     		bne	.L58
 844 00ea D6E7     		b	.L59
 845              	.LVL87:
 846              	.L66:
 847              	.LBE15:
1975:bluetooth_rxtx.c **** 		access_address >>= 1;
 848              		.loc 1 1975 0 discriminator 2
 849 00ec 0133     		adds	r3, r3, #1
 850              	.LVL88:
 851 00ee B3F5D87F 		cmp	r3, #432
 852 00f2 9DD1     		bne	.L60
 853 00f4 DCE7     		b	.L58
 854              	.L69:
 855 00f6 00BF     		.align	2
 856              	.L68:
 857 00f8 00000000 		.word	.LANCHOR0
 858 00fc 00000000 		.word	.LANCHOR2
 859 0100 00000000 		.word	unpacked
 860 0104 00000000 		.word	idle_rxbuf
ARM GAS  /tmp/ccLwKaeN.s 			page 54


 861 0108 38C00920 		.word	537509944
 862 010c 00000000 		.word	.LANCHOR1
 863              		.cfi_endproc
 864              	.LFE24:
 866              		.global	__aeabi_llsl
 867              		.section	.text.vendor_request_handler,"ax",%progbits
 868              		.align	1
 869              		.syntax unified
 870              		.thumb
 871              		.thumb_func
 872              		.fpu softvfp
 874              	vendor_request_handler:
 875              	.LFB2:
 214:bluetooth_rxtx.c **** 	uint32_t clock;
 876              		.loc 1 214 0
 877              		.cfi_startproc
 878              		@ args = 0, pretend = 0, frame = 0
 879              		@ frame_needed = 0, uses_anonymous_args = 0
 880              	.LVL89:
 881 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 882              		.cfi_def_cfa_offset 24
 883              		.cfi_offset 3, -24
 884              		.cfi_offset 4, -20
 885              		.cfi_offset 5, -16
 886              		.cfi_offset 6, -12
 887              		.cfi_offset 7, -8
 888              		.cfi_offset 14, -4
 214:bluetooth_rxtx.c **** 	uint32_t clock;
 889              		.loc 1 214 0
 890 0002 0E46     		mov	r6, r1
 891              	.LVL90:
 892 0004 1546     		mov	r5, r2
 893 0006 1C46     		mov	r4, r3
 222:bluetooth_rxtx.c **** 
 894              		.loc 1 222 0
 895 0008 4928     		cmp	r0, #73
 896 000a 00F27683 		bhi	.L187
 897 000e DFE810F0 		tbh	[pc, r0, lsl #1]
 898              	.LVL91:
 899              	.L73:
 900 0012 2201     		.2byte	(.L207-.L73)/2
 901 0014 5C00     		.2byte	(.L74-.L73)/2
 902 0016 6200     		.2byte	(.L75-.L73)/2
 903 0018 6700     		.2byte	(.L76-.L73)/2
 904 001a 6D00     		.2byte	(.L77-.L73)/2
 905 001c 7300     		.2byte	(.L78-.L73)/2
 906 001e 7800     		.2byte	(.L79-.L73)/2
 907 0020 7B00     		.2byte	(.L80-.L73)/2
 908 0022 8000     		.2byte	(.L81-.L73)/2
 909 0024 8400     		.2byte	(.L82-.L73)/2
 910 0026 8900     		.2byte	(.L83-.L73)/2
 911 0028 DD00     		.2byte	(.L84-.L73)/2
 912 002a E800     		.2byte	(.L85-.L73)/2
 913 002c 2701     		.2byte	(.L231-.L73)/2
 914 002e 9500     		.2byte	(.L87-.L73)/2
 915 0030 8F00     		.2byte	(.L88-.L73)/2
 916 0032 9A00     		.2byte	(.L89-.L73)/2
ARM GAS  /tmp/ccLwKaeN.s 			page 55


 917 0034 9F00     		.2byte	(.L90-.L73)/2
 918 0036 A400     		.2byte	(.L91-.L73)/2
 919 0038 A600     		.2byte	(.L92-.L73)/2
 920 003a AC00     		.2byte	(.L93-.L73)/2
 921 003c D400     		.2byte	(.L94-.L73)/2
 922 003e D600     		.2byte	(.L95-.L73)/2
 923 0040 D900     		.2byte	(.L96-.L73)/2
 924 0042 2001     		.2byte	(.L97-.L73)/2
 925 0044 2401     		.2byte	(.L98-.L73)/2
 926 0046 7403     		.2byte	(.L187-.L73)/2
 927 0048 2901     		.2byte	(.L99-.L73)/2
 928 004a B000     		.2byte	(.L100-.L73)/2
 929 004c B800     		.2byte	(.L101-.L73)/2
 930 004e C400     		.2byte	(.L102-.L73)/2
 931 0050 C200     		.2byte	(.L103-.L73)/2
 932 0052 C600     		.2byte	(.L104-.L73)/2
 933 0054 5301     		.2byte	(.L105-.L73)/2
 934 0056 4601     		.2byte	(.L106-.L73)/2
 935 0058 7001     		.2byte	(.L107-.L73)/2
 936 005a 7401     		.2byte	(.L108-.L73)/2
 937 005c 7B01     		.2byte	(.L109-.L73)/2
 938 005e 7D01     		.2byte	(.L110-.L73)/2
 939 0060 C701     		.2byte	(.L111-.L73)/2
 940 0062 FF01     		.2byte	(.L112-.L73)/2
 941 0064 1802     		.2byte	(.L113-.L73)/2
 942 0066 5A02     		.2byte	(.L114-.L73)/2
 943 0068 6A02     		.2byte	(.L115-.L73)/2
 944 006a 7502     		.2byte	(.L116-.L73)/2
 945 006c 9300     		.2byte	(.L178-.L73)/2
 946 006e 8902     		.2byte	(.L118-.L73)/2
 947 0070 8D02     		.2byte	(.L119-.L73)/2
 948 0072 9302     		.2byte	(.L120-.L73)/2
 949 0074 9A02     		.2byte	(.L121-.L73)/2
 950 0076 A602     		.2byte	(.L122-.L73)/2
 951 0078 0302     		.2byte	(.L123-.L73)/2
 952 007a 0E02     		.2byte	(.L124-.L73)/2
 953 007c AF02     		.2byte	(.L125-.L73)/2
 954 007e D202     		.2byte	(.L126-.L73)/2
 955 0080 6301     		.2byte	(.L127-.L73)/2
 956 0082 F902     		.2byte	(.L128-.L73)/2
 957 0084 7403     		.2byte	(.L187-.L73)/2
 958 0086 B602     		.2byte	(.L129-.L73)/2
 959 0088 6A03     		.2byte	(.L130-.L73)/2
 960 008a 6E03     		.2byte	(.L131-.L73)/2
 961 008c E901     		.2byte	(.L132-.L73)/2
 962 008e FB01     		.2byte	(.L133-.L73)/2
 963 0090 2502     		.2byte	(.L134-.L73)/2
 964 0092 7403     		.2byte	(.L187-.L73)/2
 965 0094 4A00     		.2byte	(.L135-.L73)/2
 966 0096 B902     		.2byte	(.L136-.L73)/2
 967 0098 4401     		.2byte	(.L137-.L73)/2
 968 009a C902     		.2byte	(.L138-.L73)/2
 969 009c 2C02     		.2byte	(.L139-.L73)/2
 970 009e 6603     		.2byte	(.L140-.L73)/2
 971 00a0 EE02     		.2byte	(.L141-.L73)/2
 972 00a2 7F02     		.2byte	(.L142-.L73)/2
 973 00a4 DC02     		.2byte	(.L143-.L73)/2
ARM GAS  /tmp/ccLwKaeN.s 			page 56


 974              		.p2align 1
 975              	.L135:
 222:bluetooth_rxtx.c **** 
 976              		.loc 1 222 0 is_stmt 0 discriminator 1
 977 00a6 0023     		movs	r3, #0
 978              	.LVL92:
 979              	.L144:
 654:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 980              		.loc 1 654 0 is_stmt 1 discriminator 1
 981 00a8 3288     		ldrh	r2, [r6]
 982 00aa 5C1C     		adds	r4, r3, #1
 983 00ac DBB2     		uxtb	r3, r3
 984 00ae 9342     		cmp	r3, r2
 985 00b0 42D2     		bcs	.L178
 655:bluetooth_rxtx.c **** 			cc2400_set(data[i*3], reg_val);
 986              		.loc 1 655 0 discriminator 3
 987 00b2 03EB4303 		add	r3, r3, r3, lsl #1
 988              	.LVL93:
 989 00b6 EA18     		adds	r2, r5, r3
 990 00b8 5178     		ldrb	r1, [r2, #1]	@ zero_extendqisi2
 991 00ba 9278     		ldrb	r2, [r2, #2]	@ zero_extendqisi2
 656:bluetooth_rxtx.c **** 		}
 992              		.loc 1 656 0 discriminator 3
 993 00bc E85C     		ldrb	r0, [r5, r3]	@ zero_extendqisi2
 994 00be 42EA0121 		orr	r1, r2, r1, lsl #8
 995 00c2 FFF7FEFF 		bl	cc2400_set
 996              	.LVL94:
 997 00c6 2346     		mov	r3, r4
 998 00c8 EEE7     		b	.L144
 999              	.LVL95:
 1000              	.L74:
 229:bluetooth_rxtx.c **** 		*data_len = 0;
 1001              		.loc 1 229 0
 1002 00ca 0120     		movs	r0, #1
 1003              	.LVL96:
 1004 00cc A54B     		ldr	r3, .L233
 1005 00ce 9874     		strb	r0, [r3, #18]
 230:bluetooth_rxtx.c **** 		break;
 1006              		.loc 1 230 0
 1007 00d0 0023     		movs	r3, #0
 1008              	.LVL97:
 1009              	.L203:
 524:bluetooth_rxtx.c **** 		break;
 1010              		.loc 1 524 0
 1011 00d2 2360     		str	r3, [r4]
 525:bluetooth_rxtx.c **** 
 1012              		.loc 1 525 0
 1013 00d4 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1014              	.LVL98:
 1015              	.L75:
 234:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_SYMBOLS;
 1016              		.loc 1 234 0
 1017 00d6 0222     		movs	r2, #2
 1018              	.LVL99:
 1019 00d8 A24B     		ldr	r3, .L233
 1020 00da 9A72     		strb	r2, [r3, #10]
 1021              	.LVL100:
ARM GAS  /tmp/ccLwKaeN.s 			page 57


 1022              	.L211:
 675:bluetooth_rxtx.c **** 		*data_len = 0;
 1023              		.loc 1 675 0
 1024 00dc 9A74     		strb	r2, [r3, #18]
 1025 00de BAE0     		b	.L207
 1026              	.LVL101:
 1027              	.L76:
 240:bluetooth_rxtx.c **** 		*data_len = 1;
 1028              		.loc 1 240 0
 1029 00e0 A14B     		ldr	r3, .L233+4
 1030 00e2 1B68     		ldr	r3, [r3]
 1031 00e4 C3F34003 		ubfx	r3, r3, #1, #1
 1032              	.L206:
 613:bluetooth_rxtx.c **** 		*data_len = 1;
 1033              		.loc 1 613 0
 1034 00e8 2B70     		strb	r3, [r5]
 1035              	.LVL102:
 1036 00ea 48E0     		b	.L204
 1037              	.LVL103:
 1038              	.L77:
 1039 00ec 0223     		movs	r3, #2
 245:bluetooth_rxtx.c **** 			USRLED_SET;
 1040              		.loc 1 245 0
 1041 00ee 0A88     		ldrh	r2, [r1]
 1042              	.LVL104:
 1043              	.L226:
 281:bluetooth_rxtx.c **** 			CC1V8_SET;
 1044              		.loc 1 281 0
 1045 00f0 E2B1     		cbz	r2, .L148
 282:bluetooth_rxtx.c **** 		else
 1046              		.loc 1 282 0
 1047 00f2 9E4A     		ldr	r2, .L233+8
 1048              	.L209:
 321:bluetooth_rxtx.c **** 		break;
 1049              		.loc 1 321 0
 1050 00f4 1360     		str	r3, [r2]
 1051 00f6 1FE0     		b	.L178
 1052              	.LVL105:
 1053              	.L78:
 252:bluetooth_rxtx.c **** 		*data_len = 1;
 1054              		.loc 1 252 0
 1055 00f8 9B4B     		ldr	r3, .L233+4
 1056 00fa 1B68     		ldr	r3, [r3]
 1057 00fc C3F30013 		ubfx	r3, r3, #4, #1
 1058 0100 F2E7     		b	.L206
 1059              	.L79:
 257:bluetooth_rxtx.c **** 			RXLED_SET;
 1060              		.loc 1 257 0
 1061 0102 0A88     		ldrh	r2, [r1]
 1062              	.LVL106:
 1063 0104 1023     		movs	r3, #16
 1064 0106 F3E7     		b	.L226
 1065              	.LVL107:
 1066              	.L80:
 264:bluetooth_rxtx.c **** 		*data_len = 1;
 1067              		.loc 1 264 0
 1068 0108 974B     		ldr	r3, .L233+4
ARM GAS  /tmp/ccLwKaeN.s 			page 58


 1069              	.L221:
 313:bluetooth_rxtx.c **** 		*data_len = 1;
 1070              		.loc 1 313 0
 1071 010a 1B68     		ldr	r3, [r3]
 1072 010c C3F30023 		ubfx	r3, r3, #8, #1
 1073 0110 EAE7     		b	.L206
 1074              	.L81:
 269:bluetooth_rxtx.c **** 			TXLED_SET;
 1075              		.loc 1 269 0
 1076 0112 0A88     		ldrh	r2, [r1]
 1077              	.LVL108:
 1078 0114 4FF48073 		mov	r3, #256
 1079 0118 EAE7     		b	.L226
 1080              	.LVL109:
 1081              	.L82:
 276:bluetooth_rxtx.c **** 		*data_len = 1;
 1082              		.loc 1 276 0
 1083 011a 934B     		ldr	r3, .L233+4
 1084 011c 1B68     		ldr	r3, [r3]
 1085 011e C3F34023 		ubfx	r3, r3, #9, #1
 1086 0122 E1E7     		b	.L206
 1087              	.L83:
 281:bluetooth_rxtx.c **** 			CC1V8_SET;
 1088              		.loc 1 281 0
 1089 0124 0A88     		ldrh	r2, [r1]
 1090              	.LVL110:
 1091 0126 4FF40073 		mov	r3, #512
 1092 012a E1E7     		b	.L226
 1093              	.L148:
 284:bluetooth_rxtx.c **** 		break;
 1094              		.loc 1 284 0
 1095 012c 904A     		ldr	r2, .L233+12
 1096 012e E1E7     		b	.L209
 1097              	.LVL111:
 1098              	.L88:
 288:bluetooth_rxtx.c **** 		break;
 1099              		.loc 1 288 0
 1100 0130 2146     		mov	r1, r4
 1101              	.LVL112:
 1102 0132 1046     		mov	r0, r2
 1103              	.LVL113:
 1104 0134 FFF7FEFF 		bl	get_part_num
 1105              	.LVL114:
 1106              	.L178:
 764:bluetooth_rxtx.c **** }
 1107              		.loc 1 764 0
 1108 0138 0120     		movs	r0, #1
 1109 013a F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1110              	.LVL115:
 1111              	.L87:
 296:bluetooth_rxtx.c **** 		break;
 1112              		.loc 1 296 0
 1113 013c 2146     		mov	r1, r4
 1114              	.LVL116:
 1115 013e 1046     		mov	r0, r2
 1116              	.LVL117:
 1117 0140 FFF7FEFF 		bl	get_device_serial
ARM GAS  /tmp/ccLwKaeN.s 			page 59


 1118              	.LVL118:
 1119 0144 F8E7     		b	.L178
 1120              	.LVL119:
 1121              	.L89:
 301:bluetooth_rxtx.c **** 		*data_len = 1;
 1122              		.loc 1 301 0
 1123 0146 8B4B     		ldr	r3, .L233+16
 1124 0148 1B68     		ldr	r3, [r3]
 1125 014a C3F3C013 		ubfx	r3, r3, #7, #1
 1126 014e CBE7     		b	.L206
 1127              	.L90:
 1128 0150 8023     		movs	r3, #128
 306:bluetooth_rxtx.c **** 			PAEN_SET;
 1129              		.loc 1 306 0
 1130 0152 0A88     		ldrh	r2, [r1]
 1131              	.LVL120:
 1132              	.L230:
 318:bluetooth_rxtx.c **** 			HGM_SET;
 1133              		.loc 1 318 0
 1134 0154 3AB1     		cbz	r2, .L150
 319:bluetooth_rxtx.c **** 		else
 1135              		.loc 1 319 0
 1136 0156 884A     		ldr	r2, .L233+20
 1137 0158 CCE7     		b	.L209
 1138              	.LVL121:
 1139              	.L91:
 313:bluetooth_rxtx.c **** 		*data_len = 1;
 1140              		.loc 1 313 0
 1141 015a 864B     		ldr	r3, .L233+16
 1142 015c D5E7     		b	.L221
 1143              	.L92:
 318:bluetooth_rxtx.c **** 			HGM_SET;
 1144              		.loc 1 318 0
 1145 015e 0A88     		ldrh	r2, [r1]
 1146              	.LVL122:
 1147 0160 4FF48073 		mov	r3, #256
 1148 0164 F6E7     		b	.L230
 1149              	.L150:
 321:bluetooth_rxtx.c **** 		break;
 1150              		.loc 1 321 0
 1151 0166 854A     		ldr	r2, .L233+24
 1152 0168 C4E7     		b	.L209
 1153              	.LVL123:
 1154              	.L93:
 327:bluetooth_rxtx.c **** 		break;
 1155              		.loc 1 327 0
 1156 016a 0322     		movs	r2, #3
 1157              	.LVL124:
 1158              	.L224:
 1159 016c 7D4B     		ldr	r3, .L233
 1160              	.LVL125:
 1161              	.L210:
 690:bluetooth_rxtx.c **** 		break;
 1162              		.loc 1 690 0
 1163 016e 9A74     		strb	r2, [r3, #18]
 1164 0170 E2E7     		b	.L178
 1165              	.LVL126:
ARM GAS  /tmp/ccLwKaeN.s 			page 60


 1166              	.L100:
 331:bluetooth_rxtx.c **** 		*data_len = 1;
 1167              		.loc 1 331 0
 1168 0172 0520     		movs	r0, #5
 1169              	.LVL127:
 1170 0174 FFF7FEFF 		bl	cc2400_get
 1171              	.LVL128:
 1172 0178 00F00700 		and	r0, r0, #7
 1173 017c 2870     		strb	r0, [r5]
 1174              	.LVL129:
 1175              	.L204:
 628:bluetooth_rxtx.c **** 		}
 1176              		.loc 1 628 0
 1177 017e 0120     		movs	r0, #1
 1178 0180 B9E0     		b	.L205
 1179              	.LVL130:
 1180              	.L101:
 336:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 1181              		.loc 1 336 0
 1182 0182 0988     		ldrh	r1, [r1]
 1183              	.LVL131:
 1184 0184 0729     		cmp	r1, #7
 1185 0186 00F2B882 		bhi	.L187
 337:bluetooth_rxtx.c **** 		} else {
 1186              		.loc 1 337 0
 1187 018a 0520     		movs	r0, #5
 1188              	.LVL132:
 1189 018c 41F00801 		orr	r1, r1, #8
 1190              	.L212:
 650:bluetooth_rxtx.c **** 		break;
 1191              		.loc 1 650 0
 1192 0190 FFF7FEFF 		bl	cc2400_set
 1193              	.LVL133:
 1194 0194 D0E7     		b	.L178
 1195              	.LVL134:
 1196              	.L103:
 344:bluetooth_rxtx.c **** 		break;
 1197              		.loc 1 344 0
 1198 0196 0522     		movs	r2, #5
 1199              	.LVL135:
 1200 0198 E8E7     		b	.L224
 1201              	.LVL136:
 1202              	.L102:
 348:bluetooth_rxtx.c **** 		break;
 1203              		.loc 1 348 0
 1204 019a 0622     		movs	r2, #6
 1205              	.LVL137:
 1206 019c E6E7     		b	.L224
 1207              	.LVL138:
 1208              	.L104:
 353:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 1209              		.loc 1 353 0
 1210 019e 784B     		ldr	r3, .L233+28
 1211 01a0 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1212              	.LVL139:
 1213 01a2 2A70     		strb	r2, [r5]
 1214              	.LVL140:
ARM GAS  /tmp/ccLwKaeN.s 			page 61


 354:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 1215              		.loc 1 354 0
 1216 01a4 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 1217 01a6 6A70     		strb	r2, [r5, #1]
 355:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 1218              		.loc 1 355 0
 1219 01a8 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 1220 01aa AA70     		strb	r2, [r5, #2]
 356:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
 1221              		.loc 1 356 0
 1222 01ac DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 1223 01ae EA70     		strb	r2, [r5, #3]
 357:bluetooth_rxtx.c **** 		*data_len = 5;
 1224              		.loc 1 357 0
 1225 01b0 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 1226 01b2 2B71     		strb	r3, [r5, #4]
 358:bluetooth_rxtx.c **** 		break;
 1227              		.loc 1 358 0
 1228 01b4 0523     		movs	r3, #5
 1229              	.LVL141:
 1230              	.L208:
 676:bluetooth_rxtx.c **** 		break;
 1231              		.loc 1 676 0
 1232 01b6 2360     		str	r3, [r4]
 1233 01b8 BEE7     		b	.L178
 1234              	.LVL142:
 1235              	.L94:
 362:bluetooth_rxtx.c **** 		break;
 1236              		.loc 1 362 0
 1237 01ba 0022     		movs	r2, #0
 1238              	.LVL143:
 1239 01bc D6E7     		b	.L224
 1240              	.LVL144:
 1241              	.L95:
 366:bluetooth_rxtx.c **** 		*data_len = 1;
 1242              		.loc 1 366 0
 1243 01be 694B     		ldr	r3, .L233
 1244              	.L222:
 469:bluetooth_rxtx.c **** 		*data_len = 1;
 1245              		.loc 1 469 0
 1246 01c0 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1247 01c2 91E7     		b	.L206
 1248              	.L96:
 371:bluetooth_rxtx.c **** 		break;
 1249              		.loc 1 371 0
 1250 01c4 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 1251              	.LVL145:
 1252 01c6 674B     		ldr	r3, .L233
 1253 01c8 1A70     		strb	r2, [r3]
 1254 01ca B5E7     		b	.L178
 1255              	.LVL146:
 1256              	.L84:
 375:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
 1257              		.loc 1 375 0
 1258 01cc 6D4B     		ldr	r3, .L233+32
 1259 01ce B3F84C20 		ldrh	r2, [r3, #76]
 1260              	.LVL147:
ARM GAS  /tmp/ccLwKaeN.s 			page 62


 1261 01d2 2A70     		strb	r2, [r5]
 1262              	.LVL148:
 376:bluetooth_rxtx.c **** 		*data_len = 2;
 1263              		.loc 1 376 0
 1264 01d4 B3F84C30 		ldrh	r3, [r3, #76]
 1265 01d8 C3F30723 		ubfx	r3, r3, #8, #8
 1266              	.L232:
 608:bluetooth_rxtx.c **** 		*data_len = 2;
 1267              		.loc 1 608 0
 1268 01dc 6B70     		strb	r3, [r5, #1]
 1269              	.LVL149:
 1270              	.L223:
 646:bluetooth_rxtx.c **** 		break;
 1271              		.loc 1 646 0
 1272 01de 0223     		movs	r3, #2
 1273 01e0 E9E7     		b	.L208
 1274              	.LVL150:
 1275              	.L85:
 381:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 1276              		.loc 1 381 0
 1277 01e2 0A88     		ldrh	r2, [r1]
 1278              	.LVL151:
 383:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 1279              		.loc 1 383 0
 1280 01e4 40F6EA21 		movw	r1, #2794
 1281              	.LVL152:
 381:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 1282              		.loc 1 381 0
 1283 01e8 5E4B     		ldr	r3, .L233
 1284 01ea DA81     		strh	r2, [r3, #14]	@ movhi
 383:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 1285              		.loc 1 383 0
 1286 01ec DA89     		ldrh	r2, [r3, #14]
 1287 01ee 92B2     		uxth	r2, r2
 1288 01f0 8A42     		cmp	r2, r1
 1289 01f2 18D9     		bls	.L151
 384:bluetooth_rxtx.c **** 			requested_channel = 2402;
 1290              		.loc 1 384 0
 1291 01f4 0122     		movs	r2, #1
 1292 01f6 9A72     		strb	r2, [r3, #10]
 385:bluetooth_rxtx.c **** 		}
 1293              		.loc 1 385 0
 1294 01f8 40F66212 		movw	r2, #2402
 1295              	.L154:
 391:bluetooth_rxtx.c **** 		}
 1296              		.loc 1 391 0 discriminator 4
 1297 01fc DA81     		strh	r2, [r3, #14]	@ movhi
 394:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 1298              		.loc 1 394 0 discriminator 4
 1299 01fe D989     		ldrh	r1, [r3, #14]
 1300 0200 604A     		ldr	r2, .L233+32
 1301 0202 89B2     		uxth	r1, r1
 1302 0204 A2F85010 		strh	r1, [r2, #80]	@ movhi
 395:bluetooth_rxtx.c **** 			channel = requested_channel;
 1303              		.loc 1 395 0 discriminator 4
 1304 0208 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 1305 020a 0929     		cmp	r1, #9
ARM GAS  /tmp/ccLwKaeN.s 			page 63


 1306 020c 94D0     		beq	.L178
 396:bluetooth_rxtx.c **** 			requested_channel = 0;
 1307              		.loc 1 396 0
 1308 020e D989     		ldrh	r1, [r3, #14]
 1309 0210 89B2     		uxth	r1, r1
 1310 0212 A2F84C10 		strh	r1, [r2, #76]	@ movhi
 397:bluetooth_rxtx.c **** 
 1311              		.loc 1 397 0
 1312 0216 0021     		movs	r1, #0
 1313 0218 D981     		strh	r1, [r3, #14]	@ movhi
 401:bluetooth_rxtx.c **** 		}
 1314              		.loc 1 401 0
 1315 021a B2F84C00 		ldrh	r0, [r2, #76]
 1316              	.LVL153:
 1317              	.L213:
 639:bluetooth_rxtx.c **** 		break;
 1318              		.loc 1 639 0
 1319 021e 80B2     		uxth	r0, r0
 1320 0220 FFF7FEFF 		bl	cs_threshold_calc_and_set
 1321              	.LVL154:
 1322 0224 88E7     		b	.L178
 1323              	.LVL155:
 1324              	.L151:
 389:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 1325              		.loc 1 389 0
 1326 0226 0022     		movs	r2, #0
 1327 0228 9A72     		strb	r2, [r3, #10]
 390:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 1328              		.loc 1 390 0
 1329 022a 40F6DC02 		movw	r2, #2268
 1330 022e D989     		ldrh	r1, [r3, #14]
 1331 0230 89B2     		uxth	r1, r1
 1332 0232 9142     		cmp	r1, r2
 391:bluetooth_rxtx.c **** 		}
 1333              		.loc 1 391 0
 1334 0234 40F6E921 		movw	r1, #2793
 390:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 1335              		.loc 1 390 0
 1336 0238 84BF     		itt	hi
 1337 023a DA89     		ldrhhi	r2, [r3, #14]
 1338 023c 92B2     		uxthhi	r2, r2
 1339 023e DA81     		strh	r2, [r3, #14]	@ movhi
 391:bluetooth_rxtx.c **** 		}
 1340              		.loc 1 391 0
 1341 0240 DA89     		ldrh	r2, [r3, #14]
 1342 0242 92B2     		uxth	r2, r2
 1343 0244 8A42     		cmp	r2, r1
 1344 0246 96BF     		itet	ls
 1345 0248 DA89     		ldrhls	r2, [r3, #14]
 1346 024a 40F6EA22 		movwhi	r2, #2794
 1347 024e 92B2     		uxthls	r2, r2
 1348 0250 D4E7     		b	.L154
 1349              	.LVL156:
 1350              	.L97:
 406:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 1351              		.loc 1 406 0
 1352 0252 FFF7FEFF 		bl	set_isp
ARM GAS  /tmp/ccLwKaeN.s 			page 64


 1353              	.LVL157:
 1354              	.L207:
 676:bluetooth_rxtx.c **** 		break;
 1355              		.loc 1 676 0
 1356 0256 0023     		movs	r3, #0
 1357 0258 ADE7     		b	.L208
 1358              	.LVL158:
 1359              	.L98:
 411:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 1360              		.loc 1 411 0
 1361 025a 4B4A     		ldr	r2, .L233+36
 1362              	.LVL159:
 1363 025c 4B4B     		ldr	r3, .L233+40
 1364 025e 1A60     		str	r2, [r3]
 1365              	.L231:
 412:bluetooth_rxtx.c **** 		break;
 1366              		.loc 1 412 0
 1367 0260 0B22     		movs	r2, #11
 1368 0262 83E7     		b	.L224
 1369              	.LVL160:
 1370              	.L99:
 416:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 1371              		.loc 1 416 0
 1372 0264 6FF40060 		mvn	r0, #2048
 1373              	.LVL161:
 1374 0268 0A88     		ldrh	r2, [r1]
 1375              	.LVL162:
 1376 026a 1318     		adds	r3, r2, r0
 1377 026c B3F5806F 		cmp	r3, #1024
 1378 0270 80F04382 		bcs	.L187
 417:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 1379              		.loc 1 417 0 discriminator 1
 1380 0274 4B88     		ldrh	r3, [r1, #2]
 416:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 1381              		.loc 1 416 0 discriminator 1
 1382 0276 6FF40061 		mvn	r1, #2048
 1383              	.LVL163:
 1384 027a 5918     		adds	r1, r3, r1
 1385 027c B1F5806F 		cmp	r1, #1024
 1386 0280 80F03B82 		bcs	.L187
 417:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 1387              		.loc 1 417 0 discriminator 1
 1388 0284 9A42     		cmp	r2, r3
 1389 0286 00F23882 		bhi	.L187
 420:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 1390              		.loc 1 420 0
 1391 028a 3E49     		ldr	r1, .L233+32
 1392 028c A1F85220 		strh	r2, [r1, #82]	@ movhi
 422:bluetooth_rxtx.c **** 		*data_len = 0;
 1393              		.loc 1 422 0
 1394 0290 0422     		movs	r2, #4
 421:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 1395              		.loc 1 421 0
 1396 0292 A1F85430 		strh	r3, [r1, #84]	@ movhi
 1397              	.LVL164:
 1398              	.L214:
 675:bluetooth_rxtx.c **** 		*data_len = 0;
ARM GAS  /tmp/ccLwKaeN.s 			page 65


 1399              		.loc 1 675 0
 1400 0296 334B     		ldr	r3, .L233
 1401 0298 20E7     		b	.L211
 1402              	.LVL165:
 1403              	.L137:
 427:bluetooth_rxtx.c **** 		*data_len = 0;
 1404              		.loc 1 427 0
 1405 029a 0F22     		movs	r2, #15
 1406              	.LVL166:
 1407 029c FBE7     		b	.L214
 1408              	.LVL167:
 1409              	.L106:
 432:bluetooth_rxtx.c **** 			return 0;
 1410              		.loc 1 432 0
 1411 029e 0B88     		ldrh	r3, [r1]
 1412 02a0 B3F5807F 		cmp	r3, #256
 1413 02a4 00F22982 		bhi	.L187
 434:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 1414              		.loc 1 434 0
 1415 02a8 364A     		ldr	r2, .L233+32
 1416              	.LVL168:
 1417 02aa C3F13603 		rsb	r3, r3, #54
 1418 02ae 5BB2     		sxtb	r3, r3
 1419 02b0 82F85630 		strb	r3, [r2, #86]
 435:bluetooth_rxtx.c **** 		*data_len = 0;
 1420              		.loc 1 435 0
 1421 02b4 0722     		movs	r2, #7
 1422 02b6 EEE7     		b	.L214
 1423              	.LVL169:
 1424              	.L105:
 440:bluetooth_rxtx.c **** 		data[1] = 0x00;
 1425              		.loc 1 440 0
 1426 02b8 0023     		movs	r3, #0
 443:bluetooth_rxtx.c **** 		data[2] = length;
 1427              		.loc 1 443 0
 1428 02ba 3548     		ldr	r0, .L233+44
 1429              	.LVL170:
 440:bluetooth_rxtx.c **** 		data[1] = 0x00;
 1430              		.loc 1 440 0
 1431 02bc 1370     		strb	r3, [r2]
 1432              	.LVL171:
 441:bluetooth_rxtx.c **** 
 1433              		.loc 1 441 0
 1434 02be 5370     		strb	r3, [r2, #1]
 443:bluetooth_rxtx.c **** 		data[2] = length;
 1435              		.loc 1 443 0
 1436 02c0 FFF7FEFF 		bl	strlen
 1437              	.LVL172:
 1438 02c4 C6B2     		uxtb	r6, r0
 1439              	.LVL173:
 1440 02c6 A870     		strb	r0, [r5, #2]
 446:bluetooth_rxtx.c **** 
 1441              		.loc 1 446 0
 1442 02c8 3246     		mov	r2, r6
 1443 02ca 3149     		ldr	r1, .L233+44
 1444 02cc E81C     		adds	r0, r5, #3
 1445 02ce FFF7FEFF 		bl	memcpy
ARM GAS  /tmp/ccLwKaeN.s 			page 66


 1446              	.LVL174:
 448:bluetooth_rxtx.c **** 		break;
 1447              		.loc 1 448 0
 1448 02d2 0336     		adds	r6, r6, #3
 1449              	.LVL175:
 1450              	.L215:
 455:bluetooth_rxtx.c **** 		break;
 1451              		.loc 1 455 0
 1452 02d4 2660     		str	r6, [r4]
 1453 02d6 2FE7     		b	.L178
 1454              	.LVL176:
 1455              	.L127:
 452:bluetooth_rxtx.c **** 		data[0] = length;
 1456              		.loc 1 452 0
 1457 02d8 2E48     		ldr	r0, .L233+48
 1458              	.LVL177:
 1459 02da FFF7FEFF 		bl	strlen
 1460              	.LVL178:
 1461 02de C6B2     		uxtb	r6, r0
 1462              	.LVL179:
 1463 02e0 05F8010B 		strb	r0, [r5], #1
 1464              	.LVL180:
 454:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 1465              		.loc 1 454 0
 1466 02e4 3246     		mov	r2, r6
 1467 02e6 2B49     		ldr	r1, .L233+48
 1468 02e8 2846     		mov	r0, r5
 1469 02ea FFF7FEFF 		bl	memcpy
 1470              	.LVL181:
 455:bluetooth_rxtx.c **** 		break;
 1471              		.loc 1 455 0
 1472 02ee 0136     		adds	r6, r6, #1
 1473              	.LVL182:
 1474 02f0 F0E7     		b	.L215
 1475              	.LVL183:
 1476              	.L107:
 459:bluetooth_rxtx.c **** 		*data_len = 1;
 1477              		.loc 1 459 0
 1478 02f2 0120     		movs	r0, #1
 1479              	.LVL184:
 1480 02f4 1070     		strb	r0, [r2]
 1481              	.LVL185:
 1482              	.L205:
 628:bluetooth_rxtx.c **** 		}
 1483              		.loc 1 628 0
 1484 02f6 2060     		str	r0, [r4]
 1485 02f8 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1486              	.LVL186:
 1487              	.L108:
 464:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1488              		.loc 1 464 0
 1489 02fa 0A88     		ldrh	r2, [r1]
 1490              	.LVL187:
 1491 02fc 264B     		ldr	r3, .L233+52
 1492 02fe 1A70     		strb	r2, [r3]
 1493              	.LVL188:
 1494              	.L217:
ARM GAS  /tmp/ccLwKaeN.s 			page 67


 639:bluetooth_rxtx.c **** 		break;
 1495              		.loc 1 639 0
 1496 0300 204B     		ldr	r3, .L233+32
 1497 0302 B3F84C00 		ldrh	r0, [r3, #76]
 1498 0306 8AE7     		b	.L213
 1499              	.LVL189:
 1500              	.L109:
 469:bluetooth_rxtx.c **** 		*data_len = 1;
 1501              		.loc 1 469 0
 1502 0308 234B     		ldr	r3, .L233+52
 1503 030a 59E7     		b	.L222
 1504              	.L110:
 474:bluetooth_rxtx.c **** 		target.syncword = 0;
 1505              		.loc 1 474 0
 1506 030c 0022     		movs	r2, #0
 1507              	.LVL190:
 1508 030e 0023     		movs	r3, #0
 475:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 1509              		.loc 1 475 0
 1510 0310 0026     		movs	r6, #0
 474:bluetooth_rxtx.c **** 		target.syncword = 0;
 1511              		.loc 1 474 0
 1512 0312 224C     		ldr	r4, .L233+56
 1513              	.LVL191:
 1514 0314 6F1E     		subs	r7, r5, #1
 1515 0316 C4E90023 		strd	r2, [r4]
 475:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 1516              		.loc 1 475 0
 1517 031a C4E90223 		strd	r2, [r4, #8]
 1518              	.LVL192:
 1519              	.L156:
 1520              	.LBB16:
 477:bluetooth_rxtx.c **** 		}
 1521              		.loc 1 477 0 discriminator 3
 1522 031e 3246     		mov	r2, r6
 1523 0320 17F8010F 		ldrb	r0, [r7, #1]!	@ zero_extendqisi2
 1524              	.LVL193:
 1525 0324 0021     		movs	r1, #0
 1526 0326 FFF7FEFF 		bl	__aeabi_llsl
 1527              	.LVL194:
 1528 032a D4E90023 		ldrd	r2, [r4]
 1529 032e 0836     		adds	r6, r6, #8
 1530 0330 1043     		orrs	r0, r0, r2
 1531 0332 1943     		orrs	r1, r1, r3
 476:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1532              		.loc 1 476 0 discriminator 3
 1533 0334 402E     		cmp	r6, #64
 477:bluetooth_rxtx.c **** 		}
 1534              		.loc 1 477 0 discriminator 3
 1535 0336 C4E90001 		strd	r0, [r4]
 1536              	.LVL195:
 476:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1537              		.loc 1 476 0 discriminator 3
 1538 033a F0D1     		bne	.L156
 1539 033c 0026     		movs	r6, #0
 1540 033e 0735     		adds	r5, r5, #7
 1541              	.LVL196:
ARM GAS  /tmp/ccLwKaeN.s 			page 68


 1542              	.L157:
 1543              	.LBE16:
 1544              	.LBB17:
 480:bluetooth_rxtx.c **** 		}
 1545              		.loc 1 480 0 discriminator 3
 1546 0340 3246     		mov	r2, r6
 1547 0342 15F8010F 		ldrb	r0, [r5, #1]!	@ zero_extendqisi2
 1548              	.LVL197:
 1549 0346 0021     		movs	r1, #0
 1550 0348 FFF7FEFF 		bl	__aeabi_llsl
 1551              	.LVL198:
 1552 034c D4E90223 		ldrd	r2, [r4, #8]
 1553 0350 0836     		adds	r6, r6, #8
 1554 0352 1043     		orrs	r0, r0, r2
 1555 0354 1943     		orrs	r1, r1, r3
 479:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1556              		.loc 1 479 0 discriminator 3
 1557 0356 402E     		cmp	r6, #64
 480:bluetooth_rxtx.c **** 		}
 1558              		.loc 1 480 0 discriminator 3
 1559 0358 C4E90201 		strd	r0, [r4, #8]
 1560              	.LVL199:
 479:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1561              		.loc 1 479 0 discriminator 3
 1562 035c F0D1     		bne	.L157
 1563              	.LBE17:
 482:bluetooth_rxtx.c **** 		break;
 1564              		.loc 1 482 0
 1565 035e FFF7FEFF 		bl	precalc
 1566              	.LVL200:
 1567 0362 E9E6     		b	.L178
 1568              	.L234:
 1569              		.align	2
 1570              	.L233:
 1571 0364 00000000 		.word	.LANCHOR1
 1572 0368 34C00920 		.word	537509940
 1573 036c 38C00920 		.word	537509944
 1574 0370 3CC00920 		.word	537509948
 1575 0374 54C00920 		.word	537509972
 1576 0378 58C00920 		.word	537509976
 1577 037c 5CC00920 		.word	537509980
 1578 0380 00000000 		.word	rr
 1579 0384 00000000 		.word	.LANCHOR0
 1580 0388 21BB0543 		.word	1124449057
 1581 038c 00000000 		.word	bootloader_ctrl
 1582 0390 00000000 		.word	.LC2
 1583 0394 A7000000 		.word	.LANCHOR2+167
 1584 0398 00000000 		.word	cs_threshold_req
 1585 039c 00000000 		.word	target
 1586              	.LVL201:
 1587              	.L111:
 486:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 1588              		.loc 1 486 0
 1589 03a0 0022     		movs	r2, #0
 1590              	.LVL202:
 1591 03a2 A24B     		ldr	r3, .L235
 1592 03a4 E81C     		adds	r0, r5, #3
ARM GAS  /tmp/ccLwKaeN.s 			page 69


 1593              	.LVL203:
 1594 03a6 1A60     		str	r2, [r3]
 1595              	.LVL204:
 1596 03a8 6A1E     		subs	r2, r5, #1
 1597              	.LVL205:
 1598              	.L158:
 1599              	.LBB18:
 488:bluetooth_rxtx.c **** 			clkn_offset |= data[i];
 1600              		.loc 1 488 0 discriminator 3
 1601 03aa 1968     		ldr	r1, [r3]
 1602 03ac 0902     		lsls	r1, r1, #8
 1603 03ae 1960     		str	r1, [r3]
 489:bluetooth_rxtx.c **** 		}
 1604              		.loc 1 489 0 discriminator 3
 1605 03b0 12F8011F 		ldrb	r1, [r2, #1]!	@ zero_extendqisi2
 1606              	.LVL206:
 1607 03b4 1C68     		ldr	r4, [r3]
 487:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1608              		.loc 1 487 0 discriminator 3
 1609 03b6 9042     		cmp	r0, r2
 489:bluetooth_rxtx.c **** 		}
 1610              		.loc 1 489 0 discriminator 3
 1611 03b8 41EA0401 		orr	r1, r1, r4
 1612 03bc 1960     		str	r1, [r3]
 1613              	.LVL207:
 487:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1614              		.loc 1 487 0 discriminator 3
 1615 03be F4D1     		bne	.L158
 1616              	.LBE18:
 491:bluetooth_rxtx.c **** 		dma_discard = 1;
 1617              		.loc 1 491 0
 1618 03c0 0222     		movs	r2, #2
 1619              	.LVL208:
 492:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 1620              		.loc 1 492 0
 1621 03c2 0120     		movs	r0, #1
 493:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1622              		.loc 1 493 0
 1623 03c4 4FF08051 		mov	r1, #268435456
 491:bluetooth_rxtx.c **** 		dma_discard = 1;
 1624              		.loc 1 491 0
 1625 03c8 994B     		ldr	r3, .L235+4
 1626 03ca 9A72     		strb	r2, [r3, #10]
 493:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1627              		.loc 1 493 0
 1628 03cc 994A     		ldr	r2, .L235+8
 492:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 1629              		.loc 1 492 0
 1630 03ce 1874     		strb	r0, [r3, #16]
 493:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1631              		.loc 1 493 0
 1632 03d0 1160     		str	r1, [r2]
 494:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 1633              		.loc 1 494 0
 1634 03d2 2979     		ldrb	r1, [r5, #4]	@ zero_extendqisi2
 1635 03d4 6A79     		ldrb	r2, [r5, #5]	@ zero_extendqisi2
 1636 03d6 42EA0122 		orr	r2, r2, r1, lsl #8
ARM GAS  /tmp/ccLwKaeN.s 			page 70


 1637 03da 9749     		ldr	r1, .L235+12
 1638 03dc 0A80     		strh	r2, [r1]	@ movhi
 495:bluetooth_rxtx.c **** 		break;
 1639              		.loc 1 495 0
 1640 03de 0822     		movs	r2, #8
 1641 03e0 9A74     		strb	r2, [r3, #18]
 496:bluetooth_rxtx.c **** 
 1642              		.loc 1 496 0
 1643 03e2 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1644              	.LVL209:
 1645              	.L132:
 499:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 1646              		.loc 1 499 0
 1647 03e4 0522     		movs	r2, #5
 1648              	.LVL210:
 1649 03e6 924B     		ldr	r3, .L235+4
 1650              	.LBB19:
 503:bluetooth_rxtx.c **** 		}
 1651              		.loc 1 503 0
 1652 03e8 9449     		ldr	r1, .L235+16
 1653              	.LVL211:
 1654              	.LBE19:
 499:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 1655              		.loc 1 499 0
 1656 03ea 9A72     		strb	r2, [r3, #10]
 500:bluetooth_rxtx.c **** 
 1657              		.loc 1 500 0
 1658 03ec 0E22     		movs	r2, #14
 1659 03ee 9A74     		strb	r2, [r3, #18]
 1660              	.LVL212:
 1661              	.LBB20:
 502:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1662              		.loc 1 502 0
 1663 03f0 0023     		movs	r3, #0
 503:bluetooth_rxtx.c **** 		}
 1664              		.loc 1 503 0
 1665 03f2 1A46     		mov	r2, r3
 1666              	.LVL213:
 1667              	.L159:
 503:bluetooth_rxtx.c **** 		}
 1668              		.loc 1 503 0 is_stmt 0 discriminator 3
 1669 03f4 5A54     		strb	r2, [r3, r1]
 502:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1670              		.loc 1 502 0 is_stmt 1 discriminator 3
 1671 03f6 0133     		adds	r3, r3, #1
 1672              	.LVL214:
 1673 03f8 0A2B     		cmp	r3, #10
 1674 03fa FBD1     		bne	.L159
 1675              	.LBE20:
 506:bluetooth_rxtx.c **** 		break;
 1676              		.loc 1 506 0
 1677 03fc 0120     		movs	r0, #1
 1678              	.LVL215:
 505:bluetooth_rxtx.c **** 		afh_enabled = 1;
 1679              		.loc 1 505 0
 1680 03fe 904B     		ldr	r3, .L235+20
 1681              	.LVL216:
ARM GAS  /tmp/ccLwKaeN.s 			page 71


 1682 0400 1A70     		strb	r2, [r3]
 506:bluetooth_rxtx.c **** 		break;
 1683              		.loc 1 506 0
 1684 0402 904B     		ldr	r3, .L235+24
 1685 0404 1870     		strb	r0, [r3]
 507:bluetooth_rxtx.c **** 
 1686              		.loc 1 507 0
 1687 0406 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1688              	.LVL217:
 1689              	.L133:
 510:bluetooth_rxtx.c **** 		break;
 1690              		.loc 1 510 0
 1691 0408 0120     		movs	r0, #1
 1692              	.LVL218:
 1693 040a 894B     		ldr	r3, .L235+4
 1694 040c D872     		strb	r0, [r3, #11]
 511:bluetooth_rxtx.c **** 
 1695              		.loc 1 511 0
 1696 040e F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1697              	.LVL219:
 1698              	.L112:
 1699 0410 1268     		ldr	r2, [r2]	@ unaligned
 1700              	.LVL220:
 515:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1701              		.loc 1 515 0
 1702 0412 8D4B     		ldr	r3, .L235+28
 1703 0414 1A60     		str	r2, [r3]
 1704 0416 73E7     		b	.L217
 1705              	.LVL221:
 1706              	.L123:
 222:bluetooth_rxtx.c **** 
 1707              		.loc 1 222 0 discriminator 3
 1708 0418 0023     		movs	r3, #0
 1709              	.LBB21:
 521:bluetooth_rxtx.c **** 		}
 1710              		.loc 1 521 0 discriminator 3
 1711 041a 884A     		ldr	r2, .L235+16
 1712              	.LVL222:
 1713              	.L160:
 1714 041c E95C     		ldrb	r1, [r5, r3]	@ zero_extendqisi2
 1715 041e 9954     		strb	r1, [r3, r2]
 520:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 1716              		.loc 1 520 0 discriminator 3
 1717 0420 0133     		adds	r3, r3, #1
 1718              	.LVL223:
 1719 0422 0A2B     		cmp	r3, #10
 1720 0424 FAD1     		bne	.L160
 1721              	.LBE21:
 523:bluetooth_rxtx.c **** 		*data_len = 10;
 1722              		.loc 1 523 0
 1723 0426 0120     		movs	r0, #1
 1724              	.LVL224:
 1725 0428 864A     		ldr	r2, .L235+24
 1726 042a 1070     		strb	r0, [r2]
 1727 042c 51E6     		b	.L203
 1728              	.LVL225:
 1729              	.L124:
ARM GAS  /tmp/ccLwKaeN.s 			page 72


 222:bluetooth_rxtx.c **** 
 1730              		.loc 1 222 0 discriminator 3
 1731 042e 0023     		movs	r3, #0
 1732              	.LBB22:
 529:bluetooth_rxtx.c **** 		}
 1733              		.loc 1 529 0 discriminator 3
 1734 0430 1A46     		mov	r2, r3
 1735              	.LVL226:
 1736 0432 8249     		ldr	r1, .L235+16
 1737              	.LVL227:
 1738              	.L161:
 1739 0434 5A54     		strb	r2, [r3, r1]
 528:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1740              		.loc 1 528 0 discriminator 3
 1741 0436 0133     		adds	r3, r3, #1
 1742              	.LVL228:
 1743 0438 0A2B     		cmp	r3, #10
 1744 043a FBD1     		bne	.L161
 1745              	.LBE22:
 531:bluetooth_rxtx.c **** 		*data_len = 10;
 1746              		.loc 1 531 0
 1747 043c 8149     		ldr	r1, .L235+24
 1748 043e 0A70     		strb	r2, [r1]
 1749 0440 B9E6     		b	.L208
 1750              	.LVL229:
 1751              	.L113:
 536:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 1752              		.loc 1 536 0
 1753 0442 814B     		ldr	r3, .L235+28
 1754 0444 551E     		subs	r5, r2, #1
 1755 0446 1968     		ldr	r1, [r3]
 1756              	.LVL230:
 1757 0448 0023     		movs	r3, #0
 1758              	.LVL231:
 1759              	.L162:
 1760              	.LBB23:
 538:bluetooth_rxtx.c **** 		}
 1761              		.loc 1 538 0 discriminator 3
 1762 044a 21FA03F2 		lsr	r2, r1, r3
 1763 044e 0833     		adds	r3, r3, #8
 537:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 1764              		.loc 1 537 0 discriminator 3
 1765 0450 202B     		cmp	r3, #32
 538:bluetooth_rxtx.c **** 		}
 1766              		.loc 1 538 0 discriminator 3
 1767 0452 05F8012F 		strb	r2, [r5, #1]!
 1768              	.LVL232:
 537:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 1769              		.loc 1 537 0 discriminator 3
 1770 0456 F8D1     		bne	.L162
 1771              	.LVL233:
 1772              	.L166:
 1773              	.LBE23:
 540:bluetooth_rxtx.c **** 		break;
 1774              		.loc 1 540 0
 1775 0458 0423     		movs	r3, #4
 1776 045a ACE6     		b	.L208
ARM GAS  /tmp/ccLwKaeN.s 			page 73


 1777              	.LVL234:
 1778              	.L134:
 544:bluetooth_rxtx.c **** 		break;
 1779              		.loc 1 544 0
 1780 045c 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 1781              	.LVL235:
 1782 045e 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 1783 0460 43EA0223 		orr	r3, r3, r2, lsl #8
 1784 0464 744A     		ldr	r2, .L235+12
 1785 0466 1380     		strh	r3, [r2]	@ movhi
 1786 0468 66E6     		b	.L178
 1787              	.LVL236:
 1788              	.L139:
 548:bluetooth_rxtx.c **** 
 1789              		.loc 1 548 0
 1790 046a 784A     		ldr	r2, .L235+32
 1791              	.LVL237:
 1792 046c 2878     		ldrb	r0, [r5]	@ zero_extendqisi2
 1793              	.LVL238:
 1794 046e 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 1795 0470 1188     		ldrh	r1, [r2]
 1796              	.LVL239:
 1797 0472 43EA0023 		orr	r3, r3, r0, lsl #8
 1798 0476 0B44     		add	r3, r3, r1
 1799 0478 1BB2     		sxth	r3, r3
 1800 047a 1380     		strh	r3, [r2]	@ movhi
 551:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / (uint16_t)(-clk_drift_ppm);
 1801              		.loc 1 551 0
 1802 047c 1388     		ldrh	r3, [r2]
 1803 047e 7449     		ldr	r1, .L235+36
 1804 0480 13F4004F 		tst	r3, #32768
 1805 0484 734B     		ldr	r3, .L235+40
 1806 0486 0ED0     		beq	.L163
 552:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 1807              		.loc 1 552 0
 1808 0488 4FF4A070 		mov	r0, #320
 1809 048c 1288     		ldrh	r2, [r2]
 1810 048e 5242     		negs	r2, r2
 1811 0490 92B2     		uxth	r2, r2
 1812 0492 90FBF2F2 		sdiv	r2, r0, r2
 1813              	.L216:
 557:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 1814              		.loc 1 557 0
 1815 0496 1A80     		strh	r2, [r3]	@ movhi
 558:bluetooth_rxtx.c **** 		}
 1816              		.loc 1 558 0
 1817 0498 6F4A     		ldr	r2, .L235+44
 1818 049a 1B88     		ldrh	r3, [r3]
 1819 049c 1268     		ldr	r2, [r2]
 1820 049e 9BB2     		uxth	r3, r3
 1821 04a0 1344     		add	r3, r3, r2
 1822 04a2 0B60     		str	r3, [r1]
 1823 04a4 48E6     		b	.L178
 1824              	.L163:
 556:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / clk_drift_ppm;
 1825              		.loc 1 556 0
 1826 04a6 1088     		ldrh	r0, [r2]
ARM GAS  /tmp/ccLwKaeN.s 			page 74


 1827 04a8 00B2     		sxth	r0, r0
 1828 04aa 0028     		cmp	r0, #0
 1829 04ac 07DD     		ble	.L164
 557:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 1830              		.loc 1 557 0
 1831 04ae 1288     		ldrh	r2, [r2]
 1832 04b0 10B2     		sxth	r0, r2
 1833 04b2 4FF4A072 		mov	r2, #320
 1834 04b6 92FBF0F2 		sdiv	r2, r2, r0
 1835 04ba 92B2     		uxth	r2, r2
 1836 04bc EBE7     		b	.L216
 1837              	.L164:
 562:bluetooth_rxtx.c **** 			clkn_next_drift_fix = 0;
 1838              		.loc 1 562 0
 1839 04be 0022     		movs	r2, #0
 1840 04c0 1A80     		strh	r2, [r3]	@ movhi
 563:bluetooth_rxtx.c **** 		}
 1841              		.loc 1 563 0
 1842 04c2 0A60     		str	r2, [r1]
 1843 04c4 38E6     		b	.L178
 1844              	.LVL240:
 1845              	.L114:
 570:bluetooth_rxtx.c **** 
 1846              		.loc 1 570 0
 1847 04c6 0022     		movs	r2, #0
 1848              	.LVL241:
 569:bluetooth_rxtx.c **** 		*data_len = 0;
 1849              		.loc 1 569 0
 1850 04c8 0B88     		ldrh	r3, [r1]
 1851 04ca 644D     		ldr	r5, .L235+48
 1852              	.LVL242:
 1853 04cc 6B63     		str	r3, [r5, #52]
 572:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 1854              		.loc 1 572 0
 1855 04ce 584B     		ldr	r3, .L235+4
 570:bluetooth_rxtx.c **** 
 1856              		.loc 1 570 0
 1857 04d0 2260     		str	r2, [r4]
 572:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 1858              		.loc 1 572 0
 1859 04d2 DA72     		strb	r2, [r3, #11]
 573:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 1860              		.loc 1 573 0
 1861 04d4 0322     		movs	r2, #3
 1862 04d6 9A72     		strb	r2, [r3, #10]
 574:bluetooth_rxtx.c **** 
 1863              		.loc 1 574 0
 1864 04d8 0922     		movs	r2, #9
 1865 04da 9A74     		strb	r2, [r3, #18]
 576:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1866              		.loc 1 576 0
 1867 04dc FFF7FEFF 		bl	usb_queue_init
 1868              	.LVL243:
 577:bluetooth_rxtx.c **** 		break;
 1869              		.loc 1 577 0
 1870 04e0 B5F84C00 		ldrh	r0, [r5, #76]
 1871 04e4 9BE6     		b	.L213
ARM GAS  /tmp/ccLwKaeN.s 			page 75


 1872              	.LVL244:
 1873              	.L115:
 222:bluetooth_rxtx.c **** 
 1874              		.loc 1 222 0 discriminator 3
 1875 04e6 0023     		movs	r3, #0
 1876              	.LBB24:
 582:bluetooth_rxtx.c **** 		}
 1877              		.loc 1 582 0 discriminator 3
 1878 04e8 5C49     		ldr	r1, .L235+48
 1879              	.LVL245:
 1880 04ea 551E     		subs	r5, r2, #1
 1881              	.LVL246:
 1882              	.L165:
 1883 04ec 0A68     		ldr	r2, [r1]
 1884 04ee DA40     		lsrs	r2, r2, r3
 1885 04f0 0833     		adds	r3, r3, #8
 581:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 1886              		.loc 1 581 0 discriminator 3
 1887 04f2 202B     		cmp	r3, #32
 582:bluetooth_rxtx.c **** 		}
 1888              		.loc 1 582 0 discriminator 3
 1889 04f4 05F8012F 		strb	r2, [r5, #1]!
 1890              	.LVL247:
 581:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 1891              		.loc 1 581 0 discriminator 3
 1892 04f8 F8D1     		bne	.L165
 1893 04fa ADE7     		b	.L166
 1894              	.LVL248:
 1895              	.L116:
 1896              	.LBE24:
 589:bluetooth_rxtx.c **** 		debug_printf("AA set\n");
 1897              		.loc 1 589 0
 1898 04fc 0124     		movs	r4, #1
 1899              	.LVL249:
 588:bluetooth_rxtx.c **** 		le.target_set = 1;
 1900              		.loc 1 588 0
 1901 04fe 1068     		ldr	r0, [r2]	@ unaligned
 1902              	.LVL250:
 1903 0500 FFF7FEFF 		bl	le_set_access_address
 1904              	.LVL251:
 589:bluetooth_rxtx.c **** 		debug_printf("AA set\n");
 1905              		.loc 1 589 0
 1906 0504 554B     		ldr	r3, .L235+48
 590:bluetooth_rxtx.c **** 		break;
 1907              		.loc 1 590 0
 1908 0506 5648     		ldr	r0, .L235+52
 589:bluetooth_rxtx.c **** 		debug_printf("AA set\n");
 1909              		.loc 1 589 0
 1910 0508 5C64     		str	r4, [r3, #68]
 590:bluetooth_rxtx.c **** 		break;
 1911              		.loc 1 590 0
 1912 050a FFF7FEFF 		bl	debug_printf
 1913              	.LVL252:
 1914 050e 13E6     		b	.L178
 1915              	.LVL253:
 1916              	.L142:
 594:bluetooth_rxtx.c **** 		debug_printf("Hop interval set: %d\n", le.conn_interval);
ARM GAS  /tmp/ccLwKaeN.s 			page 76


 1917              		.loc 1 594 0
 1918 0510 5378     		ldrb	r3, [r2, #1]	@ zero_extendqisi2
 1919 0512 1178     		ldrb	r1, [r2]	@ zero_extendqisi2
 1920              	.LVL254:
 595:bluetooth_rxtx.c **** 		break;
 1921              		.loc 1 595 0
 1922 0514 5348     		ldr	r0, .L235+56
 1923              	.LVL255:
 594:bluetooth_rxtx.c **** 		debug_printf("Hop interval set: %d\n", le.conn_interval);
 1924              		.loc 1 594 0
 1925 0516 41EA0321 		orr	r1, r1, r3, lsl #8
 1926 051a 504B     		ldr	r3, .L235+48
 1927 051c D983     		strh	r1, [r3, #30]	@ movhi
 1928              	.LVL256:
 595:bluetooth_rxtx.c **** 		break;
 1929              		.loc 1 595 0
 1930 051e FFF7FEFF 		bl	debug_printf
 1931              	.LVL257:
 1932 0522 09E6     		b	.L178
 1933              	.LVL258:
 1934              	.L118:
 607:bluetooth_rxtx.c **** 		data[1] = 0x37;
 1935              		.loc 1 607 0
 1936 0524 1323     		movs	r3, #19
 1937 0526 1370     		strb	r3, [r2]
 1938              	.LVL259:
 608:bluetooth_rxtx.c **** 		*data_len = 2;
 1939              		.loc 1 608 0
 1940 0528 3723     		movs	r3, #55
 1941 052a 57E6     		b	.L232
 1942              	.LVL260:
 1943              	.L119:
 613:bluetooth_rxtx.c **** 		*data_len = 1;
 1944              		.loc 1 613 0
 1945 052c 4B4B     		ldr	r3, .L235+48
 1946 052e 1B69     		ldr	r3, [r3, #16]
 1947 0530 0033     		adds	r3, r3, #0
 1948 0532 18BF     		it	ne
 1949 0534 0123     		movne	r3, #1
 1950 0536 D7E5     		b	.L206
 1951              	.L120:
 618:bluetooth_rxtx.c **** 		break;
 1952              		.loc 1 618 0
 1953 0538 0B88     		ldrh	r3, [r1]
 1954 053a 484A     		ldr	r2, .L235+48
 1955              	.LVL261:
 1956 053c 0033     		adds	r3, r3, #0
 1957 053e 18BF     		it	ne
 1958 0540 0123     		movne	r3, #1
 1959 0542 1361     		str	r3, [r2, #16]
 1960 0544 F8E5     		b	.L178
 1961              	.LVL262:
 1962              	.L121:
 622:bluetooth_rxtx.c **** 		if (p != NULL) {
 1963              		.loc 1 622 0
 1964 0546 FFF7FEFF 		bl	dequeue
 1965              	.LVL263:
ARM GAS  /tmp/ccLwKaeN.s 			page 77


 623:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 1966              		.loc 1 623 0
 1967 054a 0146     		mov	r1, r0
 1968 054c 28B1     		cbz	r0, .L167
 624:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
 1969              		.loc 1 624 0
 1970 054e 4022     		movs	r2, #64
 1971 0550 2846     		mov	r0, r5
 1972              	.LVL264:
 1973 0552 FFF7FEFF 		bl	memcpy
 1974              	.LVL265:
 625:bluetooth_rxtx.c **** 		} else {
 1975              		.loc 1 625 0
 1976 0556 4023     		movs	r3, #64
 1977 0558 2DE6     		b	.L208
 1978              	.LVL266:
 1979              	.L167:
 627:bluetooth_rxtx.c **** 			*data_len = 1;
 1980              		.loc 1 627 0
 1981 055a 2870     		strb	r0, [r5]
 1982 055c 0FE6     		b	.L204
 1983              	.LVL267:
 1984              	.L122:
 633:bluetooth_rxtx.c **** 
 1985              		.loc 1 633 0
 1986 055e 0022     		movs	r2, #0
 1987              	.LVL268:
 635:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 1988              		.loc 1 635 0
 1989 0560 334B     		ldr	r3, .L235+4
 633:bluetooth_rxtx.c **** 
 1990              		.loc 1 633 0
 1991 0562 2260     		str	r2, [r4]
 635:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 1992              		.loc 1 635 0
 1993 0564 9A72     		strb	r2, [r3, #10]
 636:bluetooth_rxtx.c **** 
 1994              		.loc 1 636 0
 1995 0566 0A22     		movs	r2, #10
 1996 0568 9A74     		strb	r2, [r3, #18]
 638:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1997              		.loc 1 638 0
 1998 056a FFF7FEFF 		bl	usb_queue_init
 1999              	.LVL269:
 2000 056e C7E6     		b	.L217
 2001              	.LVL270:
 2002              	.L125:
 643:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
 2003              		.loc 1 643 0
 2004 0570 0878     		ldrb	r0, [r1]	@ zero_extendqisi2
 2005              	.LVL271:
 2006 0572 FFF7FEFF 		bl	cc2400_get
 2007              	.LVL272:
 644:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 2008              		.loc 1 644 0
 2009 0576 030A     		lsrs	r3, r0, #8
 2010 0578 2B70     		strb	r3, [r5]
ARM GAS  /tmp/ccLwKaeN.s 			page 78


 645:bluetooth_rxtx.c **** 		*data_len = 2;
 2011              		.loc 1 645 0
 2012 057a 6870     		strb	r0, [r5, #1]
 2013 057c 2FE6     		b	.L223
 2014              	.LVL273:
 2015              	.L129:
 650:bluetooth_rxtx.c **** 		break;
 2016              		.loc 1 650 0
 2017 057e 4988     		ldrh	r1, [r1, #2]
 2018              	.LVL274:
 2019 0580 3078     		ldrb	r0, [r6]	@ zero_extendqisi2
 2020              	.LVL275:
 2021 0582 05E6     		b	.L212
 2022              	.LVL276:
 2023              	.L136:
 222:bluetooth_rxtx.c **** 
 2024              		.loc 1 222 0 discriminator 3
 2025 0584 0026     		movs	r6, #0
 2026              	.LVL277:
 2027              	.L170:
 2028 0586 F7B2     		uxtb	r7, r6
 2029              	.LVL278:
 663:bluetooth_rxtx.c **** 			data[i*3] = i;
 2030              		.loc 1 663 0 discriminator 3
 2031 0588 3846     		mov	r0, r7
 2032 058a FFF7FEFF 		bl	cc2400_get
 2033              	.LVL279:
 2034 058e 0136     		adds	r6, r6, #1
 665:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 2035              		.loc 1 665 0 discriminator 3
 2036 0590 030A     		lsrs	r3, r0, #8
 662:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2037              		.loc 1 662 0 discriminator 3
 2038 0592 2E2E     		cmp	r6, #46
 664:bluetooth_rxtx.c **** 			data[(i*3)+1] = (reg_val >> 8) & 0xff;
 2039              		.loc 1 664 0 discriminator 3
 2040 0594 2F70     		strb	r7, [r5]
 665:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 2041              		.loc 1 665 0 discriminator 3
 2042 0596 6B70     		strb	r3, [r5, #1]
 666:bluetooth_rxtx.c **** 		}
 2043              		.loc 1 666 0 discriminator 3
 2044 0598 A870     		strb	r0, [r5, #2]
 2045              	.LVL280:
 2046 059a 05F10305 		add	r5, r5, #3
 662:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2047              		.loc 1 662 0 discriminator 3
 2048 059e F2D1     		bne	.L170
 668:bluetooth_rxtx.c **** 		break;
 2049              		.loc 1 668 0
 2050 05a0 8723     		movs	r3, #135
 2051 05a2 08E6     		b	.L208
 2052              	.LVL281:
 2053              	.L138:
 672:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 2054              		.loc 1 672 0
 2055 05a4 9279     		ldrb	r2, [r2, #6]	@ zero_extendqisi2
ARM GAS  /tmp/ccLwKaeN.s 			page 79


 2056              	.LVL282:
 673:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 2057              		.loc 1 673 0
 2058 05a6 2946     		mov	r1, r5
 2059              	.LVL283:
 672:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 2060              		.loc 1 672 0
 2061 05a8 0732     		adds	r2, r2, #7
 673:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 2062              		.loc 1 673 0
 2063 05aa D2B2     		uxtb	r2, r2
 2064 05ac 2E48     		ldr	r0, .L235+60
 2065              	.LVL284:
 2066 05ae FFF7FEFF 		bl	memcpy
 2067              	.LVL285:
 675:bluetooth_rxtx.c **** 		*data_len = 0;
 2068              		.loc 1 675 0
 2069 05b2 1022     		movs	r2, #16
 2070 05b4 6FE6     		b	.L214
 2071              	.LVL286:
 2072              	.L126:
 680:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 2073              		.loc 1 680 0
 2074 05b6 1E4C     		ldr	r4, .L235+4
 2075              	.LVL287:
 2076 05b8 0622     		movs	r2, #6
 2077              	.LVL288:
 2078 05ba 2946     		mov	r1, r5
 2079              	.LVL289:
 2080 05bc 04F11C00 		add	r0, r4, #28
 2081              	.LVL290:
 2082 05c0 FFF7FEFF 		bl	memcpy
 2083              	.LVL291:
 681:bluetooth_rxtx.c **** 		break;
 2084              		.loc 1 681 0
 2085 05c4 0C23     		movs	r3, #12
 2086 05c6 A374     		strb	r3, [r4, #18]
 2087 05c8 B6E5     		b	.L178
 2088              	.LVL292:
 2089              	.L143:
 685:bluetooth_rxtx.c **** 		le.channel_idx = data[0];
 2090              		.loc 1 685 0
 2091 05ca 1178     		ldrb	r1, [r2]	@ zero_extendqisi2
 2092              	.LVL293:
 2093 05cc 2748     		ldr	r0, .L235+64
 2094              	.LVL294:
 2095 05ce FFF7FEFF 		bl	debug_printf
 2096              	.LVL295:
 686:bluetooth_rxtx.c **** 		channel = btle_channel_index_to_phys(le.channel_idx);
 2097              		.loc 1 686 0
 2098 05d2 224C     		ldr	r4, .L235+48
 2099              	.LVL296:
 2100 05d4 2878     		ldrb	r0, [r5]	@ zero_extendqisi2
 2101 05d6 6075     		strb	r0, [r4, #21]
 687:bluetooth_rxtx.c **** 		hop_mode = HOP_TX_LE;
 2102              		.loc 1 687 0
 2103 05d8 FFF7FEFF 		bl	btle_channel_index_to_phys
ARM GAS  /tmp/ccLwKaeN.s 			page 80


 2104              	.LVL297:
 688:bluetooth_rxtx.c **** 		le.interval_timer = le.conn_interval;
 2105              		.loc 1 688 0
 2106 05dc 0622     		movs	r2, #6
 2107 05de 144B     		ldr	r3, .L235+4
 687:bluetooth_rxtx.c **** 		hop_mode = HOP_TX_LE;
 2108              		.loc 1 687 0
 2109 05e0 A4F84C00 		strh	r0, [r4, #76]	@ movhi
 688:bluetooth_rxtx.c **** 		le.interval_timer = le.conn_interval;
 2110              		.loc 1 688 0
 2111 05e4 9A72     		strb	r2, [r3, #10]
 689:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_TRANSMIT_LE;
 2112              		.loc 1 689 0
 2113 05e6 E28B     		ldrh	r2, [r4, #30]
 2114 05e8 A283     		strh	r2, [r4, #28]	@ movhi
 690:bluetooth_rxtx.c **** 		break;
 2115              		.loc 1 690 0
 2116 05ea 1122     		movs	r2, #17
 2117 05ec BFE5     		b	.L210
 2118              	.LVL298:
 2119              	.L141:
 220:bluetooth_rxtx.c **** 
 2120              		.loc 1 220 0
 2121 05ee 8A88     		ldrh	r2, [r1, #4]
 2122              	.LVL299:
 695:bluetooth_rxtx.c **** 			return 0;
 2123              		.loc 1 695 0
 2124 05f0 152A     		cmp	r2, #21
 2125 05f2 00F28280 		bhi	.L187
 697:bluetooth_rxtx.c **** 		memcpy(le_adv_data, data, le_adv_len);
 2126              		.loc 1 697 0
 2127 05f6 1948     		ldr	r0, .L235+48
 2128              	.LVL300:
 698:bluetooth_rxtx.c **** 		break;
 2129              		.loc 1 698 0
 2130 05f8 2946     		mov	r1, r5
 2131              	.LVL301:
 697:bluetooth_rxtx.c **** 		memcpy(le_adv_data, data, le_adv_len);
 2132              		.loc 1 697 0
 2133 05fa 8265     		str	r2, [r0, #88]
 698:bluetooth_rxtx.c **** 		break;
 2134              		.loc 1 698 0
 2135 05fc 5C30     		adds	r0, r0, #92
 2136 05fe FFF7FEFF 		bl	memcpy
 2137              	.LVL302:
 2138 0602 99E5     		b	.L178
 2139              	.LVL303:
 2140              	.L128:
 704:bluetooth_rxtx.c **** 			return 0; // invalid mask
 2141              		.loc 1 704 0
 2142 0604 9479     		ldrb	r4, [r2, #6]	@ zero_extendqisi2
 2143              	.LVL304:
 2144 0606 302C     		cmp	r4, #48
 2145 0608 77D8     		bhi	.L187
 707:bluetooth_rxtx.c **** 			le.target_set = 0;
 2146              		.loc 1 707 0
 2147 060a 8CBB     		cbnz	r4, .L171
ARM GAS  /tmp/ccLwKaeN.s 			page 81


 708:bluetooth_rxtx.c **** 			memset(le.target, 0, 6);
 2148              		.loc 1 708 0
 2149 060c 134D     		ldr	r5, .L235+48
 709:bluetooth_rxtx.c **** 			memset(le.target_mask, 0, 6);
 2150              		.loc 1 709 0
 2151 060e 2146     		mov	r1, r4
 2152              	.LVL305:
 2153 0610 0622     		movs	r2, #6
 2154              	.LVL306:
 2155 0612 05F13800 		add	r0, r5, #56
 2156              	.LVL307:
 708:bluetooth_rxtx.c **** 			memset(le.target, 0, 6);
 2157              		.loc 1 708 0
 2158 0616 6C64     		str	r4, [r5, #68]
 709:bluetooth_rxtx.c **** 			memset(le.target_mask, 0, 6);
 2159              		.loc 1 709 0
 2160 0618 FFF7FEFF 		bl	memset
 2161              	.LVL308:
 710:bluetooth_rxtx.c **** 		} else {
 2162              		.loc 1 710 0
 2163 061c 0622     		movs	r2, #6
 2164 061e 2146     		mov	r1, r4
 2165 0620 05F13E00 		add	r0, r5, #62
 2166 0624 FFF7FEFF 		bl	memset
 2167              	.LVL309:
 2168 0628 86E5     		b	.L178
 2169              	.L236:
 2170 062a 00BF     		.align	2
 2171              	.L235:
 2172 062c 00000000 		.word	clkn_offset
 2173 0630 00000000 		.word	.LANCHOR1
 2174 0634 98C00920 		.word	537510040
 2175 0638 00000000 		.word	clk100ns_offset
 2176 063c 00000000 		.word	afh_map
 2177 0640 00000000 		.word	used_channels
 2178 0644 00000000 		.word	afh_enabled
 2179 0648 00000000 		.word	clkn
 2180 064c 00000000 		.word	clk_drift_ppm
 2181 0650 00000000 		.word	clkn_next_drift_fix
 2182 0654 00000000 		.word	clk_drift_correction
 2183 0658 00000000 		.word	clkn_last_drift_fix
 2184 065c 00000000 		.word	.LANCHOR0
 2185 0660 05000000 		.word	.LC3
 2186 0664 0D000000 		.word	.LC4
 2187 0668 00000000 		.word	tx_pkt
 2188 066c 23000000 		.word	.LC5
 2189              	.LVL310:
 2190              	.L171:
 2191 0670 234C     		ldr	r4, .L237
 2192 0672 931D     		adds	r3, r2, #6
 707:bluetooth_rxtx.c **** 			le.target_set = 0;
 2193              		.loc 1 707 0 discriminator 3
 2194 0674 2246     		mov	r2, r4
 2195              	.LVL311:
 2196              	.L172:
 2197              	.LBB25:
 715:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccLwKaeN.s 			page 82


 2198              		.loc 1 715 0 discriminator 3
 2199 0676 13F8011D 		ldrb	r1, [r3, #-1]!	@ zero_extendqisi2
 714:bluetooth_rxtx.c **** 				le.target[i] = data[5-i];
 2200              		.loc 1 714 0 discriminator 3
 2201 067a AB42     		cmp	r3, r5
 715:bluetooth_rxtx.c **** 
 2202              		.loc 1 715 0 discriminator 3
 2203 067c 02F8011F 		strb	r1, [r2, #1]!
 2204              	.LVL312:
 714:bluetooth_rxtx.c **** 				le.target[i] = data[5-i];
 2205              		.loc 1 714 0 discriminator 3
 2206 0680 F9D1     		bne	.L172
 718:bluetooth_rxtx.c **** 			for (i = 5; data[6] > 8; --i, data[6] -= 8) {
 2207              		.loc 1 718 0
 2208 0682 0021     		movs	r1, #0
 2209 0684 0622     		movs	r2, #6
 2210              	.LVL313:
 2211 0686 1F48     		ldr	r0, .L237+4
 2212              	.LVL314:
 2213 0688 FFF7FEFF 		bl	memset
 2214              	.LVL315:
 720:bluetooth_rxtx.c **** 			}
 2215              		.loc 1 720 0
 2216 068c FF26     		movs	r6, #255
 2217              	.LVL316:
 719:bluetooth_rxtx.c **** 				le.target_mask[i] = 0xff;
 2218              		.loc 1 719 0
 2219 068e 0523     		movs	r3, #5
 720:bluetooth_rxtx.c **** 			}
 2220              		.loc 1 720 0
 2221 0690 1D49     		ldr	r1, .L237+8
 2222              	.LVL317:
 2223              	.L173:
 719:bluetooth_rxtx.c **** 				le.target_mask[i] = 0xff;
 2224              		.loc 1 719 0 discriminator 1
 2225 0692 A879     		ldrb	r0, [r5, #6]	@ zero_extendqisi2
 2226 0694 0828     		cmp	r0, #8
 2227 0696 19D8     		bhi	.L174
 2228              	.LVL318:
 724:bluetooth_rxtx.c **** 				uint8_t final_byte = 0;
 2229              		.loc 1 724 0
 2230 0698 60B1     		cbz	r0, .L175
 2231 069a 0021     		movs	r1, #0
 2232 069c 0A46     		mov	r2, r1
 2233              	.LVL319:
 2234              	.L176:
 2235 069e 0131     		adds	r1, r1, #1
 2236              	.LVL320:
 2237              	.LBB26:
 726:bluetooth_rxtx.c **** 					final_byte >>= 1;
 2238              		.loc 1 726 0 discriminator 3
 2239 06a0 CDB2     		uxtb	r5, r1
 727:bluetooth_rxtx.c **** 					final_byte |= 0b10000000;
 2240              		.loc 1 727 0 discriminator 3
 2241 06a2 5208     		lsrs	r2, r2, #1
 2242              	.LVL321:
 726:bluetooth_rxtx.c **** 					final_byte >>= 1;
ARM GAS  /tmp/ccLwKaeN.s 			page 83


 2243              		.loc 1 726 0 discriminator 3
 2244 06a4 8542     		cmp	r5, r0
 728:bluetooth_rxtx.c **** 				}
 2245              		.loc 1 728 0 discriminator 3
 2246 06a6 42F08002 		orr	r2, r2, #128
 2247              	.LVL322:
 726:bluetooth_rxtx.c **** 					final_byte >>= 1;
 2248              		.loc 1 726 0 discriminator 3
 2249 06aa F8D3     		bcc	.L176
 730:bluetooth_rxtx.c **** 			}
 2250              		.loc 1 730 0
 2251 06ac 1649     		ldr	r1, .L237+8
 2252 06ae 0B44     		add	r3, r3, r1
 2253              	.LVL323:
 2254 06b0 83F83E20 		strb	r2, [r3, #62]
 2255              	.LVL324:
 2256              	.L175:
 2257 06b4 1549     		ldr	r1, .L237+12
 2258              	.L177:
 2259              	.LVL325:
 2260              	.LBE26:
 735:bluetooth_rxtx.c **** 
 2261              		.loc 1 735 0 discriminator 3
 2262 06b6 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 2263 06b8 E279     		ldrb	r2, [r4, #7]	@ zero_extendqisi2
 2264 06ba 1340     		ands	r3, r3, r2
 2265 06bc 04F8013F 		strb	r3, [r4, #1]!
 2266              	.LVL326:
 734:bluetooth_rxtx.c **** 				le.target[i] &= le.target_mask[i];
 2267              		.loc 1 734 0 discriminator 3
 2268 06c0 A142     		cmp	r1, r4
 2269 06c2 F8D1     		bne	.L177
 737:bluetooth_rxtx.c **** 		}
 2270              		.loc 1 737 0
 2271 06c4 0120     		movs	r0, #1
 2272 06c6 104B     		ldr	r3, .L237+8
 2273 06c8 5864     		str	r0, [r3, #68]
 2274 06ca F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 2275              	.LVL327:
 2276              	.L174:
 720:bluetooth_rxtx.c **** 			}
 2277              		.loc 1 720 0 discriminator 3
 2278 06cc CA18     		adds	r2, r1, r3
 2279 06ce 82F83E60 		strb	r6, [r2, #62]
 719:bluetooth_rxtx.c **** 				le.target_mask[i] = 0xff;
 2280              		.loc 1 719 0 discriminator 3
 2281 06d2 AA79     		ldrb	r2, [r5, #6]	@ zero_extendqisi2
 2282 06d4 013B     		subs	r3, r3, #1
 2283              	.LVL328:
 2284 06d6 083A     		subs	r2, r2, #8
 2285 06d8 DBB2     		uxtb	r3, r3
 2286              	.LVL329:
 2287 06da AA71     		strb	r2, [r5, #6]
 2288 06dc D9E7     		b	.L173
 2289              	.LVL330:
 2290              	.L140:
 2291              	.LBE25:
ARM GAS  /tmp/ccLwKaeN.s 			page 84


 743:bluetooth_rxtx.c **** 		break;
 2292              		.loc 1 743 0
 2293 06de 0120     		movs	r0, #1
 2294              	.LVL331:
 2295 06e0 0B4B     		ldr	r3, .L237+16
 2296 06e2 5862     		str	r0, [r3, #36]
 744:bluetooth_rxtx.c **** 
 2297              		.loc 1 744 0
 2298 06e4 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 2299              	.LVL332:
 2300              	.L130:
 748:bluetooth_rxtx.c **** 		break;
 2301              		.loc 1 748 0
 2302 06e6 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 2303              	.LVL333:
 2304 06e8 094B     		ldr	r3, .L237+16
 2305 06ea DA74     		strb	r2, [r3, #19]
 2306 06ec 24E5     		b	.L178
 2307              	.LVL334:
 2308              	.L131:
 757:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
 2309              		.loc 1 757 0
 2310 06ee 0D22     		movs	r2, #13
 2311              	.LVL335:
 2312 06f0 074B     		ldr	r3, .L237+16
 2313 06f2 9A74     		strb	r2, [r3, #18]
 758:bluetooth_rxtx.c **** 		break;
 2314              		.loc 1 758 0
 2315 06f4 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 2316 06f6 1A75     		strb	r2, [r3, #20]
 2317 06f8 1EE5     		b	.L178
 2318              	.LVL336:
 2319              	.L187:
 339:bluetooth_rxtx.c **** 		}
 2320              		.loc 1 339 0
 2321 06fa 0020     		movs	r0, #0
 765:bluetooth_rxtx.c **** 
 2322              		.loc 1 765 0
 2323 06fc F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 2324              	.LVL337:
 2325              	.L238:
 2326 06fe 00BF     		.align	2
 2327              	.L237:
 2328 0700 37000000 		.word	.LANCHOR0+55
 2329 0704 3E000000 		.word	.LANCHOR0+62
 2330 0708 00000000 		.word	.LANCHOR0
 2331 070c 3C000000 		.word	.LANCHOR0+60
 2332 0710 00000000 		.word	.LANCHOR1
 2333              		.cfi_endproc
 2334              	.LFE2:
 2336              		.section	.text.enqueue_with_ts,"ax",%progbits
 2337              		.align	1
 2338              		.global	enqueue_with_ts
 2339              		.syntax unified
 2340              		.thumb
 2341              		.thumb_func
 2342              		.fpu softvfp
ARM GAS  /tmp/ccLwKaeN.s 			page 85


 2344              	enqueue_with_ts:
 2345              	.LFB1:
 187:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 2346              		.loc 1 187 0
 2347              		.cfi_startproc
 2348              		@ args = 0, pretend = 0, frame = 0
 2349              		@ frame_needed = 0, uses_anonymous_args = 0
 2350              	.LVL338:
 2351 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 2352              		.cfi_def_cfa_offset 24
 2353              		.cfi_offset 4, -24
 2354              		.cfi_offset 5, -20
 2355              		.cfi_offset 6, -16
 2356              		.cfi_offset 7, -12
 2357              		.cfi_offset 8, -8
 2358              		.cfi_offset 14, -4
 187:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 2359              		.loc 1 187 0
 2360 0004 0646     		mov	r6, r0
 2361 0006 0F46     		mov	r7, r1
 2362 0008 9046     		mov	r8, r2
 188:bluetooth_rxtx.c **** 
 2363              		.loc 1 188 0
 2364 000a FFF7FEFF 		bl	usb_enqueue
 2365              	.LVL339:
 2366 000e 104D     		ldr	r5, .L242
 191:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 2367              		.loc 1 191 0
 2368 0010 0446     		mov	r4, r0
 2369 0012 28B9     		cbnz	r0, .L240
 192:bluetooth_rxtx.c **** 		return 0;
 2370              		.loc 1 192 0
 2371 0014 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 2372 0016 43F00403 		orr	r3, r3, #4
 2373 001a 6B70     		strb	r3, [r5, #1]
 193:bluetooth_rxtx.c **** 	}
 2374              		.loc 1 193 0
 2375 001c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2376              	.LVL340:
 2377              	.L240:
 196:bluetooth_rxtx.c **** 
 2378              		.loc 1 196 0
 2379 0020 0670     		strb	r6, [r0]
 198:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 2380              		.loc 1 198 0
 2381 0022 0026     		movs	r6, #0
 201:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2382              		.loc 1 201 0
 2383 0024 0B4B     		ldr	r3, .L242+4
 198:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 2384              		.loc 1 198 0
 2385 0026 C670     		strb	r6, [r0, #3]
 201:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2386              		.loc 1 201 0
 2387 0028 B3F84C30 		ldrh	r3, [r3, #76]
 199:bluetooth_rxtx.c **** 
 2388              		.loc 1 199 0
ARM GAS  /tmp/ccLwKaeN.s 			page 86


 2389 002c C0F80480 		str	r8, [r0, #4]
 201:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2390              		.loc 1 201 0
 2391 0030 623B     		subs	r3, r3, #98
 2392 0032 8370     		strb	r3, [r0, #2]
 202:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 2393              		.loc 1 202 0
 2394 0034 8672     		strb	r6, [r0, #10]
 203:bluetooth_rxtx.c **** 
 2395              		.loc 1 203 0
 2396 0036 C672     		strb	r6, [r0, #11]
 205:bluetooth_rxtx.c **** 
 2397              		.loc 1 205 0
 2398 0038 3222     		movs	r2, #50
 2399 003a 3946     		mov	r1, r7
 2400 003c 0E30     		adds	r0, r0, #14
 2401              	.LVL341:
 2402 003e FFF7FEFF 		bl	memcpy
 2403              	.LVL342:
 207:bluetooth_rxtx.c **** 	status = 0;
 2404              		.loc 1 207 0
 2405 0042 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 208:bluetooth_rxtx.c **** 
 2406              		.loc 1 208 0
 2407 0044 6E70     		strb	r6, [r5, #1]
 207:bluetooth_rxtx.c **** 	status = 0;
 2408              		.loc 1 207 0
 2409 0046 6370     		strb	r3, [r4, #1]
 210:bluetooth_rxtx.c **** }
 2410              		.loc 1 210 0
 2411 0048 0120     		movs	r0, #1
 211:bluetooth_rxtx.c **** 
 2412              		.loc 1 211 0
 2413 004a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2414              	.LVL343:
 2415              	.L243:
 2416 004e 00BF     		.align	2
 2417              	.L242:
 2418 0050 00000000 		.word	.LANCHOR1
 2419 0054 00000000 		.word	.LANCHOR0
 2420              		.cfi_endproc
 2421              	.LFE1:
 2423              		.section	.text.TIMER0_IRQHandler,"ax",%progbits
 2424              		.align	1
 2425              		.global	TIMER0_IRQHandler
 2426              		.syntax unified
 2427              		.thumb
 2428              		.thumb_func
 2429              		.fpu softvfp
 2431              	TIMER0_IRQHandler:
 2432              	.LFB3:
 769:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 2433              		.loc 1 769 0
 2434              		.cfi_startproc
 2435              		@ args = 0, pretend = 0, frame = 0
 2436              		@ frame_needed = 0, uses_anonymous_args = 0
 2437 0000 10B5     		push	{r4, lr}
ARM GAS  /tmp/ccLwKaeN.s 			page 87


 2438              		.cfi_def_cfa_offset 8
 2439              		.cfi_offset 4, -8
 2440              		.cfi_offset 14, -4
 770:bluetooth_rxtx.c **** 
 2441              		.loc 1 770 0
 2442 0002 4FF04023 		mov	r3, #1073758208
 2443 0006 1B68     		ldr	r3, [r3]
 2444 0008 D807     		lsls	r0, r3, #31
 2445 000a 46D5     		bpl	.L244
 2446              	.LBB27:
 772:bluetooth_rxtx.c **** 		clkn_offset = 0;
 2447              		.loc 1 772 0
 2448 000c 4849     		ldr	r1, .L269
 2449 000e 494A     		ldr	r2, .L269+4
 2450 0010 0B68     		ldr	r3, [r1]
 2451 0012 1068     		ldr	r0, [r2]
 2452 0014 0344     		add	r3, r3, r0
 2453 0016 0133     		adds	r3, r3, #1
 2454 0018 1360     		str	r3, [r2]
 773:bluetooth_rxtx.c **** 
 2455              		.loc 1 773 0
 2456 001a 0023     		movs	r3, #0
 2457 001c 0B60     		str	r3, [r1]
 780:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2458              		.loc 1 780 0
 2459 001e 4649     		ldr	r1, .L269+8
 775:bluetooth_rxtx.c **** 
 2460              		.loc 1 775 0
 2461 0020 1068     		ldr	r0, [r2]
 2462              	.LVL344:
 780:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2463              		.loc 1 780 0
 2464 0022 8C7A     		ldrb	r4, [r1, #10]	@ zero_extendqisi2
 2465 0024 0B46     		mov	r3, r1
 2466 0026 14B1     		cbz	r4, .L246
 780:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2467              		.loc 1 780 0 is_stmt 0 discriminator 1
 2468 0028 8C7A     		ldrb	r4, [r1, #10]	@ zero_extendqisi2
 2469 002a 012C     		cmp	r4, #1
 2470 002c 36D1     		bne	.L247
 2471              	.L246:
 781:bluetooth_rxtx.c **** 				do_hop = 1;
 2472              		.loc 1 781 0 is_stmt 1
 2473 002e 1168     		ldr	r1, [r2]
 2474 0030 4906     		lsls	r1, r1, #25
 2475 0032 01D1     		bne	.L248
 782:bluetooth_rxtx.c **** 		}
 2476              		.loc 1 782 0
 2477 0034 0121     		movs	r1, #1
 2478 0036 D972     		strb	r1, [r3, #11]
 2479              	.LVL345:
 2480              	.L248:
 824:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 2481              		.loc 1 824 0
 2482 0038 4049     		ldr	r1, .L269+12
 2483 003a 414B     		ldr	r3, .L269+16
 2484 003c 0868     		ldr	r0, [r1]
ARM GAS  /tmp/ccLwKaeN.s 			page 88


 2485 003e B8B1     		cbz	r0, .L254
 824:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 2486              		.loc 1 824 0 is_stmt 0 discriminator 1
 2487 0040 1888     		ldrh	r0, [r3]
 2488 0042 80B2     		uxth	r0, r0
 2489 0044 A0B9     		cbnz	r0, .L254
 825:bluetooth_rxtx.c **** 
 2490              		.loc 1 825 0 is_stmt 1
 2491 0046 1468     		ldr	r4, [r2]
 2492 0048 0868     		ldr	r0, [r1]
 2493 004a 8442     		cmp	r4, r0
 2494 004c 10D3     		bcc	.L254
 828:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
 2495              		.loc 1 828 0
 2496 004e 3D48     		ldr	r0, .L269+20
 836:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 2497              		.loc 1 836 0
 2498 0050 3D4C     		ldr	r4, .L269+24
 828:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
 2499              		.loc 1 828 0
 2500 0052 0088     		ldrh	r0, [r0]
 2501 0054 0004     		lsls	r0, r0, #16
 829:bluetooth_rxtx.c **** 				}
 2502              		.loc 1 829 0
 2503 0056 54BF     		ite	pl
 2504 0058 0120     		movpl	r0, #1
 834:bluetooth_rxtx.c **** 				}
 2505              		.loc 1 834 0
 2506 005a 41F66900 		movwmi	r0, #6249
 2507 005e 1880     		strh	r0, [r3]	@ movhi
 836:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 2508              		.loc 1 836 0
 2509 0060 1068     		ldr	r0, [r2]
 2510 0062 2060     		str	r0, [r4]
 837:bluetooth_rxtx.c **** 			}
 2511              		.loc 1 837 0
 2512 0064 3948     		ldr	r0, .L269+28
 2513 0066 0088     		ldrh	r0, [r0]
 2514 0068 2468     		ldr	r4, [r4]
 2515 006a 80B2     		uxth	r0, r0
 2516 006c 2044     		add	r0, r0, r4
 2517 006e 0860     		str	r0, [r1]
 2518              	.L254:
 842:bluetooth_rxtx.c **** 			clkn += 2;
 2519              		.loc 1 842 0
 2520 0070 40F63440 		movw	r0, #3124
 2521 0074 1988     		ldrh	r1, [r3]
 2522 0076 89B2     		uxth	r1, r1
 2523 0078 8142     		cmp	r1, r0
 843:bluetooth_rxtx.c **** 
 2524              		.loc 1 843 0
 2525 007a 82BF     		ittt	hi
 2526 007c 1168     		ldrhi	r1, [r2]
 2527 007e 0231     		addhi	r1, r1, #2
 2528 0080 1160     		strhi	r1, [r2]
 845:bluetooth_rxtx.c **** 		clk100ns_offset = 0;
 2529              		.loc 1 845 0
ARM GAS  /tmp/ccLwKaeN.s 			page 89


 2530 0082 1A88     		ldrh	r2, [r3]
 2531 0084 3249     		ldr	r1, .L269+32
 2532 0086 92B2     		uxth	r2, r2
 2533 0088 02F63442 		addw	r2, r2, #3124
 2534 008c 0A60     		str	r2, [r1]
 846:bluetooth_rxtx.c **** 
 2535              		.loc 1 846 0
 2536 008e 0022     		movs	r2, #0
 2537 0090 1A80     		strh	r2, [r3]	@ movhi
 849:bluetooth_rxtx.c **** 	}
 2538              		.loc 1 849 0
 2539 0092 0122     		movs	r2, #1
 2540 0094 4FF04023 		mov	r3, #1073758208
 2541 0098 1A60     		str	r2, [r3]
 2542              	.L244:
 2543 009a 10BD     		pop	{r4, pc}
 2544              	.LVL346:
 2545              	.L247:
 785:bluetooth_rxtx.c **** 			if ((clkn & 0x1) == 0)
 2546              		.loc 1 785 0
 2547 009c 8B7A     		ldrb	r3, [r1, #10]	@ zero_extendqisi2
 2548 009e 022B     		cmp	r3, #2
 2549 00a0 05D1     		bne	.L249
 786:bluetooth_rxtx.c **** 				do_hop = 1;
 2550              		.loc 1 786 0
 2551 00a2 1368     		ldr	r3, [r2]
 2552 00a4 DC07     		lsls	r4, r3, #31
 2553 00a6 C7D4     		bmi	.L248
 2554              	.LVL347:
 2555              	.L267:
 819:bluetooth_rxtx.c **** 			}
 2556              		.loc 1 819 0
 2557 00a8 0123     		movs	r3, #1
 2558 00aa CB72     		strb	r3, [r1, #11]
 2559 00ac C4E7     		b	.L248
 2560              	.LVL348:
 2561              	.L249:
 775:bluetooth_rxtx.c **** 
 2562              		.loc 1 775 0
 2563 00ae 294B     		ldr	r3, .L269+36
 2564 00b0 9C69     		ldr	r4, [r3, #24]
 2565 00b2 001B     		subs	r0, r0, r4
 2566              	.LVL349:
 790:bluetooth_rxtx.c **** 			// Only hop if connected
 2567              		.loc 1 790 0
 2568 00b4 8C7A     		ldrb	r4, [r1, #10]	@ zero_extendqisi2
 775:bluetooth_rxtx.c **** 
 2569              		.loc 1 775 0
 2570 00b6 00F00300 		and	r0, r0, #3
 790:bluetooth_rxtx.c **** 			// Only hop if connected
 2571              		.loc 1 790 0
 2572 00ba 032C     		cmp	r4, #3
 2573 00bc 14D1     		bne	.L250
 792:bluetooth_rxtx.c **** 				--le.interval_timer;
 2574              		.loc 1 792 0
 2575 00be 1C7D     		ldrb	r4, [r3, #20]	@ zero_extendqisi2
 2576 00c0 032C     		cmp	r4, #3
ARM GAS  /tmp/ccLwKaeN.s 			page 90


 2577 00c2 B9D1     		bne	.L248
 792:bluetooth_rxtx.c **** 				--le.interval_timer;
 2578              		.loc 1 792 0 is_stmt 0 discriminator 1
 2579 00c4 0028     		cmp	r0, #0
 2580 00c6 B7D1     		bne	.L248
 793:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 2581              		.loc 1 793 0 is_stmt 1
 2582 00c8 988B     		ldrh	r0, [r3, #28]
 2583 00ca 0138     		subs	r0, r0, #1
 2584 00cc 80B2     		uxth	r0, r0
 2585 00ce 9883     		strh	r0, [r3, #28]	@ movhi
 794:bluetooth_rxtx.c **** 					do_hop = 1;
 2586              		.loc 1 794 0
 2587 00d0 988B     		ldrh	r0, [r3, #28]
 2588 00d2 80B2     		uxth	r0, r0
 2589 00d4 D0B9     		cbnz	r0, .L253
 795:bluetooth_rxtx.c **** 					++le.conn_count;
 2590              		.loc 1 795 0
 2591 00d6 0120     		movs	r0, #1
 2592 00d8 C872     		strb	r0, [r1, #11]
 796:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 2593              		.loc 1 796 0
 2594 00da 198C     		ldrh	r1, [r3, #32]
 2595 00dc 0144     		add	r1, r1, r0
 2596 00de 89B2     		uxth	r1, r1
 2597 00e0 1984     		strh	r1, [r3, #32]	@ movhi
 797:bluetooth_rxtx.c **** 				} else {
 2598              		.loc 1 797 0
 2599 00e2 D98B     		ldrh	r1, [r3, #30]
 2600 00e4 9983     		strh	r1, [r3, #28]	@ movhi
 2601 00e6 A7E7     		b	.L248
 2602              	.L250:
 804:bluetooth_rxtx.c **** 			// Only hop if connected
 2603              		.loc 1 804 0
 2604 00e8 8C7A     		ldrb	r4, [r1, #10]	@ zero_extendqisi2
 2605 00ea 062C     		cmp	r4, #6
 2606 00ec 13D1     		bne	.L252
 806:bluetooth_rxtx.c **** 				--le.interval_timer;
 2607              		.loc 1 806 0
 2608 00ee 0028     		cmp	r0, #0
 2609 00f0 A2D1     		bne	.L248
 807:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 2610              		.loc 1 807 0
 2611 00f2 988B     		ldrh	r0, [r3, #28]
 2612 00f4 0138     		subs	r0, r0, #1
 2613 00f6 80B2     		uxth	r0, r0
 2614 00f8 9883     		strh	r0, [r3, #28]	@ movhi
 808:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 2615              		.loc 1 808 0
 2616 00fa 988B     		ldrh	r0, [r3, #28]
 2617 00fc 80B2     		uxth	r0, r0
 2618 00fe 28B9     		cbnz	r0, .L253
 809:bluetooth_rxtx.c **** 					do_transmit = 1;
 2619              		.loc 1 809 0
 2620 0100 D88B     		ldrh	r0, [r3, #30]
 2621 0102 9883     		strh	r0, [r3, #28]	@ movhi
 810:bluetooth_rxtx.c **** 				} else {
ARM GAS  /tmp/ccLwKaeN.s 			page 91


 2622              		.loc 1 810 0
 2623 0104 0123     		movs	r3, #1
 2624 0106 81F82830 		strb	r3, [r1, #40]
 2625 010a 95E7     		b	.L248
 2626              	.L253:
 812:bluetooth_rxtx.c **** 				}
 2627              		.loc 1 812 0
 2628 010c 4FF48071 		mov	r1, #256
 2629 0110 114B     		ldr	r3, .L269+40
 2630 0112 1960     		str	r1, [r3]
 2631 0114 90E7     		b	.L248
 2632              	.L252:
 817:bluetooth_rxtx.c **** 			if( (last_hop + hop_timeout) == clkn ) {
 2633              		.loc 1 817 0
 2634 0116 887A     		ldrb	r0, [r1, #10]	@ zero_extendqisi2
 2635 0118 0528     		cmp	r0, #5
 2636 011a 8DD1     		bne	.L248
 818:bluetooth_rxtx.c **** 				do_hop = 1;
 2637              		.loc 1 818 0
 2638 011c 0F48     		ldr	r0, .L269+44
 2639 011e B3F84E30 		ldrh	r3, [r3, #78]
 2640 0122 0468     		ldr	r4, [r0]
 2641 0124 9BB2     		uxth	r3, r3
 2642 0126 1068     		ldr	r0, [r2]
 2643 0128 2344     		add	r3, r3, r4
 2644 012a 8342     		cmp	r3, r0
 2645 012c 84D1     		bne	.L248
 2646 012e BBE7     		b	.L267
 2647              	.L270:
 2648              		.align	2
 2649              	.L269:
 2650 0130 00000000 		.word	clkn_offset
 2651 0134 00000000 		.word	clkn
 2652 0138 00000000 		.word	.LANCHOR1
 2653 013c 00000000 		.word	clkn_next_drift_fix
 2654 0140 00000000 		.word	clk100ns_offset
 2655 0144 00000000 		.word	clk_drift_ppm
 2656 0148 00000000 		.word	clkn_last_drift_fix
 2657 014c 00000000 		.word	clk_drift_correction
 2658 0150 18400040 		.word	1073758232
 2659 0154 00000000 		.word	.LANCHOR0
 2660 0158 3CC00920 		.word	537509948
 2661 015c 00000000 		.word	last_hop
 2662              	.LBE27:
 2663              		.cfi_endproc
 2664              	.LFE3:
 2666              		.section	.text.EINT3_IRQHandler,"ax",%progbits
 2667              		.align	1
 2668              		.global	EINT3_IRQHandler
 2669              		.syntax unified
 2670              		.thumb
 2671              		.thumb_func
 2672              		.fpu softvfp
 2674              	EINT3_IRQHandler:
 2675              	.LFB4:
 856:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 2676              		.loc 1 856 0
ARM GAS  /tmp/ccLwKaeN.s 			page 92


 2677              		.cfi_startproc
 2678              		@ args = 0, pretend = 0, frame = 0
 2679              		@ frame_needed = 0, uses_anonymous_args = 0
 2680              		@ link register save eliminated.
 858:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;           // enable SPI
 2681              		.loc 1 858 0
 2682 0000 0422     		movs	r2, #4
 2683 0002 084B     		ldr	r3, .L273
 2684 0004 1A60     		str	r2, [r3]
 859:bluetooth_rxtx.c **** 	cs_trigger  = 1;        // signal trigger
 2685              		.loc 1 859 0
 2686 0006 4FF08052 		mov	r2, #268435456
 2687 000a 074B     		ldr	r3, .L273+4
 2688 000c 1A60     		str	r2, [r3]
 860:bluetooth_rxtx.c **** 	if (hop_mode == HOP_BLUETOOTH)
 2689              		.loc 1 860 0
 2690 000e 0122     		movs	r2, #1
 2691 0010 064B     		ldr	r3, .L273+8
 2692 0012 1A70     		strb	r2, [r3]
 861:bluetooth_rxtx.c **** 		dma_discard = 0;
 2693              		.loc 1 861 0
 2694 0014 064B     		ldr	r3, .L273+12
 2695 0016 9A7A     		ldrb	r2, [r3, #10]	@ zero_extendqisi2
 2696 0018 022A     		cmp	r2, #2
 862:bluetooth_rxtx.c **** 
 2697              		.loc 1 862 0
 2698 001a 04BF     		itt	eq
 2699 001c 0022     		moveq	r2, #0
 2700 001e 1A74     		strbeq	r2, [r3, #16]
 2701 0020 7047     		bx	lr
 2702              	.L274:
 2703 0022 00BF     		.align	2
 2704              	.L273:
 2705 0024 AC800240 		.word	1073905836
 2706 0028 9CC00920 		.word	537510044
 2707 002c 00000000 		.word	cs_trigger
 2708 0030 00000000 		.word	.LANCHOR1
 2709              		.cfi_endproc
 2710              	.LFE4:
 2712              		.section	.text.legacy_DMA_IRQHandler,"ax",%progbits
 2713              		.align	1
 2714              		.global	legacy_DMA_IRQHandler
 2715              		.syntax unified
 2716              		.thumb
 2717              		.thumb_func
 2718              		.fpu softvfp
 2720              	legacy_DMA_IRQHandler:
 2721              	.LFB7:
 911:bluetooth_rxtx.c **** 
 2722              		.loc 1 911 0
 2723              		.cfi_startproc
 2724              		@ args = 0, pretend = 0, frame = 0
 2725              		@ frame_needed = 0, uses_anonymous_args = 0
 2726 0000 10B5     		push	{r4, lr}
 2727              		.cfi_def_cfa_offset 8
 2728              		.cfi_offset 4, -8
 2729              		.cfi_offset 14, -4
ARM GAS  /tmp/ccLwKaeN.s 			page 93


 913:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW
 2730              		.loc 1 913 0
 2731 0002 294B     		ldr	r3, .L311
 2732 0004 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2733 0006 012A     		cmp	r2, #1
 2734 0008 11D0     		beq	.L276
 914:bluetooth_rxtx.c **** 	   || mode == MODE_SPECAN
 2735              		.loc 1 914 0
 2736 000a 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2737 000c 082A     		cmp	r2, #8
 2738 000e 0ED0     		beq	.L276
 915:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW_LE
 2739              		.loc 1 915 0
 2740 0010 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2741 0012 042A     		cmp	r2, #4
 2742 0014 0BD0     		beq	.L276
 916:bluetooth_rxtx.c **** 	   || mode == MODE_BT_PROMISC_LE
 2743              		.loc 1 916 0
 2744 0016 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2745 0018 092A     		cmp	r2, #9
 2746 001a 08D0     		beq	.L276
 917:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE
 2747              		.loc 1 917 0
 2748 001c 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2749 001e 0A2A     		cmp	r2, #10
 2750 0020 05D0     		beq	.L276
 918:bluetooth_rxtx.c **** 	   || mode == MODE_RX_GENERIC)
 2751              		.loc 1 918 0
 2752 0022 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2753 0024 0C2A     		cmp	r2, #12
 2754 0026 02D0     		beq	.L276
 919:bluetooth_rxtx.c **** 	{
 2755              		.loc 1 919 0
 2756 0028 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2757 002a 0F2A     		cmp	r2, #15
 2758 002c 3AD1     		bne	.L275
 2759              	.L276:
 922:bluetooth_rxtx.c **** 			if (DMACIntTCStat & (1 << 0)) {
 2760              		.loc 1 922 0
 2761 002e 1F4A     		ldr	r2, .L311+4
 2762 0030 1268     		ldr	r2, [r2]
 2763 0032 D107     		lsls	r1, r2, #31
 2764 0034 36D5     		bpl	.L275
 2765              	.LBB31:
 923:bluetooth_rxtx.c **** 				DMACIntTCClear = (1 << 0);
 2766              		.loc 1 923 0
 2767 0036 1E4A     		ldr	r2, .L311+8
 2768 0038 1268     		ldr	r2, [r2]
 2769 003a D207     		lsls	r2, r2, #31
 2770 003c 27D5     		bpl	.L279
 2771              	.LBB32:
 924:bluetooth_rxtx.c **** 
 2772              		.loc 1 924 0
 2773 003e 0121     		movs	r1, #1
 2774 0040 1C4A     		ldr	r2, .L311+12
 929:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 2775              		.loc 1 929 0
ARM GAS  /tmp/ccLwKaeN.s 			page 94


 2776 0042 40F63544 		movw	r4, #3125
 924:bluetooth_rxtx.c **** 
 2777              		.loc 1 924 0
 2778 0046 1160     		str	r1, [r2]
 926:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 2779              		.loc 1 926 0
 2780 0048 9A7A     		ldrb	r2, [r3, #10]	@ zero_extendqisi2
 929:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 2781              		.loc 1 929 0
 2782 004a 1B48     		ldr	r0, .L311+16
 926:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 2783              		.loc 1 926 0
 2784 004c 022A     		cmp	r2, #2
 927:bluetooth_rxtx.c **** 
 2785              		.loc 1 927 0
 2786 004e 02BF     		ittt	eq
 2787 0050 4FF08051 		moveq	r1, #268435456
 2788 0054 194A     		ldreq	r2, .L311+20
 2789 0056 1160     		streq	r1, [r2]
 929:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 2790              		.loc 1 929 0
 2791 0058 1949     		ldr	r1, .L311+24
 2792 005a 0A68     		ldr	r2, [r1]
 2793 005c 0068     		ldr	r0, [r0]
 2794 005e C2F31302 		ubfx	r2, r2, #0, #20
 2795 0062 04FB0202 		mla	r2, r4, r2, r0
 2796 0066 5A60     		str	r2, [r3, #4]
 930:bluetooth_rxtx.c **** 				idle_buf_channel   = channel;
 2797              		.loc 1 930 0
 2798 0068 0A68     		ldr	r2, [r1]
 2799 006a C2F30752 		ubfx	r2, r2, #20, #8
 2800 006e 9A70     		strb	r2, [r3, #2]
 931:bluetooth_rxtx.c **** 
 2801              		.loc 1 931 0
 2802 0070 144A     		ldr	r2, .L311+28
 2803 0072 B2F84C20 		ldrh	r2, [r2, #76]
 2804 0076 92B2     		uxth	r2, r2
 2805 0078 1A81     		strh	r2, [r3, #8]	@ movhi
 934:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 2806              		.loc 1 934 0
 2807 007a 134A     		ldr	r2, .L311+32
 935:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 2808              		.loc 1 935 0
 2809 007c 134B     		ldr	r3, .L311+36
 934:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 2810              		.loc 1 934 0
 2811 007e 1168     		ldr	r1, [r2]
 2812              	.LVL350:
 935:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 2813              		.loc 1 935 0
 2814 0080 1868     		ldr	r0, [r3]
 2815 0082 1060     		str	r0, [r2]
 938:bluetooth_rxtx.c **** 			}
 2816              		.loc 1 938 0
 2817 0084 124A     		ldr	r2, .L311+40
 936:bluetooth_rxtx.c **** 
 2818              		.loc 1 936 0
ARM GAS  /tmp/ccLwKaeN.s 			page 95


 2819 0086 1960     		str	r1, [r3]
 938:bluetooth_rxtx.c **** 			}
 2820              		.loc 1 938 0
 2821 0088 1368     		ldr	r3, [r2]
 2822 008a 0133     		adds	r3, r3, #1
 2823 008c 1360     		str	r3, [r2]
 2824              	.LVL351:
 2825              	.L279:
 2826              	.LBE32:
 940:bluetooth_rxtx.c **** 				DMACIntErrClr = (1 << 0);
 2827              		.loc 1 940 0
 2828 008e 114B     		ldr	r3, .L311+44
 2829 0090 1B68     		ldr	r3, [r3]
 2830 0092 DB07     		lsls	r3, r3, #31
 2831 0094 06D5     		bpl	.L275
 941:bluetooth_rxtx.c **** 				++rx_err;
 2832              		.loc 1 941 0
 2833 0096 0122     		movs	r2, #1
 2834 0098 0F4B     		ldr	r3, .L311+48
 2835 009a 1A60     		str	r2, [r3]
 942:bluetooth_rxtx.c **** 			}
 2836              		.loc 1 942 0
 2837 009c 0F4A     		ldr	r2, .L311+52
 2838 009e 1368     		ldr	r3, [r2]
 2839 00a0 0133     		adds	r3, r3, #1
 2840 00a2 1360     		str	r3, [r2]
 2841              	.L275:
 2842 00a4 10BD     		pop	{r4, pc}
 2843              	.L312:
 2844 00a6 00BF     		.align	2
 2845              	.L311:
 2846 00a8 00000000 		.word	.LANCHOR1
 2847 00ac 00400050 		.word	1342193664
 2848 00b0 04400050 		.word	1342193668
 2849 00b4 08400050 		.word	1342193672
 2850 00b8 08400040 		.word	1073758216
 2851 00bc 98C00920 		.word	537510040
 2852 00c0 00000000 		.word	clkn
 2853 00c4 00000000 		.word	.LANCHOR0
 2854 00c8 00000000 		.word	active_rxbuf
 2855 00cc 00000000 		.word	idle_rxbuf
 2856 00d0 00000000 		.word	rx_tc
 2857 00d4 0C400050 		.word	1342193676
 2858 00d8 10400050 		.word	1342193680
 2859 00dc 00000000 		.word	rx_err
 2860              	.LBE31:
 2861              		.cfi_endproc
 2862              	.LFE7:
 2864              		.section	.text.DMA_IRQHandler,"ax",%progbits
 2865              		.align	1
 2866              		.global	DMA_IRQHandler
 2867              		.syntax unified
 2868              		.thumb
 2869              		.thumb_func
 2870              		.fpu softvfp
 2872              	DMA_IRQHandler:
 2873              	.LFB6:
ARM GAS  /tmp/ccLwKaeN.s 			page 96


 887:bluetooth_rxtx.c **** 	if (mode == MODE_BT_FOLLOW_LE)
 2874              		.loc 1 887 0
 2875              		.cfi_startproc
 2876              		@ args = 0, pretend = 0, frame = 0
 2877              		@ frame_needed = 0, uses_anonymous_args = 0
 2878 0000 08B5     		push	{r3, lr}
 2879              		.cfi_def_cfa_offset 8
 2880              		.cfi_offset 3, -8
 2881              		.cfi_offset 14, -4
 888:bluetooth_rxtx.c **** 		le_DMA_IRQHandler();
 2882              		.loc 1 888 0
 2883 0002 114B     		ldr	r3, .L328
 2884 0004 5B7C     		ldrb	r3, [r3, #17]	@ zero_extendqisi2
 2885 0006 092B     		cmp	r3, #9
 2886 0008 1AD1     		bne	.L314
 889:bluetooth_rxtx.c **** 	else
 2887              		.loc 1 889 0
 2888 000a FFF7FEFF 		bl	le_DMA_IRQHandler
 2889              	.LVL352:
 2890              	.L315:
 894:bluetooth_rxtx.c **** 		// TC -- DMA completed, unset flag so another printf can occur
 2891              		.loc 1 894 0
 2892 000e 0F4B     		ldr	r3, .L328+4
 2893 0010 1B68     		ldr	r3, [r3]
 2894 0012 1906     		lsls	r1, r3, #24
 2895 0014 17D5     		bpl	.L313
 896:bluetooth_rxtx.c **** 			DMACIntTCClear = (1 << 7);
 2896              		.loc 1 896 0
 2897 0016 0E4B     		ldr	r3, .L328+8
 2898 0018 1B68     		ldr	r3, [r3]
 2899 001a 1A06     		lsls	r2, r3, #24
 2900 001c 05D5     		bpl	.L317
 897:bluetooth_rxtx.c **** 			debug_dma_active = 0;
 2901              		.loc 1 897 0
 2902 001e 8022     		movs	r2, #128
 2903 0020 0C4B     		ldr	r3, .L328+12
 2904 0022 1A60     		str	r2, [r3]
 898:bluetooth_rxtx.c **** 		}
 2905              		.loc 1 898 0
 2906 0024 0022     		movs	r2, #0
 2907 0026 0C4B     		ldr	r3, .L328+16
 2908 0028 1A60     		str	r2, [r3]
 2909              	.L317:
 901:bluetooth_rxtx.c **** 			DMACIntErrClr = (1 << 7);
 2910              		.loc 1 901 0
 2911 002a 0C4B     		ldr	r3, .L328+20
 2912 002c 1B68     		ldr	r3, [r3]
 2913 002e 1B06     		lsls	r3, r3, #24
 2914 0030 09D5     		bpl	.L313
 902:bluetooth_rxtx.c **** 			// FIXME do something better here
 2915              		.loc 1 902 0
 2916 0032 8022     		movs	r2, #128
 2917 0034 0A4B     		ldr	r3, .L328+24
 2918 0036 1A60     		str	r2, [r3]
 904:bluetooth_rxtx.c **** 			while (1) { }
 2919              		.loc 1 904 0
 2920 0038 0222     		movs	r2, #2
ARM GAS  /tmp/ccLwKaeN.s 			page 97


 2921 003a 0A4B     		ldr	r3, .L328+28
 2922 003c 1A60     		str	r2, [r3]
 2923              	.L318:
 2924 003e FEE7     		b	.L318
 2925              	.L314:
 891:bluetooth_rxtx.c **** 
 2926              		.loc 1 891 0
 2927 0040 FFF7FEFF 		bl	legacy_DMA_IRQHandler
 2928              	.LVL353:
 2929 0044 E3E7     		b	.L315
 2930              	.L313:
 2931 0046 08BD     		pop	{r3, pc}
 2932              	.L329:
 2933              		.align	2
 2934              	.L328:
 2935 0048 00000000 		.word	.LANCHOR1
 2936 004c 00400050 		.word	1342193664
 2937 0050 04400050 		.word	1342193668
 2938 0054 08400050 		.word	1342193672
 2939 0058 00000000 		.word	debug_dma_active
 2940 005c 0C400050 		.word	1342193676
 2941 0060 10400050 		.word	1342193680
 2942 0064 38C00920 		.word	537509944
 2943              		.cfi_endproc
 2944              	.LFE6:
 2946              		.section	.text.le_transmit,"ax",%progbits
 2947              		.align	1
 2948              		.global	le_transmit
 2949              		.syntax unified
 2950              		.thumb
 2951              		.thumb_func
 2952              		.fpu softvfp
 2954              	le_transmit:
 2955              	.LFB12:
1171:bluetooth_rxtx.c **** 	unsigned i, j;
 2956              		.loc 1 1171 0
 2957              		.cfi_startproc
 2958              		@ args = 0, pretend = 0, frame = 40
 2959              		@ frame_needed = 0, uses_anonymous_args = 0
 2960              	.LVL354:
 2961 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 2962              		.cfi_def_cfa_offset 36
 2963              		.cfi_offset 4, -36
 2964              		.cfi_offset 5, -32
 2965              		.cfi_offset 6, -28
 2966              		.cfi_offset 7, -24
 2967              		.cfi_offset 8, -20
 2968              		.cfi_offset 9, -16
 2969              		.cfi_offset 10, -12
 2970              		.cfi_offset 11, -8
 2971              		.cfi_offset 14, -4
 2972 0004 8BB0     		sub	sp, sp, #44
 2973              		.cfi_def_cfa_offset 80
1171:bluetooth_rxtx.c **** 	unsigned i, j;
 2974              		.loc 1 1171 0
 2975 0006 0C46     		mov	r4, r1
 2976 0008 9046     		mov	r8, r2
ARM GAS  /tmp/ccLwKaeN.s 			page 98


1176:bluetooth_rxtx.c **** 
 2977              		.loc 1 1176 0
 2978 000a FFF7FEFF 		bl	rbit
 2979              	.LVL355:
1183:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
 2980              		.loc 1 1183 0
 2981 000e 504E     		ldr	r6, .L347
1176:bluetooth_rxtx.c **** 
 2982              		.loc 1 1176 0
 2983 0010 0746     		mov	r7, r0
 2984              	.LVL356:
1183:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
 2985              		.loc 1 1183 0
 2986 0012 B6F84C00 		ldrh	r0, [r6, #76]
 2987              	.LVL357:
 2988 0016 202C     		cmp	r4, #32
 2989 0018 80B2     		uxth	r0, r0
 2990 001a 28BF     		it	cs
 2991 001c 2024     		movcs	r4, #32
 2992              	.LVL358:
 2993 001e FFF7FEFF 		bl	btle_channel_index
 2994              	.LVL359:
1186:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 2995              		.loc 1 1186 0
 2996 0022 4FF00009 		mov	r9, #0
1184:bluetooth_rxtx.c **** 		byte = data[i];
 2997              		.loc 1 1184 0
 2998 0026 C646     		mov	lr, r8
1189:bluetooth_rxtx.c **** 			byte >>= 1;
 2999              		.loc 1 1189 0
 3000 0028 4FF07F0A 		mov	r10, #127
1183:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
 3001              		.loc 1 1183 0
 3002 002c 494D     		ldr	r5, .L347+4
 3003 002e 0DF10701 		add	r1, sp, #7
 3004 0032 2B5C     		ldrb	r3, [r5, r0]	@ zero_extendqisi2
 3005              	.LVL360:
 3006 0034 0196     		str	r6, [sp, #4]
 3007              	.LVL361:
 3008              	.L331:
1184:bluetooth_rxtx.c **** 		byte = data[i];
 3009              		.loc 1 1184 0 discriminator 1
 3010 0036 AEEB0802 		sub	r2, lr, r8
 3011 003a 9442     		cmp	r4, r2
 3012 003c 65D8     		bhi	.L333
1196:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3013              		.loc 1 1196 0
 3014 003e 47F6FF71 		movw	r1, #32767
 3015 0042 0D20     		movs	r0, #13
 3016 0044 FFF7FEFF 		bl	cc2400_set
 3017              	.LVL362:
1197:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 3018              		.loc 1 1197 0
 3019 0048 42F62231 		movw	r1, #11042
 3020 004c 1220     		movs	r0, #18
 3021 004e FFF7FEFF 		bl	cc2400_set
 3022              	.LVL363:
ARM GAS  /tmp/ccLwKaeN.s 			page 99


1198:bluetooth_rxtx.c **** 
 3023              		.loc 1 1198 0
 3024 0052 41F24B31 		movw	r1, #4939
 3025 0056 1420     		movs	r0, #20
 3026 0058 FFF7FEFF 		bl	cc2400_set
 3027              	.LVL364:
1200:bluetooth_rxtx.c **** 	// 0 00 01 1 001 11 0 00 0 1
 3028              		.loc 1 1200 0
 3029 005c 40F6E141 		movw	r1, #3297
 3030 0060 2020     		movs	r0, #32
 3031 0062 FFF7FEFF 		bl	cc2400_set
 3032              	.LVL365:
1208:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 3033              		.loc 1 1208 0
 3034 0066 019B     		ldr	r3, [sp, #4]
 3035 0068 0220     		movs	r0, #2
 3036 006a B3F84C10 		ldrh	r1, [r3, #76]
 3037 006e 89B2     		uxth	r1, r1
 3038 0070 FFF7FEFF 		bl	cc2400_set
 3039              	.LVL366:
1209:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 3040              		.loc 1 1209 0
 3041 0074 0B21     		movs	r1, #11
 3042 0076 0520     		movs	r0, #5
 3043 0078 FFF7FEFF 		bl	cc2400_set
 3044              	.LVL367:
1210:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
 3045              		.loc 1 1210 0
 3046 007c 4021     		movs	r1, #64
 3047 007e 0320     		movs	r0, #3
 3048 0080 FFF7FEFF 		bl	cc2400_set
 3049              	.LVL368:
1211:bluetooth_rxtx.c **** 
 3050              		.loc 1 1211 0
 3051 0084 1421     		movs	r1, #20
 3052 0086 2320     		movs	r0, #35
 3053 0088 FFF7FEFF 		bl	cc2400_set
 3054              	.LVL369:
1215:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 3055              		.loc 1 1215 0
 3056 008c B9B2     		uxth	r1, r7
 3057 008e 2C20     		movs	r0, #44
 3058 0090 FFF7FEFF 		bl	cc2400_set
 3059              	.LVL370:
1216:bluetooth_rxtx.c **** 
 3060              		.loc 1 1216 0
 3061 0094 390C     		lsrs	r1, r7, #16
 3062 0096 2D20     		movs	r0, #45
 3063 0098 FFF7FEFF 		bl	cc2400_set
 3064              	.LVL371:
 3065              	.L334:
1219:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 3066              		.loc 1 1219 0 discriminator 1
 3067 009c FFF7FEFF 		bl	cc2400_status
 3068              	.LVL372:
 3069 00a0 4106     		lsls	r1, r0, #25
 3070 00a2 FBD5     		bpl	.L334
ARM GAS  /tmp/ccLwKaeN.s 			page 100


1220:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3071              		.loc 1 1220 0
 3072 00a4 6120     		movs	r0, #97
 3073 00a6 FFF7FEFF 		bl	cc2400_strobe
 3074              	.LVL373:
 3075              	.L335:
1221:bluetooth_rxtx.c **** 	TXLED_SET;
 3076              		.loc 1 1221 0 discriminator 1
 3077 00aa FFF7FEFF 		bl	cc2400_status
 3078              	.LVL374:
 3079 00ae 4207     		lsls	r2, r0, #29
 3080 00b0 FBD5     		bpl	.L335
1222:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 3081              		.loc 1 1222 0
 3082 00b2 4FF48072 		mov	r2, #256
 3083 00b6 284B     		ldr	r3, .L347+8
 3084 00b8 1A60     		str	r2, [r3]
1224:bluetooth_rxtx.c **** #endif
 3085              		.loc 1 1224 0
 3086 00ba 8022     		movs	r2, #128
 3087 00bc 1A62     		str	r2, [r3, #32]
 3088              	.L336:
1226:bluetooth_rxtx.c **** 
 3089              		.loc 1 1226 0 discriminator 1
 3090 00be 0E20     		movs	r0, #14
 3091 00c0 FFF7FEFF 		bl	cc2400_get
 3092              	.LVL375:
 3093 00c4 00F01F00 		and	r0, r0, #31
 3094 00c8 0F28     		cmp	r0, #15
 3095 00ca F8D1     		bne	.L336
1229:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 3096              		.loc 1 1229 0
 3097 00cc 2046     		mov	r0, r4
 3098 00ce 02A9     		add	r1, sp, #8
 3099 00d0 FFF7FEFF 		bl	cc2400_fifo_write
 3100              	.LVL376:
1230:bluetooth_rxtx.c **** 
 3101              		.loc 1 1230 0
 3102 00d4 6320     		movs	r0, #99
 3103 00d6 FFF7FEFF 		bl	cc2400_strobe
 3104              	.LVL377:
 3105              	.L337:
1232:bluetooth_rxtx.c **** 	TXLED_CLR;
 3106              		.loc 1 1232 0 discriminator 1
 3107 00da 0E20     		movs	r0, #14
 3108 00dc FFF7FEFF 		bl	cc2400_get
 3109              	.LVL378:
 3110 00e0 00F01F00 		and	r0, r0, #31
 3111 00e4 0F28     		cmp	r0, #15
 3112 00e6 F8D1     		bne	.L337
1233:bluetooth_rxtx.c **** 
 3113              		.loc 1 1233 0
 3114 00e8 4FF48072 		mov	r2, #256
 3115 00ec 1B4B     		ldr	r3, .L347+12
1235:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 3116              		.loc 1 1235 0
 3117 00ee 6420     		movs	r0, #100
ARM GAS  /tmp/ccLwKaeN.s 			page 101


1233:bluetooth_rxtx.c **** 
 3118              		.loc 1 1233 0
 3119 00f0 1A60     		str	r2, [r3]
1235:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 3120              		.loc 1 1235 0
 3121 00f2 FFF7FEFF 		bl	cc2400_strobe
 3122              	.LVL379:
 3123              	.L338:
1236:bluetooth_rxtx.c **** 
 3124              		.loc 1 1236 0 discriminator 1
 3125 00f6 FFF7FEFF 		bl	cc2400_status
 3126              	.LVL380:
 3127 00fa 4307     		lsls	r3, r0, #29
 3128 00fc FBD4     		bmi	.L338
1239:bluetooth_rxtx.c **** #endif
 3129              		.loc 1 1239 0
 3130 00fe 8022     		movs	r2, #128
 3131 0100 174B     		ldr	r3, .L347+16
 3132 0102 1A60     		str	r2, [r3]
1241:bluetooth_rxtx.c **** 
 3133              		.loc 1 1241 0
 3134 0104 0BB0     		add	sp, sp, #44
 3135              		.cfi_remember_state
 3136              		.cfi_def_cfa_offset 36
 3137              		@ sp needed
 3138 0106 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 3139              	.LVL381:
 3140              	.L333:
 3141              		.cfi_restore_state
1186:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 3142              		.loc 1 1186 0
 3143 010a 0726     		movs	r6, #7
 3144 010c 81F80190 		strb	r9, [r1, #1]
1185:bluetooth_rxtx.c **** 		txbuf[i] = 0;
 3145              		.loc 1 1185 0
 3146 0110 1EF8012B 		ldrb	r2, [lr], #1	@ zero_extendqisi2
 3147              	.LVL382:
 3148 0114 11F801CF 		ldrb	ip, [r1, #1]!	@ zero_extendqisi2
 3149              	.LVL383:
 3150              	.L332:
1188:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 3151              		.loc 1 1188 0 discriminator 3
 3152 0118 E818     		adds	r0, r5, r3
 3153 011a 90F82800 		ldrb	r0, [r0, #40]	@ zero_extendqisi2
 3154 011e 02F0010B 		and	fp, r2, #1
 3155 0122 8BEA0000 		eor	r0, fp, r0
 3156              	.LVL384:
1189:bluetooth_rxtx.c **** 			byte >>= 1;
 3157              		.loc 1 1189 0 discriminator 3
 3158 0126 03F1010B 		add	fp, r3, #1
 3159 012a BBFBFAF3 		udiv	r3, fp, r10
 3160              	.LVL385:
1191:bluetooth_rxtx.c **** 		}
 3161              		.loc 1 1191 0 discriminator 3
 3162 012e B040     		lsls	r0, r0, r6
 3163              	.LVL386:
1189:bluetooth_rxtx.c **** 			byte >>= 1;
ARM GAS  /tmp/ccLwKaeN.s 			page 102


 3164              		.loc 1 1189 0 discriminator 3
 3165 0130 C3EBC313 		rsb	r3, r3, r3, lsl #7
1191:bluetooth_rxtx.c **** 		}
 3166              		.loc 1 1191 0 discriminator 3
 3167 0134 40EA0C0C 		orr	ip, r0, ip
1187:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 3168              		.loc 1 1187 0 discriminator 3
 3169 0138 16F1FF36 		adds	r6, r6, #-1
 3170              	.LVL387:
1189:bluetooth_rxtx.c **** 			byte >>= 1;
 3171              		.loc 1 1189 0 discriminator 3
 3172 013c ABEB0303 		sub	r3, fp, r3
 3173              	.LVL388:
1190:bluetooth_rxtx.c **** 			txbuf[i] |= bit << (7 - j);
 3174              		.loc 1 1190 0 discriminator 3
 3175 0140 4FEA5202 		lsr	r2, r2, #1
 3176              	.LVL389:
1191:bluetooth_rxtx.c **** 		}
 3177              		.loc 1 1191 0 discriminator 3
 3178 0144 5FFA8CFC 		uxtb	ip, ip
 3179              	.LVL390:
1187:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 3180              		.loc 1 1187 0 discriminator 3
 3181 0148 E6D2     		bcs	.L332
 3182 014a 81F800C0 		strb	ip, [r1]
 3183              	.LVL391:
 3184 014e 72E7     		b	.L331
 3185              	.L348:
 3186              		.align	2
 3187              	.L347:
 3188 0150 00000000 		.word	.LANCHOR0
 3189 0154 00000000 		.word	.LANCHOR2
 3190 0158 38C00920 		.word	537509944
 3191 015c 3CC00920 		.word	537509948
 3192 0160 5CC00920 		.word	537509980
 3193              		.cfi_endproc
 3194              	.LFE12:
 3196              		.section	.text.le_jam,"ax",%progbits
 3197              		.align	1
 3198              		.global	le_jam
 3199              		.syntax unified
 3200              		.thumb
 3201              		.thumb_func
 3202              		.fpu softvfp
 3204              	le_jam:
 3205              	.LFB13:
1243:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 3206              		.loc 1 1243 0
 3207              		.cfi_startproc
 3208              		@ args = 0, pretend = 0, frame = 0
 3209              		@ frame_needed = 0, uses_anonymous_args = 0
 3210 0000 08B5     		push	{r3, lr}
 3211              		.cfi_def_cfa_offset 8
 3212              		.cfi_offset 3, -8
 3213              		.cfi_offset 14, -4
1245:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3214              		.loc 1 1245 0
ARM GAS  /tmp/ccLwKaeN.s 			page 103


 3215 0002 47F6FF71 		movw	r1, #32767
 3216 0006 0D20     		movs	r0, #13
 3217 0008 FFF7FEFF 		bl	cc2400_set
 3218              	.LVL392:
1246:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
 3219              		.loc 1 1246 0
 3220 000c 42F62231 		movw	r1, #11042
 3221 0010 1220     		movs	r0, #18
 3222 0012 FFF7FEFF 		bl	cc2400_set
 3223              	.LVL393:
1247:bluetooth_rxtx.c **** 
 3224              		.loc 1 1247 0
 3225 0016 42F24B31 		movw	r1, #9035
 3226 001a 1420     		movs	r0, #20
 3227 001c FFF7FEFF 		bl	cc2400_set
 3228              	.LVL394:
1249:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 3229              		.loc 1 1249 0
 3230 0020 40F60141 		movw	r1, #3073
 3231 0024 2020     		movs	r0, #32
 3232 0026 FFF7FEFF 		bl	cc2400_set
 3233              	.LVL395:
1258:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 3234              		.loc 1 1258 0
 3235 002a 0B21     		movs	r1, #11
 3236 002c 0520     		movs	r0, #5
 3237 002e FFF7FEFF 		bl	cc2400_set
 3238              	.LVL396:
1259:bluetooth_rxtx.c **** 
 3239              		.loc 1 1259 0
 3240 0032 4021     		movs	r1, #64
 3241 0034 0320     		movs	r0, #3
 3242 0036 FFF7FEFF 		bl	cc2400_set
 3243              	.LVL397:
 3244              	.L350:
1261:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 3245              		.loc 1 1261 0 discriminator 1
 3246 003a FFF7FEFF 		bl	cc2400_status
 3247              	.LVL398:
 3248 003e 4206     		lsls	r2, r0, #25
 3249 0040 FBD5     		bpl	.L350
1262:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3250              		.loc 1 1262 0
 3251 0042 6120     		movs	r0, #97
 3252 0044 FFF7FEFF 		bl	cc2400_strobe
 3253              	.LVL399:
 3254              	.L351:
1263:bluetooth_rxtx.c **** 	TXLED_SET;
 3255              		.loc 1 1263 0 discriminator 1
 3256 0048 FFF7FEFF 		bl	cc2400_status
 3257              	.LVL400:
 3258 004c 4307     		lsls	r3, r0, #29
 3259 004e FBD5     		bpl	.L351
1264:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 3260              		.loc 1 1264 0
 3261 0050 4FF48072 		mov	r2, #256
 3262 0054 074B     		ldr	r3, .L358
ARM GAS  /tmp/ccLwKaeN.s 			page 104


 3263 0056 1A60     		str	r2, [r3]
1266:bluetooth_rxtx.c **** #endif
 3264              		.loc 1 1266 0
 3265 0058 8022     		movs	r2, #128
 3266 005a 1A62     		str	r2, [r3, #32]
 3267              	.L352:
1268:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 3268              		.loc 1 1268 0 discriminator 1
 3269 005c 0E20     		movs	r0, #14
 3270 005e FFF7FEFF 		bl	cc2400_get
 3271              	.LVL401:
 3272 0062 00F01F00 		and	r0, r0, #31
 3273 0066 0F28     		cmp	r0, #15
 3274 0068 F8D1     		bne	.L352
1269:bluetooth_rxtx.c **** #endif
 3275              		.loc 1 1269 0
 3276 006a 6320     		movs	r0, #99
1271:bluetooth_rxtx.c **** 
 3277              		.loc 1 1271 0
 3278 006c BDE80840 		pop	{r3, lr}
 3279              		.cfi_restore 14
 3280              		.cfi_restore 3
 3281              		.cfi_def_cfa_offset 0
1269:bluetooth_rxtx.c **** #endif
 3282              		.loc 1 1269 0
 3283 0070 FFF7FEBF 		b	cc2400_strobe
 3284              	.LVL402:
 3285              	.L359:
 3286              		.align	2
 3287              	.L358:
 3288 0074 38C00920 		.word	537509944
 3289              		.cfi_endproc
 3290              	.LFE13:
 3292              		.section	.text.reset_le,"ax",%progbits
 3293              		.align	1
 3294              		.global	reset_le
 3295              		.syntax unified
 3296              		.thumb
 3297              		.thumb_func
 3298              		.fpu softvfp
 3300              	reset_le:
 3301              	.LFB20:
1569:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
 3302              		.loc 1 1569 0
 3303              		.cfi_startproc
 3304              		@ args = 0, pretend = 0, frame = 0
 3305              		@ frame_needed = 0, uses_anonymous_args = 0
 3306 0000 08B5     		push	{r3, lr}
 3307              		.cfi_def_cfa_offset 8
 3308              		.cfi_offset 3, -8
 3309              		.cfi_offset 14, -4
1570:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;               // advertising channel CRCInit
 3310              		.loc 1 1570 0
 3311 0002 0F48     		ldr	r0, .L361
 3312 0004 FFF7FEFF 		bl	le_set_access_address
 3313              	.LVL403:
1571:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
ARM GAS  /tmp/ccLwKaeN.s 			page 105


 3314              		.loc 1 1571 0
 3315 0008 0E4B     		ldr	r3, .L361+4
 3316 000a 0F4A     		ldr	r2, .L361+8
 3317 000c 9A60     		str	r2, [r3, #8]
1572:bluetooth_rxtx.c **** 	le.crc_verify = 0;
 3318              		.loc 1 1572 0
 3319 000e 0F4A     		ldr	r2, .L361+12
 3320 0010 DA60     		str	r2, [r3, #12]
1573:bluetooth_rxtx.c **** 	le.last_packet = 0;
 3321              		.loc 1 1573 0
 3322 0012 0022     		movs	r2, #0
1582:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 3323              		.loc 1 1582 0
 3324 0014 9A83     		strh	r2, [r3, #28]	@ movhi
1573:bluetooth_rxtx.c **** 	le.last_packet = 0;
 3325              		.loc 1 1573 0
 3326 0016 1A61     		str	r2, [r3, #16]
1585:bluetooth_rxtx.c **** 
 3327              		.loc 1 1585 0
 3328 0018 1A84     		strh	r2, [r3, #32]	@ movhi
1574:bluetooth_rxtx.c **** 
 3329              		.loc 1 1574 0
 3330 001a 9A64     		str	r2, [r3, #72]
1576:bluetooth_rxtx.c **** 
 3331              		.loc 1 1576 0
 3332 001c 1A75     		strb	r2, [r3, #20]
1578:bluetooth_rxtx.c **** 	le.channel_increment = 0;
 3333              		.loc 1 1578 0
 3334 001e 5A75     		strb	r2, [r3, #21]
1579:bluetooth_rxtx.c **** 
 3335              		.loc 1 1579 0
 3336 0020 9A75     		strb	r2, [r3, #22]
1581:bluetooth_rxtx.c **** 	le.interval_timer = 0;
 3337              		.loc 1 1581 0
 3338 0022 9A61     		str	r2, [r3, #24]
1583:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 3339              		.loc 1 1583 0
 3340 0024 DA83     		strh	r2, [r3, #30]	@ movhi
1587:bluetooth_rxtx.c **** 	le.win_offset = 0;
 3341              		.loc 1 1587 0
 3342 0026 83F82220 		strb	r2, [r3, #34]
1588:bluetooth_rxtx.c **** 
 3343              		.loc 1 1588 0
 3344 002a 9A84     		strh	r2, [r3, #36]	@ movhi
1590:bluetooth_rxtx.c ****     // channel_map_update_pending = 0;
 3345              		.loc 1 1590 0
 3346 002c 9A62     		str	r2, [r3, #40]
1593:bluetooth_rxtx.c **** 	le.interval_update = 0;
 3347              		.loc 1 1593 0
 3348 002e 9A85     		strh	r2, [r3, #44]	@ movhi
1594:bluetooth_rxtx.c **** 	le.win_size_update = 0;
 3349              		.loc 1 1594 0
 3350 0030 DA85     		strh	r2, [r3, #46]	@ movhi
1595:bluetooth_rxtx.c **** 	le.win_offset_update = 0;
 3351              		.loc 1 1595 0
 3352 0032 83F83020 		strb	r2, [r3, #48]
1596:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccLwKaeN.s 			page 106


 3353              		.loc 1 1596 0
 3354 0036 5A86     		strh	r2, [r3, #50]	@ movhi
1598:bluetooth_rxtx.c **** }
 3355              		.loc 1 1598 0
 3356 0038 054B     		ldr	r3, .L361+16
 3357 003a DA72     		strb	r2, [r3, #11]
 3358 003c 08BD     		pop	{r3, pc}
 3359              	.L362:
 3360 003e 00BF     		.align	2
 3361              	.L361:
 3362 0040 D6BE898E 		.word	-1903575338
 3363 0044 00000000 		.word	.LANCHOR0
 3364 0048 55555500 		.word	5592405
 3365 004c AAAAAA00 		.word	11184810
 3366 0050 00000000 		.word	.LANCHOR1
 3367              		.cfi_endproc
 3368              	.LFE20:
 3370              		.section	.text.reset_le_promisc,"ax",%progbits
 3371              		.align	1
 3372              		.global	reset_le_promisc
 3373              		.syntax unified
 3374              		.thumb
 3375              		.thumb_func
 3376              		.fpu softvfp
 3378              	reset_le_promisc:
 3379              	.LFB21:
1602:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
 3380              		.loc 1 1602 0
 3381              		.cfi_startproc
 3382              		@ args = 0, pretend = 0, frame = 0
 3383              		@ frame_needed = 0, uses_anonymous_args = 0
 3384 0000 10B5     		push	{r4, lr}
 3385              		.cfi_def_cfa_offset 8
 3386              		.cfi_offset 4, -8
 3387              		.cfi_offset 14, -4
1603:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
 3388              		.loc 1 1603 0
 3389 0002 064C     		ldr	r4, .L364
 3390 0004 4FF48472 		mov	r2, #264
 3391 0008 0021     		movs	r1, #0
 3392 000a 2046     		mov	r0, r4
 3393 000c FFF7FEFF 		bl	memset
 3394              	.LVL404:
1604:bluetooth_rxtx.c **** }
 3395              		.loc 1 1604 0
 3396 0010 4FF0FF33 		mov	r3, #-1
 3397 0014 C4F80031 		str	r3, [r4, #256]
 3398 0018 10BD     		pop	{r4, pc}
 3399              	.L365:
 3400 001a 00BF     		.align	2
 3401              	.L364:
 3402 001c 00000000 		.word	le_promisc
 3403              		.cfi_endproc
 3404              	.LFE21:
 3406              		.section	.text.rearrange_channel,"ax",%progbits
 3407              		.align	1
 3408              		.global	rearrange_channel
ARM GAS  /tmp/ccLwKaeN.s 			page 107


 3409              		.syntax unified
 3410              		.thumb
 3411              		.thumb_func
 3412              		.fpu softvfp
 3414              	rearrange_channel:
 3415              	.LFB25:
2017:bluetooth_rxtx.c **** //sopan
2018:bluetooth_rxtx.c **** 
2019:bluetooth_rxtx.c **** void rearrange_channel(uint8_t array[]){
 3416              		.loc 1 2019 0
 3417              		.cfi_startproc
 3418              		@ args = 0, pretend = 0, frame = 0
 3419              		@ frame_needed = 0, uses_anonymous_args = 0
 3420              	.LVL405:
 3421 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 3422              		.cfi_def_cfa_offset 20
 3423              		.cfi_offset 4, -20
 3424              		.cfi_offset 5, -16
 3425              		.cfi_offset 6, -12
 3426              		.cfi_offset 7, -8
 3427              		.cfi_offset 14, -4
2020:bluetooth_rxtx.c ****     
2021:bluetooth_rxtx.c ****     static u8 m, n = 0;
2022:bluetooth_rxtx.c ****     static u8 a = 0;
2023:bluetooth_rxtx.c **** 
2024:bluetooth_rxtx.c ****     for(m=0; m<remapping.total_channels; ++m){
 3428              		.loc 1 2024 0
 3429 0002 0023     		movs	r3, #0
 3430 0004 134C     		ldr	r4, .L376
 3431 0006 9E46     		mov	lr, r3
 3432 0008 A446     		mov	ip, r4
 3433 000a 1349     		ldr	r1, .L376+4
 3434 000c 91F82A70 		ldrb	r7, [r1, #42]	@ zero_extendqisi2
 3435 0010 81F82930 		strb	r3, [r1, #41]
 3436              	.L367:
 3437              		.loc 1 2024 0 is_stmt 0 discriminator 1
 3438 0014 D4F8BC50 		ldr	r5, [r4, #188]
 3439 0018 1A46     		mov	r2, r3
 3440 001a AB42     		cmp	r3, r5
 3441 001c 07D3     		bcc	.L371
 3442 001e BEF1000F 		cmp	lr, #0
 3443 0022 03D0     		beq	.L366
 3444 0024 81F82A70 		strb	r7, [r1, #42]
 3445 0028 81F82930 		strb	r3, [r1, #41]
 3446              	.L366:
 3447 002c F0BD     		pop	{r4, r5, r6, r7, pc}
 3448              	.L371:
2025:bluetooth_rxtx.c ****         for(n=m+1; n<remapping.total_channels; ++n){
 3449              		.loc 1 2025 0 is_stmt 1
 3450 002e 0133     		adds	r3, r3, #1
 3451 0030 DBB2     		uxtb	r3, r3
 3452 0032 1F46     		mov	r7, r3
 3453 0034 4FF0010E 		mov	lr, #1
2026:bluetooth_rxtx.c ****             if(array[m] > array[n]){
 3454              		.loc 1 2026 0
 3455 0038 0244     		add	r2, r2, r0
 3456              	.L368:
ARM GAS  /tmp/ccLwKaeN.s 			page 108


2025:bluetooth_rxtx.c ****         for(n=m+1; n<remapping.total_channels; ++n){
 3457              		.loc 1 2025 0 discriminator 1
 3458 003a DCF8BC50 		ldr	r5, [ip, #188]
 3459 003e AF42     		cmp	r7, r5
 3460 0040 E8D2     		bcs	.L367
 3461              		.loc 1 2026 0
 3462 0042 C65D     		ldrb	r6, [r0, r7]	@ zero_extendqisi2
 3463 0044 1578     		ldrb	r5, [r2]	@ zero_extendqisi2
 3464 0046 B542     		cmp	r5, r6
2027:bluetooth_rxtx.c ****                 a = array[m];
2028:bluetooth_rxtx.c ****                 array[m] = array[n];
 3465              		.loc 1 2028 0
 3466 0048 84BF     		itt	hi
 3467 004a 1670     		strbhi	r6, [r2]
2029:bluetooth_rxtx.c ****                 array[n] = a;
 3468              		.loc 1 2029 0
 3469 004c C555     		strbhi	r5, [r0, r7]
 3470 004e 0137     		adds	r7, r7, #1
 3471 0050 FFB2     		uxtb	r7, r7
 3472 0052 F2E7     		b	.L368
 3473              	.L377:
 3474              		.align	2
 3475              	.L376:
 3476 0054 00000000 		.word	remapping
 3477 0058 00000000 		.word	.LANCHOR1
 3478              		.cfi_endproc
 3479              	.LFE25:
 3481              		.section	.text.connection_follow_cb,"ax",%progbits
 3482              		.align	1
 3483              		.global	connection_follow_cb
 3484              		.syntax unified
 3485              		.thumb
 3486              		.thumb_func
 3487              		.fpu softvfp
 3489              	connection_follow_cb:
 3490              	.LFB26:
2030:bluetooth_rxtx.c ****             }            
2031:bluetooth_rxtx.c ****         }
2032:bluetooth_rxtx.c ****     }
2033:bluetooth_rxtx.c ****     //hopping_channel = 0;
2034:bluetooth_rxtx.c ****     //channel_hopped = 0;
2035:bluetooth_rxtx.c ****     //return 1;
2036:bluetooth_rxtx.c **** }
2037:bluetooth_rxtx.c **** 
2038:bluetooth_rxtx.c **** /**
2039:bluetooth_rxtx.c ****  * Called when we receive a packet in connection following mode.
2040:bluetooth_rxtx.c ****  */
2041:bluetooth_rxtx.c **** 
2042:bluetooth_rxtx.c **** #define DIVIDE_ROUND(N, D) ((N) + (D)/2) / (D)
2043:bluetooth_rxtx.c **** 
2044:bluetooth_rxtx.c **** void connection_follow_cb(u8 *packet) {
 3491              		.loc 1 2044 0
 3492              		.cfi_startproc
 3493              		@ args = 0, pretend = 0, frame = 0
 3494              		@ frame_needed = 0, uses_anonymous_args = 0
 3495              	.LVL406:
 3496 0000 38B5     		push	{r3, r4, r5, lr}
ARM GAS  /tmp/ccLwKaeN.s 			page 109


 3497              		.cfi_def_cfa_offset 16
 3498              		.cfi_offset 3, -16
 3499              		.cfi_offset 4, -12
 3500              		.cfi_offset 5, -8
 3501              		.cfi_offset 14, -4
2045:bluetooth_rxtx.c **** 
2046:bluetooth_rxtx.c ****     u8 idx = btle_channel_index(channel);
 3502              		.loc 1 2046 0
 3503 0002 194B     		ldr	r3, .L384
2047:bluetooth_rxtx.c ****     //debug_printf("idx: %d val: %d\n",idx,remapping.channel_in_use[idx]);
2048:bluetooth_rxtx.c ****     if(ch_count1 < 36 && remapping.channel_in_use[idx] != 1){
 3504              		.loc 1 2048 0
 3505 0004 194D     		ldr	r5, .L384+4
2046:bluetooth_rxtx.c ****     //debug_printf("idx: %d val: %d\n",idx,remapping.channel_in_use[idx]);
 3506              		.loc 1 2046 0
 3507 0006 B3F84C00 		ldrh	r0, [r3, #76]
 3508              	.LVL407:
 3509 000a 80B2     		uxth	r0, r0
 3510 000c FFF7FEFF 		bl	btle_channel_index
 3511              	.LVL408:
 3512              		.loc 1 2048 0
 3513 0010 95F82B20 		ldrb	r2, [r5, #43]	@ zero_extendqisi2
2046:bluetooth_rxtx.c ****     //debug_printf("idx: %d val: %d\n",idx,remapping.channel_in_use[idx]);
 3514              		.loc 1 2046 0
 3515 0014 0146     		mov	r1, r0
 3516              	.LVL409:
 3517              		.loc 1 2048 0
 3518 0016 232A     		cmp	r2, #35
 3519 0018 1AD8     		bhi	.L379
 3520              		.loc 1 2048 0 is_stmt 0 discriminator 1
 3521 001a 154C     		ldr	r4, .L384+8
 3522 001c 54F82030 		ldr	r3, [r4, r0, lsl #2]
 3523 0020 012B     		cmp	r3, #1
 3524 0022 20D0     		beq	.L378
2049:bluetooth_rxtx.c ****         remapping.channel_in_use[idx] = 1;
 3525              		.loc 1 2049 0 is_stmt 1
 3526 0024 0123     		movs	r3, #1
 3527 0026 44F82030 		str	r3, [r4, r0, lsl #2]
2050:bluetooth_rxtx.c ****         remapping.remapping_index[remapping.total_channels] = idx;
 3528              		.loc 1 2050 0
 3529 002a D4F8BC30 		ldr	r3, [r4, #188]
 3530 002e 2344     		add	r3, r3, r4
 3531 0030 83F89400 		strb	r0, [r3, #148]
2051:bluetooth_rxtx.c **** 	debug_printf("idx: %d cnt: %d \n",idx,ch_count1);
 3532              		.loc 1 2051 0
 3533 0034 0F48     		ldr	r0, .L384+12
 3534              	.LVL410:
 3535 0036 FFF7FEFF 		bl	debug_printf
 3536              	.LVL411:
2052:bluetooth_rxtx.c ****         ++remapping.total_channels;
 3537              		.loc 1 2052 0
 3538 003a D4F8BC30 		ldr	r3, [r4, #188]
 3539 003e 0133     		adds	r3, r3, #1
 3540 0040 C4F8BC30 		str	r3, [r4, #188]
2053:bluetooth_rxtx.c **** 	ch_count1++;
 3541              		.loc 1 2053 0
 3542 0044 95F82B30 		ldrb	r3, [r5, #43]	@ zero_extendqisi2
ARM GAS  /tmp/ccLwKaeN.s 			page 110


 3543 0048 0133     		adds	r3, r3, #1
 3544 004a 85F82B30 		strb	r3, [r5, #43]
 3545 004e 38BD     		pop	{r3, r4, r5, pc}
 3546              	.LVL412:
 3547              	.L379:
2054:bluetooth_rxtx.c ****     }
2055:bluetooth_rxtx.c ****     else if(ch_count1 == 36){
 3548              		.loc 1 2055 0
 3549 0050 242A     		cmp	r2, #36
 3550 0052 08D1     		bne	.L378
 3551              	.LVL413:
 3552              	.LBB35:
 3553              	.LBB36:
2056:bluetooth_rxtx.c ****         //debug_printf("matching\n");
2057:bluetooth_rxtx.c ****         //le_promisc_state(2, &le.conn_interval, 2);
2058:bluetooth_rxtx.c ****         //le_promisc_state(3, &le.channel_increment, 1);
2059:bluetooth_rxtx.c **** 	rearrange_channel(remapping.remapping_index);
 3554              		.loc 1 2059 0
 3555 0054 0848     		ldr	r0, .L384+16
 3556              	.LVL414:
 3557 0056 FFF7FEFF 		bl	rearrange_channel
 3558              	.LVL415:
2060:bluetooth_rxtx.c ****         ch_count1++;
 3559              		.loc 1 2060 0
 3560 005a 2523     		movs	r3, #37
 3561 005c 85F82B30 		strb	r3, [r5, #43]
2061:bluetooth_rxtx.c ****         //do_count = 0;
2062:bluetooth_rxtx.c ****         mapped = 1;
 3562              		.loc 1 2062 0
 3563 0060 0123     		movs	r3, #1
 3564 0062 85F82C30 		strb	r3, [r5, #44]
 3565              	.LVL416:
 3566              	.L378:
 3567 0066 38BD     		pop	{r3, r4, r5, pc}
 3568              	.L385:
 3569              		.align	2
 3570              	.L384:
 3571 0068 00000000 		.word	.LANCHOR0
 3572 006c 00000000 		.word	.LANCHOR1
 3573 0070 00000000 		.word	remapping
 3574 0074 3E000000 		.word	.LC6
 3575 0078 94000000 		.word	remapping+148
 3576              	.LBE36:
 3577              	.LBE35:
 3578              		.cfi_endproc
 3579              	.LFE26:
 3581              		.section	.text.bt_follow_le,"ax",%progbits
 3582              		.align	1
 3583              		.global	bt_follow_le
 3584              		.syntax unified
 3585              		.thumb
 3586              		.thumb_func
 3587              		.fpu softvfp
 3589              	bt_follow_le:
 3590              	.LFB27:
2063:bluetooth_rxtx.c **** 	//debug_printf("Mapped\n");
2064:bluetooth_rxtx.c ****         //hopping_channel = 0;
ARM GAS  /tmp/ccLwKaeN.s 			page 111


2065:bluetooth_rxtx.c ****         //channel_hopped = 0;
2066:bluetooth_rxtx.c ****     }
2067:bluetooth_rxtx.c **** /*
2068:bluetooth_rxtx.c ****     else if(mapped == 1){
2069:bluetooth_rxtx.c ****             channel_hopped++;
2070:bluetooth_rxtx.c ****             if(abs(hopping_channel - channel_hopped) > 3 && remapped == 0){
2071:bluetooth_rxtx.c ****                 debug_printf("recalculating ch map %d\n",abs(hopping_channel - channel_hopped));
2072:bluetooth_rxtx.c ****                 mapped = 0;
2073:bluetooth_rxtx.c ****                 ch_count1 = 0;
2074:bluetooth_rxtx.c ****                 total_channel = 0;
2075:bluetooth_rxtx.c ****                 hopping_channel = 0;
2076:bluetooth_rxtx.c ****                 channel_hopped = 0;
2077:bluetooth_rxtx.c ****                 do_count = 1;
2078:bluetooth_rxtx.c ****                 memset(ch_map_hopped, 0, sizeof ch_map_hopped);
2079:bluetooth_rxtx.c ****             }
2080:bluetooth_rxtx.c ****             hopping_channel = 0;
2081:bluetooth_rxtx.c ****             channel_hopped = 0;
2082:bluetooth_rxtx.c ****      }
2083:bluetooth_rxtx.c **** 
2084:bluetooth_rxtx.c **** 
2085:bluetooth_rxtx.c ****     else if(mapped == 1){
2086:bluetooth_rxtx.c ****             channel_hopped++;
2087:bluetooth_rxtx.c ****      }
2088:bluetooth_rxtx.c **** 
2089:bluetooth_rxtx.c ****     if(do_count == 1){
2090:bluetooth_rxtx.c ****         ch_count1++;
2091:bluetooth_rxtx.c ****     }
2092:bluetooth_rxtx.c **** */
2093:bluetooth_rxtx.c **** }
2094:bluetooth_rxtx.c **** 
2095:bluetooth_rxtx.c **** void le_phy_main(void);
2096:bluetooth_rxtx.c **** void bt_follow_le() {
 3591              		.loc 1 2096 0
 3592              		.cfi_startproc
 3593              		@ args = 0, pretend = 0, frame = 0
 3594              		@ frame_needed = 0, uses_anonymous_args = 0
 3595              		@ link register save eliminated.
2097:bluetooth_rxtx.c **** 	le_phy_main();
 3596              		.loc 1 2097 0
 3597 0000 FFF7FEBF 		b	le_phy_main
 3598              	.LVL417:
 3599              		.cfi_endproc
 3600              	.LFE27:
 3602              		.section	.text.le_promisc_state,"ax",%progbits
 3603              		.align	1
 3604              		.global	le_promisc_state
 3605              		.syntax unified
 3606              		.thumb
 3607              		.thumb_func
 3608              		.fpu softvfp
 3610              	le_promisc_state:
 3611              	.LFB28:
2098:bluetooth_rxtx.c **** }
2099:bluetooth_rxtx.c **** 
2100:bluetooth_rxtx.c **** // issue state change message
2101:bluetooth_rxtx.c **** void le_promisc_state(u8 type, void *data, unsigned len) {
 3612              		.loc 1 2101 0
ARM GAS  /tmp/ccLwKaeN.s 			page 112


 3613              		.cfi_startproc
 3614              		@ args = 0, pretend = 0, frame = 56
 3615              		@ frame_needed = 0, uses_anonymous_args = 0
 3616              	.LVL418:
 3617 0000 70B5     		push	{r4, r5, r6, lr}
 3618              		.cfi_def_cfa_offset 16
 3619              		.cfi_offset 4, -16
 3620              		.cfi_offset 5, -12
 3621              		.cfi_offset 6, -8
 3622              		.cfi_offset 14, -4
 3623 0002 8EB0     		sub	sp, sp, #56
 3624              		.cfi_def_cfa_offset 72
 3625              		.loc 1 2101 0
 3626 0004 1546     		mov	r5, r2
 3627 0006 0C46     		mov	r4, r1
 3628 0008 0646     		mov	r6, r0
2102:bluetooth_rxtx.c **** 	u8 buf[50] = { 0, };
 3629              		.loc 1 2102 0
 3630 000a 3222     		movs	r2, #50
 3631              	.LVL419:
 3632 000c 0021     		movs	r1, #0
 3633              	.LVL420:
 3634 000e 01A8     		add	r0, sp, #4
 3635              	.LVL421:
 3636 0010 FFF7FEFF 		bl	memset
 3637              	.LVL422:
2103:bluetooth_rxtx.c **** 	if (len > 49)
2104:bluetooth_rxtx.c **** 		len = 49;
2105:bluetooth_rxtx.c **** 
2106:bluetooth_rxtx.c **** 	buf[0] = type;
2107:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 3638              		.loc 1 2107 0
 3639 0014 312D     		cmp	r5, #49
 3640 0016 2A46     		mov	r2, r5
 3641 0018 2146     		mov	r1, r4
 3642 001a 28BF     		it	cs
 3643 001c 3122     		movcs	r2, #49
 3644 001e 0DF10500 		add	r0, sp, #5
2106:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 3645              		.loc 1 2106 0
 3646 0022 8DF80460 		strb	r6, [sp, #4]
 3647              		.loc 1 2107 0
 3648 0026 FFF7FEFF 		bl	memcpy
 3649              	.LVL423:
2108:bluetooth_rxtx.c **** 	enqueue(LE_PROMISC, (uint8_t*)buf);
 3650              		.loc 1 2108 0
 3651 002a 01A9     		add	r1, sp, #4
 3652 002c 0520     		movs	r0, #5
 3653 002e FFF7FEFF 		bl	enqueue
 3654              	.LVL424:
2109:bluetooth_rxtx.c **** }
 3655              		.loc 1 2109 0
 3656 0032 0EB0     		add	sp, sp, #56
 3657              		.cfi_def_cfa_offset 16
 3658              		@ sp needed
 3659 0034 70BD     		pop	{r4, r5, r6, pc}
 3660              		.cfi_endproc
ARM GAS  /tmp/ccLwKaeN.s 			page 113


 3661              	.LFE28:
 3663              		.section	.text.hop,"ax",%progbits
 3664              		.align	1
 3665              		.global	hop
 3666              		.syntax unified
 3667              		.thumb
 3668              		.thumb_func
 3669              		.fpu softvfp
 3671              	hop:
 3672              	.LFB14:
1276:bluetooth_rxtx.c ****     //static count = 0;
 3673              		.loc 1 1276 0
 3674              		.cfi_startproc
 3675              		@ args = 0, pretend = 0, frame = 8
 3676              		@ frame_needed = 0, uses_anonymous_args = 0
 3677 0000 F7B5     		push	{r0, r1, r2, r4, r5, r6, r7, lr}
 3678              		.cfi_def_cfa_offset 32
 3679              		.cfi_offset 4, -20
 3680              		.cfi_offset 5, -16
 3681              		.cfi_offset 6, -12
 3682              		.cfi_offset 7, -8
 3683              		.cfi_offset 14, -4
1278:bluetooth_rxtx.c **** 	last_hop = clkn;
 3684              		.loc 1 1278 0
 3685 0002 0023     		movs	r3, #0
 3686 0004 784C     		ldr	r4, .L428
1279:bluetooth_rxtx.c **** 
 3687              		.loc 1 1279 0
 3688 0006 794A     		ldr	r2, .L428+4
1278:bluetooth_rxtx.c **** 	last_hop = clkn;
 3689              		.loc 1 1278 0
 3690 0008 E372     		strb	r3, [r4, #11]
1279:bluetooth_rxtx.c **** 
 3691              		.loc 1 1279 0
 3692 000a 794B     		ldr	r3, .L428+8
 3693 000c 1968     		ldr	r1, [r3]
 3694 000e 1160     		str	r1, [r2]
1282:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
 3695              		.loc 1 1282 0
 3696 0010 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3697 0012 5AB9     		cbnz	r2, .L389
1283:bluetooth_rxtx.c **** 			return;
 3698              		.loc 1 1283 0
 3699 0014 0220     		movs	r0, #2
 3700 0016 FFF7FEFF 		bl	cc2400_get
 3701              	.LVL425:
 3702 001a 764B     		ldr	r3, .L428+12
 3703 001c B3F84C30 		ldrh	r3, [r3, #76]
 3704 0020 9BB2     		uxth	r3, r3
 3705 0022 013B     		subs	r3, r3, #1
 3706 0024 9842     		cmp	r0, r3
 3707 0026 3DD1     		bne	.L391
 3708              	.L388:
1355:bluetooth_rxtx.c **** 
 3709              		.loc 1 1355 0
 3710 0028 03B0     		add	sp, sp, #12
 3711              		.cfi_remember_state
ARM GAS  /tmp/ccLwKaeN.s 			page 114


 3712              		.cfi_def_cfa_offset 20
 3713              		@ sp needed
 3714 002a F0BD     		pop	{r4, r5, r6, r7, pc}
 3715              	.L389:
 3716              		.cfi_restore_state
1289:bluetooth_rxtx.c **** 		do {
 3717              		.loc 1 1289 0
 3718 002c A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3719 002e 012A     		cmp	r2, #1
 3720 0030 65D1     		bne	.L392
1291:bluetooth_rxtx.c **** 			if (channel > 2480)
 3721              		.loc 1 1291 0
 3722 0032 7049     		ldr	r1, .L428+12
1294:bluetooth_rxtx.c **** 	}
 3723              		.loc 1 1294 0
 3724 0034 0826     		movs	r6, #8
 3725 0036 0846     		mov	r0, r1
 3726 0038 6F4B     		ldr	r3, .L428+16
 3727 003a 704D     		ldr	r5, .L428+20
 3728 003c 1F78     		ldrb	r7, [r3]	@ zero_extendqisi2
 3729 003e 704B     		ldr	r3, .L428+24
 3730 0040 93F800E0 		ldrb	lr, [r3]	@ zero_extendqisi2
 3731              	.L395:
1291:bluetooth_rxtx.c **** 			if (channel > 2480)
 3732              		.loc 1 1291 0
 3733 0044 B1F84C30 		ldrh	r3, [r1, #76]
 3734 0048 2033     		adds	r3, r3, #32
 3735 004a 9BB2     		uxth	r3, r3
 3736 004c A1F84C30 		strh	r3, [r1, #76]	@ movhi
1292:bluetooth_rxtx.c **** 				channel -= 79;
 3737              		.loc 1 1292 0
 3738 0050 B1F84C30 		ldrh	r3, [r1, #76]
 3739 0054 9BB2     		uxth	r3, r3
 3740 0056 B3F51B6F 		cmp	r3, #2480
1293:bluetooth_rxtx.c **** 		} while ( used_channels != 0 && afh_enabled && !( afh_map[(channel-2402)/8] & 0x1<<((channel-2402
 3741              		.loc 1 1293 0
 3742 005a 81BF     		itttt	hi
 3743 005c B1F84C30 		ldrhhi	r3, [r1, #76]
 3744 0060 4F3B     		subhi	r3, r3, #79
 3745 0062 9BB2     		uxthhi	r3, r3
 3746 0064 A1F84C30 		strhhi	r3, [r1, #76]	@ movhi
1294:bluetooth_rxtx.c **** 	}
 3747              		.loc 1 1294 0
 3748 0068 E7B1     		cbz	r7, .L391
1294:bluetooth_rxtx.c **** 	}
 3749              		.loc 1 1294 0 is_stmt 0 discriminator 1
 3750 006a BEF1000F 		cmp	lr, #0
 3751 006e 19D0     		beq	.L391
1294:bluetooth_rxtx.c **** 	}
 3752              		.loc 1 1294 0 discriminator 2
 3753 0070 B0F84C20 		ldrh	r2, [r0, #76]
 3754 0074 B0F84C30 		ldrh	r3, [r0, #76]
 3755 0078 92B2     		uxth	r2, r2
 3756 007a A2F66212 		subw	r2, r2, #2402
 3757 007e 92FBF6F2 		sdiv	r2, r2, r6
 3758 0082 9BB2     		uxth	r3, r3
 3759 0084 A3F66213 		subw	r3, r3, #2402
ARM GAS  /tmp/ccLwKaeN.s 			page 115


 3760 0088 D3F1000C 		rsbs	ip, r3, #0
 3761 008c AA5C     		ldrb	r2, [r5, r2]	@ zero_extendqisi2
 3762 008e 0CF0070C 		and	ip, ip, #7
 3763 0092 03F00703 		and	r3, r3, #7
 3764 0096 58BF     		it	pl
 3765 0098 CCF10003 		rsbpl	r3, ip, #0
 3766 009c 42FA03F3 		asr	r3, r2, r3
 3767 00a0 DA07     		lsls	r2, r3, #31
 3768 00a2 CFD5     		bpl	.L395
 3769              	.L391:
1331:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 3770              		.loc 1 1331 0 is_stmt 1
 3771 00a4 6420     		movs	r0, #100
 3772 00a6 FFF7FEFF 		bl	cc2400_strobe
 3773              	.LVL426:
 3774              	.L402:
1332:bluetooth_rxtx.c **** 
 3775              		.loc 1 1332 0 discriminator 1
 3776 00aa FFF7FEFF 		bl	cc2400_status
 3777              	.LVL427:
 3778 00ae 4207     		lsls	r2, r0, #29
 3779 00b0 FBD4     		bmi	.L402
1335:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
 3780              		.loc 1 1335 0
 3781 00b2 607C     		ldrb	r0, [r4, #17]	@ zero_extendqisi2
 3782 00b4 4F4D     		ldr	r5, .L428+12
 3783 00b6 C0B2     		uxtb	r0, r0
1336:bluetooth_rxtx.c **** 	else
 3784              		.loc 1 1336 0
 3785 00b8 B5F84C10 		ldrh	r1, [r5, #76]
1335:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
 3786              		.loc 1 1335 0
 3787 00bc 0228     		cmp	r0, #2
1338:bluetooth_rxtx.c **** 
 3788              		.loc 1 1338 0
 3789 00be 17BF     		itett	ne
 3790 00c0 01F1FF31 		addne	r1, r1, #-1
1336:bluetooth_rxtx.c **** 	else
 3791              		.loc 1 1336 0
 3792 00c4 89B2     		uxtheq	r1, r1
1338:bluetooth_rxtx.c **** 
 3793              		.loc 1 1338 0
 3794 00c6 89B2     		uxthne	r1, r1
 3795 00c8 0220     		movne	r0, #2
 3796 00ca FFF7FEFF 		bl	cc2400_set
 3797              	.LVL428:
1341:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 3798              		.loc 1 1341 0
 3799 00ce A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3800 00d0 23B1     		cbz	r3, .L405
1342:bluetooth_rxtx.c **** 	}
 3801              		.loc 1 1342 0
 3802 00d2 B5F84C00 		ldrh	r0, [r5, #76]
 3803 00d6 80B2     		uxth	r0, r0
 3804 00d8 FFF7FEFF 		bl	cs_threshold_calc_and_set
 3805              	.LVL429:
 3806              	.L405:
ARM GAS  /tmp/ccLwKaeN.s 			page 116


1346:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3807              		.loc 1 1346 0
 3808 00dc 6120     		movs	r0, #97
 3809 00de FFF7FEFF 		bl	cc2400_strobe
 3810              	.LVL430:
 3811              	.L406:
1347:bluetooth_rxtx.c **** 
 3812              		.loc 1 1347 0 discriminator 1
 3813 00e2 FFF7FEFF 		bl	cc2400_status
 3814              	.LVL431:
 3815 00e6 4307     		lsls	r3, r0, #29
 3816 00e8 FBD5     		bpl	.L406
1349:bluetooth_rxtx.c **** 
 3817              		.loc 1 1349 0
 3818 00ea 0123     		movs	r3, #1
 3819 00ec 2374     		strb	r3, [r4, #16]
1351:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
 3820              		.loc 1 1351 0
 3821 00ee 637C     		ldrb	r3, [r4, #17]	@ zero_extendqisi2
 3822 00f0 022B     		cmp	r3, #2
1352:bluetooth_rxtx.c **** 	else
 3823              		.loc 1 1352 0
 3824 00f2 0CBF     		ite	eq
 3825 00f4 6320     		moveq	r0, #99
1354:bluetooth_rxtx.c **** }
 3826              		.loc 1 1354 0
 3827 00f6 6220     		movne	r0, #98
 3828 00f8 FFF7FEFF 		bl	cc2400_strobe
 3829              	.LVL432:
 3830 00fc 94E7     		b	.L388
 3831              	.L392:
1300:bluetooth_rxtx.c **** 		do {
 3832              		.loc 1 1300 0
 3833 00fe A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3834 0100 052A     		cmp	r2, #5
 3835 0102 34D1     		bne	.L396
1302:bluetooth_rxtx.c **** 			if (channel > 2480)
 3836              		.loc 1 1302 0
 3837 0104 3B49     		ldr	r1, .L428+12
1305:bluetooth_rxtx.c **** 	}
 3838              		.loc 1 1305 0
 3839 0106 0826     		movs	r6, #8
 3840 0108 0846     		mov	r0, r1
 3841 010a 3B4B     		ldr	r3, .L428+16
 3842 010c 3B4D     		ldr	r5, .L428+20
 3843 010e 1F78     		ldrb	r7, [r3]	@ zero_extendqisi2
 3844              	.L398:
1302:bluetooth_rxtx.c **** 			if (channel > 2480)
 3845              		.loc 1 1302 0
 3846 0110 B1F84C30 		ldrh	r3, [r1, #76]
 3847 0114 2033     		adds	r3, r3, #32
 3848 0116 9BB2     		uxth	r3, r3
 3849 0118 A1F84C30 		strh	r3, [r1, #76]	@ movhi
1303:bluetooth_rxtx.c **** 				channel -= 79;
 3850              		.loc 1 1303 0
 3851 011c B1F84C30 		ldrh	r3, [r1, #76]
 3852 0120 9BB2     		uxth	r3, r3
ARM GAS  /tmp/ccLwKaeN.s 			page 117


 3853 0122 B3F51B6F 		cmp	r3, #2480
1304:bluetooth_rxtx.c **** 		} while( used_channels != 79 && (afh_map[(channel-2402)/8] & 0x1<<((channel-2402)%8)) );
 3854              		.loc 1 1304 0
 3855 0126 81BF     		itttt	hi
 3856 0128 B1F84C30 		ldrhhi	r3, [r1, #76]
 3857 012c 4F3B     		subhi	r3, r3, #79
 3858 012e 9BB2     		uxthhi	r3, r3
 3859 0130 A1F84C30 		strhhi	r3, [r1, #76]	@ movhi
1305:bluetooth_rxtx.c **** 	}
 3860              		.loc 1 1305 0
 3861 0134 4F2F     		cmp	r7, #79
 3862 0136 B5D0     		beq	.L391
1305:bluetooth_rxtx.c **** 	}
 3863              		.loc 1 1305 0 is_stmt 0 discriminator 1
 3864 0138 B0F84C20 		ldrh	r2, [r0, #76]
 3865 013c B0F84C30 		ldrh	r3, [r0, #76]
 3866 0140 92B2     		uxth	r2, r2
 3867 0142 A2F66212 		subw	r2, r2, #2402
 3868 0146 92FBF6F2 		sdiv	r2, r2, r6
 3869 014a 9BB2     		uxth	r3, r3
 3870 014c A3F66213 		subw	r3, r3, #2402
 3871 0150 D3F1000E 		rsbs	lr, r3, #0
 3872 0154 AA5C     		ldrb	r2, [r5, r2]	@ zero_extendqisi2
 3873 0156 0EF0070E 		and	lr, lr, #7
 3874 015a 03F00703 		and	r3, r3, #7
 3875 015e 58BF     		it	pl
 3876 0160 CEF10003 		rsbpl	r3, lr, #0
 3877 0164 42FA03F3 		asr	r3, r2, r3
 3878 0168 DB07     		lsls	r3, r3, #31
 3879 016a D1D4     		bmi	.L398
 3880 016c 9AE7     		b	.L391
 3881              	.L396:
1308:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
 3882              		.loc 1 1308 0 is_stmt 1
 3883 016e A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3884 0170 022A     		cmp	r2, #2
 3885 0172 06D1     		bne	.L399
1309:bluetooth_rxtx.c **** 	}
 3886              		.loc 1 1309 0
 3887 0174 1868     		ldr	r0, [r3]
 3888 0176 FFF7FEFF 		bl	next_hop
 3889              	.LVL433:
 3890 017a 1E4B     		ldr	r3, .L428+12
 3891 017c A3F84C00 		strh	r0, [r3, #76]	@ movhi
 3892 0180 90E7     		b	.L391
 3893              	.L399:
1312:bluetooth_rxtx.c **** 		if(mapped == 1){
 3894              		.loc 1 1312 0
 3895 0182 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3896 0184 032B     		cmp	r3, #3
 3897 0186 25D1     		bne	.L400
1313:bluetooth_rxtx.c **** 			le.channel_idx = le_map_channel(le.channel_idx, &remapping);
 3898              		.loc 1 1313 0
 3899 0188 94F82C60 		ldrb	r6, [r4, #44]	@ zero_extendqisi2
 3900 018c 194D     		ldr	r5, .L428+12
 3901 018e 012E     		cmp	r6, #1
 3902 0190 1AD1     		bne	.L401
ARM GAS  /tmp/ccLwKaeN.s 			page 118


 3903              	.LBB37:
1314:bluetooth_rxtx.c **** 			//debug_printf("Current index: %d\n", le.channel_idx);
 3904              		.loc 1 1314 0
 3905 0192 1C49     		ldr	r1, .L428+28
 3906 0194 687D     		ldrb	r0, [r5, #21]	@ zero_extendqisi2
 3907 0196 FFF7FEFF 		bl	le_map_channel
 3908              	.LVL434:
 3909 019a 6875     		strb	r0, [r5, #21]
1316:bluetooth_rxtx.c **** 			u8 nxt_idx = le_map_channel(le.channel_idx, &remapping);
 3910              		.loc 1 1316 0
 3911 019c 2846     		mov	r0, r5
 3912 019e FFF7FEFF 		bl	btle_next_hop
 3913              	.LVL435:
1317:bluetooth_rxtx.c **** 			debug_printf("Next index: %d\n", nxt_idx);
 3914              		.loc 1 1317 0
 3915 01a2 1849     		ldr	r1, .L428+28
1316:bluetooth_rxtx.c **** 			u8 nxt_idx = le_map_channel(le.channel_idx, &remapping);
 3916              		.loc 1 1316 0
 3917 01a4 A5F84C00 		strh	r0, [r5, #76]	@ movhi
1317:bluetooth_rxtx.c **** 			debug_printf("Next index: %d\n", nxt_idx);
 3918              		.loc 1 1317 0
 3919 01a8 687D     		ldrb	r0, [r5, #21]	@ zero_extendqisi2
 3920 01aa FFF7FEFF 		bl	le_map_channel
 3921              	.LVL436:
 3922 01ae 02AD     		add	r5, sp, #8
 3923 01b0 05F8010D 		strb	r0, [r5, #-1]!
 3924 01b4 0146     		mov	r1, r0
1318:bluetooth_rxtx.c **** 			le_promisc_state(4, &nxt_idx, 1);
 3925              		.loc 1 1318 0
 3926 01b6 1448     		ldr	r0, .L428+32
 3927 01b8 FFF7FEFF 		bl	debug_printf
 3928              	.LVL437:
1319:bluetooth_rxtx.c **** 		}
 3929              		.loc 1 1319 0
 3930 01bc 3246     		mov	r2, r6
 3931 01be 2946     		mov	r1, r5
 3932 01c0 0420     		movs	r0, #4
 3933 01c2 FFF7FEFF 		bl	le_promisc_state
 3934              	.LVL438:
 3935              	.LBE37:
 3936 01c6 6DE7     		b	.L391
 3937              	.L401:
1322:bluetooth_rxtx.c **** 		}
 3938              		.loc 1 1322 0
 3939 01c8 2846     		mov	r0, r5
 3940 01ca FFF7FEFF 		bl	btle_next_hop
 3941              	.LVL439:
 3942 01ce A5F84C00 		strh	r0, [r5, #76]	@ movhi
 3943 01d2 67E7     		b	.L391
 3944              	.L400:
1327:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
 3945              		.loc 1 1327 0
 3946 01d4 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3947 01d6 042B     		cmp	r3, #4
1328:bluetooth_rxtx.c **** 	}
 3948              		.loc 1 1328 0
 3949 01d8 01BF     		itttt	eq
ARM GAS  /tmp/ccLwKaeN.s 			page 119


 3950 01da A389     		ldrheq	r3, [r4, #12]
 3951 01dc 054A     		ldreq	r2, .L428+12
 3952 01de 9BB2     		uxtheq	r3, r3
 3953 01e0 A2F84C30 		strheq	r3, [r2, #76]	@ movhi
 3954 01e4 5EE7     		b	.L391
 3955              	.L429:
 3956 01e6 00BF     		.align	2
 3957              	.L428:
 3958 01e8 00000000 		.word	.LANCHOR1
 3959 01ec 00000000 		.word	last_hop
 3960 01f0 00000000 		.word	clkn
 3961 01f4 00000000 		.word	.LANCHOR0
 3962 01f8 00000000 		.word	used_channels
 3963 01fc 00000000 		.word	afh_map
 3964 0200 00000000 		.word	afh_enabled
 3965 0204 00000000 		.word	remapping
 3966 0208 50000000 		.word	.LC7
 3967              		.cfi_endproc
 3968              	.LFE14:
 3970              		.section	.text.bt_stream_rx,"ax",%progbits
 3971              		.align	1
 3972              		.global	bt_stream_rx
 3973              		.syntax unified
 3974              		.thumb
 3975              		.thumb_func
 3976              		.fpu softvfp
 3978              	bt_stream_rx:
 3979              	.LFB15:
1359:bluetooth_rxtx.c **** 	int8_t rssi;
 3980              		.loc 1 1359 0
 3981              		.cfi_startproc
 3982              		@ args = 0, pretend = 0, frame = 0
 3983              		@ frame_needed = 0, uses_anonymous_args = 0
 3984 0000 2DE9F84F 		push	{r3, r4, r5, r6, r7, r8, r9, r10, fp, lr}
 3985              		.cfi_def_cfa_offset 40
 3986              		.cfi_offset 3, -40
 3987              		.cfi_offset 4, -36
 3988              		.cfi_offset 5, -32
 3989              		.cfi_offset 6, -28
 3990              		.cfi_offset 7, -24
 3991              		.cfi_offset 8, -20
 3992              		.cfi_offset 9, -16
 3993              		.cfi_offset 10, -12
 3994              		.cfi_offset 11, -8
 3995              		.cfi_offset 14, -4
1363:bluetooth_rxtx.c **** 
 3996              		.loc 1 1363 0
 3997 0004 1023     		movs	r3, #16
 3998 0006 4E4E     		ldr	r6, .L462
1374:bluetooth_rxtx.c **** 	{
 3999              		.loc 1 1374 0
 4000 0008 4E4F     		ldr	r7, .L462+4
1363:bluetooth_rxtx.c **** 
 4001              		.loc 1 1363 0
 4002 000a 3360     		str	r3, [r6]
1365:bluetooth_rxtx.c **** 	dio_ssp_init();
 4003              		.loc 1 1365 0
ARM GAS  /tmp/ccLwKaeN.s 			page 120


 4004 000c FFF7FEFF 		bl	usb_queue_init
 4005              	.LVL440:
 4006 0010 3C46     		mov	r4, r7
1366:bluetooth_rxtx.c **** 	dma_init_rx_symbols();
 4007              		.loc 1 1366 0
 4008 0012 FFF7FEFF 		bl	dio_ssp_init
 4009              	.LVL441:
1367:bluetooth_rxtx.c **** 	dio_ssp_start();
 4010              		.loc 1 1367 0
 4011 0016 FFF7FEFF 		bl	dma_init_rx_symbols
 4012              	.LVL442:
1368:bluetooth_rxtx.c **** 
 4013              		.loc 1 1368 0
 4014 001a FFF7FEFF 		bl	dio_ssp_start
 4015              	.LVL443:
1370:bluetooth_rxtx.c **** 
 4016              		.loc 1 1370 0
 4017 001e FFF7FEFF 		bl	cc2400_rx
 4018              	.LVL444:
1372:bluetooth_rxtx.c **** 
 4019              		.loc 1 1372 0
 4020 0022 FFF7FEFF 		bl	cs_trigger_enable
 4021              	.LVL445:
1411:bluetooth_rxtx.c **** 
 4022              		.loc 1 1411 0
 4023 0026 DFF838B1 		ldr	fp, .L462+32
 4024              	.L431:
1374:bluetooth_rxtx.c **** 	{
 4025              		.loc 1 1374 0
 4026 002a BB7C     		ldrb	r3, [r7, #18]	@ zero_extendqisi2
 4027 002c 012B     		cmp	r3, #1
 4028 002e 08D0     		beq	.L443
1374:bluetooth_rxtx.c **** 	{
 4029              		.loc 1 1374 0 is_stmt 0 discriminator 1
 4030 0030 BB7C     		ldrb	r3, [r7, #18]	@ zero_extendqisi2
 4031 0032 082B     		cmp	r3, #8
 4032 0034 05D0     		beq	.L443
1448:bluetooth_rxtx.c **** 	cs_trigger_disable();
 4033              		.loc 1 1448 0 is_stmt 1
 4034 0036 FFF7FEFF 		bl	dio_ssp_stop
 4035              	.LVL446:
1450:bluetooth_rxtx.c **** 
 4036              		.loc 1 1450 0
 4037 003a BDE8F84F 		pop	{r3, r4, r5, r6, r7, r8, r9, r10, fp, lr}
 4038              		.cfi_remember_state
 4039              		.cfi_restore 14
 4040              		.cfi_restore 11
 4041              		.cfi_restore 10
 4042              		.cfi_restore 9
 4043              		.cfi_restore 8
 4044              		.cfi_restore 7
 4045              		.cfi_restore 6
 4046              		.cfi_restore 5
 4047              		.cfi_restore 4
 4048              		.cfi_restore 3
 4049              		.cfi_def_cfa_offset 0
1449:bluetooth_rxtx.c **** }
ARM GAS  /tmp/ccLwKaeN.s 			page 121


 4050              		.loc 1 1449 0
 4051 003e FFF7FEBF 		b	cs_trigger_disable
 4052              	.LVL447:
 4053              	.L443:
 4054              		.cfi_restore_state
1377:bluetooth_rxtx.c **** 
 4055              		.loc 1 1377 0
 4056 0042 1023     		movs	r3, #16
 4057 0044 3360     		str	r3, [r6]
1389:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 4058              		.loc 1 1389 0
 4059 0046 FFF7FEFF 		bl	rssi_reset
 4060              	.LVL448:
1390:bluetooth_rxtx.c **** 		while (!rx_tc) {
 4061              		.loc 1 1390 0
 4062 004a 6FF07F05 		mvn	r5, #127
1391:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
 4063              		.loc 1 1391 0
 4064 004e DFF81481 		ldr	r8, .L462+36
 4065 0052 DFF81491 		ldr	r9, .L462+40
 4066              	.LVL449:
 4067              	.L432:
 4068 0056 D8F80030 		ldr	r3, [r8]
 4069 005a DFF810A1 		ldr	r10, .L462+44
 4070 005e 002B     		cmp	r3, #0
 4071 0060 49D0     		beq	.L436
1411:bluetooth_rxtx.c **** 
 4072              		.loc 1 1411 0
 4073 0062 1023     		movs	r3, #16
1413:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 4074              		.loc 1 1413 0
 4075 0064 384D     		ldr	r5, .L462+8
 4076              	.LVL450:
1411:bluetooth_rxtx.c **** 
 4077              		.loc 1 1411 0
 4078 0066 CBF80030 		str	r3, [fp]
1413:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 4079              		.loc 1 1413 0
 4080 006a 2B68     		ldr	r3, [r5]
 4081 006c 1BB1     		cbz	r3, .L437
1414:bluetooth_rxtx.c **** 		}
 4082              		.loc 1 1414 0
 4083 006e 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4084 0070 43F00203 		orr	r3, r3, #2
 4085 0074 6370     		strb	r3, [r4, #1]
 4086              	.L437:
1418:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 4087              		.loc 1 1418 0
 4088 0076 D8F80030 		ldr	r3, [r8]
 4089 007a 012B     		cmp	r3, #1
1419:bluetooth_rxtx.c **** 
 4090              		.loc 1 1419 0
 4091 007c 82BF     		ittt	hi
 4092 007e 6378     		ldrbhi	r3, [r4, #1]	@ zero_extendqisi2
 4093 0080 43F00103 		orrhi	r3, r3, #1
 4094 0084 6370     		strbhi	r3, [r4, #1]
1421:bluetooth_rxtx.c **** 			status |= DISCARD;
ARM GAS  /tmp/ccLwKaeN.s 			page 122


 4095              		.loc 1 1421 0
 4096 0086 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
 4097 0088 2BB1     		cbz	r3, .L439
1422:bluetooth_rxtx.c **** 			dma_discard = 0;
 4098              		.loc 1 1422 0
 4099 008a 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4100 008c 43F02003 		orr	r3, r3, #32
 4101 0090 6370     		strb	r3, [r4, #1]
1423:bluetooth_rxtx.c **** 		}
 4102              		.loc 1 1423 0
 4103 0092 0023     		movs	r3, #0
 4104 0094 2374     		strb	r3, [r4, #16]
 4105              	.L439:
1426:bluetooth_rxtx.c **** 
 4106              		.loc 1 1426 0
 4107 0096 2D4B     		ldr	r3, .L462+12
 4108 0098 B3F84C00 		ldrh	r0, [r3, #76]
 4109 009c 80B2     		uxth	r0, r0
 4110 009e FFF7FEFF 		bl	rssi_iir_update
 4111              	.LVL451:
1432:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4112              		.loc 1 1432 0
 4113 00a2 99F80030 		ldrb	r3, [r9]	@ zero_extendqisi2
 4114 00a6 13B9     		cbnz	r3, .L440
1432:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4115              		.loc 1 1432 0 is_stmt 0 discriminator 1
 4116 00a8 294B     		ldr	r3, .L462+16
 4117 00aa 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 4118 00ac 33B1     		cbz	r3, .L441
 4119              	.L440:
1433:bluetooth_rxtx.c **** 			cs_trigger = 0;
 4120              		.loc 1 1433 0 is_stmt 1
 4121 00ae 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4122 00b0 43F00803 		orr	r3, r3, #8
 4123 00b4 6370     		strb	r3, [r4, #1]
1434:bluetooth_rxtx.c **** 		}
 4124              		.loc 1 1434 0
 4125 00b6 0023     		movs	r3, #0
 4126 00b8 89F80030 		strb	r3, [r9]
 4127              	.L441:
1437:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 4128              		.loc 1 1437 0
 4129 00bc 254B     		ldr	r3, .L462+20
 4130 00be 264A     		ldr	r2, .L462+24
 4131 00c0 93F90030 		ldrsb	r3, [r3]
 4132 00c4 92F90020 		ldrsb	r2, [r2]
 4133 00c8 3533     		adds	r3, r3, #53
 4134 00ca 9342     		cmp	r3, r2
1438:bluetooth_rxtx.c **** 		}
 4135              		.loc 1 1438 0
 4136 00cc B8BF     		it	lt
 4137 00ce 6378     		ldrblt	r3, [r4, #1]	@ zero_extendqisi2
1441:bluetooth_rxtx.c **** 
 4138              		.loc 1 1441 0
 4139 00d0 4FF00000 		mov	r0, #0
1438:bluetooth_rxtx.c **** 		}
 4140              		.loc 1 1438 0
ARM GAS  /tmp/ccLwKaeN.s 			page 123


 4141 00d4 BCBF     		itt	lt
 4142 00d6 43F01003 		orrlt	r3, r3, #16
 4143 00da 6370     		strblt	r3, [r4, #1]
1441:bluetooth_rxtx.c **** 
 4144              		.loc 1 1441 0
 4145 00dc 1F4B     		ldr	r3, .L462+28
 4146 00de 1968     		ldr	r1, [r3]
 4147 00e0 FFF7FEFF 		bl	enqueue
 4148              	.LVL452:
1443:bluetooth_rxtx.c **** 		rx_tc = 0;
 4149              		.loc 1 1443 0
 4150 00e4 DAF80000 		ldr	r0, [r10]
 4151 00e8 FFF7FEFF 		bl	handle_usb
 4152              	.LVL453:
1444:bluetooth_rxtx.c **** 		rx_err = 0;
 4153              		.loc 1 1444 0
 4154 00ec 0023     		movs	r3, #0
 4155 00ee C8F80030 		str	r3, [r8]
1445:bluetooth_rxtx.c **** 	}
 4156              		.loc 1 1445 0
 4157 00f2 2B60     		str	r3, [r5]
 4158 00f4 99E7     		b	.L431
 4159              	.LVL454:
 4160              	.L436:
1392:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4161              		.loc 1 1392 0
 4162 00f6 0620     		movs	r0, #6
 4163 00f8 FFF7FEFF 		bl	cc2400_get
 4164              	.LVL455:
1393:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4165              		.loc 1 1393 0
 4166 00fc 99F80030 		ldrb	r3, [r9]	@ zero_extendqisi2
1392:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4167              		.loc 1 1392 0
 4168 0100 40F30720 		sbfx	r0, r0, #8, #8
 4169              	.LVL456:
1393:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4170              		.loc 1 1393 0
 4171 0104 63B1     		cbz	r3, .L433
1393:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4172              		.loc 1 1393 0 is_stmt 0 discriminator 1
 4173 0106 15F1800F 		cmn	r5, #128
 4174 010a 09D1     		bne	.L433
1394:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 4175              		.loc 1 1394 0 is_stmt 1
 4176 010c 114B     		ldr	r3, .L462+20
 4177 010e 93F90030 		ldrsb	r3, [r3]
 4178 0112 03F13605 		add	r5, r3, #54
 4179              	.LVL457:
 4180 0116 A842     		cmp	r0, r5
 4181 0118 B8BF     		it	lt
 4182 011a 2846     		movlt	r0, r5
 4183              	.LVL458:
 4184 011c 45B2     		sxtb	r5, r0
1395:bluetooth_rxtx.c **** 			}
 4185              		.loc 1 1395 0
 4186 011e 2846     		mov	r0, r5
ARM GAS  /tmp/ccLwKaeN.s 			page 124


 4187              	.L433:
 4188              	.LVL459:
1397:bluetooth_rxtx.c **** 
 4189              		.loc 1 1397 0
 4190 0120 FFF7FEFF 		bl	rssi_add
 4191              	.LVL460:
1399:bluetooth_rxtx.c **** 
 4192              		.loc 1 1399 0
 4193 0124 DAF80000 		ldr	r0, [r10]
 4194 0128 FFF7FEFF 		bl	handle_usb
 4195              	.LVL461:
1402:bluetooth_rxtx.c **** 				hop();
 4196              		.loc 1 1402 0
 4197 012c E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 4198 012e 13B1     		cbz	r3, .L434
1403:bluetooth_rxtx.c **** 			} else {
 4199              		.loc 1 1403 0
 4200 0130 FFF7FEFF 		bl	hop
 4201              	.LVL462:
 4202 0134 8FE7     		b	.L432
 4203              	.L434:
1405:bluetooth_rxtx.c **** 			}
 4204              		.loc 1 1405 0
 4205 0136 4FF48073 		mov	r3, #256
 4206 013a 3360     		str	r3, [r6]
 4207 013c 8BE7     		b	.L432
 4208              	.L463:
 4209 013e 00BF     		.align	2
 4210              	.L462:
 4211 0140 3CC00920 		.word	537509948
 4212 0144 00000000 		.word	.LANCHOR1
 4213 0148 00000000 		.word	rx_err
 4214 014c 00000000 		.word	.LANCHOR0
 4215 0150 00000000 		.word	cs_no_squelch
 4216 0154 00000000 		.word	cs_threshold_cur
 4217 0158 00000000 		.word	rssi_max
 4218 015c 00000000 		.word	idle_rxbuf
 4219 0160 38C00920 		.word	537509944
 4220 0164 00000000 		.word	rx_tc
 4221 0168 00000000 		.word	cs_trigger
 4222 016c 00000000 		.word	clkn
 4223              		.cfi_endproc
 4224              	.LFE15:
 4226              		.section	.text.br_transmit,"ax",%progbits
 4227              		.align	1
 4228              		.global	br_transmit
 4229              		.syntax unified
 4230              		.thumb
 4231              		.thumb_func
 4232              		.fpu softvfp
 4234              	br_transmit:
 4235              	.LFB18:
1482:bluetooth_rxtx.c **** 	uint16_t gio_save;
 4236              		.loc 1 1482 0
 4237              		.cfi_startproc
 4238              		@ args = 0, pretend = 0, frame = 16
 4239              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/ccLwKaeN.s 			page 125


 4240 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 4241              		.cfi_def_cfa_offset 28
 4242              		.cfi_offset 4, -28
 4243              		.cfi_offset 5, -24
 4244              		.cfi_offset 6, -20
 4245              		.cfi_offset 7, -16
 4246              		.cfi_offset 8, -12
 4247              		.cfi_offset 9, -8
 4248              		.cfi_offset 14, -4
 4249 0004 85B0     		sub	sp, sp, #20
 4250              		.cfi_def_cfa_offset 48
 4251              	.LVL463:
1487:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 4252              		.loc 1 1487 0
 4253 0006 954B     		ldr	r3, .L503
1488:bluetooth_rxtx.c **** 
 4254              		.loc 1 1488 0
 4255 0008 0027     		movs	r7, #0
1487:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 4256              		.loc 1 1487 0
 4257 000a D3E90245 		ldrd	r4, [r3, #8]
 4258 000e 0023     		movs	r3, #0
 4259 0010 04F00102 		and	r2, r4, #1
 4260 0014 1343     		orrs	r3, r2, r3
 4261 0016 4AF6AA23 		movw	r3, #43690
1488:bluetooth_rxtx.c **** 
 4262              		.loc 1 1488 0
 4263 001a 4FEAD576 		lsr	r6, r5, #31
1487:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 4264              		.loc 1 1487 0
 4265 001e 45F25558 		movw	r8, #21845
 4266 0022 08BF     		it	eq
 4267 0024 9846     		moveq	r8, r3
 4268              	.LVL464:
1488:bluetooth_rxtx.c **** 
 4269              		.loc 1 1488 0
 4270 0026 002F     		cmp	r7, #0
 4271 0028 08BF     		it	eq
 4272 002a 012E     		cmpeq	r6, #1
1491:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
 4273              		.loc 1 1491 0
 4274 002c E0B2     		uxtb	r0, r4
1488:bluetooth_rxtx.c **** 
 4275              		.loc 1 1488 0
 4276 002e 0CBF     		ite	eq
 4277 0030 AA26     		moveq	r6, #170
 4278 0032 5526     		movne	r6, #85
 4279              	.LVL465:
1491:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
 4280              		.loc 1 1491 0
 4281 0034 FFF7FEFF 		bl	reverse8
 4282              	.LVL466:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4283              		.loc 1 1490 0
 4284 0038 8DF80000 		strb	r0, [sp]
1492:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 16) & 0xFF),
 4285              		.loc 1 1492 0
ARM GAS  /tmp/ccLwKaeN.s 			page 126


 4286 003c C4F30720 		ubfx	r0, r4, #8, #8
 4287 0040 FFF7FEFF 		bl	reverse8
 4288              	.LVL467:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4289              		.loc 1 1490 0
 4290 0044 8DF80100 		strb	r0, [sp, #1]
1493:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 24) & 0xFF),
 4291              		.loc 1 1493 0
 4292 0048 C4F30740 		ubfx	r0, r4, #16, #8
 4293 004c FFF7FEFF 		bl	reverse8
 4294              	.LVL468:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4295              		.loc 1 1490 0
 4296 0050 8DF80200 		strb	r0, [sp, #2]
1494:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 32) & 0xFF),
 4297              		.loc 1 1494 0
 4298 0054 200E     		lsrs	r0, r4, #24
 4299 0056 FFF7FEFF 		bl	reverse8
 4300              	.LVL469:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4301              		.loc 1 1490 0
 4302 005a 8DF80300 		strb	r0, [sp, #3]
1495:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 40) & 0xFF),
 4303              		.loc 1 1495 0
 4304 005e E8B2     		uxtb	r0, r5
 4305 0060 FFF7FEFF 		bl	reverse8
 4306              	.LVL470:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4307              		.loc 1 1490 0
 4308 0064 8DF80400 		strb	r0, [sp, #4]
1496:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 48) & 0xFF),
 4309              		.loc 1 1496 0
 4310 0068 C5F30720 		ubfx	r0, r5, #8, #8
 4311 006c FFF7FEFF 		bl	reverse8
 4312              	.LVL471:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4313              		.loc 1 1490 0
 4314 0070 8DF80500 		strb	r0, [sp, #5]
1497:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 56) & 0xFF),
 4315              		.loc 1 1497 0
 4316 0074 C5F30740 		ubfx	r0, r5, #16, #8
 4317 0078 FFF7FEFF 		bl	reverse8
 4318              	.LVL472:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4319              		.loc 1 1490 0
 4320 007c 8DF80600 		strb	r0, [sp, #6]
1498:bluetooth_rxtx.c **** 		reverse8(trailer),
 4321              		.loc 1 1498 0
 4322 0080 280E     		lsrs	r0, r5, #24
 4323 0082 FFF7FEFF 		bl	reverse8
 4324              	.LVL473:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4325              		.loc 1 1490 0
 4326 0086 8DF80700 		strb	r0, [sp, #7]
1499:bluetooth_rxtx.c **** 		reverse8(0x77),
 4327              		.loc 1 1499 0
 4328 008a 3046     		mov	r0, r6
ARM GAS  /tmp/ccLwKaeN.s 			page 127


 4329 008c FFF7FEFF 		bl	reverse8
 4330              	.LVL474:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4331              		.loc 1 1490 0
 4332 0090 8DF80800 		strb	r0, [sp, #8]
1500:bluetooth_rxtx.c **** 		reverse8(0x66),
 4333              		.loc 1 1500 0
 4334 0094 7720     		movs	r0, #119
 4335 0096 FFF7FEFF 		bl	reverse8
 4336              	.LVL475:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4337              		.loc 1 1490 0
 4338 009a 8DF80900 		strb	r0, [sp, #9]
1501:bluetooth_rxtx.c **** 		reverse8(0x55),
 4339              		.loc 1 1501 0
 4340 009e 6620     		movs	r0, #102
 4341 00a0 FFF7FEFF 		bl	reverse8
 4342              	.LVL476:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4343              		.loc 1 1490 0
 4344 00a4 8DF80A00 		strb	r0, [sp, #10]
1502:bluetooth_rxtx.c **** 		reverse8(0x44),
 4345              		.loc 1 1502 0
 4346 00a8 5520     		movs	r0, #85
 4347 00aa FFF7FEFF 		bl	reverse8
 4348              	.LVL477:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4349              		.loc 1 1490 0
 4350 00ae 8DF80B00 		strb	r0, [sp, #11]
1503:bluetooth_rxtx.c **** 		reverse8(0x33),
 4351              		.loc 1 1503 0
 4352 00b2 4420     		movs	r0, #68
 4353 00b4 FFF7FEFF 		bl	reverse8
 4354              	.LVL478:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4355              		.loc 1 1490 0
 4356 00b8 8DF80C00 		strb	r0, [sp, #12]
1504:bluetooth_rxtx.c **** 		reverse8(0x22),
 4357              		.loc 1 1504 0
 4358 00bc 3320     		movs	r0, #51
 4359 00be FFF7FEFF 		bl	reverse8
 4360              	.LVL479:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4361              		.loc 1 1490 0
 4362 00c2 8DF80D00 		strb	r0, [sp, #13]
1505:bluetooth_rxtx.c **** 		reverse8(0x11)
 4363              		.loc 1 1505 0
 4364 00c6 2220     		movs	r0, #34
 4365 00c8 FFF7FEFF 		bl	reverse8
 4366              	.LVL480:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4367              		.loc 1 1490 0
 4368 00cc 8DF80E00 		strb	r0, [sp, #14]
1506:bluetooth_rxtx.c **** 	};
 4369              		.loc 1 1506 0
 4370 00d0 1120     		movs	r0, #17
 4371 00d2 FFF7FEFF 		bl	reverse8
ARM GAS  /tmp/ccLwKaeN.s 			page 128


 4372              	.LVL481:
 4373              	.LBB43:
 4374              	.LBB44:
1466:bluetooth_rxtx.c **** 
 4375              		.loc 1 1466 0
 4376 00d6 3C46     		mov	r4, r7
 4377              	.LBB45:
1468:bluetooth_rxtx.c **** 	{
 4378              		.loc 1 1468 0
 4379 00d8 3B46     		mov	r3, r7
 4380              	.LBE45:
 4381              	.LBE44:
 4382              	.LBE43:
1490:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4383              		.loc 1 1490 0
 4384 00da 8DF80F00 		strb	r0, [sp, #15]
 4385              	.LVL482:
 4386              	.L467:
 4387              	.LBB48:
 4388              	.LBB47:
 4389              	.LBB46:
1470:bluetooth_rxtx.c **** 	}
 4390              		.loc 1 1470 0
 4391 00de 48FA03F2 		asr	r2, r8, r3
 4392 00e2 C3F10F01 		rsb	r1, r3, #15
 4393 00e6 02F00102 		and	r2, r2, #1
 4394 00ea 8A40     		lsls	r2, r2, r1
1468:bluetooth_rxtx.c **** 	{
 4395              		.loc 1 1468 0
 4396 00ec 0133     		adds	r3, r3, #1
 4397              	.LVL483:
1470:bluetooth_rxtx.c **** 	}
 4398              		.loc 1 1470 0
 4399 00ee 1443     		orrs	r4, r4, r2
 4400              	.LVL484:
1468:bluetooth_rxtx.c **** 	{
 4401              		.loc 1 1468 0
 4402 00f0 102B     		cmp	r3, #16
1470:bluetooth_rxtx.c **** 	}
 4403              		.loc 1 1470 0
 4404 00f2 A4B2     		uxth	r4, r4
 4405              	.LVL485:
1468:bluetooth_rxtx.c **** 	{
 4406              		.loc 1 1468 0
 4407 00f4 F3D1     		bne	.L467
 4408              	.LVL486:
 4409              	.LBE46:
 4410              	.LBE47:
 4411              	.LBE48:
 4412              	.LBB49:
 4413              	.LBB50:
1117:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 4414              		.loc 1 1117 0
 4415 00f6 47F6FF71 		movw	r1, #32767
 4416 00fa 0D20     		movs	r0, #13
 4417 00fc FFF7FEFF 		bl	cc2400_set
 4418              	.LVL487:
ARM GAS  /tmp/ccLwKaeN.s 			page 129


1118:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 4419              		.loc 1 1118 0
 4420 0100 42F62231 		movw	r1, #11042
 4421 0104 1220     		movs	r0, #18
 4422 0106 FFF7FEFF 		bl	cc2400_set
 4423              	.LVL488:
1119:bluetooth_rxtx.c **** 
 4424              		.loc 1 1119 0
 4425 010a 41F24B31 		movw	r1, #4939
 4426 010e 1420     		movs	r0, #20
 4427 0110 FFF7FEFF 		bl	cc2400_set
 4428              	.LVL489:
1121:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 4429              		.loc 1 1121 0
 4430 0114 40F60141 		movw	r1, #3073
 4431 0118 2020     		movs	r0, #32
 4432 011a FFF7FEFF 		bl	cc2400_set
 4433              	.LVL490:
1129:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 4434              		.loc 1 1129 0
 4435 011e 2146     		mov	r1, r4
 4436 0120 2C20     		movs	r0, #44
 4437 0122 FFF7FEFF 		bl	cc2400_set
 4438              	.LVL491:
1130:bluetooth_rxtx.c **** 
 4439              		.loc 1 1130 0
 4440 0126 0021     		movs	r1, #0
 4441 0128 2D20     		movs	r0, #45
 4442 012a FFF7FEFF 		bl	cc2400_set
 4443              	.LVL492:
1132:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 4444              		.loc 1 1132 0
 4445 012e 4C4B     		ldr	r3, .L503+4
 4446 0130 0220     		movs	r0, #2
 4447 0132 B3F84C10 		ldrh	r1, [r3, #76]
1135:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
 4448              		.loc 1 1135 0
 4449 0136 4B4C     		ldr	r4, .L503+8
 4450              	.LVL493:
1132:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 4451              		.loc 1 1132 0
 4452 0138 89B2     		uxth	r1, r1
 4453 013a FFF7FEFF 		bl	cc2400_set
 4454              	.LVL494:
1133:bluetooth_rxtx.c **** 
 4455              		.loc 1 1133 0
 4456 013e 0B21     		movs	r1, #11
 4457 0140 0520     		movs	r0, #5
 4458 0142 FFF7FEFF 		bl	cc2400_set
 4459              	.LVL495:
1135:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
 4460              		.loc 1 1135 0
 4461 0146 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 4462 0148 BBBB     		cbnz	r3, .L468
1136:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
 4463              		.loc 1 1136 0
 4464 014a 2921     		movs	r1, #41
ARM GAS  /tmp/ccLwKaeN.s 			page 130


 4465              	.L502:
1138:bluetooth_rxtx.c **** 	} else {
 4466              		.loc 1 1138 0
 4467 014c 0320     		movs	r0, #3
 4468 014e FFF7FEFF 		bl	cc2400_set
 4469              	.LVL496:
1144:bluetooth_rxtx.c **** 
 4470              		.loc 1 1144 0
 4471 0152 FFF7FEFF 		bl	clkn_start
 4472              	.LVL497:
 4473              	.L471:
1146:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 4474              		.loc 1 1146 0
 4475 0156 FFF7FEFF 		bl	cc2400_status
 4476              	.LVL498:
 4477 015a 4506     		lsls	r5, r0, #25
 4478 015c FBD5     		bpl	.L471
1147:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 4479              		.loc 1 1147 0
 4480 015e 6120     		movs	r0, #97
 4481 0160 FFF7FEFF 		bl	cc2400_strobe
 4482              	.LVL499:
 4483              	.L472:
1148:bluetooth_rxtx.c **** 
 4484              		.loc 1 1148 0
 4485 0164 FFF7FEFF 		bl	cc2400_status
 4486              	.LVL500:
 4487 0168 4007     		lsls	r0, r0, #29
 4488 016a FBD5     		bpl	.L472
1151:bluetooth_rxtx.c **** #endif
 4489              		.loc 1 1151 0
 4490 016c 8022     		movs	r2, #128
 4491 016e 3E4B     		ldr	r3, .L503+12
 4492 0170 1A60     		str	r2, [r3]
 4493              	.L473:
1154:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 4494              		.loc 1 1154 0
 4495 0172 0E20     		movs	r0, #14
 4496 0174 FFF7FEFF 		bl	cc2400_get
 4497              	.LVL501:
 4498 0178 00F01F00 		and	r0, r0, #31
 4499 017c 0F28     		cmp	r0, #15
 4500 017e F8D1     		bne	.L473
1155:bluetooth_rxtx.c **** 
 4501              		.loc 1 1155 0
 4502 0180 6320     		movs	r0, #99
 4503 0182 FFF7FEFF 		bl	cc2400_strobe
 4504              	.LVL502:
 4505              	.L470:
 4506              	.LBE50:
 4507              	.LBE49:
1511:bluetooth_rxtx.c **** 
 4508              		.loc 1 1511 0 discriminator 4
 4509 0186 1421     		movs	r1, #20
 4510 0188 2320     		movs	r0, #35
 4511 018a FFF7FEFF 		bl	cc2400_set
 4512              	.LVL503:
ARM GAS  /tmp/ccLwKaeN.s 			page 131


1514:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 4513              		.loc 1 1514 0 discriminator 4
 4514 018e 0820     		movs	r0, #8
 4515 0190 FFF7FEFF 		bl	cc2400_get
 4516              	.LVL504:
1515:bluetooth_rxtx.c **** 
 4517              		.loc 1 1515 0 discriminator 4
 4518 0194 C0F30801 		ubfx	r1, r0, #0, #9
1514:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 4519              		.loc 1 1514 0 discriminator 4
 4520 0198 0746     		mov	r7, r0
 4521              	.LVL505:
1515:bluetooth_rxtx.c **** 
 4522              		.loc 1 1515 0 discriminator 4
 4523 019a 41F49C41 		orr	r1, r1, #19968
 4524 019e 0820     		movs	r0, #8
 4525              	.LVL506:
 4526 01a0 FFF7FEFF 		bl	cc2400_set
 4527              	.LVL507:
1485:bluetooth_rxtx.c **** 
 4528              		.loc 1 1485 0 discriminator 4
 4529 01a4 0025     		movs	r5, #0
1520:bluetooth_rxtx.c **** 
 4530              		.loc 1 1520 0 discriminator 4
 4531 01a6 314E     		ldr	r6, .L503+16
 4532              	.LVL508:
1530:bluetooth_rxtx.c **** 
 4533              		.loc 1 1530 0 discriminator 4
 4534 01a8 DFF8CC90 		ldr	r9, .L503+28
 4535              	.LVL509:
 4536              	.L474:
1517:bluetooth_rxtx.c **** 	{
 4537              		.loc 1 1517 0
 4538 01ac A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4539 01ae 022B     		cmp	r3, #2
 4540 01b0 4AD1     		bne	.L482
1520:bluetooth_rxtx.c **** 
 4541              		.loc 1 1520 0
 4542 01b2 6D08     		lsrs	r5, r5, #1
 4543              	.LVL510:
 4544 01b4 DFF8C480 		ldr	r8, .L503+32
 4545 01b8 08E0     		b	.L483
 4546              	.LVL511:
 4547              	.L468:
 4548              	.LBB52:
 4549              	.LBB51:
1137:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 4550              		.loc 1 1137 0
 4551 01ba 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 4552 01bc 012B     		cmp	r3, #1
 4553 01be E2D1     		bne	.L470
1138:bluetooth_rxtx.c **** 	} else {
 4554              		.loc 1 1138 0
 4555 01c0 4021     		movs	r1, #64
 4556 01c2 C3E7     		b	.L502
 4557              	.LVL512:
 4558              	.L476:
ARM GAS  /tmp/ccLwKaeN.s 			page 132


 4559              	.LBE51:
 4560              	.LBE52:
1523:bluetooth_rxtx.c **** 				hop();
 4561              		.loc 1 1523 0
 4562 01c4 E27A     		ldrb	r2, [r4, #11]	@ zero_extendqisi2
 4563 01c6 1AB1     		cbz	r2, .L475
1524:bluetooth_rxtx.c **** 			}
 4564              		.loc 1 1524 0
 4565 01c8 FFF7FEFF 		bl	hop
 4566              	.LVL513:
 4567              	.L483:
1520:bluetooth_rxtx.c **** 
 4568              		.loc 1 1520 0
 4569 01cc 40F6C903 		movw	r3, #2249
 4570              	.L475:
 4571 01d0 3268     		ldr	r2, [r6]
 4572 01d2 B5EB520F 		cmp	r5, r2, lsr #1
 4573 01d6 F5D0     		beq	.L476
1520:bluetooth_rxtx.c **** 
 4574              		.loc 1 1520 0 is_stmt 0 discriminator 1
 4575 01d8 D8F80020 		ldr	r2, [r8]
 4576 01dc 9A42     		cmp	r2, r3
 4577 01de F1D9     		bls	.L476
1530:bluetooth_rxtx.c **** 
 4578              		.loc 1 1530 0 is_stmt 1
 4579 01e0 4FF48073 		mov	r3, #256
1528:bluetooth_rxtx.c **** 
 4580              		.loc 1 1528 0
 4581 01e4 3568     		ldr	r5, [r6]
 4582              	.LVL514:
1532:bluetooth_rxtx.c **** 
 4583              		.loc 1 1532 0
 4584 01e6 6946     		mov	r1, sp
1530:bluetooth_rxtx.c **** 
 4585              		.loc 1 1530 0
 4586 01e8 C9F80030 		str	r3, [r9]
1532:bluetooth_rxtx.c **** 
 4587              		.loc 1 1532 0
 4588 01ec 1020     		movs	r0, #16
 4589 01ee FFF7FEFF 		bl	cc2400_fifo_write
 4590              	.LVL515:
 4591              	.L477:
1534:bluetooth_rxtx.c **** 		TXLED_CLR;
 4592              		.loc 1 1534 0 discriminator 1
 4593 01f2 0E20     		movs	r0, #14
 4594 01f4 FFF7FEFF 		bl	cc2400_get
 4595              	.LVL516:
 4596 01f8 00F01F00 		and	r0, r0, #31
 4597 01fc 0F28     		cmp	r0, #15
 4598 01fe F8D1     		bne	.L477
1535:bluetooth_rxtx.c **** 
 4599              		.loc 1 1535 0
 4600 0200 4FF48072 		mov	r2, #256
 4601 0204 1A4B     		ldr	r3, .L503+20
1537:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 4602              		.loc 1 1537 0
 4603 0206 6420     		movs	r0, #100
ARM GAS  /tmp/ccLwKaeN.s 			page 133


1535:bluetooth_rxtx.c **** 
 4604              		.loc 1 1535 0
 4605 0208 1A60     		str	r2, [r3]
1537:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 4606              		.loc 1 1537 0
 4607 020a FFF7FEFF 		bl	cc2400_strobe
 4608              	.LVL517:
 4609              	.L478:
1538:bluetooth_rxtx.c **** 
 4610              		.loc 1 1538 0 discriminator 1
 4611 020e FFF7FEFF 		bl	cc2400_status
 4612              	.LVL518:
 4613 0212 4107     		lsls	r1, r0, #29
 4614 0214 FBD4     		bmi	.L478
 4615              	.L479:
1540:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 4616              		.loc 1 1540 0 discriminator 1
 4617 0216 FFF7FEFF 		bl	cc2400_status
 4618              	.LVL519:
 4619 021a 4206     		lsls	r2, r0, #25
 4620 021c FBD5     		bpl	.L479
1541:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
 4621              		.loc 1 1541 0
 4622 021e 6120     		movs	r0, #97
 4623 0220 FFF7FEFF 		bl	cc2400_strobe
 4624              	.LVL520:
 4625              	.L480:
1542:bluetooth_rxtx.c **** 
 4626              		.loc 1 1542 0 discriminator 1
 4627 0224 FFF7FEFF 		bl	cc2400_status
 4628              	.LVL521:
 4629 0228 4307     		lsls	r3, r0, #29
 4630 022a FBD5     		bpl	.L480
 4631              	.L491:
1544:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
 4632              		.loc 1 1544 0 discriminator 1
 4633 022c 0E20     		movs	r0, #14
 4634 022e FFF7FEFF 		bl	cc2400_get
 4635              	.LVL522:
 4636 0232 00F01F00 		and	r0, r0, #31
 4637 0236 0F28     		cmp	r0, #15
 4638 0238 F8D1     		bne	.L491
1545:bluetooth_rxtx.c **** 
 4639              		.loc 1 1545 0
 4640 023a 6320     		movs	r0, #99
 4641 023c FFF7FEFF 		bl	cc2400_strobe
 4642              	.LVL523:
1547:bluetooth_rxtx.c **** 	}
 4643              		.loc 1 1547 0
 4644 0240 3068     		ldr	r0, [r6]
 4645 0242 FFF7FEFF 		bl	handle_usb
 4646              	.LVL524:
 4647 0246 B1E7     		b	.L474
 4648              	.L482:
1551:bluetooth_rxtx.c **** #endif
 4649              		.loc 1 1551 0
 4650 0248 8022     		movs	r2, #128
ARM GAS  /tmp/ccLwKaeN.s 			page 134


 4651 024a 0A4B     		ldr	r3, .L503+24
1555:bluetooth_rxtx.c **** }
 4652              		.loc 1 1555 0
 4653 024c 3946     		mov	r1, r7
1551:bluetooth_rxtx.c **** #endif
 4654              		.loc 1 1551 0
 4655 024e 1A60     		str	r2, [r3]
1555:bluetooth_rxtx.c **** }
 4656              		.loc 1 1555 0
 4657 0250 0820     		movs	r0, #8
 4658 0252 FFF7FEFF 		bl	cc2400_set
 4659              	.LVL525:
1556:bluetooth_rxtx.c **** 
 4660              		.loc 1 1556 0
 4661 0256 05B0     		add	sp, sp, #20
 4662              		.cfi_def_cfa_offset 28
 4663              		@ sp needed
 4664 0258 BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 4665              	.LVL526:
 4666              	.L504:
 4667              		.align	2
 4668              	.L503:
 4669 025c 00000000 		.word	target
 4670 0260 00000000 		.word	.LANCHOR0
 4671 0264 00000000 		.word	.LANCHOR1
 4672 0268 58C00920 		.word	537509976
 4673 026c 00000000 		.word	clkn
 4674 0270 3CC00920 		.word	537509948
 4675 0274 5CC00920 		.word	537509980
 4676 0278 38C00920 		.word	537509944
 4677 027c 08400040 		.word	1073758216
 4678              		.cfi_endproc
 4679              	.LFE18:
 4681              		.section	.text.bt_generic_le,"ax",%progbits
 4682              		.align	1
 4683              		.global	bt_generic_le
 4684              		.syntax unified
 4685              		.thumb
 4686              		.thumb_func
 4687              		.fpu softvfp
 4689              	bt_generic_le:
 4690              	.LFB22:
1609:bluetooth_rxtx.c **** 	u8 hold;
 4691              		.loc 1 1609 0
 4692              		.cfi_startproc
 4693              		@ args = 0, pretend = 0, frame = 0
 4694              		@ frame_needed = 0, uses_anonymous_args = 0
 4695              	.LVL527:
 4696 0000 2DE9F84F 		push	{r3, r4, r5, r6, r7, r8, r9, r10, fp, lr}
 4697              		.cfi_def_cfa_offset 40
 4698              		.cfi_offset 3, -40
 4699              		.cfi_offset 4, -36
 4700              		.cfi_offset 5, -32
 4701              		.cfi_offset 6, -28
 4702              		.cfi_offset 7, -24
 4703              		.cfi_offset 8, -20
 4704              		.cfi_offset 9, -16
ARM GAS  /tmp/ccLwKaeN.s 			page 135


 4705              		.cfi_offset 10, -12
 4706              		.cfi_offset 11, -8
 4707              		.cfi_offset 14, -4
1615:bluetooth_rxtx.c **** 	mode = active_mode;
 4708              		.loc 1 1615 0
 4709 0004 0123     		movs	r3, #1
 4710 0006 6F4C     		ldr	r4, .L550
1609:bluetooth_rxtx.c **** 	u8 hold;
 4711              		.loc 1 1609 0
 4712 0008 8246     		mov	r10, r0
1615:bluetooth_rxtx.c **** 	mode = active_mode;
 4713              		.loc 1 1615 0
 4714 000a 2370     		strb	r3, [r4]
1616:bluetooth_rxtx.c **** 
 4715              		.loc 1 1616 0
 4716 000c 6074     		strb	r0, [r4, #17]
1618:bluetooth_rxtx.c **** 
 4717              		.loc 1 1618 0
 4718 000e FFF7FEFF 		bl	reset_le
 4719              	.LVL528:
1621:bluetooth_rxtx.c **** 
 4720              		.loc 1 1621 0
 4721 0012 4FF08072 		mov	r2, #16777216
 4722 0016 6C4B     		ldr	r3, .L550+4
1623:bluetooth_rxtx.c **** 
 4723              		.loc 1 1623 0
 4724 0018 6C4F     		ldr	r7, .L550+8
1621:bluetooth_rxtx.c **** 
 4725              		.loc 1 1621 0
 4726 001a 1A60     		str	r2, [r3]
1623:bluetooth_rxtx.c **** 
 4727              		.loc 1 1623 0
 4728 001c 1023     		movs	r3, #16
 4729 001e 3B60     		str	r3, [r7]
1625:bluetooth_rxtx.c **** 	dio_ssp_init();
 4730              		.loc 1 1625 0
 4731 0020 FFF7FEFF 		bl	usb_queue_init
 4732              	.LVL529:
1633:bluetooth_rxtx.c **** 
 4733              		.loc 1 1633 0
 4734 0024 0026     		movs	r6, #0
1626:bluetooth_rxtx.c **** 	dma_init_rx_symbols();
 4735              		.loc 1 1626 0
 4736 0026 FFF7FEFF 		bl	dio_ssp_init
 4737              	.LVL530:
1627:bluetooth_rxtx.c **** 	dio_ssp_start();
 4738              		.loc 1 1627 0
 4739 002a FFF7FEFF 		bl	dma_init_rx_symbols
 4740              	.LVL531:
1628:bluetooth_rxtx.c **** 	cc2400_rx();
 4741              		.loc 1 1628 0
 4742 002e FFF7FEFF 		bl	dio_ssp_start
 4743              	.LVL532:
1629:bluetooth_rxtx.c **** 
 4744              		.loc 1 1629 0
 4745 0032 FFF7FEFF 		bl	cc2400_rx
 4746              	.LVL533:
ARM GAS  /tmp/ccLwKaeN.s 			page 136


1631:bluetooth_rxtx.c **** 
 4747              		.loc 1 1631 0
 4748 0036 FFF7FEFF 		bl	cs_trigger_enable
 4749              	.LVL534:
 4750              	.LBB53:
1642:bluetooth_rxtx.c **** 
 4751              		.loc 1 1642 0
 4752 003a DFF8B4B1 		ldr	fp, .L550+44
1665:bluetooth_rxtx.c **** 		{
 4753              		.loc 1 1665 0
 4754 003e DFF8B481 		ldr	r8, .L550+48
 4755              	.LVL535:
 4756              	.L506:
 4757              	.LBE53:
1635:bluetooth_rxtx.c **** 
 4758              		.loc 1 1635 0
 4759 0042 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4760 0044 9A45     		cmp	r10, r3
 4761 0046 40F08C80 		bne	.L527
 4762              	.LBB54:
1637:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 4763              		.loc 1 1637 0
 4764 004a E389     		ldrh	r3, [r4, #14]
 4765 004c 9BB2     		uxth	r3, r3
 4766 004e CBB1     		cbz	r3, .L507
1638:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 4767              		.loc 1 1638 0
 4768 0050 6420     		movs	r0, #100
 4769 0052 FFF7FEFF 		bl	cc2400_strobe
 4770              	.LVL536:
 4771              	.L508:
1639:bluetooth_rxtx.c **** 
 4772              		.loc 1 1639 0 discriminator 1
 4773 0056 FFF7FEFF 		bl	cc2400_status
 4774              	.LVL537:
 4775 005a 4207     		lsls	r2, r0, #29
 4776 005c FBD4     		bmi	.L508
1642:bluetooth_rxtx.c **** 
 4777              		.loc 1 1642 0
 4778 005e BBF84C10 		ldrh	r1, [fp, #76]
 4779 0062 0220     		movs	r0, #2
 4780 0064 0139     		subs	r1, r1, #1
 4781 0066 89B2     		uxth	r1, r1
 4782 0068 FFF7FEFF 		bl	cc2400_set
 4783              	.LVL538:
1645:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 4784              		.loc 1 1645 0
 4785 006c 6120     		movs	r0, #97
 4786 006e FFF7FEFF 		bl	cc2400_strobe
 4787              	.LVL539:
 4788              	.L509:
1646:bluetooth_rxtx.c **** 
 4789              		.loc 1 1646 0 discriminator 1
 4790 0072 FFF7FEFF 		bl	cc2400_status
 4791              	.LVL540:
 4792 0076 4307     		lsls	r3, r0, #29
 4793 0078 FBD5     		bpl	.L509
ARM GAS  /tmp/ccLwKaeN.s 			page 137


1649:bluetooth_rxtx.c **** 
 4794              		.loc 1 1649 0
 4795 007a 6220     		movs	r0, #98
 4796 007c FFF7FEFF 		bl	cc2400_strobe
 4797              	.LVL541:
1651:bluetooth_rxtx.c **** 		}
 4798              		.loc 1 1651 0
 4799 0080 0023     		movs	r3, #0
 4800 0082 E381     		strh	r3, [r4, #14]	@ movhi
 4801              	.L507:
1654:bluetooth_rxtx.c **** 			hop();
 4802              		.loc 1 1654 0
 4803 0084 E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 4804 0086 002B     		cmp	r3, #0
 4805 0088 77D0     		beq	.L510
1655:bluetooth_rxtx.c **** 		} else {
 4806              		.loc 1 1655 0
 4807 008a FFF7FEFF 		bl	hop
 4808              	.LVL542:
 4809              	.L511:
1660:bluetooth_rxtx.c **** 
 4810              		.loc 1 1660 0
 4811 008e 1023     		movs	r3, #16
 4812 0090 3B60     		str	r3, [r7]
1663:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 4813              		.loc 1 1663 0
 4814 0092 FFF7FEFF 		bl	rssi_reset
 4815              	.LVL543:
1664:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
 4816              		.loc 1 1664 0
 4817 0096 6FF07F05 		mvn	r5, #127
 4818 009a DFF85C91 		ldr	r9, .L550+52
 4819              	.LVL544:
 4820              	.L512:
1665:bluetooth_rxtx.c **** 		{
 4821              		.loc 1 1665 0
 4822 009e D8F80030 		ldr	r3, [r8]
 4823 00a2 1BB9     		cbnz	r3, .L514
1665:bluetooth_rxtx.c **** 		{
 4824              		.loc 1 1665 0 is_stmt 0 discriminator 1
 4825 00a4 D9F80030 		ldr	r3, [r9]
 4826 00a8 002B     		cmp	r3, #0
 4827 00aa 6AD0     		beq	.L515
 4828              	.L514:
1675:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 4829              		.loc 1 1675 0 is_stmt 1
 4830 00ac D9F80030 		ldr	r3, [r9]
 4831 00b0 1BB1     		cbz	r3, .L516
1676:bluetooth_rxtx.c **** 		}
 4832              		.loc 1 1676 0
 4833 00b2 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4834 00b4 43F00203 		orr	r3, r3, #2
 4835 00b8 6370     		strb	r3, [r4, #1]
 4836              	.L516:
1680:bluetooth_rxtx.c **** 			goto rx_continue;
 4837              		.loc 1 1680 0
 4838 00ba D8F80030 		ldr	r3, [r8]
ARM GAS  /tmp/ccLwKaeN.s 			page 138


 4839 00be 002B     		cmp	r3, #0
 4840 00c0 79D0     		beq	.L517
1684:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 4841              		.loc 1 1684 0
 4842 00c2 D8F80030 		ldr	r3, [r8]
 4843 00c6 012B     		cmp	r3, #1
1685:bluetooth_rxtx.c **** 
 4844              		.loc 1 1685 0
 4845 00c8 82BF     		ittt	hi
 4846 00ca 6378     		ldrbhi	r3, [r4, #1]	@ zero_extendqisi2
 4847 00cc 43F00103 		orrhi	r3, r3, #1
 4848 00d0 6370     		strbhi	r3, [r4, #1]
1687:bluetooth_rxtx.c **** 
 4849              		.loc 1 1687 0
 4850 00d2 BBF84C00 		ldrh	r0, [fp, #76]
 4851 00d6 80B2     		uxth	r0, r0
 4852 00d8 FFF7FEFF 		bl	rssi_iir_update
 4853              	.LVL545:
1693:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4854              		.loc 1 1693 0
 4855 00dc 3C4A     		ldr	r2, .L550+12
 4856 00de 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 4857 00e0 13B9     		cbnz	r3, .L519
1693:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4858              		.loc 1 1693 0 is_stmt 0 discriminator 1
 4859 00e2 3C4B     		ldr	r3, .L550+16
 4860 00e4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 4861 00e6 33B1     		cbz	r3, .L520
 4862              	.L519:
1694:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4863              		.loc 1 1694 0 is_stmt 1
 4864 00e8 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
1695:bluetooth_rxtx.c **** 			cs_trigger = 0;
 4865              		.loc 1 1695 0
 4866 00ea 0226     		movs	r6, #2
 4867              	.LVL546:
1694:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4868              		.loc 1 1694 0
 4869 00ec 43F00803 		orr	r3, r3, #8
 4870 00f0 6370     		strb	r3, [r4, #1]
 4871              	.LVL547:
1696:bluetooth_rxtx.c **** 		}
 4872              		.loc 1 1696 0
 4873 00f2 0023     		movs	r3, #0
 4874 00f4 1370     		strb	r3, [r2]
 4875              	.LVL548:
 4876              	.L520:
1699:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 4877              		.loc 1 1699 0
 4878 00f6 384B     		ldr	r3, .L550+20
 4879 00f8 384A     		ldr	r2, .L550+24
 4880 00fa 93F90030 		ldrsb	r3, [r3]
 4881 00fe 92F90020 		ldrsb	r2, [r2]
 4882 0102 3533     		adds	r3, r3, #53
 4883 0104 9342     		cmp	r3, r2
 4884 0106 54DA     		bge	.L521
1701:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccLwKaeN.s 			page 139


 4885              		.loc 1 1701 0
 4886 0108 0226     		movs	r6, #2
 4887              	.LVL549:
1700:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4888              		.loc 1 1700 0
 4889 010a 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4890 010c 43F01003 		orr	r3, r3, #16
 4891 0110 6370     		strb	r3, [r4, #1]
 4892              	.LVL550:
 4893              	.L522:
1711:bluetooth_rxtx.c **** 
 4894              		.loc 1 1711 0
 4895 0112 3349     		ldr	r1, .L550+28
 4896 0114 4FF4C872 		mov	r2, #400
 4897 0118 A1F5C870 		sub	r0, r1, #400
 4898 011c FFF7FEFF 		bl	memcpy
 4899              	.LVL551:
1714:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 4900              		.loc 1 1714 0
 4901 0120 0023     		movs	r3, #0
1708:bluetooth_rxtx.c **** 
 4902              		.loc 1 1708 0
 4903 0122 013E     		subs	r6, r6, #1
 4904              	.LVL552:
 4905 0124 DFF8C0C0 		ldr	ip, .L550+36
1717:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4906              		.loc 1 1717 0
 4907 0128 2E4D     		ldr	r5, .L550+32
 4908              	.LVL553:
1708:bluetooth_rxtx.c **** 
 4909              		.loc 1 1708 0
 4910 012a F6B2     		uxtb	r6, r6
 4911              	.LVL554:
 4912              	.L523:
1701:bluetooth_rxtx.c **** 		}
 4913              		.loc 1 1701 0
 4914 012c 0021     		movs	r1, #0
 4915 012e 03F13200 		add	r0, r3, #50
 4916 0132 0CEBC000 		add	r0, ip, r0, lsl #3
 4917              	.LVL555:
 4918              	.L524:
1717:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4919              		.loc 1 1717 0 discriminator 3
 4920 0136 2A68     		ldr	r2, [r5]
 4921 0138 D25C     		ldrb	r2, [r2, r3]	@ zero_extendqisi2
1718:bluetooth_rxtx.c **** 			}
 4922              		.loc 1 1718 0 discriminator 3
 4923 013a D5F800E0 		ldr	lr, [r5]
1717:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4924              		.loc 1 1717 0 discriminator 3
 4925 013e D209     		lsrs	r2, r2, #7
 4926 0140 4254     		strb	r2, [r0, r1]
1718:bluetooth_rxtx.c **** 			}
 4927              		.loc 1 1718 0 discriminator 3
 4928 0142 1EF80320 		ldrb	r2, [lr, r3]	@ zero_extendqisi2
1716:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4929              		.loc 1 1716 0 discriminator 3
ARM GAS  /tmp/ccLwKaeN.s 			page 140


 4930 0146 0131     		adds	r1, r1, #1
 4931              	.LVL556:
1718:bluetooth_rxtx.c **** 			}
 4932              		.loc 1 1718 0 discriminator 3
 4933 0148 5200     		lsls	r2, r2, #1
 4934 014a D2B2     		uxtb	r2, r2
1716:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4935              		.loc 1 1716 0 discriminator 3
 4936 014c 0829     		cmp	r1, #8
1718:bluetooth_rxtx.c **** 			}
 4937              		.loc 1 1718 0 discriminator 3
 4938 014e 0EF80320 		strb	r2, [lr, r3]
1716:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4939              		.loc 1 1716 0 discriminator 3
 4940 0152 F0D1     		bne	.L524
1714:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 4941              		.loc 1 1714 0 discriminator 2
 4942 0154 0133     		adds	r3, r3, #1
 4943              	.LVL557:
 4944 0156 322B     		cmp	r3, #50
 4945 0158 E8D1     		bne	.L523
1722:bluetooth_rxtx.c **** 		if (!ret) break;
 4946              		.loc 1 1722 0
 4947 015a 236B     		ldr	r3, [r4, #48]
 4948              	.LVL558:
 4949 015c 2248     		ldr	r0, .L550+36
 4950 015e 9847     		blx	r3
 4951              	.LVL559:
1723:bluetooth_rxtx.c **** 
 4952              		.loc 1 1723 0
 4953 0160 48BB     		cbnz	r0, .L517
 4954              	.LVL560:
 4955              	.L527:
 4956              	.LBE54:
1731:bluetooth_rxtx.c **** 
 4957              		.loc 1 1731 0
 4958 0162 4FF08072 		mov	r2, #16777216
 4959 0166 214B     		ldr	r3, .L550+40
 4960 0168 1A60     		str	r2, [r3]
1734:bluetooth_rxtx.c **** 	dio_ssp_stop();
 4961              		.loc 1 1734 0
 4962 016a FFF7FEFF 		bl	cc2400_idle
 4963              	.LVL561:
1735:bluetooth_rxtx.c **** 	cs_trigger_disable();
 4964              		.loc 1 1735 0
 4965 016e FFF7FEFF 		bl	dio_ssp_stop
 4966              	.LVL562:
1738:bluetooth_rxtx.c **** 
 4967              		.loc 1 1738 0
 4968 0172 BDE8F84F 		pop	{r3, r4, r5, r6, r7, r8, r9, r10, fp, lr}
 4969              		.cfi_remember_state
 4970              		.cfi_restore 14
 4971              		.cfi_restore 11
 4972              		.cfi_restore 10
 4973              		.cfi_restore 9
 4974              		.cfi_restore 8
 4975              		.cfi_restore 7
ARM GAS  /tmp/ccLwKaeN.s 			page 141


 4976              		.cfi_restore 6
 4977              		.cfi_restore 5
 4978              		.cfi_restore 4
 4979              		.cfi_restore 3
 4980              		.cfi_def_cfa_offset 0
 4981              	.LVL563:
1736:bluetooth_rxtx.c **** 
 4982              		.loc 1 1736 0
 4983 0176 FFF7FEBF 		b	cs_trigger_disable
 4984              	.LVL564:
 4985              	.L510:
 4986              		.cfi_restore_state
 4987              	.LBB55:
1657:bluetooth_rxtx.c **** 		}
 4988              		.loc 1 1657 0
 4989 017a 4FF48073 		mov	r3, #256
 4990 017e 3B60     		str	r3, [r7]
 4991 0180 85E7     		b	.L511
 4992              	.LVL565:
 4993              	.L515:
1667:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4994              		.loc 1 1667 0
 4995 0182 0620     		movs	r0, #6
 4996 0184 FFF7FEFF 		bl	cc2400_get
 4997              	.LVL566:
1668:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4998              		.loc 1 1668 0
 4999 0188 114B     		ldr	r3, .L550+12
1667:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 5000              		.loc 1 1667 0
 5001 018a 40F30720 		sbfx	r0, r0, #8, #8
 5002              	.LVL567:
1668:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 5003              		.loc 1 1668 0
 5004 018e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 5005 0190 63B1     		cbz	r3, .L513
1668:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 5006              		.loc 1 1668 0 is_stmt 0 discriminator 1
 5007 0192 15F1800F 		cmn	r5, #128
 5008 0196 09D1     		bne	.L513
1669:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 5009              		.loc 1 1669 0 is_stmt 1
 5010 0198 0F4B     		ldr	r3, .L550+20
 5011 019a 93F90030 		ldrsb	r3, [r3]
 5012 019e 03F13605 		add	r5, r3, #54
 5013              	.LVL568:
 5014 01a2 A842     		cmp	r0, r5
 5015 01a4 B8BF     		it	lt
 5016 01a6 2846     		movlt	r0, r5
 5017              	.LVL569:
 5018 01a8 45B2     		sxtb	r5, r0
1670:bluetooth_rxtx.c **** 			}
 5019              		.loc 1 1670 0
 5020 01aa 2846     		mov	r0, r5
 5021              	.L513:
 5022              	.LVL570:
1672:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccLwKaeN.s 			page 142


 5023              		.loc 1 1672 0
 5024 01ac FFF7FEFF 		bl	rssi_add
 5025              	.LVL571:
 5026 01b0 75E7     		b	.L512
 5027              	.L521:
1705:bluetooth_rxtx.c **** 			goto rx_continue;
 5028              		.loc 1 1705 0
 5029 01b2 002E     		cmp	r6, #0
 5030 01b4 ADD1     		bne	.L522
 5031              	.LVL572:
 5032              	.L517:
1726:bluetooth_rxtx.c **** 		rx_err = 0;
 5033              		.loc 1 1726 0
 5034 01b6 0023     		movs	r3, #0
 5035 01b8 C8F80030 		str	r3, [r8]
1727:bluetooth_rxtx.c **** 	}
 5036              		.loc 1 1727 0
 5037 01bc C9F80030 		str	r3, [r9]
 5038 01c0 3FE7     		b	.L506
 5039              	.L551:
 5040 01c2 00BF     		.align	2
 5041              	.L550:
 5042 01c4 00000000 		.word	.LANCHOR1
 5043 01c8 00E100E0 		.word	-536813312
 5044 01cc 3CC00920 		.word	537509948
 5045 01d0 00000000 		.word	cs_trigger
 5046 01d4 00000000 		.word	cs_no_squelch
 5047 01d8 00000000 		.word	cs_threshold_cur
 5048 01dc 00000000 		.word	rssi_max
 5049 01e0 90010000 		.word	unpacked+400
 5050 01e4 00000000 		.word	idle_rxbuf
 5051 01e8 00000000 		.word	unpacked
 5052 01ec 80E100E0 		.word	-536813184
 5053 01f0 00000000 		.word	.LANCHOR0
 5054 01f4 00000000 		.word	rx_tc
 5055 01f8 00000000 		.word	rx_err
 5056              	.LBE55:
 5057              		.cfi_endproc
 5058              	.LFE22:
 5060              		.section	.text.bt_le_sync,"ax",%progbits
 5061              		.align	1
 5062              		.global	bt_le_sync
 5063              		.syntax unified
 5064              		.thumb
 5065              		.thumb_func
 5066              		.fpu softvfp
 5068              	bt_le_sync:
 5069              	.LFB23:
1742:bluetooth_rxtx.c **** 	int i;
 5070              		.loc 1 1742 0
 5071              		.cfi_startproc
 5072              		@ args = 0, pretend = 0, frame = 72
 5073              		@ frame_needed = 0, uses_anonymous_args = 0
 5074              	.LVL573:
 5075 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 5076              		.cfi_def_cfa_offset 36
 5077              		.cfi_offset 4, -36
ARM GAS  /tmp/ccLwKaeN.s 			page 143


 5078              		.cfi_offset 5, -32
 5079              		.cfi_offset 6, -28
 5080              		.cfi_offset 7, -24
 5081              		.cfi_offset 8, -20
 5082              		.cfi_offset 9, -16
 5083              		.cfi_offset 10, -12
 5084              		.cfi_offset 11, -8
 5085              		.cfi_offset 14, -4
 5086 0004 93B0     		sub	sp, sp, #76
 5087              		.cfi_def_cfa_offset 112
1747:bluetooth_rxtx.c **** 	mode = active_mode;
 5088              		.loc 1 1747 0
 5089 0006 0123     		movs	r3, #1
1753:bluetooth_rxtx.c **** 
 5090              		.loc 1 1753 0
 5091 0008 4FF08072 		mov	r2, #16777216
1747:bluetooth_rxtx.c **** 	mode = active_mode;
 5092              		.loc 1 1747 0
 5093 000c B74C     		ldr	r4, .L623
1750:bluetooth_rxtx.c **** 
 5094              		.loc 1 1750 0
 5095 000e B84D     		ldr	r5, .L623+4
1747:bluetooth_rxtx.c **** 	mode = active_mode;
 5096              		.loc 1 1747 0
 5097 0010 2370     		strb	r3, [r4]
1750:bluetooth_rxtx.c **** 
 5098              		.loc 1 1750 0
 5099 0012 2B75     		strb	r3, [r5, #20]
1753:bluetooth_rxtx.c **** 
 5100              		.loc 1 1753 0
 5101 0014 B74B     		ldr	r3, .L623+8
1748:bluetooth_rxtx.c **** 
 5102              		.loc 1 1748 0
 5103 0016 6074     		strb	r0, [r4, #17]
1753:bluetooth_rxtx.c **** 
 5104              		.loc 1 1753 0
 5105 0018 1A60     		str	r2, [r3]
1755:bluetooth_rxtx.c **** 
 5106              		.loc 1 1755 0
 5107 001a 1023     		movs	r3, #16
 5108 001c B64E     		ldr	r6, .L623+12
1742:bluetooth_rxtx.c **** 	int i;
 5109              		.loc 1 1742 0
 5110 001e 8146     		mov	r9, r0
1755:bluetooth_rxtx.c **** 
 5111              		.loc 1 1755 0
 5112 0020 3360     		str	r3, [r6]
1757:bluetooth_rxtx.c **** 	dio_ssp_init();
 5113              		.loc 1 1757 0
 5114 0022 FFF7FEFF 		bl	usb_queue_init
 5115              	.LVL574:
1758:bluetooth_rxtx.c **** 	dma_init_le();
 5116              		.loc 1 1758 0
 5117 0026 FFF7FEFF 		bl	dio_ssp_init
 5118              	.LVL575:
1759:bluetooth_rxtx.c **** 	dio_ssp_start();
 5119              		.loc 1 1759 0
ARM GAS  /tmp/ccLwKaeN.s 			page 144


 5120 002a FFF7FEFF 		bl	dma_init_le
 5121              	.LVL576:
1760:bluetooth_rxtx.c **** 
 5122              		.loc 1 1760 0
 5123 002e FFF7FEFF 		bl	dio_ssp_start
 5124              	.LVL577:
1762:bluetooth_rxtx.c **** 
 5125              		.loc 1 1762 0
 5126 0032 2868     		ldr	r0, [r5]
 5127 0034 FFF7FEFF 		bl	rbit
 5128              	.LVL578:
 5129              	.LBB56:
1881:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
 5130              		.loc 1 1881 0
 5131 0038 DFF8F4A2 		ldr	r10, .L623+68
 5132              	.LBE56:
1762:bluetooth_rxtx.c **** 
 5133              		.loc 1 1762 0
 5134 003c FFF7FEFF 		bl	cc2400_rx_sync
 5135              	.LVL579:
 5136 0040 0096     		str	r6, [sp]
 5137              	.L553:
1764:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 5138              		.loc 1 1764 0
 5139 0042 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 5140 0044 9945     		cmp	r9, r3
 5141 0046 40F04081 		bne	.L589
 5142              	.LBB63:
1765:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 5143              		.loc 1 1765 0
 5144 004a E389     		ldrh	r3, [r4, #14]
 5145 004c 9BB2     		uxth	r3, r3
 5146 004e CBB1     		cbz	r3, .L554
1766:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 5147              		.loc 1 1766 0
 5148 0050 6420     		movs	r0, #100
 5149 0052 FFF7FEFF 		bl	cc2400_strobe
 5150              	.LVL580:
 5151              	.L555:
1767:bluetooth_rxtx.c **** 
 5152              		.loc 1 1767 0 discriminator 1
 5153 0056 FFF7FEFF 		bl	cc2400_status
 5154              	.LVL581:
 5155 005a 4707     		lsls	r7, r0, #29
 5156 005c FBD4     		bmi	.L555
1770:bluetooth_rxtx.c **** 
 5157              		.loc 1 1770 0
 5158 005e B5F84C10 		ldrh	r1, [r5, #76]
 5159 0062 0220     		movs	r0, #2
 5160 0064 0139     		subs	r1, r1, #1
 5161 0066 89B2     		uxth	r1, r1
 5162 0068 FFF7FEFF 		bl	cc2400_set
 5163              	.LVL582:
1773:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 5164              		.loc 1 1773 0
 5165 006c 6120     		movs	r0, #97
 5166 006e FFF7FEFF 		bl	cc2400_strobe
ARM GAS  /tmp/ccLwKaeN.s 			page 145


 5167              	.LVL583:
 5168              	.L556:
1774:bluetooth_rxtx.c **** 
 5169              		.loc 1 1774 0 discriminator 1
 5170 0072 FFF7FEFF 		bl	cc2400_status
 5171              	.LVL584:
 5172 0076 4607     		lsls	r6, r0, #29
 5173 0078 FBD5     		bpl	.L556
1777:bluetooth_rxtx.c **** 
 5174              		.loc 1 1777 0
 5175 007a 6220     		movs	r0, #98
 5176 007c FFF7FEFF 		bl	cc2400_strobe
 5177              	.LVL585:
1779:bluetooth_rxtx.c **** 		}
 5178              		.loc 1 1779 0
 5179 0080 0023     		movs	r3, #0
 5180 0082 E381     		strh	r3, [r4, #14]	@ movhi
 5181              	.L554:
1782:bluetooth_rxtx.c **** 
 5182              		.loc 1 1782 0
 5183 0084 1023     		movs	r3, #16
 5184 0086 009A     		ldr	r2, [sp]
1786:bluetooth_rxtx.c **** 			;
 5185              		.loc 1 1786 0
 5186 0088 DFF8A8B2 		ldr	fp, .L623+72
1782:bluetooth_rxtx.c **** 
 5187              		.loc 1 1782 0
 5188 008c 1360     		str	r3, [r2]
1785:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)
 5189              		.loc 1 1785 0
 5190 008e FFF7FEFF 		bl	rssi_reset
 5191              	.LVL586:
1786:bluetooth_rxtx.c **** 			;
 5192              		.loc 1 1786 0
 5193 0092 9A4A     		ldr	r2, .L623+16
 5194              	.L558:
1786:bluetooth_rxtx.c **** 			;
 5195              		.loc 1 1786 0 is_stmt 0 discriminator 4
 5196 0094 DBF80030 		ldr	r3, [fp]
 5197 0098 33B9     		cbnz	r3, .L557
1786:bluetooth_rxtx.c **** 			;
 5198              		.loc 1 1786 0 discriminator 1
 5199 009a 1368     		ldr	r3, [r2]
 5200 009c 23B9     		cbnz	r3, .L557
1786:bluetooth_rxtx.c **** 			;
 5201              		.loc 1 1786 0 discriminator 2
 5202 009e E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 5203 00a0 13B9     		cbnz	r3, .L557
1786:bluetooth_rxtx.c **** 			;
 5204              		.loc 1 1786 0 discriminator 3
 5205 00a2 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 5206 00a4 9945     		cmp	r9, r3
 5207 00a6 F5D0     		beq	.L558
 5208              	.L557:
1789:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 5209              		.loc 1 1789 0 is_stmt 1
 5210 00a8 0620     		movs	r0, #6
ARM GAS  /tmp/ccLwKaeN.s 			page 146


 5211 00aa FFF7FEFF 		bl	cc2400_get
 5212              	.LVL587:
1790:bluetooth_rxtx.c **** 
 5213              		.loc 1 1790 0
 5214 00ae 944B     		ldr	r3, .L623+20
1789:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 5215              		.loc 1 1789 0
 5216 00b0 40F30720 		sbfx	r0, r0, #8, #8
 5217              	.LVL588:
1790:bluetooth_rxtx.c **** 
 5218              		.loc 1 1790 0
 5219 00b4 1870     		strb	r0, [r3]
 5220 00b6 934B     		ldr	r3, .L623+24
 5221 00b8 1870     		strb	r0, [r3]
1792:bluetooth_rxtx.c **** 			goto cleanup;
 5222              		.loc 1 1792 0
 5223 00ba A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 5224 00bc 9945     		cmp	r9, r3
 5225 00be 40F00481 		bne	.L589
1796:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 5226              		.loc 1 1796 0
 5227 00c2 8E4B     		ldr	r3, .L623+16
 5228 00c4 8D4F     		ldr	r7, .L623+16
 5229 00c6 1B68     		ldr	r3, [r3]
 5230 00c8 1BB1     		cbz	r3, .L560
1797:bluetooth_rxtx.c **** 		}
 5231              		.loc 1 1797 0
 5232 00ca 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 5233 00cc 43F00203 		orr	r3, r3, #2
 5234 00d0 6370     		strb	r3, [r4, #1]
 5235              	.L560:
1800:bluetooth_rxtx.c **** 			goto rx_flush;
 5236              		.loc 1 1800 0
 5237 00d2 E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 5238 00d4 03F0FF01 		and	r1, r3, #255
 5239 00d8 002B     		cmp	r3, #0
 5240 00da 40F0BE80 		bne	.L562
1804:bluetooth_rxtx.c **** 			continue;
 5241              		.loc 1 1804 0
 5242 00de DBF80030 		ldr	r3, [fp]
 5243 00e2 002B     		cmp	r3, #0
 5244 00e4 ADD0     		beq	.L553
1810:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
 5245              		.loc 1 1810 0
 5246 00e6 3422     		movs	r2, #52
 5247 00e8 05A8     		add	r0, sp, #20
 5248              	.LVL589:
 5249 00ea FFF7FEFF 		bl	memset
 5250              	.LVL590:
1814:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5251              		.loc 1 1814 0
 5252 00ee B5F84C00 		ldrh	r0, [r5, #76]
1812:bluetooth_rxtx.c **** 
 5253              		.loc 1 1812 0
 5254 00f2 2B68     		ldr	r3, [r5]
1814:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5255              		.loc 1 1814 0
ARM GAS  /tmp/ccLwKaeN.s 			page 147


 5256 00f4 80B2     		uxth	r0, r0
1812:bluetooth_rxtx.c **** 
 5257              		.loc 1 1812 0
 5258 00f6 0593     		str	r3, [sp, #20]
1814:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5259              		.loc 1 1814 0
 5260 00f8 3026     		movs	r6, #48
 5261 00fa FFF7FEFF 		bl	btle_channel_index
 5262              	.LVL591:
 5263 00fe 4643     		muls	r6, r0, r6
 5264 0100 DFF83482 		ldr	r8, .L623+76
 5265 0104 08EB0603 		add	r3, r8, r6
 5266 0108 0193     		str	r3, [sp, #4]
 5267              	.LVL592:
 5268              	.LBB57:
1816:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5269              		.loc 1 1816 0
 5270 010a 7F4B     		ldr	r3, .L623+28
 5271              	.LVL593:
 5272 010c 93F800E0 		ldrb	lr, [r3]	@ zero_extendqisi2
1817:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5273              		.loc 1 1817 0
 5274 0110 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
1818:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5275              		.loc 1 1818 0
 5276 0112 9978     		ldrb	r1, [r3, #2]	@ zero_extendqisi2
1817:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5277              		.loc 1 1817 0
 5278 0114 1204     		lsls	r2, r2, #16
1819:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5279              		.loc 1 1819 0
 5280 0116 D878     		ldrb	r0, [r3, #3]	@ zero_extendqisi2
 5281              	.LVL594:
1817:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5282              		.loc 1 1817 0
 5283 0118 42EA0E62 		orr	r2, r2, lr, lsl #24
1819:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5284              		.loc 1 1819 0
 5285 011c 1043     		orrs	r0, r0, r2
1820:bluetooth_rxtx.c **** 		}
 5286              		.loc 1 1820 0
 5287 011e 40EA0120 		orr	r0, r0, r1, lsl #8
1819:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5288              		.loc 1 1819 0
 5289 0122 0293     		str	r3, [sp, #8]
1820:bluetooth_rxtx.c **** 		}
 5290              		.loc 1 1820 0
 5291 0124 FFF7FEFF 		bl	rbit
 5292              	.LVL595:
 5293 0128 58F80660 		ldr	r6, [r8, r6]
 5294 012c 4640     		eors	r6, r6, r0
 5295 012e 0696     		str	r6, [sp, #24]
 5296              	.LVL596:
 5297              	.LBE57:
1823:bluetooth_rxtx.c **** 		if (len > 39)
 5298              		.loc 1 1823 0
 5299 0130 C6F30526 		ubfx	r6, r6, #8, #6
ARM GAS  /tmp/ccLwKaeN.s 			page 148


 5300 0134 06F10208 		add	r8, r6, #2
 5301              	.LVL597:
1824:bluetooth_rxtx.c **** 			goto rx_flush;
 5302              		.loc 1 1824 0
 5303 0138 B8F1270F 		cmp	r8, #39
 5304 013c 00F38D80 		bgt	.L562
1829:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
 5305              		.loc 1 1829 0
 5306 0140 0836     		adds	r6, r6, #8
 5307              	.LVL598:
1830:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
 5308              		.loc 1 1830 0
 5309 0142 2B2E     		cmp	r6, #43
 5310 0144 6DD8     		bhi	.L566
1831:bluetooth_rxtx.c **** 				;
 5311              		.loc 1 1831 0 discriminator 2
 5312 0146 029B     		ldr	r3, [sp, #8]
 5313 0148 26F00302 		bic	r2, r6, #3
 5314 014c 6F49     		ldr	r1, .L623+32
 5315 014e 1344     		add	r3, r3, r2
 5316              	.L611:
 5317 0150 0A68     		ldr	r2, [r1]
 5318 0152 9A42     		cmp	r2, r3
 5319 0154 02D2     		bcs	.L567
1831:bluetooth_rxtx.c **** 				;
 5320              		.loc 1 1831 0 is_stmt 0 discriminator 1
 5321 0156 3A68     		ldr	r2, [r7]
 5322 0158 002A     		cmp	r2, #0
 5323 015a F9D0     		beq	.L611
 5324              	.L567:
1843:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5325              		.loc 1 1843 0 is_stmt 1
 5326 015c 0427     		movs	r7, #4
1837:bluetooth_rxtx.c **** 
 5327              		.loc 1 1837 0
 5328 015e DAF80030 		ldr	r3, [r10]
1840:bluetooth_rxtx.c **** 
 5329              		.loc 1 1840 0
 5330 0162 6120     		movs	r0, #97
1837:bluetooth_rxtx.c **** 
 5331              		.loc 1 1837 0
 5332 0164 23F00103 		bic	r3, r3, #1
 5333 0168 CAF80030 		str	r3, [r10]
1840:bluetooth_rxtx.c **** 
 5334              		.loc 1 1840 0
 5335 016c FFF7FEFF 		bl	cc2400_strobe
 5336              	.LVL599:
 5337              	.LBB58:
1844:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5338              		.loc 1 1844 0
 5339 0170 654A     		ldr	r2, .L623+28
 5340              	.LVL600:
 5341              	.L569:
 5342 0172 7B1C     		adds	r3, r7, #1
1844:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5343              		.loc 1 1844 0 is_stmt 0 discriminator 3
 5344 0174 12F807C0 		ldrb	ip, [r2, r7]	@ zero_extendqisi2
ARM GAS  /tmp/ccLwKaeN.s 			page 149


1845:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5345              		.loc 1 1845 0 is_stmt 1 discriminator 3
 5346 0178 D05C     		ldrb	r0, [r2, r3]	@ zero_extendqisi2
 5347 017a BB1C     		adds	r3, r7, #2
1846:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5348              		.loc 1 1846 0 discriminator 3
 5349 017c 12F803E0 		ldrb	lr, [r2, r3]	@ zero_extendqisi2
 5350 0180 FB1C     		adds	r3, r7, #3
1847:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5351              		.loc 1 1847 0 discriminator 3
 5352 0182 D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
 5353              	.LVL601:
1848:bluetooth_rxtx.c **** 		}
 5354              		.loc 1 1848 0 discriminator 3
 5355 0184 B910     		asrs	r1, r7, #2
1847:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5356              		.loc 1 1847 0 discriminator 3
 5357 0186 43EA0C63 		orr	r3, r3, ip, lsl #24
 5358              	.LVL602:
 5359 018a 43EA0040 		orr	r0, r3, r0, lsl #16
1848:bluetooth_rxtx.c **** 		}
 5360              		.loc 1 1848 0 discriminator 3
 5361 018e 40EA0E20 		orr	r0, r0, lr, lsl #8
1847:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5362              		.loc 1 1847 0 discriminator 3
 5363 0192 0392     		str	r2, [sp, #12]
1848:bluetooth_rxtx.c **** 		}
 5364              		.loc 1 1848 0 discriminator 3
 5365 0194 0291     		str	r1, [sp, #8]
 5366 0196 FFF7FEFF 		bl	rbit
 5367              	.LVL603:
 5368 019a 0299     		ldr	r1, [sp, #8]
 5369 019c 12AB     		add	r3, sp, #72
 5370 019e 03EB810E 		add	lr, r3, r1, lsl #2
 5371 01a2 019B     		ldr	r3, [sp, #4]
 5372              	.LBE58:
1843:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5373              		.loc 1 1843 0 discriminator 3
 5374 01a4 0437     		adds	r7, r7, #4
 5375              	.LVL604:
 5376              	.LBB59:
1848:bluetooth_rxtx.c **** 		}
 5377              		.loc 1 1848 0 discriminator 3
 5378 01a6 53F82130 		ldr	r3, [r3, r1, lsl #2]
 5379              	.LBE59:
1843:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5380              		.loc 1 1843 0 discriminator 3
 5381 01aa 2C2F     		cmp	r7, #44
 5382              	.LBB60:
1848:bluetooth_rxtx.c **** 		}
 5383              		.loc 1 1848 0 discriminator 3
 5384 01ac 80EA0300 		eor	r0, r0, r3
 5385 01b0 4EF8300C 		str	r0, [lr, #-48]
 5386              	.LBE60:
1843:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5387              		.loc 1 1843 0 discriminator 3
 5388 01b4 039A     		ldr	r2, [sp, #12]
ARM GAS  /tmp/ccLwKaeN.s 			page 150


 5389 01b6 DCD1     		bne	.L569
1851:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
 5390              		.loc 1 1851 0
 5391 01b8 2B69     		ldr	r3, [r5, #16]
 5392 01ba 002B     		cmp	r3, #0
 5393 01bc 39D1     		bne	.L570
 5394              	.LVL605:
 5395              	.L573:
1861:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
 5396              		.loc 1 1861 0
 5397 01be 1022     		movs	r2, #16
 5398 01c0 534B     		ldr	r3, .L623+36
1862:bluetooth_rxtx.c ****         if(btle_channel_index(channel) == idx3){
 5399              		.loc 1 1862 0
 5400 01c2 05A8     		add	r0, sp, #20
 5401              	.LVL606:
1861:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
 5402              		.loc 1 1861 0
 5403 01c4 1A60     		str	r2, [r3]
1862:bluetooth_rxtx.c ****         if(btle_channel_index(channel) == idx3){
 5404              		.loc 1 1862 0
 5405 01c6 A369     		ldr	r3, [r4, #24]
 5406 01c8 9847     		blx	r3
 5407              	.LVL607:
1863:bluetooth_rxtx.c ****             count3++;  
 5408              		.loc 1 1863 0
 5409 01ca B5F84C00 		ldrh	r0, [r5, #76]
 5410 01ce 80B2     		uxth	r0, r0
 5411 01d0 FFF7FEFF 		bl	btle_channel_index
 5412              	.LVL608:
 5413 01d4 95F87130 		ldrb	r3, [r5, #113]	@ zero_extendqisi2
 5414 01d8 8342     		cmp	r3, r0
 5415 01da 0CD1     		bne	.L574
1864:bluetooth_rxtx.c ****             if(count3 > count2-1){
 5416              		.loc 1 1864 0
 5417 01dc 94F83430 		ldrb	r3, [r4, #52]	@ zero_extendqisi2
1865:bluetooth_rxtx.c ****                 count3 = 0;
 5418              		.loc 1 1865 0
 5419 01e0 94F83520 		ldrb	r2, [r4, #53]	@ zero_extendqisi2
1864:bluetooth_rxtx.c ****             if(count3 > count2-1){
 5420              		.loc 1 1864 0
 5421 01e4 0133     		adds	r3, r3, #1
 5422 01e6 DBB2     		uxtb	r3, r3
1865:bluetooth_rxtx.c ****                 count3 = 0;
 5423              		.loc 1 1865 0
 5424 01e8 9A42     		cmp	r2, r3
1864:bluetooth_rxtx.c ****             if(count3 > count2-1){
 5425              		.loc 1 1864 0
 5426 01ea 84F83430 		strb	r3, [r4, #52]
1866:bluetooth_rxtx.c ****             }      
 5427              		.loc 1 1866 0
 5428 01ee DCBF     		itt	le
 5429 01f0 0023     		movle	r3, #0
 5430 01f2 84F83430 		strble	r3, [r4, #52]
 5431              	.L574:
1870:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
 5432              		.loc 1 1870 0
ARM GAS  /tmp/ccLwKaeN.s 			page 151


 5433 01f6 4FF08076 		mov	r6, #16777216
 5434 01fa 464B     		ldr	r3, .L623+40
1871:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 5435              		.loc 1 1871 0
 5436 01fc 05A9     		add	r1, sp, #20
 5437              	.LVL609:
1870:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
 5438              		.loc 1 1870 0
 5439 01fe 1E60     		str	r6, [r3]
1871:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 5440              		.loc 1 1871 0
 5441 0200 0120     		movs	r0, #1
 5442 0202 FFF7FEFF 		bl	enqueue
 5443              	.LVL610:
1874:bluetooth_rxtx.c **** 
 5444              		.loc 1 1874 0
 5445 0206 40F63541 		movw	r1, #3125
1872:bluetooth_rxtx.c **** 
 5446              		.loc 1 1872 0
 5447 020a 3A4B     		ldr	r3, .L623+8
1874:bluetooth_rxtx.c **** 
 5448              		.loc 1 1874 0
 5449 020c 424A     		ldr	r2, .L623+44
1872:bluetooth_rxtx.c **** 
 5450              		.loc 1 1872 0
 5451 020e 1E60     		str	r6, [r3]
1874:bluetooth_rxtx.c **** 
 5452              		.loc 1 1874 0
 5453 0210 424B     		ldr	r3, .L623+48
 5454 0212 1B68     		ldr	r3, [r3]
 5455 0214 1268     		ldr	r2, [r2]
 5456 0216 C3F31303 		ubfx	r3, r3, #0, #20
 5457 021a 01FB0323 		mla	r3, r1, r3, r2
 5458 021e AB64     		str	r3, [r5, #72]
 5459 0220 1BE0     		b	.L562
 5460              	.LVL611:
 5461              	.L566:
1834:bluetooth_rxtx.c **** 				;
 5462              		.loc 1 1834 0 discriminator 2
 5463 0222 3F4A     		ldr	r2, .L623+52
 5464              	.L612:
 5465 0224 1368     		ldr	r3, [r2]
 5466 0226 D807     		lsls	r0, r3, #31
 5467 0228 98D5     		bpl	.L567
1834:bluetooth_rxtx.c **** 				;
 5468              		.loc 1 1834 0 is_stmt 0 discriminator 1
 5469 022a 3B68     		ldr	r3, [r7]
 5470 022c 002B     		cmp	r3, #0
 5471 022e F9D0     		beq	.L612
 5472 0230 94E7     		b	.L567
 5473              	.LVL612:
 5474              	.L570:
 5475              	.LBB61:
1852:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
 5476              		.loc 1 1852 0 is_stmt 1
 5477 0232 4246     		mov	r2, r8
 5478 0234 06A9     		add	r1, sp, #24
ARM GAS  /tmp/ccLwKaeN.s 			page 152


 5479 0236 E868     		ldr	r0, [r5, #12]
 5480 0238 FFF7FEFF 		bl	btle_crcgen_lut
 5481              	.LVL613:
1854:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 5482              		.loc 1 1854 0
 5483 023c 12AB     		add	r3, sp, #72
1853:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 5484              		.loc 1 1853 0
 5485 023e 1E44     		add	r6, r6, r3
 5486              	.LVL614:
1854:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 5487              		.loc 1 1854 0
 5488 0240 9844     		add	r8, r8, r3
 5489              	.LVL615:
1853:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 5490              		.loc 1 1853 0
 5491 0242 16F8343C 		ldrb	r3, [r6, #-52]	@ zero_extendqisi2
1854:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 5492              		.loc 1 1854 0
 5493 0246 18F82F2C 		ldrb	r2, [r8, #-47]	@ zero_extendqisi2
1853:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 5494              		.loc 1 1853 0
 5495 024a 1B04     		lsls	r3, r3, #16
1854:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 5496              		.loc 1 1854 0
 5497 024c 43EA0223 		orr	r3, r3, r2, lsl #8
1855:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
 5498              		.loc 1 1855 0
 5499 0250 18F8302C 		ldrb	r2, [r8, #-48]	@ zero_extendqisi2
 5500 0254 1343     		orrs	r3, r3, r2
1856:bluetooth_rxtx.c **** 				goto rx_flush;
 5501              		.loc 1 1856 0
 5502 0256 9842     		cmp	r0, r3
 5503 0258 B1D0     		beq	.L573
 5504              	.LVL616:
 5505              	.L562:
 5506              	.LBE61:
1878:bluetooth_rxtx.c **** 
 5507              		.loc 1 1878 0
 5508 025a 6120     		movs	r0, #97
 5509 025c FFF7FEFF 		bl	cc2400_strobe
 5510              	.LVL617:
1881:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
 5511              		.loc 1 1881 0
 5512 0260 DAF80030 		ldr	r3, [r10]
1882:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
 5513              		.loc 1 1882 0
 5514 0264 2F4A     		ldr	r2, .L623+56
1881:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
 5515              		.loc 1 1881 0
 5516 0266 23F00103 		bic	r3, r3, #1
 5517 026a CAF80030 		str	r3, [r10]
 5518              	.L575:
1882:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
 5519              		.loc 1 1882 0
 5520 026e 1368     		ldr	r3, [r2]
 5521 0270 5907     		lsls	r1, r3, #29
ARM GAS  /tmp/ccLwKaeN.s 			page 153


 5522 0272 37D4     		bmi	.L576
1887:bluetooth_rxtx.c **** 		if (now < le.last_packet)
 5523              		.loc 1 1887 0
 5524 0274 40F63541 		movw	r1, #3125
 5525 0278 284B     		ldr	r3, .L623+48
 5526 027a 274A     		ldr	r2, .L623+44
 5527 027c 1B68     		ldr	r3, [r3]
 5528 027e 1268     		ldr	r2, [r2]
 5529 0280 C3F31303 		ubfx	r3, r3, #0, #20
 5530 0284 01FB0323 		mla	r3, r1, r3, r2
 5531              	.LVL618:
1888:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 5532              		.loc 1 1888 0
 5533 0288 A96C     		ldr	r1, [r5, #72]
1891:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
 5534              		.loc 1 1891 0
 5535 028a 2A7D     		ldrb	r2, [r5, #20]	@ zero_extendqisi2
1888:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 5536              		.loc 1 1888 0
 5537 028c 8B42     		cmp	r3, r1
1889:bluetooth_rxtx.c **** 		if  ( // timeout
 5538              		.loc 1 1889 0
 5539 028e 38BF     		it	cc
 5540 0290 03F14343 		addcc	r3, r3, #-1023410176
 5541              	.LVL619:
1890:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 5542              		.loc 1 1890 0
 5543 0294 A2F10202 		sub	r2, r2, #2
1889:bluetooth_rxtx.c **** 		if  ( // timeout
 5544              		.loc 1 1889 0
 5545 0298 38BF     		it	cc
 5546 029a 03F5A003 		addcc	r3, r3, #5242880
 5547              	.LVL620:
1890:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 5548              		.loc 1 1890 0
 5549 029e 012A     		cmp	r2, #1
 5550 02a0 03D8     		bhi	.L578
1892:bluetooth_rxtx.c **** 			// jam finished
 5551              		.loc 1 1892 0
 5552 02a2 214A     		ldr	r2, .L623+60
 5553 02a4 5B1A     		subs	r3, r3, r1
 5554              	.LVL621:
 5555 02a6 9342     		cmp	r3, r2
 5556 02a8 02D8     		bhi	.L579
 5557              	.L578:
1894:bluetooth_rxtx.c **** 			)
 5558              		.loc 1 1894 0
 5559 02aa A36B     		ldr	r3, [r4, #56]
 5560 02ac 012B     		cmp	r3, #1
 5561 02ae 5CD1     		bne	.L580
 5562              	.L579:
1897:bluetooth_rxtx.c **** 			le_jam_count = 0;
 5563              		.loc 1 1897 0
 5564 02b0 FFF7FEFF 		bl	reset_le
 5565              	.LVL622:
1899:bluetooth_rxtx.c **** 
 5566              		.loc 1 1899 0
ARM GAS  /tmp/ccLwKaeN.s 			page 154


 5567 02b4 4FF48072 		mov	r2, #256
1898:bluetooth_rxtx.c **** 			TXLED_CLR;
 5568              		.loc 1 1898 0
 5569 02b8 0023     		movs	r3, #0
1899:bluetooth_rxtx.c **** 
 5570              		.loc 1 1899 0
 5571 02ba 0099     		ldr	r1, [sp]
1898:bluetooth_rxtx.c **** 			TXLED_CLR;
 5572              		.loc 1 1898 0
 5573 02bc A363     		str	r3, [r4, #56]
1899:bluetooth_rxtx.c **** 
 5574              		.loc 1 1899 0
 5575 02be 0A60     		str	r2, [r1]
1901:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 5576              		.loc 1 1901 0
 5577 02c0 E27C     		ldrb	r2, [r4, #19]	@ zero_extendqisi2
 5578 02c2 012A     		cmp	r2, #1
 5579 02c4 3AD1     		bne	.L581
1902:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
 5580              		.loc 1 1902 0
 5581 02c6 E374     		strb	r3, [r4, #19]
1903:bluetooth_rxtx.c **** 				goto cleanup;
 5582              		.loc 1 1903 0
 5583 02c8 A374     		strb	r3, [r4, #18]
 5584              	.L589:
 5585              	.LBE63:
1953:bluetooth_rxtx.c **** 
 5586              		.loc 1 1953 0
 5587 02ca 4FF08072 		mov	r2, #16777216
 5588 02ce 114B     		ldr	r3, .L623+40
 5589 02d0 1A60     		str	r2, [r3]
1956:bluetooth_rxtx.c **** 	dio_ssp_stop();
 5590              		.loc 1 1956 0
 5591 02d2 FFF7FEFF 		bl	cc2400_idle
 5592              	.LVL623:
1957:bluetooth_rxtx.c **** 	cs_trigger_disable();
 5593              		.loc 1 1957 0
 5594 02d6 FFF7FEFF 		bl	dio_ssp_stop
 5595              	.LVL624:
1958:bluetooth_rxtx.c **** }
 5596              		.loc 1 1958 0
 5597 02da FFF7FEFF 		bl	cs_trigger_disable
 5598              	.LVL625:
1959:bluetooth_rxtx.c **** 
 5599              		.loc 1 1959 0
 5600 02de 13B0     		add	sp, sp, #76
 5601              		.cfi_remember_state
 5602              		.cfi_def_cfa_offset 36
 5603              		@ sp needed
 5604 02e0 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 5605              	.L576:
 5606              		.cfi_restore_state
 5607              	.LBB64:
 5608              	.LBB62:
1883:bluetooth_rxtx.c **** 		}
 5609              		.loc 1 1883 0
 5610 02e4 114B     		ldr	r3, .L623+64
ARM GAS  /tmp/ccLwKaeN.s 			page 155


 5611 02e6 1B68     		ldr	r3, [r3]
 5612 02e8 C1E7     		b	.L575
 5613              	.L624:
 5614 02ea 00BF     		.align	2
 5615              	.L623:
 5616 02ec 00000000 		.word	.LANCHOR1
 5617 02f0 00000000 		.word	.LANCHOR0
 5618 02f4 00E100E0 		.word	-536813312
 5619 02f8 3CC00920 		.word	537509948
 5620 02fc 00000000 		.word	rx_err
 5621 0300 00000000 		.word	rssi_max
 5622 0304 00000000 		.word	rssi_min
 5623 0308 00000000 		.word	rxbuf1
 5624 030c 04410050 		.word	1342193924
 5625 0310 38C00920 		.word	537509944
 5626 0314 80E100E0 		.word	-536813184
 5627 0318 08400040 		.word	1073758216
 5628 031c 00000000 		.word	clkn
 5629 0320 10410050 		.word	1342193936
 5630 0324 0C000340 		.word	1073938444
 5631 0328 80F0FA02 		.word	50000000
 5632 032c 08000340 		.word	1073938440
 5633 0330 24000340 		.word	1073938468
 5634 0334 00000000 		.word	rx_tc
 5635 0338 FC000000 		.word	.LANCHOR2+252
 5636              	.L581:
 5637              	.LBE62:
1908:bluetooth_rxtx.c **** 				goto cleanup;
 5638              		.loc 1 1908 0
 5639 033c B9F10A0F 		cmp	r9, #10
 5640 0340 C3D0     		beq	.L589
1911:bluetooth_rxtx.c **** 
 5641              		.loc 1 1911 0
 5642 0342 0123     		movs	r3, #1
1913:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5643              		.loc 1 1913 0
 5644 0344 6420     		movs	r0, #100
1911:bluetooth_rxtx.c **** 
 5645              		.loc 1 1911 0
 5646 0346 2B75     		strb	r3, [r5, #20]
1913:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5647              		.loc 1 1913 0
 5648 0348 FFF7FEFF 		bl	cc2400_strobe
 5649              	.LVL626:
 5650              	.L583:
1914:bluetooth_rxtx.c **** 
 5651              		.loc 1 1914 0 discriminator 1
 5652 034c FFF7FEFF 		bl	cc2400_status
 5653              	.LVL627:
 5654 0350 4207     		lsls	r2, r0, #29
 5655 0352 FBD4     		bmi	.L583
1917:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5656              		.loc 1 1917 0
 5657 0354 B5F85030 		ldrh	r3, [r5, #80]
 5658 0358 9BB2     		uxth	r3, r3
 5659 035a 03B3     		cbz	r3, .L591
1917:bluetooth_rxtx.c **** 			restart_jamming = 1;
ARM GAS  /tmp/ccLwKaeN.s 			page 156


 5660              		.loc 1 1917 0 is_stmt 0 discriminator 1
 5661 035c B5F85030 		ldrh	r3, [r5, #80]
 5662 0360 9BB2     		uxth	r3, r3
 5663              	.L584:
1917:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5664              		.loc 1 1917 0 discriminator 4
 5665 0362 A5F84C30 		strh	r3, [r5, #76]	@ movhi
1918:bluetooth_rxtx.c **** 		}
 5666              		.loc 1 1918 0 is_stmt 1 discriminator 4
 5667 0366 0123     		movs	r3, #1
 5668 0368 E363     		str	r3, [r4, #60]
 5669              	.L580:
1921:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
 5670              		.loc 1 1921 0
 5671 036a E988     		ldrh	r1, [r5, #6]
 5672 036c 2C20     		movs	r0, #44
 5673 036e FFF7FEFF 		bl	cc2400_set
 5674              	.LVL628:
1922:bluetooth_rxtx.c **** 
 5675              		.loc 1 1922 0
 5676 0372 A988     		ldrh	r1, [r5, #4]
 5677 0374 2D20     		movs	r0, #45
 5678 0376 FFF7FEFF 		bl	cc2400_set
 5679              	.LVL629:
1924:bluetooth_rxtx.c **** 			hop();
 5680              		.loc 1 1924 0
 5681 037a E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 5682 037c 0BB1     		cbz	r3, .L585
1925:bluetooth_rxtx.c **** 
 5683              		.loc 1 1925 0
 5684 037e FFF7FEFF 		bl	hop
 5685              	.LVL630:
 5686              	.L585:
1928:bluetooth_rxtx.c **** 			le_jam();
 5687              		.loc 1 1928 0
 5688 0382 A36B     		ldr	r3, [r4, #56]
 5689 0384 002B     		cmp	r3, #0
 5690 0386 0DDD     		ble	.L586
1929:bluetooth_rxtx.c **** 			--le_jam_count;
 5691              		.loc 1 1929 0
 5692 0388 FFF7FEFF 		bl	le_jam
 5693              	.LVL631:
1930:bluetooth_rxtx.c **** 		} else {
 5694              		.loc 1 1930 0
 5695 038c A36B     		ldr	r3, [r4, #56]
 5696 038e 013B     		subs	r3, r3, #1
 5697 0390 A363     		str	r3, [r4, #56]
 5698              	.L587:
1946:bluetooth_rxtx.c **** 		rx_err = 0;
 5699              		.loc 1 1946 0
 5700 0392 0023     		movs	r3, #0
1947:bluetooth_rxtx.c **** 	}
 5701              		.loc 1 1947 0
 5702 0394 0E4A     		ldr	r2, .L625
1946:bluetooth_rxtx.c **** 		rx_err = 0;
 5703              		.loc 1 1946 0
 5704 0396 CBF80030 		str	r3, [fp]
ARM GAS  /tmp/ccLwKaeN.s 			page 157


1947:bluetooth_rxtx.c **** 	}
 5705              		.loc 1 1947 0
 5706 039a 1360     		str	r3, [r2]
 5707 039c 51E6     		b	.L553
 5708              	.L591:
1917:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5709              		.loc 1 1917 0
 5710 039e 40F66213 		movw	r3, #2402
 5711 03a2 DEE7     		b	.L584
 5712              	.L586:
1933:bluetooth_rxtx.c **** 			dio_ssp_start();
 5713              		.loc 1 1933 0
 5714 03a4 FFF7FEFF 		bl	dma_init_le
 5715              	.LVL632:
1934:bluetooth_rxtx.c **** 
 5716              		.loc 1 1934 0
 5717 03a8 FFF7FEFF 		bl	dio_ssp_start
 5718              	.LVL633:
1936:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
 5719              		.loc 1 1936 0
 5720 03ac E36B     		ldr	r3, [r4, #60]
 5721 03ae 3BB1     		cbz	r3, .L588
1937:bluetooth_rxtx.c **** 				restart_jamming = 0;
 5722              		.loc 1 1937 0
 5723 03b0 2868     		ldr	r0, [r5]
 5724 03b2 FFF7FEFF 		bl	rbit
 5725              	.LVL634:
 5726 03b6 FFF7FEFF 		bl	cc2400_rx_sync
 5727              	.LVL635:
1938:bluetooth_rxtx.c **** 			} else {
 5728              		.loc 1 1938 0
 5729 03ba 0023     		movs	r3, #0
 5730 03bc E363     		str	r3, [r4, #60]
 5731 03be E8E7     		b	.L587
 5732              	.L588:
1941:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
 5733              		.loc 1 1941 0 discriminator 1
 5734 03c0 FFF7FEFF 		bl	cc2400_status
 5735              	.LVL636:
 5736 03c4 4307     		lsls	r3, r0, #29
 5737 03c6 FBD5     		bpl	.L588
1942:bluetooth_rxtx.c **** 			}
 5738              		.loc 1 1942 0
 5739 03c8 6220     		movs	r0, #98
 5740 03ca FFF7FEFF 		bl	cc2400_strobe
 5741              	.LVL637:
 5742 03ce E0E7     		b	.L587
 5743              	.L626:
 5744              		.align	2
 5745              	.L625:
 5746 03d0 00000000 		.word	rx_err
 5747              	.LBE64:
 5748              		.cfi_endproc
 5749              	.LFE23:
 5751              		.global	__aeabi_i2d
 5752              		.global	__aeabi_dadd
 5753              		.global	__aeabi_ddiv
ARM GAS  /tmp/ccLwKaeN.s 			page 158


 5754              		.global	__aeabi_d2uiz
 5755              		.global	__aeabi_dmul
 5756              		.global	__aeabi_dsub
 5757              		.section	.text.promisc_recover_hop_interval,"ax",%progbits
 5758              		.align	1
 5759              		.global	promisc_recover_hop_interval
 5760              		.syntax unified
 5761              		.thumb
 5762              		.thumb_func
 5763              		.fpu softvfp
 5765              	promisc_recover_hop_interval:
 5766              	.LFB29:
2110:bluetooth_rxtx.c **** 
2111:bluetooth_rxtx.c **** // divide, rounding to the nearest integer: round up at 0.5.
2112:bluetooth_rxtx.c **** 
2113:bluetooth_rxtx.c **** 
2114:bluetooth_rxtx.c **** //sopan
2115:bluetooth_rxtx.c **** void promisc_recover_hop_interval(u8 *packet) {
 5767              		.loc 1 2115 0
 5768              		.cfi_startproc
 5769              		@ args = 0, pretend = 0, frame = 88
 5770              		@ frame_needed = 0, uses_anonymous_args = 0
 5771              	.LVL638:
 5772 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 5773              		.cfi_def_cfa_offset 36
 5774              		.cfi_offset 4, -36
 5775              		.cfi_offset 5, -32
 5776              		.cfi_offset 6, -28
 5777              		.cfi_offset 7, -24
 5778              		.cfi_offset 8, -20
 5779              		.cfi_offset 9, -16
 5780              		.cfi_offset 10, -12
 5781              		.cfi_offset 11, -8
 5782              		.cfi_offset 14, -4
 5783 0004 99B0     		sub	sp, sp, #100
 5784              		.cfi_def_cfa_offset 136
 5785              	.LVL639:
2116:bluetooth_rxtx.c ****     
2117:bluetooth_rxtx.c ****     // for hop interval
2118:bluetooth_rxtx.c **** 	static u32 prev_clk = 0;
2119:bluetooth_rxtx.c ****     	static u32 seq[18];
2120:bluetooth_rxtx.c **** 	static uint16_t count, sindex = 0;
2121:bluetooth_rxtx.c **** 	static uint8_t calc = 1;
2122:bluetooth_rxtx.c **** 	static int interval = 0;
2123:bluetooth_rxtx.c ****     	static uint8_t step, match = 0;
2124:bluetooth_rxtx.c **** 
2125:bluetooth_rxtx.c ****     // for hop increment
2126:bluetooth_rxtx.c ****     	static u32 first_ts = 0;
2127:bluetooth_rxtx.c ****     	u8 hops = 0;
2128:bluetooth_rxtx.c ****     	u32 diff = 0;
2129:bluetooth_rxtx.c ****     	u32 channels_hopped = 0;
2130:bluetooth_rxtx.c ****     	time_array1[0] = 0;
 5786              		.loc 1 2130 0
 5787 0006 0021     		movs	r1, #0
 5788 0008 D54E     		ldr	r6, .L719
2131:bluetooth_rxtx.c **** 
2132:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccLwKaeN.s 			page 159


2133:bluetooth_rxtx.c **** 
2134:bluetooth_rxtx.c ****     // for increment
2135:bluetooth_rxtx.c ****     
2136:bluetooth_rxtx.c ****     if(count > 8){
 5789              		.loc 1 2136 0
 5790 000a B6F86030 		ldrh	r3, [r6, #96]
2130:bluetooth_rxtx.c **** 
 5791              		.loc 1 2130 0
 5792 000e A6F84010 		strh	r1, [r6, #64]	@ movhi
 5793              		.loc 1 2136 0
 5794 0012 082B     		cmp	r3, #8
 5795 0014 06D9     		bls	.L628
2137:bluetooth_rxtx.c **** 	count = 0;
2138:bluetooth_rxtx.c **** 	memset(seq, 0, sizeof seq);    
 5796              		.loc 1 2138 0
 5797 0016 4822     		movs	r2, #72
 5798 0018 06F16400 		add	r0, r6, #100
 5799              	.LVL640:
2137:bluetooth_rxtx.c **** 	count = 0;
 5800              		.loc 1 2137 0
 5801 001c A6F86010 		strh	r1, [r6, #96]	@ movhi
 5802              		.loc 1 2138 0
 5803 0020 FFF7FEFF 		bl	memset
 5804              	.LVL641:
 5805              	.L628:
2139:bluetooth_rxtx.c ****     }
2140:bluetooth_rxtx.c **** 
2141:bluetooth_rxtx.c **** 	u32 cur_clk = CLK100NS;
 5806              		.loc 1 2141 0
 5807 0024 40F63541 		movw	r1, #3125
 5808 0028 CE4C     		ldr	r4, .L719+4
 5809 002a CF4A     		ldr	r2, .L719+8
 5810 002c 2368     		ldr	r3, [r4]
 5811 002e 1268     		ldr	r2, [r2]
 5812 0030 C3F31303 		ubfx	r3, r3, #0, #20
 5813 0034 01FB0323 		mla	r3, r1, r3, r2
2142:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
 5814              		.loc 1 2142 0
 5815 0038 D6F8AC50 		ldr	r5, [r6, #172]
2141:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
 5816              		.loc 1 2141 0
 5817 003c 0393     		str	r3, [sp, #12]
 5818              	.LVL642:
 5819              		.loc 1 2142 0
 5820 003e AB42     		cmp	r3, r5
2143:bluetooth_rxtx.c **** 		cur_clk += 3267800000; // handle rollover
 5821              		.loc 1 2143 0
 5822 0040 3FBF     		itttt	cc
 5823 0042 03F14343 		addcc	r3, r3, #-1023410176
 5824              	.LVL643:
 5825 0046 A3F56513 		subcc	r3, r3, #3751936
 5826 004a A3F5A253 		subcc	r3, r3, #5184
 5827 004e 0393     		strcc	r3, [sp, #12]
 5828              	.LVL644:
2144:bluetooth_rxtx.c **** 	u32 clk_diff = cur_clk - prev_clk;
 5829              		.loc 1 2144 0
 5830 0050 039B     		ldr	r3, [sp, #12]
ARM GAS  /tmp/ccLwKaeN.s 			page 160


 5831 0052 5D1B     		subs	r5, r3, r5
 5832              	.LVL645:
2145:bluetooth_rxtx.c **** 
2146:bluetooth_rxtx.c **** 	static u16 obsv_hop_interval; // observed hop interval
2147:bluetooth_rxtx.c ****     	u16 hop_diff;
2148:bluetooth_rxtx.c **** 
2149:bluetooth_rxtx.c **** 	// probably consecutive data packets on the same channel
2150:bluetooth_rxtx.c **** 	if (clk_diff < 6 * LE_BASECLK)
 5833              		.loc 1 2150 0
 5834 0054 C54B     		ldr	r3, .L719+12
 5835 0056 9D42     		cmp	r5, r3
 5836 0058 40F2C880 		bls	.L627
2151:bluetooth_rxtx.c **** 		return;
2152:bluetooth_rxtx.c **** 	
2153:bluetooth_rxtx.c ****     if(match == 0){
 5837              		.loc 1 2153 0
 5838 005c 96F8B030 		ldrb	r3, [r6, #176]	@ zero_extendqisi2
 5839 0060 43B9     		cbnz	r3, .L631
2154:bluetooth_rxtx.c **** 	    seq[count] = (clk_diff/10000);
 5840              		.loc 1 2154 0
 5841 0062 42F21072 		movw	r2, #10000
 5842 0066 B5FBF2F2 		udiv	r2, r5, r2
 5843 006a B6F86030 		ldrh	r3, [r6, #96]
 5844 006e 06EB8303 		add	r3, r6, r3, lsl #2
 5845 0072 5A66     		str	r2, [r3, #100]
 5846              	.L631:
2155:bluetooth_rxtx.c ****     }
2156:bluetooth_rxtx.c ****     //debug_printf("s = %d\n",seq[count]);
2157:bluetooth_rxtx.c **** 	if(calc == 0){
 5847              		.loc 1 2157 0
 5848 0074 BE4F     		ldr	r7, .L719+16
 5849 0076 97F87280 		ldrb	r8, [r7, #114]	@ zero_extendqisi2
 5850 007a B8F1000F 		cmp	r8, #0
 5851 007e 39D1     		bne	.L633
 5852              	.LBB65:
2158:bluetooth_rxtx.c **** 		++sindex;
2159:bluetooth_rxtx.c ****         hop_diff = abs(seq[sindex] - (clk_diff/10000));
 5853              		.loc 1 2159 0
 5854 0080 42F21079 		movw	r9, #10000
 5855 0084 B5FBF9F9 		udiv	r9, r5, r9
2158:bluetooth_rxtx.c **** 		++sindex;
 5856              		.loc 1 2158 0
 5857 0088 B6F8B230 		ldrh	r3, [r6, #178]
 5858 008c 0133     		adds	r3, r3, #1
 5859 008e 9BB2     		uxth	r3, r3
 5860 0090 A6F8B230 		strh	r3, [r6, #178]	@ movhi
 5861              		.loc 1 2159 0
 5862 0094 06EB8303 		add	r3, r6, r3, lsl #2
 5863 0098 586E     		ldr	r0, [r3, #100]
 5864 009a A0EB0900 		sub	r0, r0, r9
 5865 009e FFF7FEFF 		bl	abs
 5866              	.LVL646:
2160:bluetooth_rxtx.c ****         interval += (clk_diff/10000);
 5867              		.loc 1 2160 0
 5868 00a2 D6F8B420 		ldr	r2, [r6, #180]
2161:bluetooth_rxtx.c ****         //debug_printf("sn=%d c=%d si =%d ei=%d cnt=%d interval=%d step=%d\n",seq[sindex],(clk_diff
2162:bluetooth_rxtx.c **** 		if(hop_diff <= 10){		
ARM GAS  /tmp/ccLwKaeN.s 			page 161


 5869              		.loc 1 2162 0
 5870 00a6 80B2     		uxth	r0, r0
2160:bluetooth_rxtx.c ****         interval += (clk_diff/10000);
 5871              		.loc 1 2160 0
 5872 00a8 4A44     		add	r2, r2, r9
 5873              		.loc 1 2162 0
 5874 00aa 0A28     		cmp	r0, #10
2160:bluetooth_rxtx.c ****         interval += (clk_diff/10000);
 5875              		.loc 1 2160 0
 5876 00ac C6F8B420 		str	r2, [r6, #180]
 5877              		.loc 1 2162 0
 5878 00b0 00F29F80 		bhi	.L634
2163:bluetooth_rxtx.c ****             if(step < 1){
 5879              		.loc 1 2163 0
 5880 00b4 96F8B830 		ldrb	r3, [r6, #184]	@ zero_extendqisi2
 5881 00b8 2BB9     		cbnz	r3, .L635
2164:bluetooth_rxtx.c ****                 time_array1[sindex] = interval;
 5882              		.loc 1 2164 0
 5883 00ba B6F8B210 		ldrh	r1, [r6, #178]
 5884 00be 06EB4101 		add	r1, r6, r1, lsl #1
 5885 00c2 A1F84020 		strh	r2, [r1, #64]	@ movhi
 5886              	.L635:
2165:bluetooth_rxtx.c ****             }
2166:bluetooth_rxtx.c **** 			if(sindex == eindex){
 5887              		.loc 1 2166 0
 5888 00c6 B6F8B210 		ldrh	r1, [r6, #178]
 5889 00ca B6F8BA20 		ldrh	r2, [r6, #186]
 5890 00ce 9142     		cmp	r1, r2
 5891 00d0 10D1     		bne	.L633
2167:bluetooth_rxtx.c ****                 match = 1;
 5892              		.loc 1 2167 0
 5893 00d2 0122     		movs	r2, #1
 5894 00d4 86F8B020 		strb	r2, [r6, #176]
2168:bluetooth_rxtx.c ****                 sindex = 0;
 5895              		.loc 1 2168 0
 5896 00d8 0022     		movs	r2, #0
2169:bluetooth_rxtx.c ****                 count = 0;
2170:bluetooth_rxtx.c ****                 step = step + 1;
 5897              		.loc 1 2170 0
 5898 00da 0133     		adds	r3, r3, #1
 5899 00dc DBB2     		uxtb	r3, r3
2171:bluetooth_rxtx.c ****                 if(step >= 3){
 5900              		.loc 1 2171 0
 5901 00de 022B     		cmp	r3, #2
2168:bluetooth_rxtx.c ****                 sindex = 0;
 5902              		.loc 1 2168 0
 5903 00e0 A6F8B220 		strh	r2, [r6, #178]	@ movhi
2169:bluetooth_rxtx.c ****                 count = 0;
 5904              		.loc 1 2169 0
 5905 00e4 A6F86020 		strh	r2, [r6, #96]	@ movhi
2170:bluetooth_rxtx.c ****                 if(step >= 3){
 5906              		.loc 1 2170 0
 5907 00e8 86F8B830 		strb	r3, [r6, #184]
 5908              		.loc 1 2171 0
 5909 00ec 39D9     		bls	.L639
2172:bluetooth_rxtx.c ****                     calc = 2;
 5910              		.loc 1 2172 0
ARM GAS  /tmp/ccLwKaeN.s 			page 162


 5911 00ee 0223     		movs	r3, #2
 5912 00f0 87F87230 		strb	r3, [r7, #114]
 5913              	.LVL647:
 5914              	.L633:
 5915              	.LBE65:
2173:bluetooth_rxtx.c ****                 }
2174:bluetooth_rxtx.c **** 			}
2175:bluetooth_rxtx.c ****         }
2176:bluetooth_rxtx.c **** 
2177:bluetooth_rxtx.c **** 		else{
2178:bluetooth_rxtx.c **** 			interval = 0;
2179:bluetooth_rxtx.c ****             sindex = 0;
2180:bluetooth_rxtx.c ****             memset(seq, 0, sizeof seq);
2181:bluetooth_rxtx.c ****             memset(time_array1, 0, sizeof time_array1);        
2182:bluetooth_rxtx.c **** 			calc = 1;
2183:bluetooth_rxtx.c ****             count = 1;
2184:bluetooth_rxtx.c ****             step = 0;
2185:bluetooth_rxtx.c ****             match = 0;
2186:bluetooth_rxtx.c ****             seq[count] = (clk_diff/10000);
2187:bluetooth_rxtx.c **** 			}
2188:bluetooth_rxtx.c **** 	}
2189:bluetooth_rxtx.c **** 
2190:bluetooth_rxtx.c **** 	if((count > 1) && (calc == 1)){
 5916              		.loc 1 2190 0
 5917 00f4 B6F86030 		ldrh	r3, [r6, #96]
 5918 00f8 012B     		cmp	r3, #1
 5919 00fa 32D9     		bls	.L639
 5920              		.loc 1 2190 0 is_stmt 0 discriminator 1
 5921 00fc 97F87280 		ldrb	r8, [r7, #114]	@ zero_extendqisi2
 5922 0100 B8F1010F 		cmp	r8, #1
 5923 0104 2DD1     		bne	.L639
 5924              	.LBB66:
2191:bluetooth_rxtx.c ****         hop_diff = abs(seq[1] - (clk_diff/10000));
 5925              		.loc 1 2191 0 is_stmt 1
 5926 0106 42F21073 		movw	r3, #10000
 5927 010a B5FBF3F5 		udiv	r5, r5, r3
 5928              	.LVL648:
 5929 010e B06E     		ldr	r0, [r6, #104]
 5930 0110 401B     		subs	r0, r0, r5
 5931 0112 FFF7FEFF 		bl	abs
 5932              	.LVL649:
2192:bluetooth_rxtx.c **** 		if(hop_diff <= 10){
 5933              		.loc 1 2192 0
 5934 0116 80B2     		uxth	r0, r0
 5935 0118 0A28     		cmp	r0, #10
 5936 011a 22D8     		bhi	.L639
2193:bluetooth_rxtx.c **** 			interval += (clk_diff/10000);
2194:bluetooth_rxtx.c **** 			calc = 0;
 5937              		.loc 1 2194 0
 5938 011c 0022     		movs	r2, #0
2193:bluetooth_rxtx.c **** 			interval += (clk_diff/10000);
 5939              		.loc 1 2193 0
 5940 011e D6F8B430 		ldr	r3, [r6, #180]
 5941              		.loc 1 2194 0
 5942 0122 87F87220 		strb	r2, [r7, #114]
2193:bluetooth_rxtx.c **** 			interval += (clk_diff/10000);
 5943              		.loc 1 2193 0
ARM GAS  /tmp/ccLwKaeN.s 			page 163


 5944 0126 1D44     		add	r5, r5, r3
2195:bluetooth_rxtx.c **** 			sindex = 1;
2196:bluetooth_rxtx.c **** 			eindex = count - 1;
 5945              		.loc 1 2196 0
 5946 0128 B6F86030 		ldrh	r3, [r6, #96]
2193:bluetooth_rxtx.c **** 			interval += (clk_diff/10000);
 5947              		.loc 1 2193 0
 5948 012c C6F8B450 		str	r5, [r6, #180]
 5949              		.loc 1 2196 0
 5950 0130 013B     		subs	r3, r3, #1
 5951 0132 9BB2     		uxth	r3, r3
2197:bluetooth_rxtx.c ****             if(sindex == eindex){
 5952              		.loc 1 2197 0
 5953 0134 012B     		cmp	r3, #1
2195:bluetooth_rxtx.c **** 			sindex = 1;
 5954              		.loc 1 2195 0
 5955 0136 A6F8B280 		strh	r8, [r6, #178]	@ movhi
2196:bluetooth_rxtx.c ****             if(sindex == eindex){
 5956              		.loc 1 2196 0
 5957 013a A6F8BA30 		strh	r3, [r6, #186]	@ movhi
 5958              		.loc 1 2197 0
 5959 013e 0AD1     		bne	.L640
2198:bluetooth_rxtx.c ****                 match = 1;
 5960              		.loc 1 2198 0
 5961 0140 86F8B030 		strb	r3, [r6, #176]
2199:bluetooth_rxtx.c ****                 sindex = 0;
2200:bluetooth_rxtx.c ****                 count = 0;
2201:bluetooth_rxtx.c ****                 step = step + 1;
 5962              		.loc 1 2201 0
 5963 0144 96F8B830 		ldrb	r3, [r6, #184]	@ zero_extendqisi2
2199:bluetooth_rxtx.c ****                 sindex = 0;
 5964              		.loc 1 2199 0
 5965 0148 A6F8B220 		strh	r2, [r6, #178]	@ movhi
 5966              		.loc 1 2201 0
 5967 014c 0133     		adds	r3, r3, #1
2200:bluetooth_rxtx.c ****                 step = step + 1;
 5968              		.loc 1 2200 0
 5969 014e A6F86020 		strh	r2, [r6, #96]	@ movhi
 5970              		.loc 1 2201 0
 5971 0152 86F8B830 		strb	r3, [r6, #184]
 5972              	.L640:
2202:bluetooth_rxtx.c **** 			}
2203:bluetooth_rxtx.c ****             time_array1[sindex] = interval;
 5973              		.loc 1 2203 0
 5974 0156 B6F8B230 		ldrh	r3, [r6, #178]
 5975 015a 06EB4303 		add	r3, r6, r3, lsl #1
 5976 015e A3F84050 		strh	r5, [r3, #64]	@ movhi
 5977              	.LVL650:
 5978              	.L639:
 5979              	.LBE66:
2204:bluetooth_rxtx.c ****             //debug_printf("s1=%d c=%d si =%d ei=%d cnt=%d interval=%d step=%d\n",seq[1],(clk_diff/
2205:bluetooth_rxtx.c **** 		}
2206:bluetooth_rxtx.c **** 	}
2207:bluetooth_rxtx.c **** 
2208:bluetooth_rxtx.c ****     if(calc == 2){
 5980              		.loc 1 2208 0
 5981 0162 97F87230 		ldrb	r3, [r7, #114]	@ zero_extendqisi2
ARM GAS  /tmp/ccLwKaeN.s 			page 164


 5982 0166 022B     		cmp	r3, #2
 5983 0168 5DD1     		bne	.L641
 5984              	.LBB67:
2209:bluetooth_rxtx.c **** 	uint16_t val = DIVIDE_ROUND(interval,step);
 5985              		.loc 1 2209 0
 5986 016a 96F8B820 		ldrb	r2, [r6, #184]	@ zero_extendqisi2
 5987              	.LVL651:
 5988 016e D6F8B430 		ldr	r3, [r6, #180]
2210:bluetooth_rxtx.c **** 	obsv_hop_interval = DIVIDE_ROUND(val, 37);
2211:bluetooth_rxtx.c **** 	debug_printf("Hop interval: %d\n",obsv_hop_interval);
 5989              		.loc 1 2211 0
 5990 0172 8048     		ldr	r0, .L719+20
2209:bluetooth_rxtx.c **** 	uint16_t val = DIVIDE_ROUND(interval,step);
 5991              		.loc 1 2209 0
 5992 0174 03EB5201 		add	r1, r3, r2, lsr #1
 5993 0178 91FBF2F1 		sdiv	r1, r1, r2
2210:bluetooth_rxtx.c **** 	obsv_hop_interval = DIVIDE_ROUND(val, 37);
 5994              		.loc 1 2210 0
 5995 017c 2523     		movs	r3, #37
 5996 017e 89B2     		uxth	r1, r1
 5997 0180 1231     		adds	r1, r1, #18
 5998 0182 91FBF3F1 		sdiv	r1, r1, r3
 5999 0186 A6F8BC10 		strh	r1, [r6, #188]	@ movhi
 6000              		.loc 1 2211 0
 6001 018a FFF7FEFF 		bl	debug_printf
 6002              	.LVL652:
2212:bluetooth_rxtx.c **** 	le.conn_interval = DIVIDE_ROUND(obsv_hop_interval, 1.25);
 6003              		.loc 1 2212 0
 6004 018e B6F8BC00 		ldrh	r0, [r6, #188]
 6005 0192 FFF7FEFF 		bl	__aeabi_i2d
 6006              	.LVL653:
 6007 0196 0022     		movs	r2, #0
 6008 0198 774B     		ldr	r3, .L719+24
 6009 019a FFF7FEFF 		bl	__aeabi_dadd
 6010              	.LVL654:
 6011 019e 0022     		movs	r2, #0
 6012 01a0 764B     		ldr	r3, .L719+28
 6013 01a2 FFF7FEFF 		bl	__aeabi_ddiv
 6014              	.LVL655:
 6015 01a6 FFF7FEFF 		bl	__aeabi_d2uiz
 6016              	.LVL656:
2213:bluetooth_rxtx.c **** 	first_ts = CLK100NS; 
 6017              		.loc 1 2213 0
 6018 01aa 40F63541 		movw	r1, #3125
 6019 01ae 6E4A     		ldr	r2, .L719+8
 6020 01b0 2368     		ldr	r3, [r4]
 6021 01b2 1268     		ldr	r2, [r2]
 6022 01b4 C3F31303 		ubfx	r3, r3, #0, #20
 6023 01b8 01FB0323 		mla	r3, r1, r3, r2
2212:bluetooth_rxtx.c **** 	le.conn_interval = DIVIDE_ROUND(obsv_hop_interval, 1.25);
 6024              		.loc 1 2212 0
 6025 01bc F883     		strh	r0, [r7, #30]	@ movhi
2214:bluetooth_rxtx.c **** 	hop_direct_channel = btle_channel_index_to_phys(idx2);
 6026              		.loc 1 2214 0
 6027 01be 97F87300 		ldrb	r0, [r7, #115]	@ zero_extendqisi2
2213:bluetooth_rxtx.c **** 	first_ts = CLK100NS; 
 6028              		.loc 1 2213 0
ARM GAS  /tmp/ccLwKaeN.s 			page 165


 6029 01c2 C6F8C030 		str	r3, [r6, #192]
 6030              		.loc 1 2214 0
 6031 01c6 FFF7FEFF 		bl	btle_channel_index_to_phys
 6032              	.LVL657:
2215:bluetooth_rxtx.c **** 	hop_mode = HOP_DIRECT;
 6033              		.loc 1 2215 0
 6034 01ca 0423     		movs	r3, #4
2214:bluetooth_rxtx.c **** 	hop_direct_channel = btle_channel_index_to_phys(idx2);
 6035              		.loc 1 2214 0
 6036 01cc B081     		strh	r0, [r6, #12]	@ movhi
 6037              		.loc 1 2215 0
 6038 01ce B372     		strb	r3, [r6, #10]
2216:bluetooth_rxtx.c **** 	do_hop = 1;
 6039              		.loc 1 2216 0
 6040 01d0 0123     		movs	r3, #1
 6041 01d2 F372     		strb	r3, [r6, #11]
2217:bluetooth_rxtx.c **** 	calc = 3;
 6042              		.loc 1 2217 0
 6043 01d4 0323     		movs	r3, #3
 6044 01d6 87F87230 		strb	r3, [r7, #114]
 6045              	.LVL658:
 6046              	.L642:
 6047              	.LBE67:
2218:bluetooth_rxtx.c ****     }
2219:bluetooth_rxtx.c **** 
2220:bluetooth_rxtx.c ****     // for increment
2221:bluetooth_rxtx.c **** 
2222:bluetooth_rxtx.c ****     else if (channel == btle_channel_index_to_phys(idx2) && calc == 3) {
2223:bluetooth_rxtx.c **** 		u32 second_ts = CLK100NS;
2224:bluetooth_rxtx.c **** 	if (second_ts < first_ts){
2225:bluetooth_rxtx.c **** 		second_ts += 3276800000;
2226:bluetooth_rxtx.c ****         }
2227:bluetooth_rxtx.c **** 
2228:bluetooth_rxtx.c ****         diff = (second_ts - first_ts);
2229:bluetooth_rxtx.c ****         time_array2[count1] = diff/10000;//
2230:bluetooth_rxtx.c **** 		channels_hopped = DIVIDE_ROUND(diff,le.conn_interval * LE_BASECLK);
2231:bluetooth_rxtx.c **** 
2232:bluetooth_rxtx.c **** 	if (channels_hopped > 37) {
2233:bluetooth_rxtx.c ****             	first_ts = CLK100NS; 
2234:bluetooth_rxtx.c ****             	hop_direct_channel = btle_channel_index_to_phys(idx3);
2235:bluetooth_rxtx.c **** 		hop_mode = HOP_DIRECT;
2236:bluetooth_rxtx.c **** 	    	do_hop = 1;
2237:bluetooth_rxtx.c ****             	calc = 4;
2238:bluetooth_rxtx.c **** 	}
2239:bluetooth_rxtx.c **** 	do_hop = 1;
2240:bluetooth_rxtx.c **** 	//debug_printf("Count1 %d ch %d diff %d int %d arr %d\n", count1, channels_hopped, diff, le.conn_i
2241:bluetooth_rxtx.c **** 	++count1;
2242:bluetooth_rxtx.c **** 	}
2243:bluetooth_rxtx.c ****     
2244:bluetooth_rxtx.c ****     else if(channel == btle_channel_index_to_phys(idx3) && calc == 4){
2245:bluetooth_rxtx.c ****         u32 second_ts2 = CLK100NS;
2246:bluetooth_rxtx.c **** 		if (second_ts2 < first_ts){
2247:bluetooth_rxtx.c **** 			second_ts2 += 3276800000;
2248:bluetooth_rxtx.c ****         }
2249:bluetooth_rxtx.c **** 
2250:bluetooth_rxtx.c ****         diff = (second_ts2 - first_ts);
2251:bluetooth_rxtx.c ****         time_array3[count2] = ((diff/10000)+ time_array2[0])%(37*obsv_hop_interval);
ARM GAS  /tmp/ccLwKaeN.s 			page 166


2252:bluetooth_rxtx.c **** 		channels_hopped = DIVIDE_ROUND(diff,le.conn_interval * LE_BASECLK);
2253:bluetooth_rxtx.c **** 
2254:bluetooth_rxtx.c **** 		if (channels_hopped > 37) {
2255:bluetooth_rxtx.c ****             		calc = 5;
2256:bluetooth_rxtx.c **** 		}
2257:bluetooth_rxtx.c **** 		do_hop = 1;
2258:bluetooth_rxtx.c ****         //debug_printf("Count2 %d ch %d diff %d int %d arr %d\n", count2, channels_hopped, diff, le
2259:bluetooth_rxtx.c ****         ++count2;
2260:bluetooth_rxtx.c ****     }
2261:bluetooth_rxtx.c **** 
2262:bluetooth_rxtx.c ****     else if(calc == 5){
2263:bluetooth_rxtx.c **** 
2264:bluetooth_rxtx.c ****         static u8 index = 0; 
2265:bluetooth_rxtx.c ****         static u16 ch_hop[32];
2266:bluetooth_rxtx.c ****         static u16 diff = 0;
2267:bluetooth_rxtx.c ****         static u16 max_count = 1;
2268:bluetooth_rxtx.c ****         static u16 curr_count = 0;
2269:bluetooth_rxtx.c ****         static u16 max_val; 
2270:bluetooth_rxtx.c ****         static u16 val;
2271:bluetooth_rxtx.c ****         static u8 ta1, ta2, ta3 = 0;
2272:bluetooth_rxtx.c ****         static u8 i, j = 0;
2273:bluetooth_rxtx.c ****         static u8 hops,hops2 = 0;
2274:bluetooth_rxtx.c **** 
2275:bluetooth_rxtx.c ****         for( ta1 = 0; ta1 < eindex; ta1++){
2276:bluetooth_rxtx.c ****             for( ta2 = 0; ta2 < count1-1; ta2++){
2277:bluetooth_rxtx.c ****                 if(time_array1[ta1] > time_array2[ta2]){
2278:bluetooth_rxtx.c ****                     diff = (le.conn_interval*1.25*37) - time_array1[ta1] + time_array2[ta2];
2279:bluetooth_rxtx.c ****                 }
2280:bluetooth_rxtx.c ****                 else {
2281:bluetooth_rxtx.c ****                     diff = time_array2[ta2] - time_array1[ta1];
2282:bluetooth_rxtx.c ****                 }
2283:bluetooth_rxtx.c **** 
2284:bluetooth_rxtx.c ****                 u8 channels_hopped = DIVIDE_ROUND(diff,le.conn_interval*1.25);
2285:bluetooth_rxtx.c ****                 if((idx2 - idx1) > 0){
2286:bluetooth_rxtx.c ****                     hops = ((idx2 - idx1)*hop_interval_lut[channels_hopped])%37;
2287:bluetooth_rxtx.c ****                 }
2288:bluetooth_rxtx.c ****                 else{
2289:bluetooth_rxtx.c ****                     hops = ((37 + idx2 - idx1)*hop_interval_lut[channels_hopped])%37;
2290:bluetooth_rxtx.c ****                 }
2291:bluetooth_rxtx.c ****                 if ((hops > 4) && (hops < 17)){
2292:bluetooth_rxtx.c ****                 //added
2293:bluetooth_rxtx.c ****                     for( ta3 = 0; ta3 < count2 - 1; ta3++){
2294:bluetooth_rxtx.c ****                         if(time_array2[ta2] > time_array3[ta3]){
2295:bluetooth_rxtx.c ****                             diff = (le.conn_interval*1.25*37) - time_array2[ta2] + time_array3[ta3]
2296:bluetooth_rxtx.c ****                         }
2297:bluetooth_rxtx.c ****                         else {
2298:bluetooth_rxtx.c ****                             diff = time_array3[ta3] - time_array2[ta2];
2299:bluetooth_rxtx.c ****                         }
2300:bluetooth_rxtx.c ****                         u8 channels_hopped = DIVIDE_ROUND(diff,le.conn_interval*1.25);
2301:bluetooth_rxtx.c ****                         if((idx3 - idx2) > 0){
2302:bluetooth_rxtx.c ****                             hops2 = ((idx3 - idx2)*hop_interval_lut[channels_hopped])%37;
2303:bluetooth_rxtx.c ****                         }
2304:bluetooth_rxtx.c ****                         else{
2305:bluetooth_rxtx.c ****                             hops2 = ((37 + idx3 - idx2)*hop_interval_lut[channels_hopped])%37;
2306:bluetooth_rxtx.c ****                         }
2307:bluetooth_rxtx.c ****                         if (hops2 == hops){
2308:bluetooth_rxtx.c ****                               ch_hop[index] = hops;
ARM GAS  /tmp/ccLwKaeN.s 			page 167


2309:bluetooth_rxtx.c ****                               sync_count = ta3+1;
2310:bluetooth_rxtx.c ****                               index += 1;
2311:bluetooth_rxtx.c ****                         }
2312:bluetooth_rxtx.c ****                     }
2313:bluetooth_rxtx.c ****                 //added
2314:bluetooth_rxtx.c ****                      ch_hop[index] = hops;
2315:bluetooth_rxtx.c ****                      index += 1;
2316:bluetooth_rxtx.c ****                 }
2317:bluetooth_rxtx.c ****             }
2318:bluetooth_rxtx.c ****         }
2319:bluetooth_rxtx.c **** /*      
2320:bluetooth_rxtx.c ****         for( ta1 = 0; ta1 < count1 - 1; ta1++){
2321:bluetooth_rxtx.c ****             for( ta2 = 0; ta2 < count2 - 1; ta2++){
2322:bluetooth_rxtx.c ****                 if(time_array2[ta1] > time_array3[ta2]){
2323:bluetooth_rxtx.c ****                     diff = (le.conn_interval*1.25*37) - time_array2[ta1] + time_array3[ta2];
2324:bluetooth_rxtx.c ****                 }
2325:bluetooth_rxtx.c ****                 else {
2326:bluetooth_rxtx.c ****                     diff = time_array3[ta2] - time_array2[ta1];
2327:bluetooth_rxtx.c ****                 }
2328:bluetooth_rxtx.c **** 
2329:bluetooth_rxtx.c ****                 u8 channels_hopped = DIVIDE_ROUND(diff,le.conn_interval*1.25);
2330:bluetooth_rxtx.c ****                 if((idx3 - idx2) > 0){
2331:bluetooth_rxtx.c ****                     hops = ((idx3 - idx2)*hop_interval_lut[channels_hopped])%37;
2332:bluetooth_rxtx.c ****                 }
2333:bluetooth_rxtx.c ****                 else{
2334:bluetooth_rxtx.c ****                     hops = ((37 + idx3 - idx2)*hop_interval_lut[channels_hopped])%37;
2335:bluetooth_rxtx.c ****                 }
2336:bluetooth_rxtx.c ****                 if ((hops > 4) && (hops < 17)){
2337:bluetooth_rxtx.c ****                       ch_hop[index] = hops;
2338:bluetooth_rxtx.c ****                       index += 1;
2339:bluetooth_rxtx.c ****                 }
2340:bluetooth_rxtx.c ****             }
2341:bluetooth_rxtx.c ****         }
2342:bluetooth_rxtx.c **** */
2343:bluetooth_rxtx.c ****         for( j = 0; j< index; j++){
2344:bluetooth_rxtx.c ****             val = ch_hop[j];
2345:bluetooth_rxtx.c ****             for( i = j; i < index; i++){
2346:bluetooth_rxtx.c ****                 if(val == ch_hop[i]){
2347:bluetooth_rxtx.c ****                     curr_count++;
2348:bluetooth_rxtx.c ****                  }
2349:bluetooth_rxtx.c ****             }
2350:bluetooth_rxtx.c ****             if(curr_count > max_count){
2351:bluetooth_rxtx.c ****                 max_count = curr_count;
2352:bluetooth_rxtx.c ****                 max_val = val;
2353:bluetooth_rxtx.c ****             }
2354:bluetooth_rxtx.c ****             curr_count = 0;
2355:bluetooth_rxtx.c ****         }
2356:bluetooth_rxtx.c ****         le.channel_increment = max_val;
2357:bluetooth_rxtx.c ****         debug_printf("Increment: %d Interval: %d %d out of %d\n",le.channel_increment,le.conn_inter
2358:bluetooth_rxtx.c ****         calc = 6;
2359:bluetooth_rxtx.c ****     
2360:bluetooth_rxtx.c ****         /*le.channel_increment = max_val;
2361:bluetooth_rxtx.c ****         debug_printf("Increment: %d Interval: %d %d out of %d\n",le.channel_increment,le.conn_inter
2362:bluetooth_rxtx.c ****         le.interval_timer = le.conn_interval / 2;
2363:bluetooth_rxtx.c ****         le.conn_count = 0;
2364:bluetooth_rxtx.c ****         le.conn_epoch = 0;
2365:bluetooth_rxtx.c ****         le.channel_idx = (idx3 + le.channel_increment) % 37;
ARM GAS  /tmp/ccLwKaeN.s 			page 168


2366:bluetooth_rxtx.c ****         le.link_state = LINK_CONNECTED;
2367:bluetooth_rxtx.c ****         le.crc_verify = 0;
2368:bluetooth_rxtx.c ****         hop_mode = HOP_BTLE;
2369:bluetooth_rxtx.c ****         packet_cb = connection_follow_cb;
2370:bluetooth_rxtx.c ****         le_promisc_state(2, &le.conn_interval, 2);
2371:bluetooth_rxtx.c ****         le_promisc_state(3, &le.channel_increment, 1);    
2372:bluetooth_rxtx.c ****         return;*/
2373:bluetooth_rxtx.c ****     }
2374:bluetooth_rxtx.c ****     else if(calc == 6){
2375:bluetooth_rxtx.c ****         //debug_printf("c3: %d c2: %d syc: %d\n",count3, count2-1, sync_count);
2376:bluetooth_rxtx.c ****         if(count3  == sync_count){
2377:bluetooth_rxtx.c ****             le.interval_timer = le.conn_interval / 2;
2378:bluetooth_rxtx.c ****             le.conn_count = 0;
2379:bluetooth_rxtx.c ****             le.conn_epoch = 0;
2380:bluetooth_rxtx.c ****             le.channel_idx = (idx3 + le.channel_increment) % 37;
2381:bluetooth_rxtx.c ****             le.link_state = LINK_CONNECTED;
2382:bluetooth_rxtx.c ****             le.crc_verify = 0;
2383:bluetooth_rxtx.c ****             hop_mode = HOP_BTLE;
2384:bluetooth_rxtx.c ****             packet_cb = connection_follow_cb;
2385:bluetooth_rxtx.c ****             le_promisc_state(2, &le.conn_interval, 2);
2386:bluetooth_rxtx.c ****             le_promisc_state(3, &le.channel_increment, 1); 
2387:bluetooth_rxtx.c **** 	    le_promisc_state(4, &le.channel_idx, 1);    
2388:bluetooth_rxtx.c ****             return;
2389:bluetooth_rxtx.c ****         }
2390:bluetooth_rxtx.c ****     }
2391:bluetooth_rxtx.c **** 
2392:bluetooth_rxtx.c ****     // for increment
2393:bluetooth_rxtx.c **** 	
2394:bluetooth_rxtx.c **** 	++count;
 6048              		.loc 1 2394 0
 6049 01da 614B     		ldr	r3, .L719
 6050 01dc B3F86020 		ldrh	r2, [r3, #96]
 6051 01e0 0132     		adds	r2, r2, #1
 6052 01e2 A3F86020 		strh	r2, [r3, #96]	@ movhi
2395:bluetooth_rxtx.c **** 	prev_clk = cur_clk;
 6053              		.loc 1 2395 0
 6054 01e6 039A     		ldr	r2, [sp, #12]
 6055 01e8 C3F8AC20 		str	r2, [r3, #172]
 6056              	.L627:
2396:bluetooth_rxtx.c **** }
 6057              		.loc 1 2396 0
 6058 01ec 19B0     		add	sp, sp, #100
 6059              		.cfi_remember_state
 6060              		.cfi_def_cfa_offset 36
 6061              		@ sp needed
 6062 01ee BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 6063              	.LVL659:
 6064              	.L634:
 6065              		.cfi_restore_state
 6066              	.LBB68:
2180:bluetooth_rxtx.c ****             memset(time_array1, 0, sizeof time_array1);        
 6067              		.loc 1 2180 0
 6068 01f2 4822     		movs	r2, #72
 6069 01f4 4146     		mov	r1, r8
 6070 01f6 6248     		ldr	r0, .L719+32
 6071              	.LVL660:
2178:bluetooth_rxtx.c ****             sindex = 0;
ARM GAS  /tmp/ccLwKaeN.s 			page 169


 6072              		.loc 1 2178 0
 6073 01f8 C6F8B480 		str	r8, [r6, #180]
2179:bluetooth_rxtx.c ****             memset(seq, 0, sizeof seq);
 6074              		.loc 1 2179 0
 6075 01fc A6F8B280 		strh	r8, [r6, #178]	@ movhi
2180:bluetooth_rxtx.c ****             memset(time_array1, 0, sizeof time_array1);        
 6076              		.loc 1 2180 0
 6077 0200 FFF7FEFF 		bl	memset
 6078              	.LVL661:
2181:bluetooth_rxtx.c **** 			calc = 1;
 6079              		.loc 1 2181 0
 6080 0204 2022     		movs	r2, #32
 6081 0206 4146     		mov	r1, r8
 6082 0208 5E48     		ldr	r0, .L719+36
 6083 020a FFF7FEFF 		bl	memset
 6084              	.LVL662:
2182:bluetooth_rxtx.c ****             count = 1;
 6085              		.loc 1 2182 0
 6086 020e 0123     		movs	r3, #1
2184:bluetooth_rxtx.c ****             match = 0;
 6087              		.loc 1 2184 0
 6088 0210 86F8B880 		strb	r8, [r6, #184]
2182:bluetooth_rxtx.c ****             count = 1;
 6089              		.loc 1 2182 0
 6090 0214 87F87230 		strb	r3, [r7, #114]
2183:bluetooth_rxtx.c ****             step = 0;
 6091              		.loc 1 2183 0
 6092 0218 A6F86030 		strh	r3, [r6, #96]	@ movhi
2185:bluetooth_rxtx.c ****             seq[count] = (clk_diff/10000);
 6093              		.loc 1 2185 0
 6094 021c 86F8B080 		strb	r8, [r6, #176]
2186:bluetooth_rxtx.c **** 			}
 6095              		.loc 1 2186 0
 6096 0220 C6F86890 		str	r9, [r6, #104]
 6097 0224 66E7     		b	.L633
 6098              	.LVL663:
 6099              	.L641:
 6100              	.LBE68:
2222:bluetooth_rxtx.c **** 		u32 second_ts = CLK100NS;
 6101              		.loc 1 2222 0
 6102 0226 97F87300 		ldrb	r0, [r7, #115]	@ zero_extendqisi2
 6103 022a FFF7FEFF 		bl	btle_channel_index_to_phys
 6104              	.LVL664:
 6105 022e B7F84C30 		ldrh	r3, [r7, #76]
 6106 0232 9BB2     		uxth	r3, r3
 6107 0234 9842     		cmp	r0, r3
 6108 0236 49D1     		bne	.L643
2222:bluetooth_rxtx.c **** 		u32 second_ts = CLK100NS;
 6109              		.loc 1 2222 0 is_stmt 0 discriminator 1
 6110 0238 97F87230 		ldrb	r3, [r7, #114]	@ zero_extendqisi2
 6111 023c 032B     		cmp	r3, #3
 6112 023e 45D1     		bne	.L643
 6113              	.LBB69:
2223:bluetooth_rxtx.c **** 	if (second_ts < first_ts){
 6114              		.loc 1 2223 0 is_stmt 1
 6115 0240 40F63541 		movw	r1, #3125
 6116 0244 484A     		ldr	r2, .L719+8
ARM GAS  /tmp/ccLwKaeN.s 			page 170


 6117 0246 2368     		ldr	r3, [r4]
 6118 0248 1268     		ldr	r2, [r2]
 6119 024a C3F31303 		ubfx	r3, r3, #0, #20
 6120 024e 01FB0323 		mla	r3, r1, r3, r2
 6121              	.LVL665:
2229:bluetooth_rxtx.c **** 		channels_hopped = DIVIDE_ROUND(diff,le.conn_interval * LE_BASECLK);
 6122              		.loc 1 2229 0
 6123 0252 42F21071 		movw	r1, #10000
2224:bluetooth_rxtx.c **** 		second_ts += 3276800000;
 6124              		.loc 1 2224 0
 6125 0256 D6F8C020 		ldr	r2, [r6, #192]
 6126 025a 9342     		cmp	r3, r2
2225:bluetooth_rxtx.c ****         }
 6127              		.loc 1 2225 0
 6128 025c 3CBF     		itt	cc
 6129 025e 03F14343 		addcc	r3, r3, #-1023410176
 6130              	.LVL666:
 6131 0262 03F5A003 		addcc	r3, r3, #5242880
 6132              	.LVL667:
2228:bluetooth_rxtx.c ****         time_array2[count1] = diff/10000;//
 6133              		.loc 1 2228 0
 6134 0266 9B1A     		subs	r3, r3, r2
 6135              	.LVL668:
2229:bluetooth_rxtx.c **** 		channels_hopped = DIVIDE_ROUND(diff,le.conn_interval * LE_BASECLK);
 6136              		.loc 1 2229 0
 6137 0268 B3FBF1F1 		udiv	r1, r3, r1
 6138 026c 96F8E420 		ldrb	r2, [r6, #228]	@ zero_extendqisi2
 6139 0270 06EB4202 		add	r2, r6, r2, lsl #1
 6140 0274 A2F8C410 		strh	r1, [r2, #196]	@ movhi
2230:bluetooth_rxtx.c **** 
 6141              		.loc 1 2230 0
 6142 0278 41F66A02 		movw	r2, #6250
 6143 027c F98B     		ldrh	r1, [r7, #30]
 6144              	.LVL669:
 6145 027e 02FB0133 		mla	r3, r2, r1, r3
 6146              	.LVL670:
 6147 0282 43F2D402 		movw	r2, #12500
 6148 0286 4A43     		muls	r2, r1, r2
 6149 0288 B3FBF2F3 		udiv	r3, r3, r2
 6150              	.LVL671:
2232:bluetooth_rxtx.c ****             	first_ts = CLK100NS; 
 6151              		.loc 1 2232 0
 6152 028c 252B     		cmp	r3, #37
 6153 028e 15D9     		bls	.L645
2233:bluetooth_rxtx.c ****             	hop_direct_channel = btle_channel_index_to_phys(idx3);
 6154              		.loc 1 2233 0
 6155 0290 40F63541 		movw	r1, #3125
 6156 0294 344A     		ldr	r2, .L719+8
 6157 0296 2368     		ldr	r3, [r4]
 6158              	.LVL672:
 6159 0298 1268     		ldr	r2, [r2]
 6160 029a C3F31303 		ubfx	r3, r3, #0, #20
 6161 029e 01FB0323 		mla	r3, r1, r3, r2
2234:bluetooth_rxtx.c **** 		hop_mode = HOP_DIRECT;
 6162              		.loc 1 2234 0
 6163 02a2 97F87100 		ldrb	r0, [r7, #113]	@ zero_extendqisi2
2233:bluetooth_rxtx.c ****             	hop_direct_channel = btle_channel_index_to_phys(idx3);
ARM GAS  /tmp/ccLwKaeN.s 			page 171


 6164              		.loc 1 2233 0
 6165 02a6 C6F8C030 		str	r3, [r6, #192]
2234:bluetooth_rxtx.c **** 		hop_mode = HOP_DIRECT;
 6166              		.loc 1 2234 0
 6167 02aa FFF7FEFF 		bl	btle_channel_index_to_phys
 6168              	.LVL673:
2235:bluetooth_rxtx.c **** 	    	do_hop = 1;
 6169              		.loc 1 2235 0
 6170 02ae 0423     		movs	r3, #4
2236:bluetooth_rxtx.c ****             	calc = 4;
 6171              		.loc 1 2236 0
 6172 02b0 0122     		movs	r2, #1
2234:bluetooth_rxtx.c **** 		hop_mode = HOP_DIRECT;
 6173              		.loc 1 2234 0
 6174 02b2 B081     		strh	r0, [r6, #12]	@ movhi
2237:bluetooth_rxtx.c **** 	}
 6175              		.loc 1 2237 0
 6176 02b4 87F87230 		strb	r3, [r7, #114]
2235:bluetooth_rxtx.c **** 	    	do_hop = 1;
 6177              		.loc 1 2235 0
 6178 02b8 B372     		strb	r3, [r6, #10]
2236:bluetooth_rxtx.c ****             	calc = 4;
 6179              		.loc 1 2236 0
 6180 02ba F272     		strb	r2, [r6, #11]
 6181              	.L645:
2239:bluetooth_rxtx.c **** 	//debug_printf("Count1 %d ch %d diff %d int %d arr %d\n", count1, channels_hopped, diff, le.conn_i
 6182              		.loc 1 2239 0
 6183 02bc 0123     		movs	r3, #1
 6184 02be F372     		strb	r3, [r6, #11]
2241:bluetooth_rxtx.c **** 	}
 6185              		.loc 1 2241 0
 6186 02c0 96F8E430 		ldrb	r3, [r6, #228]	@ zero_extendqisi2
 6187 02c4 0133     		adds	r3, r3, #1
 6188 02c6 86F8E430 		strb	r3, [r6, #228]
 6189              	.LBE69:
2222:bluetooth_rxtx.c **** 		u32 second_ts = CLK100NS;
 6190              		.loc 1 2222 0
 6191 02ca 86E7     		b	.L642
 6192              	.LVL674:
 6193              	.L643:
2244:bluetooth_rxtx.c ****         u32 second_ts2 = CLK100NS;
 6194              		.loc 1 2244 0
 6195 02cc 97F87100 		ldrb	r0, [r7, #113]	@ zero_extendqisi2
 6196 02d0 FFF7FEFF 		bl	btle_channel_index_to_phys
 6197              	.LVL675:
 6198 02d4 B7F84C30 		ldrh	r3, [r7, #76]
 6199 02d8 9BB2     		uxth	r3, r3
 6200 02da 9842     		cmp	r0, r3
 6201 02dc 54D1     		bne	.L646
2244:bluetooth_rxtx.c ****         u32 second_ts2 = CLK100NS;
 6202              		.loc 1 2244 0 is_stmt 0 discriminator 1
 6203 02de 97F87230 		ldrb	r3, [r7, #114]	@ zero_extendqisi2
 6204 02e2 042B     		cmp	r3, #4
 6205 02e4 50D1     		bne	.L646
 6206              	.LBB70:
2245:bluetooth_rxtx.c **** 		if (second_ts2 < first_ts){
 6207              		.loc 1 2245 0 is_stmt 1
ARM GAS  /tmp/ccLwKaeN.s 			page 172


 6208 02e6 40F63541 		movw	r1, #3125
 6209 02ea 1F4A     		ldr	r2, .L719+8
 6210 02ec 2368     		ldr	r3, [r4]
 6211 02ee 1268     		ldr	r2, [r2]
 6212 02f0 C3F31303 		ubfx	r3, r3, #0, #20
 6213 02f4 01FB0323 		mla	r3, r1, r3, r2
 6214              	.LVL676:
2246:bluetooth_rxtx.c **** 			second_ts2 += 3276800000;
 6215              		.loc 1 2246 0
 6216 02f8 D6F8C020 		ldr	r2, [r6, #192]
2251:bluetooth_rxtx.c **** 		channels_hopped = DIVIDE_ROUND(diff,le.conn_interval * LE_BASECLK);
 6217              		.loc 1 2251 0
 6218 02fc B6F8C400 		ldrh	r0, [r6, #196]
2246:bluetooth_rxtx.c **** 			second_ts2 += 3276800000;
 6219              		.loc 1 2246 0
 6220 0300 9342     		cmp	r3, r2
2247:bluetooth_rxtx.c ****         }
 6221              		.loc 1 2247 0
 6222 0302 3CBF     		itt	cc
 6223 0304 03F14343 		addcc	r3, r3, #-1023410176
 6224              	.LVL677:
 6225 0308 03F5A003 		addcc	r3, r3, #5242880
 6226              	.LVL678:
2250:bluetooth_rxtx.c ****         time_array3[count2] = ((diff/10000)+ time_array2[0])%(37*obsv_hop_interval);
 6227              		.loc 1 2250 0
 6228 030c 9B1A     		subs	r3, r3, r2
 6229              	.LVL679:
2251:bluetooth_rxtx.c **** 		channels_hopped = DIVIDE_ROUND(diff,le.conn_interval * LE_BASECLK);
 6230              		.loc 1 2251 0
 6231 030e 42F21072 		movw	r2, #10000
 6232 0312 B3FBF2F2 		udiv	r2, r3, r2
 6233 0316 0244     		add	r2, r2, r0
 6234 0318 2520     		movs	r0, #37
 6235 031a B6F8BC40 		ldrh	r4, [r6, #188]
 6236 031e 96F83510 		ldrb	r1, [r6, #53]	@ zero_extendqisi2
 6237 0322 6043     		muls	r0, r4, r0
 6238 0324 B2FBF0F4 		udiv	r4, r2, r0
 6239 0328 00FB1422 		mls	r2, r0, r4, r2
 6240 032c 06EB4105 		add	r5, r6, r1, lsl #1
 6241 0330 A5F8E620 		strh	r2, [r5, #230]	@ movhi
2252:bluetooth_rxtx.c **** 
 6242              		.loc 1 2252 0
 6243 0334 41F66A02 		movw	r2, #6250
 6244 0338 F88B     		ldrh	r0, [r7, #30]
 6245              	.LVL680:
 6246 033a 02FB0033 		mla	r3, r2, r0, r3
 6247              	.LVL681:
 6248 033e 43F2D402 		movw	r2, #12500
 6249 0342 4243     		muls	r2, r0, r2
 6250 0344 B3FBF2F3 		udiv	r3, r3, r2
 6251              	.LVL682:
2254:bluetooth_rxtx.c ****             		calc = 5;
 6252              		.loc 1 2254 0
 6253 0348 252B     		cmp	r3, #37
2255:bluetooth_rxtx.c **** 		}
 6254              		.loc 1 2255 0
 6255 034a 84BF     		itt	hi
ARM GAS  /tmp/ccLwKaeN.s 			page 173


 6256 034c 0523     		movhi	r3, #5
 6257              	.LVL683:
 6258 034e 87F87230 		strbhi	r3, [r7, #114]
2257:bluetooth_rxtx.c ****         //debug_printf("Count2 %d ch %d diff %d int %d arr %d\n", count2, channels_hopped, diff, le
 6259              		.loc 1 2257 0
 6260 0352 0123     		movs	r3, #1
2259:bluetooth_rxtx.c ****     }
 6261              		.loc 1 2259 0
 6262 0354 1944     		add	r1, r1, r3
2257:bluetooth_rxtx.c ****         //debug_printf("Count2 %d ch %d diff %d int %d arr %d\n", count2, channels_hopped, diff, le
 6263              		.loc 1 2257 0
 6264 0356 F372     		strb	r3, [r6, #11]
2259:bluetooth_rxtx.c ****     }
 6265              		.loc 1 2259 0
 6266 0358 86F83510 		strb	r1, [r6, #53]
 6267              	.LBE70:
2244:bluetooth_rxtx.c ****         u32 second_ts2 = CLK100NS;
 6268              		.loc 1 2244 0
 6269 035c 3DE7     		b	.L642
 6270              	.L720:
 6271 035e 00BF     		.align	2
 6272              	.L719:
 6273 0360 00000000 		.word	.LANCHOR1
 6274 0364 00000000 		.word	clkn
 6275 0368 08400040 		.word	1073758216
 6276 036c F7240100 		.word	74999
 6277 0370 00000000 		.word	.LANCHOR0
 6278 0374 60000000 		.word	.LC8
 6279 0378 0000E43F 		.word	1071906816
 6280 037c 0000F43F 		.word	1072955392
 6281 0380 64000000 		.word	.LANCHOR1+100
 6282 0384 40000000 		.word	.LANCHOR1+64
 6283              	.LVL684:
 6284              	.L646:
2262:bluetooth_rxtx.c **** 
 6285              		.loc 1 2262 0
 6286 0388 97F87230 		ldrb	r3, [r7, #114]	@ zero_extendqisi2
 6287 038c 052B     		cmp	r3, #5
 6288 038e 40F0AF81 		bne	.L649
 6289              	.LBB71:
2275:bluetooth_rxtx.c ****             for( ta2 = 0; ta2 < count1-1; ta2++){
 6290              		.loc 1 2275 0
 6291 0392 0025     		movs	r5, #0
 6292 0394 B6F8BA30 		ldrh	r3, [r6, #186]
 6293 0398 96F80721 		ldrb	r2, [r6, #263]	@ zero_extendqisi2
 6294 039c 1293     		str	r3, [sp, #72]
2276:bluetooth_rxtx.c ****                 if(time_array1[ta1] > time_array2[ta2]){
 6295              		.loc 1 2276 0
 6296 039e 96F8E430 		ldrb	r3, [r6, #228]	@ zero_extendqisi2
2275:bluetooth_rxtx.c ****             for( ta2 = 0; ta2 < count1-1; ta2++){
 6297              		.loc 1 2275 0
 6298 03a2 AE46     		mov	lr, r5
2276:bluetooth_rxtx.c ****                 if(time_array1[ta1] > time_array2[ta2]){
 6299              		.loc 1 2276 0
 6300 03a4 013B     		subs	r3, r3, #1
 6301 03a6 1393     		str	r3, [sp, #76]
 6302              	.LBB72:
ARM GAS  /tmp/ccLwKaeN.s 			page 174


2278:bluetooth_rxtx.c ****                 }
 6303              		.loc 1 2278 0
 6304 03a8 FB8B     		ldrh	r3, [r7, #30]
 6305 03aa 96F808A1 		ldrb	r10, [r6, #264]	@ zero_extendqisi2
 6306 03ae 0593     		str	r3, [sp, #20]
 6307 03b0 97F87330 		ldrb	r3, [r7, #115]	@ zero_extendqisi2
 6308 03b4 B6F80A41 		ldrh	r4, [r6, #266]
2285:bluetooth_rxtx.c ****                     hops = ((idx2 - idx1)*hop_interval_lut[channels_hopped])%37;
 6309              		.loc 1 2285 0
 6310 03b8 991A     		subs	r1, r3, r2
 6311 03ba 0B91     		str	r1, [sp, #44]
2289:bluetooth_rxtx.c ****                 }
 6312              		.loc 1 2289 0
 6313 03bc 03F12501 		add	r1, r3, #37
 6314 03c0 8A1A     		subs	r2, r1, r2
 6315 03c2 97F87110 		ldrb	r1, [r7, #113]	@ zero_extendqisi2
 6316              	.LBE72:
2275:bluetooth_rxtx.c ****             for( ta2 = 0; ta2 < count1-1; ta2++){
 6317              		.loc 1 2275 0
 6318 03c6 2F46     		mov	r7, r5
 6319              	.LBB77:
 6320              	.LBB73:
2301:bluetooth_rxtx.c ****                             hops2 = ((idx3 - idx2)*hop_interval_lut[channels_hopped])%37;
 6321              		.loc 1 2301 0
 6322 03c8 C81A     		subs	r0, r1, r3
2305:bluetooth_rxtx.c ****                         }
 6323              		.loc 1 2305 0
 6324 03ca 2531     		adds	r1, r1, #37
 6325 03cc CB1A     		subs	r3, r1, r3
2301:bluetooth_rxtx.c ****                             hops2 = ((idx3 - idx2)*hop_interval_lut[channels_hopped])%37;
 6326              		.loc 1 2301 0
 6327 03ce 0E90     		str	r0, [sp, #56]
 6328              	.LBE73:
 6329              	.LBE77:
2275:bluetooth_rxtx.c ****             for( ta2 = 0; ta2 < count1-1; ta2++){
 6330              		.loc 1 2275 0
 6331 03d0 2946     		mov	r1, r5
 6332 03d2 2846     		mov	r0, r5
 6333              	.LBB78:
2289:bluetooth_rxtx.c ****                 }
 6334              		.loc 1 2289 0
 6335 03d4 1492     		str	r2, [sp, #80]
 6336              	.LBB74:
2305:bluetooth_rxtx.c ****                         }
 6337              		.loc 1 2305 0
 6338 03d6 1693     		str	r3, [sp, #88]
 6339              	.LBE74:
2293:bluetooth_rxtx.c ****                         if(time_array2[ta2] > time_array3[ta3]){
 6340              		.loc 1 2293 0
 6341 03d8 96F83520 		ldrb	r2, [r6, #53]	@ zero_extendqisi2
 6342 03dc 96F80E31 		ldrb	r3, [r6, #270]	@ zero_extendqisi2
 6343 03e0 013A     		subs	r2, r2, #1
 6344 03e2 1093     		str	r3, [sp, #64]
 6345 03e4 96F80F31 		ldrb	r3, [r6, #271]	@ zero_extendqisi2
 6346 03e8 1592     		str	r2, [sp, #84]
 6347 03ea 96F80C81 		ldrb	r8, [r6, #268]	@ zero_extendqisi2
 6348 03ee 96F80921 		ldrb	r2, [r6, #265]	@ zero_extendqisi2
ARM GAS  /tmp/ccLwKaeN.s 			page 175


 6349 03f2 96F80D91 		ldrb	r9, [r6, #269]	@ zero_extendqisi2
 6350              	.LBE78:
2275:bluetooth_rxtx.c ****             for( ta2 = 0; ta2 < count1-1; ta2++){
 6351              		.loc 1 2275 0
 6352 03f6 86F80651 		strb	r5, [r6, #262]
 6353 03fa 0493     		str	r3, [sp, #16]
 6354 03fc 1195     		str	r5, [sp, #68]
 6355 03fe 0F95     		str	r5, [sp, #60]
 6356 0400 0C95     		str	r5, [sp, #48]
 6357              	.L650:
2275:bluetooth_rxtx.c ****             for( ta2 = 0; ta2 < count1-1; ta2++){
 6358              		.loc 1 2275 0 is_stmt 0 discriminator 1
 6359 0402 129B     		ldr	r3, [sp, #72]
 6360 0404 9D42     		cmp	r5, r3
 6361 0406 80F0E980 		bcs	.L664
 6362 040a 0023     		movs	r3, #0
 6363 040c 0A93     		str	r3, [sp, #40]
 6364              	.LBB79:
2277:bluetooth_rxtx.c ****                     diff = (le.conn_interval*1.25*37) - time_array1[ta1] + time_array2[ta2];
 6365              		.loc 1 2277 0 is_stmt 1 discriminator 1
 6366 040e B04B     		ldr	r3, .L721
2289:bluetooth_rxtx.c ****                 }
 6367              		.loc 1 2289 0 discriminator 1
 6368 0410 2526     		movs	r6, #37
2277:bluetooth_rxtx.c ****                     diff = (le.conn_interval*1.25*37) - time_array1[ta1] + time_array2[ta2];
 6369              		.loc 1 2277 0 discriminator 1
 6370 0412 03EB4503 		add	r3, r3, r5, lsl #1
 6371 0416 1793     		str	r3, [sp, #92]
 6372 0418 75E0     		b	.L665
 6373              	.L663:
2277:bluetooth_rxtx.c ****                     diff = (le.conn_interval*1.25*37) - time_array1[ta1] + time_array2[ta2];
 6374              		.loc 1 2277 0 is_stmt 0
 6375 041a 179B     		ldr	r3, [sp, #92]
 6376 041c B3F84040 		ldrh	r4, [r3, #64]
 6377 0420 AB4B     		ldr	r3, .L721
 6378 0422 03EB4202 		add	r2, r3, r2, lsl #1
 6379 0426 B2F8C4B0 		ldrh	fp, [r2, #196]
 6380 042a 5C45     		cmp	r4, fp
 6381 042c 74D9     		bls	.L651
2278:bluetooth_rxtx.c ****                 }
 6382              		.loc 1 2278 0 is_stmt 1
 6383 042e 0598     		ldr	r0, [sp, #20]
 6384 0430 FFF7FEFF 		bl	__aeabi_i2d
 6385              	.LVL685:
 6386 0434 0022     		movs	r2, #0
 6387 0436 A74B     		ldr	r3, .L721+4
 6388 0438 FFF7FEFF 		bl	__aeabi_dmul
 6389              	.LVL686:
 6390 043c 0022     		movs	r2, #0
 6391 043e A64B     		ldr	r3, .L721+8
 6392 0440 FFF7FEFF 		bl	__aeabi_dmul
 6393              	.LVL687:
 6394 0444 CDE90601 		strd	r0, [sp, #24]
 6395 0448 2046     		mov	r0, r4
 6396 044a FFF7FEFF 		bl	__aeabi_i2d
 6397              	.LVL688:
 6398 044e 0246     		mov	r2, r0
ARM GAS  /tmp/ccLwKaeN.s 			page 176


 6399 0450 0B46     		mov	r3, r1
 6400 0452 DDE90601 		ldrd	r0, [sp, #24]
 6401 0456 FFF7FEFF 		bl	__aeabi_dsub
 6402              	.LVL689:
 6403 045a CDE90601 		strd	r0, [sp, #24]
 6404 045e 5846     		mov	r0, fp
 6405 0460 FFF7FEFF 		bl	__aeabi_i2d
 6406              	.LVL690:
 6407 0464 0246     		mov	r2, r0
 6408 0466 0B46     		mov	r3, r1
 6409 0468 DDE90601 		ldrd	r0, [sp, #24]
 6410 046c FFF7FEFF 		bl	__aeabi_dadd
 6411              	.LVL691:
 6412 0470 FFF7FEFF 		bl	__aeabi_d2uiz
 6413              	.LVL692:
 6414 0474 84B2     		uxth	r4, r0
 6415              	.L652:
2284:bluetooth_rxtx.c ****                 if((idx2 - idx1) > 0){
 6416              		.loc 1 2284 0
 6417 0476 0598     		ldr	r0, [sp, #20]
 6418 0478 FFF7FEFF 		bl	__aeabi_i2d
 6419              	.LVL693:
 6420 047c 0022     		movs	r2, #0
 6421 047e 954B     		ldr	r3, .L721+4
 6422 0480 FFF7FEFF 		bl	__aeabi_dmul
 6423              	.LVL694:
 6424 0484 0022     		movs	r2, #0
 6425 0486 954B     		ldr	r3, .L721+12
 6426 0488 CDE90601 		strd	r0, [sp, #24]
 6427 048c FFF7FEFF 		bl	__aeabi_dmul
 6428              	.LVL695:
 6429 0490 CDE90801 		strd	r0, [sp, #32]
 6430 0494 2046     		mov	r0, r4
 6431 0496 FFF7FEFF 		bl	__aeabi_i2d
 6432              	.LVL696:
 6433 049a DDE90823 		ldrd	r2, [sp, #32]
 6434 049e FFF7FEFF 		bl	__aeabi_dadd
 6435              	.LVL697:
 6436 04a2 DDE90623 		ldrd	r2, [sp, #24]
 6437 04a6 FFF7FEFF 		bl	__aeabi_ddiv
 6438              	.LVL698:
 6439 04aa FFF7FEFF 		bl	__aeabi_d2uiz
 6440              	.LVL699:
2285:bluetooth_rxtx.c ****                     hops = ((idx2 - idx1)*hop_interval_lut[channels_hopped])%37;
 6441              		.loc 1 2285 0
 6442 04ae 0B9B     		ldr	r3, [sp, #44]
2284:bluetooth_rxtx.c ****                 if((idx2 - idx1) > 0){
 6443              		.loc 1 2284 0
 6444 04b0 C0B2     		uxtb	r0, r0
 6445              	.LVL700:
2285:bluetooth_rxtx.c ****                     hops = ((idx2 - idx1)*hop_interval_lut[channels_hopped])%37;
 6446              		.loc 1 2285 0
 6447 04b2 002B     		cmp	r3, #0
2286:bluetooth_rxtx.c ****                 }
 6448              		.loc 1 2286 0
 6449 04b4 8A4B     		ldr	r3, .L721+16
 6450 04b6 C8BF     		it	gt
ARM GAS  /tmp/ccLwKaeN.s 			page 177


 6451 04b8 0B9A     		ldrgt	r2, [sp, #44]
 6452 04ba 1844     		add	r0, r0, r3
 6453              	.LVL701:
2289:bluetooth_rxtx.c ****                 }
 6454              		.loc 1 2289 0
 6455 04bc D8BF     		it	le
 6456 04be 149A     		ldrle	r2, [sp, #80]
2286:bluetooth_rxtx.c ****                 }
 6457              		.loc 1 2286 0
 6458 04c0 90F87C38 		ldrb	r3, [r0, #2172]	@ zero_extendqisi2
2289:bluetooth_rxtx.c ****                 }
 6459              		.loc 1 2289 0
 6460 04c4 5343     		muls	r3, r2, r3
 6461 04c6 93FBF6FA 		sdiv	r10, r3, r6
 6462 04ca 06FB1A3A 		mls	r10, r6, r10, r3
 6463 04ce 5FFA8AFA 		uxtb	r10, r10
2291:bluetooth_rxtx.c ****                 //added
 6464              		.loc 1 2291 0
 6465 04d2 AAF10503 		sub	r3, r10, #5
 6466 04d6 0B2B     		cmp	r3, #11
 6467 04d8 10D8     		bhi	.L655
 6468 04da 0027     		movs	r7, #0
 6469              	.LVL702:
 6470              	.L656:
2293:bluetooth_rxtx.c ****                         if(time_array2[ta2] > time_array3[ta3]){
 6471              		.loc 1 2293 0 discriminator 1
 6472 04dc 159A     		ldr	r2, [sp, #84]
 6473 04de FBB2     		uxtb	r3, r7
 6474 04e0 9342     		cmp	r3, r2
 6475 04e2 0493     		str	r3, [sp, #16]
 6476              	.LBB75:
2294:bluetooth_rxtx.c ****                             diff = (le.conn_interval*1.25*37) - time_array2[ta2] + time_array3[ta3]
 6477              		.loc 1 2294 0 discriminator 1
 6478 04e4 7A4B     		ldr	r3, .L721
 6479              	.LBE75:
2293:bluetooth_rxtx.c ****                         if(time_array2[ta2] > time_array3[ta3]){
 6480              		.loc 1 2293 0 discriminator 1
 6481 04e6 1BDB     		blt	.L662
2315:bluetooth_rxtx.c ****                 }
 6482              		.loc 1 2315 0
 6483 04e8 0127     		movs	r7, #1
2314:bluetooth_rxtx.c ****                      index += 1;
 6484              		.loc 1 2314 0
 6485 04ea 03EB4903 		add	r3, r3, r9, lsl #1
 6486 04ee A3F810A1 		strh	r10, [r3, #272]	@ movhi
2315:bluetooth_rxtx.c ****                 }
 6487              		.loc 1 2315 0
 6488 04f2 09F10103 		add	r3, r9, #1
 6489 04f6 5FFA83F9 		uxtb	r9, r3
 6490 04fa 0C97     		str	r7, [sp, #48]
 6491              	.L655:
 6492 04fc 0121     		movs	r1, #1
 6493 04fe 8E46     		mov	lr, r1
 6494 0500 0A9B     		ldr	r3, [sp, #40]
 6495 0502 0133     		adds	r3, r3, #1
 6496 0504 0A93     		str	r3, [sp, #40]
 6497              	.L665:
ARM GAS  /tmp/ccLwKaeN.s 			page 178


 6498 0506 9DF82820 		ldrb	r2, [sp, #40]	@ zero_extendqisi2
 6499              	.LBE79:
2276:bluetooth_rxtx.c ****                 if(time_array1[ta1] > time_array2[ta2]){
 6500              		.loc 1 2276 0 discriminator 1
 6501 050a 139B     		ldr	r3, [sp, #76]
 6502 050c 9A42     		cmp	r2, r3
 6503 050e 84DB     		blt	.L663
 6504 0510 0135     		adds	r5, r5, #1
 6505 0512 EDB2     		uxtb	r5, r5
 6506 0514 0120     		movs	r0, #1
 6507 0516 74E7     		b	.L650
 6508              	.L651:
 6509              	.LBB80:
2281:bluetooth_rxtx.c ****                 }
 6510              		.loc 1 2281 0
 6511 0518 ABEB0404 		sub	r4, fp, r4
 6512 051c A4B2     		uxth	r4, r4
 6513 051e AAE7     		b	.L652
 6514              	.L662:
 6515              	.LBB76:
2294:bluetooth_rxtx.c ****                             diff = (le.conn_interval*1.25*37) - time_array2[ta2] + time_array3[ta3]
 6516              		.loc 1 2294 0
 6517 0520 049A     		ldr	r2, [sp, #16]
 6518 0522 03EB4203 		add	r3, r3, r2, lsl #1
 6519 0526 B3F8E640 		ldrh	r4, [r3, #230]
 6520 052a A345     		cmp	fp, r4
 6521 052c 52D9     		bls	.L657
2295:bluetooth_rxtx.c ****                         }
 6522              		.loc 1 2295 0
 6523 052e DDE90601 		ldrd	r0, [sp, #24]
 6524 0532 0022     		movs	r2, #0
 6525 0534 684B     		ldr	r3, .L721+8
 6526 0536 FFF7FEFF 		bl	__aeabi_dmul
 6527              	.LVL703:
 6528 053a CDE90C01 		strd	r0, [sp, #48]
 6529 053e 5846     		mov	r0, fp
 6530 0540 FFF7FEFF 		bl	__aeabi_i2d
 6531              	.LVL704:
 6532 0544 0246     		mov	r2, r0
 6533 0546 0B46     		mov	r3, r1
 6534 0548 DDE90C01 		ldrd	r0, [sp, #48]
 6535 054c FFF7FEFF 		bl	__aeabi_dsub
 6536              	.LVL705:
 6537 0550 CDE90C01 		strd	r0, [sp, #48]
 6538 0554 2046     		mov	r0, r4
 6539 0556 FFF7FEFF 		bl	__aeabi_i2d
 6540              	.LVL706:
 6541 055a 0246     		mov	r2, r0
 6542 055c 0B46     		mov	r3, r1
 6543 055e DDE90C01 		ldrd	r0, [sp, #48]
 6544 0562 FFF7FEFF 		bl	__aeabi_dadd
 6545              	.LVL707:
 6546 0566 FFF7FEFF 		bl	__aeabi_d2uiz
 6547              	.LVL708:
 6548 056a 84B2     		uxth	r4, r0
 6549              	.L658:
2300:bluetooth_rxtx.c ****                         if((idx3 - idx2) > 0){
ARM GAS  /tmp/ccLwKaeN.s 			page 179


 6550              		.loc 1 2300 0
 6551 056c 2046     		mov	r0, r4
 6552 056e FFF7FEFF 		bl	__aeabi_i2d
 6553              	.LVL709:
 6554 0572 DDE90823 		ldrd	r2, [sp, #32]
 6555 0576 FFF7FEFF 		bl	__aeabi_dadd
 6556              	.LVL710:
 6557 057a DDE90623 		ldrd	r2, [sp, #24]
 6558 057e FFF7FEFF 		bl	__aeabi_ddiv
 6559              	.LVL711:
 6560 0582 FFF7FEFF 		bl	__aeabi_d2uiz
 6561              	.LVL712:
2301:bluetooth_rxtx.c ****                             hops2 = ((idx3 - idx2)*hop_interval_lut[channels_hopped])%37;
 6562              		.loc 1 2301 0
 6563 0586 0E9B     		ldr	r3, [sp, #56]
2300:bluetooth_rxtx.c ****                         if((idx3 - idx2) > 0){
 6564              		.loc 1 2300 0
 6565 0588 C0B2     		uxtb	r0, r0
 6566              	.LVL713:
2301:bluetooth_rxtx.c ****                             hops2 = ((idx3 - idx2)*hop_interval_lut[channels_hopped])%37;
 6567              		.loc 1 2301 0
 6568 058a 002B     		cmp	r3, #0
2302:bluetooth_rxtx.c ****                         }
 6569              		.loc 1 2302 0
 6570 058c 544B     		ldr	r3, .L721+16
 6571 058e C8BF     		it	gt
 6572 0590 0E9A     		ldrgt	r2, [sp, #56]
 6573 0592 1844     		add	r0, r0, r3
 6574              	.LVL714:
2305:bluetooth_rxtx.c ****                         }
 6575              		.loc 1 2305 0
 6576 0594 D8BF     		it	le
 6577 0596 169A     		ldrle	r2, [sp, #88]
2302:bluetooth_rxtx.c ****                         }
 6578              		.loc 1 2302 0
 6579 0598 90F87C38 		ldrb	r3, [r0, #2172]	@ zero_extendqisi2
2305:bluetooth_rxtx.c ****                         }
 6580              		.loc 1 2305 0
 6581 059c 5343     		muls	r3, r2, r3
 6582 059e 93FBF6F2 		sdiv	r2, r3, r6
 6583 05a2 06FB1233 		mls	r3, r6, r2, r3
 6584 05a6 5FFA83F8 		uxtb	r8, r3
2307:bluetooth_rxtx.c ****                               ch_hop[index] = hops;
 6585              		.loc 1 2307 0
 6586 05aa D045     		cmp	r8, r10
 6587 05ac 0ED1     		bne	.L661
2308:bluetooth_rxtx.c ****                               sync_count = ta3+1;
 6588              		.loc 1 2308 0
 6589 05ae 484B     		ldr	r3, .L721
 6590 05b0 03EB4903 		add	r3, r3, r9, lsl #1
 6591 05b4 A3F81081 		strh	r8, [r3, #272]	@ movhi
 6592 05b8 049B     		ldr	r3, [sp, #16]
 6593 05ba 0133     		adds	r3, r3, #1
 6594 05bc DBB2     		uxtb	r3, r3
 6595 05be 1093     		str	r3, [sp, #64]
2310:bluetooth_rxtx.c ****                         }
 6596              		.loc 1 2310 0
ARM GAS  /tmp/ccLwKaeN.s 			page 180


 6597 05c0 09F10103 		add	r3, r9, #1
 6598 05c4 5FFA83F9 		uxtb	r9, r3
 6599 05c8 0123     		movs	r3, #1
 6600 05ca 1193     		str	r3, [sp, #68]
 6601              	.L661:
 6602 05cc 0123     		movs	r3, #1
 6603 05ce 0137     		adds	r7, r7, #1
 6604 05d0 0F93     		str	r3, [sp, #60]
 6605 05d2 83E7     		b	.L656
 6606              	.LVL715:
 6607              	.L657:
2298:bluetooth_rxtx.c ****                         }
 6608              		.loc 1 2298 0
 6609 05d4 A4EB0B04 		sub	r4, r4, fp
 6610 05d8 A4B2     		uxth	r4, r4
 6611 05da C7E7     		b	.L658
 6612              	.L664:
 6613 05dc 0C9E     		ldr	r6, [sp, #48]
 6614 05de 3C4B     		ldr	r3, .L721
 6615 05e0 0EB1     		cbz	r6, .L666
 6616 05e2 83F80D91 		strb	r9, [r3, #269]
 6617              	.L666:
 6618 05e6 09B1     		cbz	r1, .L667
 6619 05e8 A3F80A41 		strh	r4, [r3, #266]	@ movhi
 6620              	.L667:
 6621 05ec 0F99     		ldr	r1, [sp, #60]
 6622 05ee 09B1     		cbz	r1, .L668
 6623 05f0 83F80C81 		strb	r8, [r3, #268]
 6624              	.L668:
 6625 05f4 1199     		ldr	r1, [sp, #68]
 6626 05f6 19B1     		cbz	r1, .L669
 6627 05f8 9DF84010 		ldrb	r1, [sp, #64]	@ zero_extendqisi2
 6628 05fc 83F80E11 		strb	r1, [r3, #270]
 6629              	.L669:
 6630 0600 1FB1     		cbz	r7, .L670
 6631 0602 9DF81010 		ldrb	r1, [sp, #16]	@ zero_extendqisi2
 6632 0606 83F80F11 		strb	r1, [r3, #271]
 6633              	.L670:
 6634 060a BEF1000F 		cmp	lr, #0
 6635 060e 01D0     		beq	.L671
 6636 0610 83F808A1 		strb	r10, [r3, #264]
 6637              	.L671:
 6638 0614 18B1     		cbz	r0, .L672
 6639 0616 83F80921 		strb	r2, [r3, #265]
 6640 061a 83F80651 		strb	r5, [r3, #262]
 6641              	.L672:
 6642              	.LBE76:
 6643              	.LBE80:
2343:bluetooth_rxtx.c ****             val = ch_hop[j];
 6644              		.loc 1 2343 0
 6645 061e 0022     		movs	r2, #0
 6646 0620 9446     		mov	ip, r2
 6647 0622 9246     		mov	r10, r2
 6648 0624 1646     		mov	r6, r2
 6649 0626 2F4C     		ldr	r4, .L721+20
 6650 0628 93F80D01 		ldrb	r0, [r3, #269]	@ zero_extendqisi2
 6651 062c B4F87450 		ldrh	r5, [r4, #116]
ARM GAS  /tmp/ccLwKaeN.s 			page 181


 6652 0630 B3F852E1 		ldrh	lr, [r3, #338]
 6653 0634 B3F85411 		ldrh	r1, [r3, #340]
 6654 0638 93F85681 		ldrb	r8, [r3, #342]	@ zero_extendqisi2
2344:bluetooth_rxtx.c ****             for( i = j; i < index; i++){
 6655              		.loc 1 2344 0
 6656 063c DFF8ACB0 		ldr	fp, .L721+28
2343:bluetooth_rxtx.c ****             val = ch_hop[j];
 6657              		.loc 1 2343 0
 6658 0640 83F85021 		strb	r2, [r3, #336]
 6659              	.L673:
 6660 0644 D7B2     		uxtb	r7, r2
2343:bluetooth_rxtx.c ****             val = ch_hop[j];
 6661              		.loc 1 2343 0 is_stmt 0 discriminator 1
 6662 0646 B842     		cmp	r0, r7
 6663 0648 20D8     		bhi	.L678
 6664 064a 1EB1     		cbz	r6, .L679
 6665 064c A3F85411 		strh	r1, [r3, #340]	@ movhi
 6666 0650 83F85681 		strb	r8, [r3, #342]
 6667              	.L679:
 6668 0654 BAF1000F 		cmp	r10, #0
 6669 0658 02D0     		beq	.L680
 6670 065a 224A     		ldr	r2, .L721+20
 6671 065c A2F87450 		strh	r5, [r2, #116]	@ movhi
 6672              	.L680:
 6673 0660 BCF1000F 		cmp	ip, #0
 6674 0664 01D0     		beq	.L681
 6675 0666 A3F852E1 		strh	lr, [r3, #338]	@ movhi
 6676              	.L681:
 6677 066a 0EB1     		cbz	r6, .L682
 6678 066c 83F85071 		strb	r7, [r3, #336]
 6679              	.L682:
2356:bluetooth_rxtx.c ****         debug_printf("Increment: %d Interval: %d %d out of %d\n",le.channel_increment,le.conn_inter
 6680              		.loc 1 2356 0 is_stmt 1
 6681 0670 93F85211 		ldrb	r1, [r3, #338]	@ zero_extendqisi2
2357:bluetooth_rxtx.c ****         calc = 6;
 6682              		.loc 1 2357 0
 6683 0674 059A     		ldr	r2, [sp, #20]
 6684 0676 B4F87430 		ldrh	r3, [r4, #116]
2356:bluetooth_rxtx.c ****         debug_printf("Increment: %d Interval: %d %d out of %d\n",le.channel_increment,le.conn_inter
 6685              		.loc 1 2356 0
 6686 067a A175     		strb	r1, [r4, #22]
2357:bluetooth_rxtx.c ****         calc = 6;
 6687              		.loc 1 2357 0
 6688 067c 0090     		str	r0, [sp]
 6689 067e 1A48     		ldr	r0, .L721+24
 6690 0680 FFF7FEFF 		bl	debug_printf
 6691              	.LVL716:
2358:bluetooth_rxtx.c ****     
 6692              		.loc 1 2358 0
 6693 0684 0623     		movs	r3, #6
 6694 0686 84F87230 		strb	r3, [r4, #114]
 6695              	.LBE71:
 6696 068a A6E5     		b	.L642
 6697              	.L678:
 6698              	.LBB81:
2345:bluetooth_rxtx.c ****                 if(val == ch_hop[i]){
 6699              		.loc 1 2345 0
ARM GAS  /tmp/ccLwKaeN.s 			page 182


 6700 068c 0026     		movs	r6, #0
2344:bluetooth_rxtx.c ****             for( i = j; i < index; i++){
 6701              		.loc 1 2344 0
 6702 068e 3BF81280 		ldrh	r8, [fp, r2, lsl #1]
 6703              	.L674:
2345:bluetooth_rxtx.c ****                 if(val == ch_hop[i]){
 6704              		.loc 1 2345 0 discriminator 1
 6705 0692 07EB0609 		add	r9, r7, r6
 6706 0696 5FFA89F9 		uxtb	r9, r9
 6707 069a 8145     		cmp	r9, r0
 6708 069c 0ED3     		bcc	.L676
2350:bluetooth_rxtx.c ****                 max_count = curr_count;
 6709              		.loc 1 2350 0
 6710 069e 8D42     		cmp	r5, r1
 6711 06a0 26BF     		itte	cs
 6712 06a2 F046     		movcs	r8, lr
 6713 06a4 2946     		movcs	r1, r5
 6714 06a6 4FF0010C 		movcc	ip, #1
2354:bluetooth_rxtx.c ****         }
 6715              		.loc 1 2354 0
 6716 06aa C646     		mov	lr, r8
 6717 06ac 0D46     		mov	r5, r1
 6718 06ae 38BF     		it	cc
 6719 06b0 E246     		movcc	r10, ip
 6720 06b2 0132     		adds	r2, r2, #1
 6721 06b4 0126     		movs	r6, #1
 6722 06b6 8046     		mov	r8, r0
 6723 06b8 0021     		movs	r1, #0
 6724 06ba C3E7     		b	.L673
 6725              	.L676:
2346:bluetooth_rxtx.c ****                     curr_count++;
 6726              		.loc 1 2346 0
 6727 06bc 02EB0609 		add	r9, r2, r6
 6728 06c0 3BF81990 		ldrh	r9, [fp, r9, lsl #1]
 6729 06c4 0136     		adds	r6, r6, #1
 6730 06c6 C145     		cmp	r9, r8
2347:bluetooth_rxtx.c ****                  }
 6731              		.loc 1 2347 0
 6732 06c8 04BF     		itt	eq
 6733 06ca 0131     		addeq	r1, r1, #1
 6734 06cc 89B2     		uxtheq	r1, r1
 6735 06ce E0E7     		b	.L674
 6736              	.L722:
 6737              		.align	2
 6738              	.L721:
 6739 06d0 00000000 		.word	.LANCHOR1
 6740 06d4 0000F43F 		.word	1072955392
 6741 06d8 00804240 		.word	1078099968
 6742 06dc 0000E03F 		.word	1071644672
 6743 06e0 00000000 		.word	.LANCHOR2
 6744 06e4 00000000 		.word	.LANCHOR0
 6745 06e8 72000000 		.word	.LC9
 6746 06ec 10010000 		.word	.LANCHOR1+272
 6747              	.L649:
 6748              	.LBE81:
2374:bluetooth_rxtx.c ****         //debug_printf("c3: %d c2: %d syc: %d\n",count3, count2-1, sync_count);
 6749              		.loc 1 2374 0
ARM GAS  /tmp/ccLwKaeN.s 			page 183


 6750 06f0 062B     		cmp	r3, #6
 6751 06f2 7FF472AD 		bne	.L642
2376:bluetooth_rxtx.c ****             le.interval_timer = le.conn_interval / 2;
 6752              		.loc 1 2376 0
 6753 06f6 96F83420 		ldrb	r2, [r6, #52]	@ zero_extendqisi2
 6754 06fa 96F80E31 		ldrb	r3, [r6, #270]	@ zero_extendqisi2
 6755 06fe 9A42     		cmp	r2, r3
 6756 0700 7FF46BAD 		bne	.L642
2380:bluetooth_rxtx.c ****             le.link_state = LINK_CONNECTED;
 6757              		.loc 1 2380 0
 6758 0704 2520     		movs	r0, #37
2378:bluetooth_rxtx.c ****             le.conn_epoch = 0;
 6759              		.loc 1 2378 0
 6760 0706 0022     		movs	r2, #0
2377:bluetooth_rxtx.c ****             le.conn_count = 0;
 6761              		.loc 1 2377 0
 6762 0708 FB8B     		ldrh	r3, [r7, #30]
2380:bluetooth_rxtx.c ****             le.link_state = LINK_CONNECTED;
 6763              		.loc 1 2380 0
 6764 070a B97D     		ldrb	r1, [r7, #22]	@ zero_extendqisi2
2377:bluetooth_rxtx.c ****             le.conn_count = 0;
 6765              		.loc 1 2377 0
 6766 070c 5B08     		lsrs	r3, r3, #1
 6767 070e BB83     		strh	r3, [r7, #28]	@ movhi
2380:bluetooth_rxtx.c ****             le.link_state = LINK_CONNECTED;
 6768              		.loc 1 2380 0
 6769 0710 97F87130 		ldrb	r3, [r7, #113]	@ zero_extendqisi2
2378:bluetooth_rxtx.c ****             le.conn_epoch = 0;
 6770              		.loc 1 2378 0
 6771 0714 3A84     		strh	r2, [r7, #32]	@ movhi
2380:bluetooth_rxtx.c ****             le.link_state = LINK_CONNECTED;
 6772              		.loc 1 2380 0
 6773 0716 0B44     		add	r3, r3, r1
 6774 0718 93FBF0F1 		sdiv	r1, r3, r0
2379:bluetooth_rxtx.c ****             le.channel_idx = (idx3 + le.channel_increment) % 37;
 6775              		.loc 1 2379 0
 6776 071c BA61     		str	r2, [r7, #24]
2382:bluetooth_rxtx.c ****             hop_mode = HOP_BTLE;
 6777              		.loc 1 2382 0
 6778 071e 3A61     		str	r2, [r7, #16]
2385:bluetooth_rxtx.c ****             le_promisc_state(3, &le.channel_increment, 1); 
 6779              		.loc 1 2385 0
 6780 0720 0222     		movs	r2, #2
2381:bluetooth_rxtx.c ****             le.crc_verify = 0;
 6781              		.loc 1 2381 0
 6782 0722 0324     		movs	r4, #3
2380:bluetooth_rxtx.c ****             le.link_state = LINK_CONNECTED;
 6783              		.loc 1 2380 0
 6784 0724 00FB1133 		mls	r3, r0, r1, r3
 6785 0728 7B75     		strb	r3, [r7, #21]
2384:bluetooth_rxtx.c ****             le_promisc_state(2, &le.conn_interval, 2);
 6786              		.loc 1 2384 0
 6787 072a 0A4B     		ldr	r3, .L723
2385:bluetooth_rxtx.c ****             le_promisc_state(3, &le.channel_increment, 1); 
 6788              		.loc 1 2385 0
 6789 072c 1046     		mov	r0, r2
 6790 072e 0A49     		ldr	r1, .L723+4
ARM GAS  /tmp/ccLwKaeN.s 			page 184


2384:bluetooth_rxtx.c ****             le_promisc_state(2, &le.conn_interval, 2);
 6791              		.loc 1 2384 0
 6792 0730 B361     		str	r3, [r6, #24]
2381:bluetooth_rxtx.c ****             le.crc_verify = 0;
 6793              		.loc 1 2381 0
 6794 0732 3C75     		strb	r4, [r7, #20]
2383:bluetooth_rxtx.c ****             packet_cb = connection_follow_cb;
 6795              		.loc 1 2383 0
 6796 0734 B472     		strb	r4, [r6, #10]
2385:bluetooth_rxtx.c ****             le_promisc_state(3, &le.channel_increment, 1); 
 6797              		.loc 1 2385 0
 6798 0736 FFF7FEFF 		bl	le_promisc_state
 6799              	.LVL717:
2386:bluetooth_rxtx.c **** 	    le_promisc_state(4, &le.channel_idx, 1);    
 6800              		.loc 1 2386 0
 6801 073a 2046     		mov	r0, r4
 6802 073c 0122     		movs	r2, #1
 6803 073e 0749     		ldr	r1, .L723+8
 6804 0740 FFF7FEFF 		bl	le_promisc_state
 6805              	.LVL718:
2387:bluetooth_rxtx.c ****             return;
 6806              		.loc 1 2387 0
 6807 0744 0122     		movs	r2, #1
 6808 0746 0420     		movs	r0, #4
 6809 0748 0549     		ldr	r1, .L723+12
 6810              		.loc 1 2396 0
 6811 074a 19B0     		add	sp, sp, #100
 6812              		.cfi_def_cfa_offset 36
 6813              		@ sp needed
 6814 074c BDE8F04F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 6815              		.cfi_restore 14
 6816              		.cfi_restore 11
 6817              		.cfi_restore 10
 6818              		.cfi_restore 9
 6819              		.cfi_restore 8
 6820              		.cfi_restore 7
 6821              		.cfi_restore 6
 6822              		.cfi_restore 5
 6823              		.cfi_restore 4
 6824              		.cfi_def_cfa_offset 0
 6825              	.LVL719:
2387:bluetooth_rxtx.c ****             return;
 6826              		.loc 1 2387 0
 6827 0750 FFF7FEBF 		b	le_promisc_state
 6828              	.LVL720:
 6829              	.L724:
 6830              		.align	2
 6831              	.L723:
 6832 0754 00000000 		.word	connection_follow_cb
 6833 0758 1E000000 		.word	.LANCHOR0+30
 6834 075c 16000000 		.word	.LANCHOR0+22
 6835 0760 15000000 		.word	.LANCHOR0+21
 6836              		.cfi_endproc
 6837              	.LFE29:
 6839              		.section	.text.promisc_follow_cb,"ax",%progbits
 6840              		.align	1
 6841              		.global	promisc_follow_cb
ARM GAS  /tmp/ccLwKaeN.s 			page 185


 6842              		.syntax unified
 6843              		.thumb
 6844              		.thumb_func
 6845              		.fpu softvfp
 6847              	promisc_follow_cb:
 6848              	.LFB30:
2397:bluetooth_rxtx.c **** 
2398:bluetooth_rxtx.c **** 
2399:bluetooth_rxtx.c **** //sopan
2400:bluetooth_rxtx.c **** void promisc_follow_cb(u8 *packet) {
 6849              		.loc 1 2400 0
 6850              		.cfi_startproc
 6851              		@ args = 0, pretend = 0, frame = 0
 6852              		@ frame_needed = 0, uses_anonymous_args = 0
 6853              	.LVL721:
 6854 0000 70B5     		push	{r4, r5, r6, lr}
 6855              		.cfi_def_cfa_offset 16
 6856              		.cfi_offset 4, -16
 6857              		.cfi_offset 5, -12
 6858              		.cfi_offset 6, -8
 6859              		.cfi_offset 14, -4
2401:bluetooth_rxtx.c ****     debug_printf("promisc_follow_cb\n");
2402:bluetooth_rxtx.c **** 	int i;
2403:bluetooth_rxtx.c **** 
2404:bluetooth_rxtx.c **** 	// get the CRCInit
2405:bluetooth_rxtx.c **** 	if (!le.crc_verify && packet[4] == 0x01 && packet[5] == 0x00) {
 6860              		.loc 1 2405 0
 6861 0002 194D     		ldr	r5, .L729
2400:bluetooth_rxtx.c ****     debug_printf("promisc_follow_cb\n");
 6862              		.loc 1 2400 0
 6863 0004 0646     		mov	r6, r0
2401:bluetooth_rxtx.c ****     debug_printf("promisc_follow_cb\n");
 6864              		.loc 1 2401 0
 6865 0006 1948     		ldr	r0, .L729+4
 6866              	.LVL722:
 6867 0008 FFF7FEFF 		bl	debug_printf
 6868              	.LVL723:
 6869              		.loc 1 2405 0
 6870 000c 2C69     		ldr	r4, [r5, #16]
 6871 000e 4CBB     		cbnz	r4, .L725
 6872              		.loc 1 2405 0 is_stmt 0 discriminator 1
 6873 0010 3379     		ldrb	r3, [r6, #4]	@ zero_extendqisi2
 6874 0012 012B     		cmp	r3, #1
 6875 0014 26D1     		bne	.L725
 6876              		.loc 1 2405 0 discriminator 2
 6877 0016 7379     		ldrb	r3, [r6, #5]	@ zero_extendqisi2
 6878 0018 23BB     		cbnz	r3, .L725
 6879              	.LVL724:
 6880              	.LBB85:
 6881              	.LBB86:
 6882              	.LBB87:
2406:bluetooth_rxtx.c **** 		u32 crc = (packet[8] << 16) | (packet[7] << 8) | packet[6];
 6883              		.loc 1 2406 0 is_stmt 1
 6884 001a F379     		ldrb	r3, [r6, #7]	@ zero_extendqisi2
 6885 001c 307A     		ldrb	r0, [r6, #8]	@ zero_extendqisi2
 6886 001e 1B02     		lsls	r3, r3, #8
 6887 0020 43EA0043 		orr	r3, r3, r0, lsl #16
ARM GAS  /tmp/ccLwKaeN.s 			page 186


 6888 0024 B079     		ldrb	r0, [r6, #6]	@ zero_extendqisi2
2407:bluetooth_rxtx.c **** 
2408:bluetooth_rxtx.c **** 		le.crc_init = btle_reverse_crc(crc, packet + 4, 2);
 6889              		.loc 1 2408 0
 6890 0026 0222     		movs	r2, #2
 6891 0028 311D     		adds	r1, r6, #4
 6892 002a 1843     		orrs	r0, r0, r3
 6893 002c FFF7FEFF 		bl	btle_reverse_crc
 6894              	.LVL725:
 6895 0030 2246     		mov	r2, r4
 6896 0032 A860     		str	r0, [r5, #8]
 6897              	.LVL726:
 6898              	.L727:
2409:bluetooth_rxtx.c **** 		le.crc_init_reversed = 0;
2410:bluetooth_rxtx.c **** 		for (i = 0; i < 24; ++i)
2411:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 6899              		.loc 1 2411 0
 6900 0034 20FA04F3 		lsr	r3, r0, r4
 6901 0038 C4F11701 		rsb	r1, r4, #23
 6902 003c 03F00103 		and	r3, r3, #1
2410:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 6903              		.loc 1 2410 0
 6904 0040 0134     		adds	r4, r4, #1
 6905              	.LVL727:
 6906              		.loc 1 2411 0
 6907 0042 8B40     		lsls	r3, r3, r1
2410:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 6908              		.loc 1 2410 0
 6909 0044 182C     		cmp	r4, #24
 6910              		.loc 1 2411 0
 6911 0046 42EA0302 		orr	r2, r2, r3
2410:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 6912              		.loc 1 2410 0
 6913 004a F3D1     		bne	.L727
2412:bluetooth_rxtx.c **** 
2413:bluetooth_rxtx.c **** 		le.crc_verify = 1;
 6914              		.loc 1 2413 0
 6915 004c 0120     		movs	r0, #1
 6916 004e EA60     		str	r2, [r5, #12]
2414:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 6917              		.loc 1 2414 0
 6918 0050 074B     		ldr	r3, .L729+8
 6919 0052 084A     		ldr	r2, .L729+12
2413:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 6920              		.loc 1 2413 0
 6921 0054 2861     		str	r0, [r5, #16]
 6922              		.loc 1 2414 0
 6923 0056 9A61     		str	r2, [r3, #24]
2415:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 6924              		.loc 1 2415 0
 6925 0058 0749     		ldr	r1, .L729+16
 6926 005a 0322     		movs	r2, #3
 6927              	.LBE87:
 6928              	.LBE86:
 6929              	.LBE85:
2416:bluetooth_rxtx.c **** 	}
2417:bluetooth_rxtx.c **** }
ARM GAS  /tmp/ccLwKaeN.s 			page 187


 6930              		.loc 1 2417 0
 6931 005c BDE87040 		pop	{r4, r5, r6, lr}
 6932              		.cfi_remember_state
 6933              		.cfi_restore 14
 6934              		.cfi_restore 6
 6935              		.cfi_restore 5
 6936              		.cfi_restore 4
 6937              		.cfi_def_cfa_offset 0
 6938              	.LVL728:
 6939              	.LBB90:
 6940              	.LBB89:
 6941              	.LBB88:
2415:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 6942              		.loc 1 2415 0
 6943 0060 FFF7FEBF 		b	le_promisc_state
 6944              	.LVL729:
 6945              	.L725:
 6946              		.cfi_restore_state
 6947 0064 70BD     		pop	{r4, r5, r6, pc}
 6948              	.LVL730:
 6949              	.L730:
 6950 0066 00BF     		.align	2
 6951              	.L729:
 6952 0068 00000000 		.word	.LANCHOR0
 6953 006c 9B000000 		.word	.LC10
 6954 0070 00000000 		.word	.LANCHOR1
 6955 0074 00000000 		.word	promisc_recover_hop_interval
 6956 0078 08000000 		.word	.LANCHOR0+8
 6957              	.LBE88:
 6958              	.LBE89:
 6959              	.LBE90:
 6960              		.cfi_endproc
 6961              	.LFE30:
 6963              		.section	.text.see_aa,"ax",%progbits
 6964              		.align	1
 6965              		.global	see_aa
 6966              		.syntax unified
 6967              		.thumb
 6968              		.thumb_func
 6969              		.fpu softvfp
 6971              	see_aa:
 6972              	.LFB31:
2418:bluetooth_rxtx.c **** 
2419:bluetooth_rxtx.c **** // called when we see an AA, add it to the list
2420:bluetooth_rxtx.c **** void see_aa(u32 aa) {
 6973              		.loc 1 2420 0
 6974              		.cfi_startproc
 6975              		@ args = 0, pretend = 0, frame = 0
 6976              		@ frame_needed = 0, uses_anonymous_args = 0
 6977              	.LVL731:
 6978 0000 30B5     		push	{r4, r5, lr}
 6979              		.cfi_def_cfa_offset 12
 6980              		.cfi_offset 4, -12
 6981              		.cfi_offset 5, -8
 6982              		.cfi_offset 14, -4
 6983              	.LVL732:
2421:bluetooth_rxtx.c ****     //debug_printf("see_aa\n");
ARM GAS  /tmp/ccLwKaeN.s 			page 188


2422:bluetooth_rxtx.c **** 	int i, max = -1, killme = -1;
2423:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
2424:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 6984              		.loc 1 2424 0
 6985 0002 1349     		ldr	r1, .L740
2423:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 6986              		.loc 1 2423 0
 6987 0004 0023     		movs	r3, #0
 6988 0006 0A46     		mov	r2, r1
 6989              	.LVL733:
 6990              	.L734:
 6991              		.loc 1 2424 0
 6992 0008 51F83350 		ldr	r5, [r1, r3, lsl #3]
 6993 000c 01EBC304 		add	r4, r1, r3, lsl #3
 6994 0010 8542     		cmp	r5, r0
 6995 0012 03D1     		bne	.L732
2425:bluetooth_rxtx.c **** 			++le_promisc.active_aa[i].count;
 6996              		.loc 1 2425 0
 6997 0014 6368     		ldr	r3, [r4, #4]
 6998              	.LVL734:
 6999 0016 0133     		adds	r3, r3, #1
 7000 0018 6360     		str	r3, [r4, #4]
2426:bluetooth_rxtx.c **** 			return;
 7001              		.loc 1 2426 0
 7002 001a 30BD     		pop	{r4, r5, pc}
 7003              	.LVL735:
 7004              	.L732:
2423:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 7005              		.loc 1 2423 0 discriminator 2
 7006 001c 0133     		adds	r3, r3, #1
 7007              	.LVL736:
 7008 001e 202B     		cmp	r3, #32
 7009 0020 F2D1     		bne	.L734
 7010 0022 4FF0FF31 		mov	r1, #-1
 7011 0026 0023     		movs	r3, #0
 7012              	.LVL737:
 7013 0028 0C46     		mov	r4, r1
 7014              	.L736:
 7015              	.LVL738:
 7016              	.LBB93:
 7017              	.LBB94:
2427:bluetooth_rxtx.c **** 		}
2428:bluetooth_rxtx.c **** 
2429:bluetooth_rxtx.c **** 	// evict someone
2430:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
2431:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 7018              		.loc 1 2431 0
 7019 002a 02EBC305 		add	r5, r2, r3, lsl #3
 7020 002e 6D68     		ldr	r5, [r5, #4]
 7021 0030 A542     		cmp	r5, r4
 7022 0032 01DB     		blt	.L737
 7023 0034 002C     		cmp	r4, #0
 7024 0036 01DA     		bge	.L735
 7025              	.L737:
 7026 0038 1946     		mov	r1, r3
 7027 003a 2C46     		mov	r4, r5
 7028              	.LVL739:
ARM GAS  /tmp/ccLwKaeN.s 			page 189


 7029              	.L735:
2430:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 7030              		.loc 1 2430 0
 7031 003c 0133     		adds	r3, r3, #1
 7032              	.LVL740:
 7033 003e 202B     		cmp	r3, #32
 7034 0040 F3D1     		bne	.L736
2432:bluetooth_rxtx.c **** 			killme = i;
2433:bluetooth_rxtx.c **** 			max = le_promisc.active_aa[i].count;
2434:bluetooth_rxtx.c **** 		}
2435:bluetooth_rxtx.c **** 
2436:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].aa = aa;
2437:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].count = 1;
 7035              		.loc 1 2437 0
 7036 0042 0123     		movs	r3, #1
 7037              	.LVL741:
2436:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].count = 1;
 7038              		.loc 1 2436 0
 7039 0044 42F83100 		str	r0, [r2, r1, lsl #3]
 7040              		.loc 1 2437 0
 7041 0048 02EBC102 		add	r2, r2, r1, lsl #3
 7042 004c 5360     		str	r3, [r2, #4]
 7043 004e 30BD     		pop	{r4, r5, pc}
 7044              	.LVL742:
 7045              	.L741:
 7046              		.align	2
 7047              	.L740:
 7048 0050 00000000 		.word	le_promisc
 7049              	.LBE94:
 7050              	.LBE93:
 7051              		.cfi_endproc
 7052              	.LFE31:
 7054              		.section	.text.cb_le_promisc,"ax",%progbits
 7055              		.align	1
 7056              		.global	cb_le_promisc
 7057              		.syntax unified
 7058              		.thumb
 7059              		.thumb_func
 7060              		.fpu softvfp
 7062              	cb_le_promisc:
 7063              	.LFB32:
2438:bluetooth_rxtx.c **** }
2439:bluetooth_rxtx.c **** 
2440:bluetooth_rxtx.c **** /* le promiscuous mode */
2441:bluetooth_rxtx.c **** int cb_le_promisc(char *unpacked) {
 7064              		.loc 1 2441 0
 7065              		.cfi_startproc
 7066              		@ args = 0, pretend = 0, frame = 80
 7067              		@ frame_needed = 0, uses_anonymous_args = 0
 7068              	.LVL743:
 7069 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 7070              		.cfi_def_cfa_offset 32
 7071              		.cfi_offset 4, -32
 7072              		.cfi_offset 5, -28
 7073              		.cfi_offset 6, -24
 7074              		.cfi_offset 7, -20
 7075              		.cfi_offset 8, -16
ARM GAS  /tmp/ccLwKaeN.s 			page 190


 7076              		.cfi_offset 9, -12
 7077              		.cfi_offset 10, -8
 7078              		.cfi_offset 14, -4
 7079 0004 94B0     		sub	sp, sp, #80
 7080              		.cfi_def_cfa_offset 112
2442:bluetooth_rxtx.c ****     
2443:bluetooth_rxtx.c **** 	int i, j, k;
2444:bluetooth_rxtx.c **** 	int idx;
2445:bluetooth_rxtx.c **** 
2446:bluetooth_rxtx.c **** 	// empty data PDU: 01 00
2447:bluetooth_rxtx.c **** 	char desired[4][16] = {
 7081              		.loc 1 2447 0
 7082 0006 4022     		movs	r2, #64
2441:bluetooth_rxtx.c ****     
 7083              		.loc 1 2441 0
 7084 0008 0746     		mov	r7, r0
 7085              		.loc 1 2447 0
 7086 000a 0021     		movs	r1, #0
 7087 000c 04A8     		add	r0, sp, #16
 7088              	.LVL744:
2448:bluetooth_rxtx.c **** 		{ 1, 0, 0, 0, 0, 0, 0, 0,
2449:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2450:bluetooth_rxtx.c **** 		{ 1, 0, 0, 1, 0, 0, 0, 0,
2451:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2452:bluetooth_rxtx.c **** 		{ 1, 0, 1, 0, 0, 0, 0, 0,
2453:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2454:bluetooth_rxtx.c **** 		{ 1, 0, 1, 1, 0, 0, 0, 0,
2455:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2456:bluetooth_rxtx.c **** 	};
2457:bluetooth_rxtx.c **** 
2458:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
2459:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel)];
 7089              		.loc 1 2459 0
 7090 000e DFF8B081 		ldr	r8, .L770+20
2447:bluetooth_rxtx.c **** 		{ 1, 0, 0, 0, 0, 0, 0, 0,
 7091              		.loc 1 2447 0
 7092 0012 FFF7FEFF 		bl	memset
 7093              	.LVL745:
 7094 0016 0123     		movs	r3, #1
 7095 0018 0024     		movs	r4, #0
 7096 001a 4646     		mov	r6, r8
 7097              		.loc 1 2459 0
 7098 001c 634D     		ldr	r5, .L770
2447:bluetooth_rxtx.c **** 		{ 1, 0, 0, 0, 0, 0, 0, 0,
 7099              		.loc 1 2447 0
 7100 001e 8DF81030 		strb	r3, [sp, #16]
 7101 0022 8DF82030 		strb	r3, [sp, #32]
 7102 0026 8DF82330 		strb	r3, [sp, #35]
 7103 002a 8DF83030 		strb	r3, [sp, #48]
 7104 002e 8DF83230 		strb	r3, [sp, #50]
 7105 0032 8DF84030 		strb	r3, [sp, #64]
 7106 0036 8DF84230 		strb	r3, [sp, #66]
 7107 003a 8DF84330 		strb	r3, [sp, #67]
 7108              	.LVL746:
 7109              	.L744:
 7110              		.loc 1 2459 0
 7111 003e B8F84C00 		ldrh	r0, [r8, #76]
ARM GAS  /tmp/ccLwKaeN.s 			page 191


 7112 0042 80B2     		uxth	r0, r0
 7113 0044 FFF7FEFF 		bl	btle_channel_index
 7114              	.LVL747:
2460:bluetooth_rxtx.c **** 
2461:bluetooth_rxtx.c **** 		// whiten the desired data
2462:bluetooth_rxtx.c **** 		for (j = 0; j < (int)sizeof(desired[i]); ++j) {
 7115              		.loc 1 2462 0
 7116 0048 0022     		movs	r2, #0
2463:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
2464:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 7117              		.loc 1 2464 0
 7118 004a 4FF07F0E 		mov	lr, #127
 7119 004e 04A9     		add	r1, sp, #16
2459:bluetooth_rxtx.c **** 
 7120              		.loc 1 2459 0
 7121 0050 2B5C     		ldrb	r3, [r5, r0]	@ zero_extendqisi2
 7122              	.LVL748:
 7123 0052 0819     		adds	r0, r1, r4
 7124              	.LVL749:
 7125              	.L743:
2463:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7126              		.loc 1 2463 0 discriminator 3
 7127 0054 05EB030C 		add	ip, r5, r3
 7128 0058 815C     		ldrb	r1, [r0, r2]	@ zero_extendqisi2
 7129 005a 9CF828C0 		ldrb	ip, [ip, #40]	@ zero_extendqisi2
 7130              		.loc 1 2464 0 discriminator 3
 7131 005e 0133     		adds	r3, r3, #1
 7132              	.LVL750:
2463:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7133              		.loc 1 2463 0 discriminator 3
 7134 0060 81EA0C01 		eor	r1, r1, ip
 7135 0064 8154     		strb	r1, [r0, r2]
 7136              		.loc 1 2464 0 discriminator 3
 7137 0066 B3FBFEF1 		udiv	r1, r3, lr
2462:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7138              		.loc 1 2462 0 discriminator 3
 7139 006a 0132     		adds	r2, r2, #1
 7140              	.LVL751:
 7141              		.loc 1 2464 0 discriminator 3
 7142 006c C1EBC111 		rsb	r1, r1, r1, lsl #7
2462:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7143              		.loc 1 2462 0 discriminator 3
 7144 0070 102A     		cmp	r2, #16
 7145              		.loc 1 2464 0 discriminator 3
 7146 0072 A3EB0103 		sub	r3, r3, r1
 7147              	.LVL752:
2462:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7148              		.loc 1 2462 0 discriminator 3
 7149 0076 EDD1     		bne	.L743
 7150 0078 1034     		adds	r4, r4, #16
2458:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel)];
 7151              		.loc 1 2458 0 discriminator 2
 7152 007a 402C     		cmp	r4, #64
 7153 007c DFD1     		bne	.L744
 7154 007e 2024     		movs	r4, #32
 7155              	.LBB95:
 7156              	.LBB96:
ARM GAS  /tmp/ccLwKaeN.s 			page 192


 7157              	.LBB97:
2465:bluetooth_rxtx.c **** 		}
2466:bluetooth_rxtx.c **** 	}
2467:bluetooth_rxtx.c **** 
2468:bluetooth_rxtx.c **** 	// then look for that bitsream in our receive buffer
2469:bluetooth_rxtx.c **** 	for (i = 32; i < (DMA_SIZE*8*2 - 32 - 16); i++) {
2470:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
2471:bluetooth_rxtx.c **** 		int matching = -1;
2472:bluetooth_rxtx.c **** 
2473:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
2474:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
2475:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
2476:bluetooth_rxtx.c **** 					ok[j] = 0;
2477:bluetooth_rxtx.c **** 					break;
2478:bluetooth_rxtx.c **** 				}
2479:bluetooth_rxtx.c **** 			}
2480:bluetooth_rxtx.c **** 		}
2481:bluetooth_rxtx.c **** 
2482:bluetooth_rxtx.c **** 		// see if any match
2483:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
2484:bluetooth_rxtx.c **** 			if (ok[j]) {
2485:bluetooth_rxtx.c **** 				matching = j;
2486:bluetooth_rxtx.c **** 				break;
2487:bluetooth_rxtx.c **** 			}
2488:bluetooth_rxtx.c **** 		}
2489:bluetooth_rxtx.c **** 
2490:bluetooth_rxtx.c **** 		// skip if no match
2491:bluetooth_rxtx.c **** 		if (matching < 0)
2492:bluetooth_rxtx.c **** 			continue;
2493:bluetooth_rxtx.c **** 
2494:bluetooth_rxtx.c **** 		// found a match! unwhiten it and send it home
2495:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel)];
2496:bluetooth_rxtx.c **** 		for (j = 0; j < 4+3+3; ++j) {
2497:bluetooth_rxtx.c **** 			u8 byte = 0;
2498:bluetooth_rxtx.c **** 			for (k = 0; k < 8; k++) {
2499:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
2500:bluetooth_rxtx.c **** 				if (offset >= DMA_SIZE*8*2) break;
2501:bluetooth_rxtx.c **** 				int bit = unpacked[offset];
2502:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
2503:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
2504:bluetooth_rxtx.c **** 					idx = (idx + 1) % sizeof(whitening);
 7158              		.loc 1 2504 0
 7159 0080 4FF07F08 		mov	r8, #127
 7160              	.LVL753:
 7161              	.L757:
 7162              	.LBE97:
 7163              	.LBE96:
2470:bluetooth_rxtx.c **** 		int matching = -1;
 7164              		.loc 1 2470 0
 7165 0084 4A4B     		ldr	r3, .L770+4
 7166 0086 EE46     		mov	lr, sp
 7167 0088 0FCB     		ldm	r3, {r0, r1, r2, r3}
 7168 008a 8DE80F00 		stm	sp, {r0, r1, r2, r3}
 7169              	.LVL754:
2473:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 7170              		.loc 1 2473 0
 7171 008e 0023     		movs	r3, #0
ARM GAS  /tmp/ccLwKaeN.s 			page 193


2476:bluetooth_rxtx.c **** 					break;
 7172              		.loc 1 2476 0
 7173 0090 9C46     		mov	ip, r3
2475:bluetooth_rxtx.c **** 					ok[j] = 0;
 7174              		.loc 1 2475 0
 7175 0092 3819     		adds	r0, r7, r4
 7176              	.LVL755:
 7177              	.L745:
 7178 0094 04AA     		add	r2, sp, #16
 7179 0096 02EB0311 		add	r1, r2, r3, lsl #4
 7180              	.LBE95:
 7181 009a 0022     		movs	r2, #0
 7182 009c 02E0     		b	.L748
 7183              	.LVL756:
 7184              	.L746:
 7185              	.LBB103:
2474:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 7186              		.loc 1 2474 0 discriminator 2
 7187 009e 0132     		adds	r2, r2, #1
 7188              	.LVL757:
 7189 00a0 102A     		cmp	r2, #16
 7190 00a2 07D0     		beq	.L747
 7191              	.LVL758:
 7192              	.L748:
2475:bluetooth_rxtx.c **** 					ok[j] = 0;
 7193              		.loc 1 2475 0
 7194 00a4 10F802A0 		ldrb	r10, [r0, r2]	@ zero_extendqisi2
 7195 00a8 11F80290 		ldrb	r9, [r1, r2]	@ zero_extendqisi2
 7196 00ac CA45     		cmp	r10, r9
 7197 00ae F6D0     		beq	.L746
2476:bluetooth_rxtx.c **** 					break;
 7198              		.loc 1 2476 0
 7199 00b0 4EF823C0 		str	ip, [lr, r3, lsl #2]
 7200              	.L747:
2473:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 7201              		.loc 1 2473 0 discriminator 2
 7202 00b4 0133     		adds	r3, r3, #1
 7203              	.LVL759:
 7204 00b6 042B     		cmp	r3, #4
 7205 00b8 ECD1     		bne	.L745
 7206 00ba 0023     		movs	r3, #0
 7207              	.LVL760:
 7208              	.L751:
2484:bluetooth_rxtx.c **** 				matching = j;
 7209              		.loc 1 2484 0
 7210 00bc 5EF82320 		ldr	r2, [lr, r3, lsl #2]
 7211 00c0 002A     		cmp	r2, #0
 7212 00c2 69D1     		bne	.L750
 7213              	.LVL761:
2483:bluetooth_rxtx.c **** 			if (ok[j]) {
 7214              		.loc 1 2483 0 discriminator 2
 7215 00c4 0133     		adds	r3, r3, #1
 7216              	.LVL762:
 7217 00c6 042B     		cmp	r3, #4
 7218 00c8 F8D1     		bne	.L751
 7219              	.LVL763:
 7220              	.L761:
ARM GAS  /tmp/ccLwKaeN.s 			page 194


 7221              	.LBE103:
2469:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 7222              		.loc 1 2469 0 discriminator 2
 7223 00ca 0134     		adds	r4, r4, #1
 7224              	.LVL764:
 7225 00cc B4F53C7F 		cmp	r4, #752
 7226 00d0 D8D1     		bne	.L757
 7227 00d2 0024     		movs	r4, #0
 7228              	.LVL765:
2505:bluetooth_rxtx.c **** 				}
2506:bluetooth_rxtx.c **** 				byte |= bit << k;
2507:bluetooth_rxtx.c **** 			}
2508:bluetooth_rxtx.c **** 			idle_rxbuf[j] = byte;
2509:bluetooth_rxtx.c **** 		}
2510:bluetooth_rxtx.c **** 
2511:bluetooth_rxtx.c **** 		u32 aa = (idle_rxbuf[3] << 24) |
2512:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
2513:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
2514:bluetooth_rxtx.c **** 				 (idle_rxbuf[0]);
2515:bluetooth_rxtx.c **** 		see_aa(aa);
2516:bluetooth_rxtx.c **** 
2517:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t*)idle_rxbuf);
2518:bluetooth_rxtx.c **** 
2519:bluetooth_rxtx.c **** 	}
2520:bluetooth_rxtx.c **** 
2521:bluetooth_rxtx.c **** 	// once we see an AA 5 times, start following it
2522:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i) {
2523:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 7229              		.loc 1 2523 0
 7230 00d4 374D     		ldr	r5, .L770+8
2524:bluetooth_rxtx.c **** 			le_set_access_address(le_promisc.active_aa[i].aa);
2525:bluetooth_rxtx.c **** 			data_cb = cb_follow_le;
 7231              		.loc 1 2525 0
 7232 00d6 384F     		ldr	r7, .L770+12
 7233              	.LVL766:
 7234 00d8 DFF8E880 		ldr	r8, .L770+24
 7235              	.L759:
2523:bluetooth_rxtx.c **** 			le_set_access_address(le_promisc.active_aa[i].aa);
 7236              		.loc 1 2523 0
 7237 00dc 6319     		adds	r3, r4, r5
 7238 00de 5B68     		ldr	r3, [r3, #4]
 7239 00e0 032B     		cmp	r3, #3
 7240 00e2 0EDD     		ble	.L758
2524:bluetooth_rxtx.c **** 			le_set_access_address(le_promisc.active_aa[i].aa);
 7241              		.loc 1 2524 0
 7242 00e4 6059     		ldr	r0, [r4, r5]
 7243 00e6 FFF7FEFF 		bl	le_set_access_address
 7244              	.LVL767:
2526:bluetooth_rxtx.c ****             //debug_printf("calling promisc_follow_cb\n");
2527:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
 7245              		.loc 1 2527 0
 7246 00ea 344B     		ldr	r3, .L770+16
2528:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 7247              		.loc 1 2528 0
 7248 00ec 0020     		movs	r0, #0
2527:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 7249              		.loc 1 2527 0
ARM GAS  /tmp/ccLwKaeN.s 			page 195


 7250 00ee BB61     		str	r3, [r7, #24]
2529:bluetooth_rxtx.c ****             le.target_set = 1;
 7251              		.loc 1 2529 0
 7252 00f0 0123     		movs	r3, #1
2530:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 7253              		.loc 1 2530 0
 7254 00f2 0422     		movs	r2, #4
 7255 00f4 3249     		ldr	r1, .L770+20
2525:bluetooth_rxtx.c ****             //debug_printf("calling promisc_follow_cb\n");
 7256              		.loc 1 2525 0
 7257 00f6 C7F83080 		str	r8, [r7, #48]
2528:bluetooth_rxtx.c ****             le.target_set = 1;
 7258              		.loc 1 2528 0
 7259 00fa 3061     		str	r0, [r6, #16]
2529:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 7260              		.loc 1 2529 0
 7261 00fc 7364     		str	r3, [r6, #68]
 7262              		.loc 1 2530 0
 7263 00fe FFF7FEFF 		bl	le_promisc_state
 7264              	.LVL768:
 7265              	.L758:
 7266 0102 0834     		adds	r4, r4, #8
2522:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 7267              		.loc 1 2522 0 discriminator 2
 7268 0104 B4F5807F 		cmp	r4, #256
 7269 0108 E8D1     		bne	.L759
2531:bluetooth_rxtx.c **** 			// quit using the old stuff and switch to sync mode
2532:bluetooth_rxtx.c **** 		}
2533:bluetooth_rxtx.c **** 	}
2534:bluetooth_rxtx.c **** 	return 1;
2535:bluetooth_rxtx.c **** }
 7270              		.loc 1 2535 0
 7271 010a 0120     		movs	r0, #1
 7272 010c 14B0     		add	sp, sp, #80
 7273              		.cfi_remember_state
 7274              		.cfi_def_cfa_offset 32
 7275              		@ sp needed
 7276 010e BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 7277              	.LVL769:
 7278              	.L755:
 7279              		.cfi_restore_state
 7280              	.LBB104:
 7281              	.LBB101:
 7282              	.LBB98:
2501:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 7283              		.loc 1 2501 0
 7284 0112 00EB0C03 		add	r3, r0, ip
 7285 0116 3B44     		add	r3, r3, r7
2502:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 7286              		.loc 1 2502 0
 7287 0118 032A     		cmp	r2, #3
2501:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 7288              		.loc 1 2501 0
 7289 011a 13F8203C 		ldrb	r3, [r3, #-32]	@ zero_extendqisi2
 7290              	.LVL770:
2502:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 7291              		.loc 1 2502 0
ARM GAS  /tmp/ccLwKaeN.s 			page 196


 7292 011e 0CDD     		ble	.L754
2503:bluetooth_rxtx.c **** 					idx = (idx + 1) % sizeof(whitening);
 7293              		.loc 1 2503 0
 7294 0120 05EB010A 		add	r10, r5, r1
 7295 0124 9AF828A0 		ldrb	r10, [r10, #40]	@ zero_extendqisi2
2504:bluetooth_rxtx.c **** 				}
 7296              		.loc 1 2504 0
 7297 0128 0131     		adds	r1, r1, #1
 7298              	.LVL771:
2503:bluetooth_rxtx.c **** 					idx = (idx + 1) % sizeof(whitening);
 7299              		.loc 1 2503 0
 7300 012a 83EA0A03 		eor	r3, r3, r10
 7301              	.LVL772:
2504:bluetooth_rxtx.c **** 				}
 7302              		.loc 1 2504 0
 7303 012e B1FBF8FA 		udiv	r10, r1, r8
 7304 0132 CAEBCA1A 		rsb	r10, r10, r10, lsl #7
 7305 0136 A1EB0A01 		sub	r1, r1, r10
 7306              	.LVL773:
 7307              	.L754:
2506:bluetooth_rxtx.c **** 			}
 7308              		.loc 1 2506 0 discriminator 2
 7309 013a 8340     		lsls	r3, r3, r0
 7310              	.LVL774:
 7311              	.LBE98:
2498:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 7312              		.loc 1 2498 0 discriminator 2
 7313 013c 0130     		adds	r0, r0, #1
 7314              	.LVL775:
 7315              	.LBB99:
2506:bluetooth_rxtx.c **** 			}
 7316              		.loc 1 2506 0 discriminator 2
 7317 013e 43EA0E03 		orr	r3, r3, lr
 7318              	.LBE99:
2498:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 7319              		.loc 1 2498 0 discriminator 2
 7320 0142 0828     		cmp	r0, #8
 7321              	.LBB100:
2506:bluetooth_rxtx.c **** 			}
 7322              		.loc 1 2506 0 discriminator 2
 7323 0144 5FFA83FE 		uxtb	lr, r3
 7324              	.LVL776:
 7325              	.LBE100:
2498:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 7326              		.loc 1 2498 0 discriminator 2
 7327 0148 E3D1     		bne	.L755
2508:bluetooth_rxtx.c **** 		}
 7328              		.loc 1 2508 0 discriminator 2
 7329 014a D9F80030 		ldr	r3, [r9]
 7330 014e 03F802E0 		strb	lr, [r3, r2]
 7331              	.LBE101:
2496:bluetooth_rxtx.c **** 			u8 byte = 0;
 7332              		.loc 1 2496 0 discriminator 2
 7333 0152 0132     		adds	r2, r2, #1
 7334              	.LVL777:
 7335 0154 0A2A     		cmp	r2, #10
 7336 0156 05D0     		beq	.L756
ARM GAS  /tmp/ccLwKaeN.s 			page 197


 7337              	.LVL778:
 7338              	.L760:
 7339 0158 4FF0000E 		mov	lr, #0
 7340 015c 04EBC20C 		add	ip, r4, r2, lsl #3
 7341 0160 7046     		mov	r0, lr
 7342 0162 D6E7     		b	.L755
 7343              	.LVL779:
 7344              	.L756:
2511:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 7345              		.loc 1 2511 0
 7346 0164 D9F80030 		ldr	r3, [r9]
 7347 0168 D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 7348              	.LVL780:
2512:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 7349              		.loc 1 2512 0
 7350 016a D9F80030 		ldr	r3, [r9]
 7351 016e 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
2513:bluetooth_rxtx.c **** 				 (idle_rxbuf[0]);
 7352              		.loc 1 2513 0
 7353 0170 D9F80020 		ldr	r2, [r9]
 7354              	.LVL781:
2512:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 7355              		.loc 1 2512 0
 7356 0174 1B04     		lsls	r3, r3, #16
2513:bluetooth_rxtx.c **** 				 (idle_rxbuf[0]);
 7357              		.loc 1 2513 0
 7358 0176 5078     		ldrb	r0, [r2, #1]	@ zero_extendqisi2
 7359              	.LVL782:
2514:bluetooth_rxtx.c **** 		see_aa(aa);
 7360              		.loc 1 2514 0
 7361 0178 D9F80020 		ldr	r2, [r9]
2511:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 7362              		.loc 1 2511 0
 7363 017c 43EA0163 		orr	r3, r3, r1, lsl #24
2514:bluetooth_rxtx.c **** 		see_aa(aa);
 7364              		.loc 1 2514 0
 7365 0180 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 7366              	.LVL783:
2513:bluetooth_rxtx.c **** 				 (idle_rxbuf[0]);
 7367              		.loc 1 2513 0
 7368 0182 1343     		orrs	r3, r3, r2
2515:bluetooth_rxtx.c **** 
 7369              		.loc 1 2515 0
 7370 0184 43EA0020 		orr	r0, r3, r0, lsl #8
 7371 0188 FFF7FEFF 		bl	see_aa
 7372              	.LVL784:
2517:bluetooth_rxtx.c **** 
 7373              		.loc 1 2517 0
 7374 018c D9F80010 		ldr	r1, [r9]
 7375 0190 0120     		movs	r0, #1
 7376 0192 FFF7FEFF 		bl	enqueue
 7377              	.LVL785:
 7378 0196 98E7     		b	.L761
 7379              	.LVL786:
 7380              	.L750:
2495:bluetooth_rxtx.c **** 		for (j = 0; j < 4+3+3; ++j) {
 7381              		.loc 1 2495 0
ARM GAS  /tmp/ccLwKaeN.s 			page 198


 7382 0198 B6F84C00 		ldrh	r0, [r6, #76]
 7383              	.LBB102:
2508:bluetooth_rxtx.c **** 		}
 7384              		.loc 1 2508 0
 7385 019c DFF82890 		ldr	r9, .L770+28
 7386              	.LBE102:
2495:bluetooth_rxtx.c **** 		for (j = 0; j < 4+3+3; ++j) {
 7387              		.loc 1 2495 0
 7388 01a0 80B2     		uxth	r0, r0
 7389 01a2 FFF7FEFF 		bl	btle_channel_index
 7390              	.LVL787:
2496:bluetooth_rxtx.c **** 			u8 byte = 0;
 7391              		.loc 1 2496 0
 7392 01a6 0022     		movs	r2, #0
2495:bluetooth_rxtx.c **** 		for (j = 0; j < 4+3+3; ++j) {
 7393              		.loc 1 2495 0
 7394 01a8 295C     		ldrb	r1, [r5, r0]	@ zero_extendqisi2
 7395              	.LVL788:
 7396 01aa D5E7     		b	.L760
 7397              	.L771:
 7398              		.align	2
 7399              	.L770:
 7400 01ac 00000000 		.word	.LANCHOR2
 7401 01b0 A4080000 		.word	.LANCHOR2+2212
 7402 01b4 00000000 		.word	le_promisc
 7403 01b8 00000000 		.word	.LANCHOR1
 7404 01bc 00000000 		.word	promisc_follow_cb
 7405 01c0 00000000 		.word	.LANCHOR0
 7406 01c4 00000000 		.word	cb_follow_le
 7407 01c8 00000000 		.word	idle_rxbuf
 7408              	.LBE104:
 7409              		.cfi_endproc
 7410              	.LFE32:
 7412              		.section	.text.bt_promisc_le,"ax",%progbits
 7413              		.align	1
 7414              		.global	bt_promisc_le
 7415              		.syntax unified
 7416              		.thumb
 7417              		.thumb_func
 7418              		.fpu softvfp
 7420              	bt_promisc_le:
 7421              	.LFB33:
2536:bluetooth_rxtx.c **** 
2537:bluetooth_rxtx.c **** void bt_promisc_le() {
 7422              		.loc 1 2537 0
 7423              		.cfi_startproc
 7424              		@ args = 0, pretend = 0, frame = 0
 7425              		@ frame_needed = 0, uses_anonymous_args = 0
 7426 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 7427              		.cfi_def_cfa_offset 24
 7428              		.cfi_offset 3, -24
 7429              		.cfi_offset 4, -20
 7430              		.cfi_offset 5, -16
 7431              		.cfi_offset 6, -12
 7432              		.cfi_offset 7, -8
 7433              		.cfi_offset 14, -4
2538:bluetooth_rxtx.c ****     //static inc = 0;
ARM GAS  /tmp/ccLwKaeN.s 			page 199


2539:bluetooth_rxtx.c ****     //u8 channel_37[37] = {0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,242,5,26,2
2540:bluetooth_rxtx.c **** 
2541:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_PROMISC_LE) {
 7434              		.loc 1 2541 0
 7435 0002 1B4E     		ldr	r6, .L782
2542:bluetooth_rxtx.c ****         //if(check_channel == 0 && channel_37[inc] != idx2 && channel_37[inc] != idx3){
2543:bluetooth_rxtx.c **** 		    reset_le_promisc();
2544:bluetooth_rxtx.c ****             //idx1 = channel_37[inc];
2545:bluetooth_rxtx.c **** 		    // jump to a random data channel and turn up the squelch
2546:bluetooth_rxtx.c **** 		    if ((channel & 1) == 1){
 7436              		.loc 1 2546 0
 7437 0004 1B4C     		ldr	r4, .L782+4
 7438 0006 3746     		mov	r7, r6
 7439              	.L773:
2541:bluetooth_rxtx.c ****         //if(check_channel == 0 && channel_37[inc] != idx2 && channel_37[inc] != idx3){
 7440              		.loc 1 2541 0
 7441 0008 B37C     		ldrb	r3, [r6, #18]	@ zero_extendqisi2
 7442 000a 0A2B     		cmp	r3, #10
 7443 000c 00D0     		beq	.L777
 7444              	.L772:
 7445 000e F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 7446              	.L777:
2543:bluetooth_rxtx.c ****             //idx1 = channel_37[inc];
 7447              		.loc 1 2543 0
 7448 0010 FFF7FEFF 		bl	reset_le_promisc
 7449              	.LVL789:
 7450              		.loc 1 2546 0
 7451 0014 B4F84C30 		ldrh	r3, [r4, #76]
 7452 0018 DB07     		lsls	r3, r3, #31
 7453 001a 0BD5     		bpl	.L774
2547:bluetooth_rxtx.c **** 			    channel = btle_channel_index_to_phys(idx1);// sopan
 7454              		.loc 1 2547 0
 7455 001c 96F80701 		ldrb	r0, [r6, #263]	@ zero_extendqisi2
 7456 0020 FFF7FEFF 		bl	btle_channel_index_to_phys
 7457              	.LVL790:
 7458 0024 A4F84C00 		strh	r0, [r4, #76]	@ movhi
2548:bluetooth_rxtx.c ****                 debug_printf("Channel: %d\n", channel);
 7459              		.loc 1 2548 0
 7460 0028 B4F84C10 		ldrh	r1, [r4, #76]
 7461 002c 1248     		ldr	r0, .L782+8
 7462 002e 89B2     		uxth	r1, r1
 7463 0030 FFF7FEFF 		bl	debug_printf
 7464              	.LVL791:
 7465              	.L774:
2549:bluetooth_rxtx.c ****             }
2550:bluetooth_rxtx.c ****         //}
2551:bluetooth_rxtx.c **** 		// if the PC hasn't given us AA, determine by listening
2552:bluetooth_rxtx.c **** 		if (!le.target_set) {
 7466              		.loc 1 2552 0
 7467 0034 636C     		ldr	r3, [r4, #68]
 7468 0036 4BB9     		cbnz	r3, .L775
2553:bluetooth_rxtx.c **** 			// cs_threshold_req = -80;
2554:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set(channel);
 7469              		.loc 1 2554 0
 7470 0038 B4F84C00 		ldrh	r0, [r4, #76]
 7471 003c 80B2     		uxth	r0, r0
 7472 003e FFF7FEFF 		bl	cs_threshold_calc_and_set
ARM GAS  /tmp/ccLwKaeN.s 			page 200


 7473              	.LVL792:
2555:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 7474              		.loc 1 2555 0
 7475 0042 0E4B     		ldr	r3, .L782+12
2556:bluetooth_rxtx.c **** 			bt_generic_le(MODE_BT_PROMISC_LE);
 7476              		.loc 1 2556 0
 7477 0044 0A20     		movs	r0, #10
2555:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 7478              		.loc 1 2555 0
 7479 0046 3B63     		str	r3, [r7, #48]
 7480              		.loc 1 2556 0
 7481 0048 FFF7FEFF 		bl	bt_generic_le
 7482              	.LVL793:
 7483              	.L775:
2557:bluetooth_rxtx.c **** 		}
2558:bluetooth_rxtx.c **** 
2559:bluetooth_rxtx.c **** 		// could have got mode change in middle of above
2560:bluetooth_rxtx.c **** 		if (requested_mode != MODE_BT_PROMISC_LE)
 7484              		.loc 1 2560 0
 7485 004c BD7C     		ldrb	r5, [r7, #18]	@ zero_extendqisi2
 7486 004e EDB2     		uxtb	r5, r5
 7487 0050 0A2D     		cmp	r5, #10
 7488 0052 DCD1     		bne	.L772
2561:bluetooth_rxtx.c **** 			break;
2562:bluetooth_rxtx.c **** 
2563:bluetooth_rxtx.c **** 		le_promisc_state(0, &le.access_address, 4);
 7489              		.loc 1 2563 0
 7490 0054 0422     		movs	r2, #4
 7491 0056 2146     		mov	r1, r4
 7492 0058 0020     		movs	r0, #0
 7493 005a FFF7FEFF 		bl	le_promisc_state
 7494              	.LVL794:
2564:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 7495              		.loc 1 2564 0
 7496 005e 084B     		ldr	r3, .L782+16
2565:bluetooth_rxtx.c **** 		le.crc_verify = 0;
2566:bluetooth_rxtx.c **** 		bt_le_sync(MODE_BT_PROMISC_LE);
 7497              		.loc 1 2566 0
 7498 0060 2846     		mov	r0, r5
2564:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 7499              		.loc 1 2564 0
 7500 0062 BB61     		str	r3, [r7, #24]
2565:bluetooth_rxtx.c **** 		le.crc_verify = 0;
 7501              		.loc 1 2565 0
 7502 0064 0023     		movs	r3, #0
 7503 0066 2361     		str	r3, [r4, #16]
 7504              		.loc 1 2566 0
 7505 0068 FFF7FEFF 		bl	bt_le_sync
 7506              	.LVL795:
 7507 006c CCE7     		b	.L773
 7508              	.L783:
 7509 006e 00BF     		.align	2
 7510              	.L782:
 7511 0070 00000000 		.word	.LANCHOR1
 7512 0074 00000000 		.word	.LANCHOR0
 7513 0078 AE000000 		.word	.LC11
 7514 007c 00000000 		.word	cb_le_promisc
ARM GAS  /tmp/ccLwKaeN.s 			page 201


 7515 0080 00000000 		.word	promisc_follow_cb
 7516              		.cfi_endproc
 7517              	.LFE33:
 7519              		.section	.text.bt_slave_le,"ax",%progbits
 7520              		.align	1
 7521              		.global	bt_slave_le
 7522              		.syntax unified
 7523              		.thumb
 7524              		.thumb_func
 7525              		.fpu softvfp
 7527              	bt_slave_le:
 7528              	.LFB34:
2567:bluetooth_rxtx.c ****         
2568:bluetooth_rxtx.c ****         /*if(inc >= 36){
2569:bluetooth_rxtx.c ****             inc = 0;
2570:bluetooth_rxtx.c ****         }
2571:bluetooth_rxtx.c ****         inc++;*/
2572:bluetooth_rxtx.c **** 	}
2573:bluetooth_rxtx.c **** }
2574:bluetooth_rxtx.c **** 
2575:bluetooth_rxtx.c **** void bt_slave_le() {
 7529              		.loc 1 2575 0
 7530              		.cfi_startproc
 7531              		@ args = 0, pretend = 0, frame = 32
 7532              		@ frame_needed = 0, uses_anonymous_args = 0
 7533 0000 70B5     		push	{r4, r5, r6, lr}
 7534              		.cfi_def_cfa_offset 16
 7535              		.cfi_offset 4, -16
 7536              		.cfi_offset 5, -12
 7537              		.cfi_offset 6, -8
 7538              		.cfi_offset 14, -4
 7539 0002 88B0     		sub	sp, sp, #32
 7540              		.cfi_def_cfa_offset 48
2576:bluetooth_rxtx.c **** 	u32 calc_crc;
2577:bluetooth_rxtx.c **** 	int i;
2578:bluetooth_rxtx.c **** 	uint8_t adv_ind[32] = { 0x00, };
2579:bluetooth_rxtx.c **** 	uint8_t adv_ind_len;
2580:bluetooth_rxtx.c **** 
2581:bluetooth_rxtx.c **** 	if (le_adv_len > LE_ADV_MAX_LEN) {
 7541              		.loc 1 2581 0
 7542 0004 294E     		ldr	r6, .L793
2578:bluetooth_rxtx.c **** 	uint8_t adv_ind_len;
 7543              		.loc 1 2578 0
 7544 0006 2022     		movs	r2, #32
 7545 0008 0021     		movs	r1, #0
 7546 000a 6846     		mov	r0, sp
 7547 000c FFF7FEFF 		bl	memset
 7548              	.LVL796:
 7549              		.loc 1 2581 0
 7550 0010 B26D     		ldr	r2, [r6, #88]
 7551 0012 152A     		cmp	r2, #21
 7552 0014 04D9     		bls	.L785
2582:bluetooth_rxtx.c **** 		requested_mode = MODE_IDLE;
 7553              		.loc 1 2582 0
 7554 0016 0022     		movs	r2, #0
 7555 0018 254B     		ldr	r3, .L793+4
 7556 001a 9A74     		strb	r2, [r3, #18]
ARM GAS  /tmp/ccLwKaeN.s 			page 202


 7557              	.L784:
2583:bluetooth_rxtx.c **** 		return;
2584:bluetooth_rxtx.c **** 	}
2585:bluetooth_rxtx.c **** 
2586:bluetooth_rxtx.c **** 	adv_ind_len = 6 + le_adv_len;
2587:bluetooth_rxtx.c **** 	adv_ind[1] = adv_ind_len;
2588:bluetooth_rxtx.c **** 
2589:bluetooth_rxtx.c **** 	// copy the user-specified mac address
2590:bluetooth_rxtx.c **** 	for (i = 0; i < 6; ++i)
2591:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
2592:bluetooth_rxtx.c **** 
2593:bluetooth_rxtx.c **** 	// copy in the adv data
2594:bluetooth_rxtx.c **** 	memcpy(adv_ind + 2 + 6, le_adv_data, le_adv_len);
2595:bluetooth_rxtx.c **** 
2596:bluetooth_rxtx.c **** 	// total: 2 + 6 + le_adv_len
2597:bluetooth_rxtx.c **** 	adv_ind_len += 2;
2598:bluetooth_rxtx.c **** 
2599:bluetooth_rxtx.c **** 	calc_crc = btle_calc_crc(le.crc_init_reversed, adv_ind, adv_ind_len);
2600:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len + 0] = (calc_crc >>  0) & 0xff;
2601:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len + 1] = (calc_crc >>  8) & 0xff;
2602:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len + 2] = (calc_crc >> 16) & 0xff;
2603:bluetooth_rxtx.c **** 
2604:bluetooth_rxtx.c **** 	clkn_start();
2605:bluetooth_rxtx.c **** 
2606:bluetooth_rxtx.c **** 	// enable USB interrupts due to busy waits
2607:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
2608:bluetooth_rxtx.c **** 
2609:bluetooth_rxtx.c **** 	// spam advertising packets
2610:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_SLAVE_LE) {
2611:bluetooth_rxtx.c **** 		le_transmit(0x8e89bed6, adv_ind_len+3, adv_ind);
2612:bluetooth_rxtx.c **** 		msleep(100);
2613:bluetooth_rxtx.c **** 	}
2614:bluetooth_rxtx.c **** 
2615:bluetooth_rxtx.c **** 	// disable USB interrupts
2616:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
2617:bluetooth_rxtx.c **** }
 7558              		.loc 1 2617 0
 7559 001c 08B0     		add	sp, sp, #32
 7560              		.cfi_remember_state
 7561              		.cfi_def_cfa_offset 16
 7562              		@ sp needed
 7563 001e 70BD     		pop	{r4, r5, r6, pc}
 7564              	.L785:
 7565              		.cfi_restore_state
2586:bluetooth_rxtx.c **** 	adv_ind[1] = adv_ind_len;
 7566              		.loc 1 2586 0
 7567 0020 D5B2     		uxtb	r5, r2
 7568              	.LVL797:
 7569 0022 AB1D     		adds	r3, r5, #6
2587:bluetooth_rxtx.c **** 
 7570              		.loc 1 2587 0
 7571 0024 08A9     		add	r1, sp, #32
 7572 0026 01F81F3D 		strb	r3, [r1, #-31]!
 7573              	.LVL798:
 7574 002a 0523     		movs	r3, #5
2591:bluetooth_rxtx.c **** 
 7575              		.loc 1 2591 0
ARM GAS  /tmp/ccLwKaeN.s 			page 203


 7576 002c 214C     		ldr	r4, .L793+8
 7577              	.LVL799:
 7578              	.L787:
2591:bluetooth_rxtx.c **** 
 7579              		.loc 1 2591 0 is_stmt 0 discriminator 3
 7580 002e 185D     		ldrb	r0, [r3, r4]	@ zero_extendqisi2
2590:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
 7581              		.loc 1 2590 0 is_stmt 1 discriminator 3
 7582 0030 13F1FF33 		adds	r3, r3, #-1
2591:bluetooth_rxtx.c **** 
 7583              		.loc 1 2591 0 discriminator 3
 7584 0034 01F8010F 		strb	r0, [r1, #1]!
 7585              	.LVL800:
2590:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
 7586              		.loc 1 2590 0 discriminator 3
 7587 0038 F9D2     		bcs	.L787
2594:bluetooth_rxtx.c **** 
 7588              		.loc 1 2594 0
 7589 003a 1F49     		ldr	r1, .L793+12
 7590              	.LVL801:
 7591 003c 02A8     		add	r0, sp, #8
 7592 003e FFF7FEFF 		bl	memcpy
 7593              	.LVL802:
2597:bluetooth_rxtx.c **** 
 7594              		.loc 1 2597 0
 7595 0042 05F10802 		add	r2, r5, #8
2599:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len + 0] = (calc_crc >>  0) & 0xff;
 7596              		.loc 1 2599 0
 7597 0046 D4B2     		uxtb	r4, r2
 7598 0048 2246     		mov	r2, r4
 7599 004a 6946     		mov	r1, sp
 7600 004c F068     		ldr	r0, [r6, #12]
 7601 004e FFF7FEFF 		bl	btle_calc_crc
 7602              	.LVL803:
2600:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len + 1] = (calc_crc >>  8) & 0xff;
 7603              		.loc 1 2600 0
 7604 0052 08AB     		add	r3, sp, #32
 7605 0054 1A19     		adds	r2, r3, r4
 7606 0056 02F8200C 		strb	r0, [r2, #-32]
2601:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len + 2] = (calc_crc >> 16) & 0xff;
 7607              		.loc 1 2601 0
 7608 005a 030A     		lsrs	r3, r0, #8
2602:bluetooth_rxtx.c **** 
 7609              		.loc 1 2602 0
 7610 005c 000C     		lsrs	r0, r0, #16
 7611              	.LVL804:
2601:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len + 2] = (calc_crc >> 16) & 0xff;
 7612              		.loc 1 2601 0
 7613 005e 02F81F3C 		strb	r3, [r2, #-31]
2602:bluetooth_rxtx.c **** 
 7614              		.loc 1 2602 0
 7615 0062 02F81E0C 		strb	r0, [r2, #-30]
2604:bluetooth_rxtx.c **** 
 7616              		.loc 1 2604 0
 7617 0066 FFF7FEFF 		bl	clkn_start
 7618              	.LVL805:
2607:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccLwKaeN.s 			page 204


 7619              		.loc 1 2607 0
 7620 006a 4FF08072 		mov	r2, #16777216
 7621 006e 134B     		ldr	r3, .L793+16
2611:bluetooth_rxtx.c **** 		msleep(100);
 7622              		.loc 1 2611 0
 7623 0070 134E     		ldr	r6, .L793+20
 7624              	.LBB107:
 7625              	.LBB108:
 873:bluetooth_rxtx.c **** 	uint32_t stop_at = now + millis * 10000 / 3125; // millis -> clkn ticks
 7626              		.loc 1 873 0
 7627 0072 144C     		ldr	r4, .L793+24
 7628              	.LBE108:
 7629              	.LBE107:
2607:bluetooth_rxtx.c **** 
 7630              		.loc 1 2607 0
 7631 0074 1A60     		str	r2, [r3]
 7632              	.L788:
2610:bluetooth_rxtx.c **** 		le_transmit(0x8e89bed6, adv_ind_len+3, adv_ind);
 7633              		.loc 1 2610 0
 7634 0076 0E4B     		ldr	r3, .L793+4
 7635 0078 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 7636 007a 0C2B     		cmp	r3, #12
 7637 007c 04D0     		beq	.L790
2616:bluetooth_rxtx.c **** }
 7638              		.loc 1 2616 0
 7639 007e 4FF08072 		mov	r2, #16777216
 7640 0082 114B     		ldr	r3, .L793+28
 7641 0084 1A60     		str	r2, [r3]
 7642 0086 C9E7     		b	.L784
 7643              	.L790:
2611:bluetooth_rxtx.c **** 		msleep(100);
 7644              		.loc 1 2611 0
 7645 0088 05F10B01 		add	r1, r5, #11
 7646 008c 6A46     		mov	r2, sp
 7647 008e C9B2     		uxtb	r1, r1
 7648 0090 3046     		mov	r0, r6
 7649 0092 FFF7FEFF 		bl	le_transmit
 7650              	.LVL806:
 7651              	.LBB110:
 7652              	.LBB109:
 873:bluetooth_rxtx.c **** 	uint32_t stop_at = now + millis * 10000 / 3125; // millis -> clkn ticks
 7653              		.loc 1 873 0
 7654 0096 2368     		ldr	r3, [r4]
 7655              	.LVL807:
 7656 0098 23F07F43 		bic	r3, r3, #-16777216
 7657              	.LVL808:
 874:bluetooth_rxtx.c **** 
 7658              		.loc 1 874 0
 7659 009c 03F5A073 		add	r3, r3, #320
 7660              	.LVL809:
 7661              	.L789:
 881:bluetooth_rxtx.c **** 	}
 7662              		.loc 1 881 0
 7663 00a0 2268     		ldr	r2, [r4]
 7664 00a2 22F07F42 		bic	r2, r2, #-16777216
 7665 00a6 9342     		cmp	r3, r2
 7666 00a8 FAD8     		bhi	.L789
ARM GAS  /tmp/ccLwKaeN.s 			page 205


 7667 00aa E4E7     		b	.L788
 7668              	.L794:
 7669              		.align	2
 7670              	.L793:
 7671 00ac 00000000 		.word	.LANCHOR0
 7672 00b0 00000000 		.word	.LANCHOR1
 7673 00b4 1C000000 		.word	.LANCHOR1+28
 7674 00b8 5C000000 		.word	.LANCHOR0+92
 7675 00bc 00E100E0 		.word	-536813312
 7676 00c0 D6BE898E 		.word	-1903575338
 7677 00c4 00000000 		.word	clkn
 7678 00c8 80E100E0 		.word	-536813184
 7679              	.LBE109:
 7680              	.LBE110:
 7681              		.cfi_endproc
 7682              	.LFE34:
 7684              		.section	.text.bt_transmit_le,"ax",%progbits
 7685              		.align	1
 7686              		.global	bt_transmit_le
 7687              		.syntax unified
 7688              		.thumb
 7689              		.thumb_func
 7690              		.fpu softvfp
 7692              	bt_transmit_le:
 7693              	.LFB35:
2618:bluetooth_rxtx.c **** 
2619:bluetooth_rxtx.c **** // Sopan Sarkar
2620:bluetooth_rxtx.c **** void bt_transmit_le(){
 7694              		.loc 1 2620 0
 7695              		.cfi_startproc
 7696              		@ args = 0, pretend = 0, frame = 8
 7697              		@ frame_needed = 0, uses_anonymous_args = 0
 7698 0000 37B5     		push	{r0, r1, r2, r4, r5, lr}
 7699              		.cfi_def_cfa_offset 24
 7700              		.cfi_offset 4, -12
 7701              		.cfi_offset 5, -8
 7702              		.cfi_offset 14, -4
2621:bluetooth_rxtx.c **** 	uint8_t pdu_data[2] = {0x50,0x00};
 7703              		.loc 1 2621 0
 7704 0002 5023     		movs	r3, #80
 7705 0004 8DF80430 		strb	r3, [sp, #4]
 7706 0008 0023     		movs	r3, #0
 7707 000a 8DF80530 		strb	r3, [sp, #5]
 7708              	.LVL810:
2622:bluetooth_rxtx.c **** 	uint8_t pdu_data_len = 2;
2623:bluetooth_rxtx.c **** 
2624:bluetooth_rxtx.c **** 	clkn_start();
 7709              		.loc 1 2624 0
 7710 000e FFF7FEFF 		bl	clkn_start
 7711              	.LVL811:
2625:bluetooth_rxtx.c **** 
2626:bluetooth_rxtx.c **** 	// enable USB interrupts due to busy waits
2627:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
 7712              		.loc 1 2627 0
 7713 0012 4FF08072 		mov	r2, #16777216
 7714 0016 0B4B     		ldr	r3, .L799
2628:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccLwKaeN.s 			page 206


2629:bluetooth_rxtx.c **** 	// spam data packets
2630:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_TRANSMIT_LE && do_transmit == 1) {
 7715              		.loc 1 2630 0
 7716 0018 0B4C     		ldr	r4, .L799+4
2631:bluetooth_rxtx.c **** 		le_transmit(le.access_address, pdu_data_len, pdu_data);
 7717              		.loc 1 2631 0
 7718 001a 0C4D     		ldr	r5, .L799+8
2627:bluetooth_rxtx.c **** 
 7719              		.loc 1 2627 0
 7720 001c 1A60     		str	r2, [r3]
 7721              	.L796:
2630:bluetooth_rxtx.c **** 		le_transmit(le.access_address, pdu_data_len, pdu_data);
 7722              		.loc 1 2630 0
 7723 001e A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 7724 0020 112B     		cmp	r3, #17
 7725 0022 03D1     		bne	.L797
2630:bluetooth_rxtx.c **** 		le_transmit(le.access_address, pdu_data_len, pdu_data);
 7726              		.loc 1 2630 0 is_stmt 0 discriminator 1
 7727 0024 94F82830 		ldrb	r3, [r4, #40]	@ zero_extendqisi2
 7728 0028 012B     		cmp	r3, #1
 7729 002a 05D0     		beq	.L798
 7730              	.L797:
2632:bluetooth_rxtx.c **** 	}
2633:bluetooth_rxtx.c **** 	// disable USB interrupts
2634:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
 7731              		.loc 1 2634 0 is_stmt 1
 7732 002c 4FF08072 		mov	r2, #16777216
 7733 0030 074B     		ldr	r3, .L799+12
 7734 0032 1A60     		str	r2, [r3]
2635:bluetooth_rxtx.c **** }
 7735              		.loc 1 2635 0
 7736 0034 03B0     		add	sp, sp, #12
 7737              		.cfi_remember_state
 7738              		.cfi_def_cfa_offset 12
 7739              		@ sp needed
 7740 0036 30BD     		pop	{r4, r5, pc}
 7741              	.L798:
 7742              		.cfi_restore_state
2631:bluetooth_rxtx.c **** 	}
 7743              		.loc 1 2631 0
 7744 0038 01AA     		add	r2, sp, #4
 7745 003a 0221     		movs	r1, #2
 7746 003c 2868     		ldr	r0, [r5]
 7747 003e FFF7FEFF 		bl	le_transmit
 7748              	.LVL812:
 7749 0042 ECE7     		b	.L796
 7750              	.L800:
 7751              		.align	2
 7752              	.L799:
 7753 0044 00E100E0 		.word	-536813312
 7754 0048 00000000 		.word	.LANCHOR1
 7755 004c 00000000 		.word	.LANCHOR0
 7756 0050 80E100E0 		.word	-536813184
 7757              		.cfi_endproc
 7758              	.LFE35:
 7760              		.section	.text.rx_generic_sync,"ax",%progbits
 7761              		.align	1
ARM GAS  /tmp/ccLwKaeN.s 			page 207


 7762              		.global	rx_generic_sync
 7763              		.syntax unified
 7764              		.thumb
 7765              		.thumb_func
 7766              		.fpu softvfp
 7768              	rx_generic_sync:
 7769              	.LFB36:
2636:bluetooth_rxtx.c **** ///////////////////////////////
2637:bluetooth_rxtx.c **** 
2638:bluetooth_rxtx.c **** void rx_generic_sync(void) {
 7770              		.loc 1 2638 0
 7771              		.cfi_startproc
 7772              		@ args = 0, pretend = 0, frame = 40
 7773              		@ frame_needed = 0, uses_anonymous_args = 0
 7774 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 7775              		.cfi_def_cfa_offset 20
 7776              		.cfi_offset 4, -20
 7777              		.cfi_offset 5, -16
 7778              		.cfi_offset 6, -12
 7779              		.cfi_offset 7, -8
 7780              		.cfi_offset 14, -4
 7781 0002 8BB0     		sub	sp, sp, #44
 7782              		.cfi_def_cfa_offset 64
 7783              	.LVL813:
2639:bluetooth_rxtx.c **** 	u8 len = 32;
2640:bluetooth_rxtx.c **** 	u8 buf[len+4];
2641:bluetooth_rxtx.c **** 	u16 reg_val;
2642:bluetooth_rxtx.c **** 
2643:bluetooth_rxtx.c **** 	/* Put syncword at start of buffer
2644:bluetooth_rxtx.c **** 	 * DGS: fix this later, we don't know number of syncword bytes, etc
2645:bluetooth_rxtx.c **** 	 */
2646:bluetooth_rxtx.c **** 	reg_val = cc2400_get(SYNCH);
 7784              		.loc 1 2646 0
 7785 0004 2D20     		movs	r0, #45
 7786 0006 FFF7FEFF 		bl	cc2400_get
 7787              	.LVL814:
2647:bluetooth_rxtx.c **** 	buf[0] = (reg_val >> 8) & 0xFF;
 7788              		.loc 1 2647 0
 7789 000a 030A     		lsrs	r3, r0, #8
2648:bluetooth_rxtx.c **** 	buf[1] = reg_val & 0xFF;
 7790              		.loc 1 2648 0
 7791 000c 8DF80500 		strb	r0, [sp, #5]
2649:bluetooth_rxtx.c **** 	reg_val = cc2400_get(SYNCL);
 7792              		.loc 1 2649 0
 7793 0010 2C20     		movs	r0, #44
 7794              	.LVL815:
2647:bluetooth_rxtx.c **** 	buf[0] = (reg_val >> 8) & 0xFF;
 7795              		.loc 1 2647 0
 7796 0012 8DF80430 		strb	r3, [sp, #4]
 7797              		.loc 1 2649 0
 7798 0016 FFF7FEFF 		bl	cc2400_get
 7799              	.LVL816:
2650:bluetooth_rxtx.c **** 	buf[2] = (reg_val >> 8) & 0xFF;
 7800              		.loc 1 2650 0
 7801 001a 030A     		lsrs	r3, r0, #8
 7802 001c 8DF80630 		strb	r3, [sp, #6]
2651:bluetooth_rxtx.c **** 	buf[3] = reg_val & 0xFF;
ARM GAS  /tmp/ccLwKaeN.s 			page 208


 7803              		.loc 1 2651 0
 7804 0020 8DF80700 		strb	r0, [sp, #7]
2652:bluetooth_rxtx.c **** 
2653:bluetooth_rxtx.c **** 	usb_queue_init();
 7805              		.loc 1 2653 0
 7806 0024 FFF7FEFF 		bl	usb_queue_init
 7807              	.LVL817:
2654:bluetooth_rxtx.c **** 	clkn_start();
 7808              		.loc 1 2654 0
 7809 0028 FFF7FEFF 		bl	clkn_start
 7810              	.LVL818:
 7811              	.L802:
2655:bluetooth_rxtx.c **** 
2656:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 7812              		.loc 1 2656 0 discriminator 1
 7813 002c FFF7FEFF 		bl	cc2400_status
 7814              	.LVL819:
 7815 0030 4106     		lsls	r1, r0, #25
 7816 0032 FBD5     		bpl	.L802
2657:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 7817              		.loc 1 2657 0
 7818 0034 6120     		movs	r0, #97
 7819 0036 FFF7FEFF 		bl	cc2400_strobe
 7820              	.LVL820:
 7821              	.L803:
2658:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 7822              		.loc 1 2658 0 discriminator 1
 7823 003a FFF7FEFF 		bl	cc2400_status
 7824              	.LVL821:
 7825 003e 4207     		lsls	r2, r0, #29
 7826 0040 FBD5     		bpl	.L803
2659:bluetooth_rxtx.c **** 	RXLED_SET;
 7827              		.loc 1 2659 0
 7828 0042 1022     		movs	r2, #16
2660:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2661:bluetooth_rxtx.c **** 		PAEN_SET;
 7829              		.loc 1 2661 0
 7830 0044 8021     		movs	r1, #128
2659:bluetooth_rxtx.c **** 	RXLED_SET;
 7831              		.loc 1 2659 0
 7832 0046 134C     		ldr	r4, .L814
2662:bluetooth_rxtx.c **** 		HGM_SET;
2663:bluetooth_rxtx.c **** #endif
2664:bluetooth_rxtx.c **** 	while (1) {
2665:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
2666:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
2667:bluetooth_rxtx.c **** 		USRLED_CLR;
 7833              		.loc 1 2667 0
 7834 0048 0225     		movs	r5, #2
2659:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 7835              		.loc 1 2659 0
 7836 004a 2260     		str	r2, [r4]
2661:bluetooth_rxtx.c **** 		HGM_SET;
 7837              		.loc 1 2661 0
 7838 004c 124A     		ldr	r2, .L814+4
 7839              		.loc 1 2667 0
 7840 004e 134F     		ldr	r7, .L814+8
ARM GAS  /tmp/ccLwKaeN.s 			page 209


2661:bluetooth_rxtx.c **** 		HGM_SET;
 7841              		.loc 1 2661 0
 7842 0050 1160     		str	r1, [r2]
2662:bluetooth_rxtx.c **** 		HGM_SET;
 7843              		.loc 1 2662 0
 7844 0052 4FF48071 		mov	r1, #256
2668:bluetooth_rxtx.c **** 		while (!(cc2400_status() & SYNC_RECEIVED));
2669:bluetooth_rxtx.c **** 		USRLED_SET;
2670:bluetooth_rxtx.c **** 
2671:bluetooth_rxtx.c **** 		cc2400_fifo_read(len, buf+4);
2672:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, buf);
2673:bluetooth_rxtx.c **** 		handle_usb(clkn);
 7845              		.loc 1 2673 0
 7846 0056 124E     		ldr	r6, .L814+12
2662:bluetooth_rxtx.c **** #endif
 7847              		.loc 1 2662 0
 7848 0058 1160     		str	r1, [r2]
 7849              	.L804:
2665:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 7850              		.loc 1 2665 0 discriminator 1
 7851 005a 0E20     		movs	r0, #14
 7852 005c FFF7FEFF 		bl	cc2400_get
 7853              	.LVL822:
 7854 0060 00F01F00 		and	r0, r0, #31
 7855 0064 0F28     		cmp	r0, #15
 7856 0066 F8D1     		bne	.L804
2666:bluetooth_rxtx.c **** 		USRLED_CLR;
 7857              		.loc 1 2666 0
 7858 0068 6220     		movs	r0, #98
 7859 006a FFF7FEFF 		bl	cc2400_strobe
 7860              	.LVL823:
2667:bluetooth_rxtx.c **** 		while (!(cc2400_status() & SYNC_RECEIVED));
 7861              		.loc 1 2667 0
 7862 006e 3D60     		str	r5, [r7]
 7863              	.L805:
2668:bluetooth_rxtx.c **** 		USRLED_SET;
 7864              		.loc 1 2668 0 discriminator 1
 7865 0070 FFF7FEFF 		bl	cc2400_status
 7866              	.LVL824:
 7867 0074 C306     		lsls	r3, r0, #27
 7868 0076 FBD5     		bpl	.L805
2671:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, buf);
 7869              		.loc 1 2671 0
 7870 0078 02A9     		add	r1, sp, #8
2669:bluetooth_rxtx.c **** 
 7871              		.loc 1 2669 0
 7872 007a 2560     		str	r5, [r4]
2671:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, buf);
 7873              		.loc 1 2671 0
 7874 007c 2020     		movs	r0, #32
 7875 007e FFF7FEFF 		bl	cc2400_fifo_read
 7876              	.LVL825:
2672:bluetooth_rxtx.c **** 		handle_usb(clkn);
 7877              		.loc 1 2672 0
 7878 0082 01A9     		add	r1, sp, #4
 7879              	.LVL826:
 7880 0084 0020     		movs	r0, #0
ARM GAS  /tmp/ccLwKaeN.s 			page 210


 7881 0086 FFF7FEFF 		bl	enqueue
 7882              	.LVL827:
 7883              		.loc 1 2673 0
 7884 008a 3068     		ldr	r0, [r6]
 7885 008c FFF7FEFF 		bl	handle_usb
 7886              	.LVL828:
2665:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 7887              		.loc 1 2665 0
 7888 0090 E3E7     		b	.L804
 7889              	.L815:
 7890 0092 00BF     		.align	2
 7891              	.L814:
 7892 0094 38C00920 		.word	537509944
 7893 0098 58C00920 		.word	537509976
 7894 009c 3CC00920 		.word	537509948
 7895 00a0 00000000 		.word	clkn
 7896              		.cfi_endproc
 7897              	.LFE36:
 7899              		.section	.text.rx_generic,"ax",%progbits
 7900              		.align	1
 7901              		.global	rx_generic
 7902              		.syntax unified
 7903              		.thumb
 7904              		.thumb_func
 7905              		.fpu softvfp
 7907              	rx_generic:
 7908              	.LFB37:
2674:bluetooth_rxtx.c **** 	}
2675:bluetooth_rxtx.c **** }
2676:bluetooth_rxtx.c **** 
2677:bluetooth_rxtx.c **** void rx_generic(void) {
 7909              		.loc 1 2677 0
 7910              		.cfi_startproc
 7911              		@ args = 0, pretend = 0, frame = 0
 7912              		@ frame_needed = 0, uses_anonymous_args = 0
 7913 0000 08B5     		push	{r3, lr}
 7914              		.cfi_def_cfa_offset 8
 7915              		.cfi_offset 3, -8
 7916              		.cfi_offset 14, -4
2678:bluetooth_rxtx.c **** 	// Check for packet mode
2679:bluetooth_rxtx.c **** 	if(cc2400_get(GRMDM) && 0x0400) {
 7917              		.loc 1 2679 0
 7918 0002 2020     		movs	r0, #32
 7919 0004 FFF7FEFF 		bl	cc2400_get
 7920              	.LVL829:
 7921 0008 08B1     		cbz	r0, .L817
2680:bluetooth_rxtx.c **** 		rx_generic_sync();
 7922              		.loc 1 2680 0
 7923 000a FFF7FEFF 		bl	rx_generic_sync
 7924              	.LVL830:
 7925              	.L817:
2681:bluetooth_rxtx.c **** 	} else {
2682:bluetooth_rxtx.c **** 		modulation = MOD_NONE;
 7926              		.loc 1 2682 0
 7927 000e 0322     		movs	r2, #3
 7928 0010 024B     		ldr	r3, .L818
 7929 0012 1A70     		strb	r2, [r3]
ARM GAS  /tmp/ccLwKaeN.s 			page 211


2683:bluetooth_rxtx.c **** 		bt_stream_rx();
2684:bluetooth_rxtx.c **** 	}
2685:bluetooth_rxtx.c **** }
 7930              		.loc 1 2685 0
 7931 0014 BDE80840 		pop	{r3, lr}
 7932              		.cfi_restore 14
 7933              		.cfi_restore 3
 7934              		.cfi_def_cfa_offset 0
2683:bluetooth_rxtx.c **** 		bt_stream_rx();
 7935              		.loc 1 2683 0
 7936 0018 FFF7FEBF 		b	bt_stream_rx
 7937              	.LVL831:
 7938              	.L819:
 7939              		.align	2
 7940              	.L818:
 7941 001c 00000000 		.word	.LANCHOR1
 7942              		.cfi_endproc
 7943              	.LFE37:
 7945              		.section	.text.tx_generic,"ax",%progbits
 7946              		.align	1
 7947              		.global	tx_generic
 7948              		.syntax unified
 7949              		.thumb
 7950              		.thumb_func
 7951              		.fpu softvfp
 7953              	tx_generic:
 7954              	.LFB38:
2686:bluetooth_rxtx.c **** 
2687:bluetooth_rxtx.c **** void tx_generic(void) {
 7955              		.loc 1 2687 0
 7956              		.cfi_startproc
 7957              		@ args = 0, pretend = 0, frame = 0
 7958              		@ frame_needed = 0, uses_anonymous_args = 0
 7959 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 7960              		.cfi_def_cfa_offset 24
 7961              		.cfi_offset 4, -24
 7962              		.cfi_offset 5, -20
 7963              		.cfi_offset 6, -16
 7964              		.cfi_offset 7, -12
 7965              		.cfi_offset 8, -8
 7966              		.cfi_offset 14, -4
2688:bluetooth_rxtx.c **** 	u16 synch, syncl;
2689:bluetooth_rxtx.c **** 	u8 prev_mode = mode;
2690:bluetooth_rxtx.c **** 
2691:bluetooth_rxtx.c **** 	mode = MODE_TX_GENERIC;
 7967              		.loc 1 2691 0
 7968 0004 1023     		movs	r3, #16
2689:bluetooth_rxtx.c **** 
 7969              		.loc 1 2689 0
 7970 0006 354D     		ldr	r5, .L833
2692:bluetooth_rxtx.c **** 
2693:bluetooth_rxtx.c **** 	// Save existing syncword
2694:bluetooth_rxtx.c **** 	synch = cc2400_get(SYNCH);
 7971              		.loc 1 2694 0
 7972 0008 2D20     		movs	r0, #45
2689:bluetooth_rxtx.c **** 
 7973              		.loc 1 2689 0
ARM GAS  /tmp/ccLwKaeN.s 			page 212


 7974 000a 6E7C     		ldrb	r6, [r5, #17]	@ zero_extendqisi2
2691:bluetooth_rxtx.c **** 
 7975              		.loc 1 2691 0
 7976 000c 6B74     		strb	r3, [r5, #17]
 7977              		.loc 1 2694 0
 7978 000e FFF7FEFF 		bl	cc2400_get
 7979              	.LVL832:
 7980 0012 8046     		mov	r8, r0
2695:bluetooth_rxtx.c **** 	syncl = cc2400_get(SYNCL);
 7981              		.loc 1 2695 0
 7982 0014 2C20     		movs	r0, #44
 7983 0016 FFF7FEFF 		bl	cc2400_get
 7984              	.LVL833:
2696:bluetooth_rxtx.c **** 
2697:bluetooth_rxtx.c **** 	cc2400_set(SYNCH, tx_pkt.synch);
 7985              		.loc 1 2697 0
 7986 001a 314C     		ldr	r4, .L833+4
2695:bluetooth_rxtx.c **** 	syncl = cc2400_get(SYNCL);
 7987              		.loc 1 2695 0
 7988 001c 0746     		mov	r7, r0
 7989              		.loc 1 2697 0
 7990 001e 2188     		ldrh	r1, [r4]
 7991 0020 2D20     		movs	r0, #45
 7992 0022 FFF7FEFF 		bl	cc2400_set
 7993              	.LVL834:
2698:bluetooth_rxtx.c **** 	cc2400_set(SYNCL, tx_pkt.syncl);
 7994              		.loc 1 2698 0
 7995 0026 6188     		ldrh	r1, [r4, #2]
 7996 0028 2C20     		movs	r0, #44
 7997 002a FFF7FEFF 		bl	cc2400_set
 7998              	.LVL835:
2699:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0057);
 7999              		.loc 1 2699 0
 8000 002e 5721     		movs	r1, #87
 8001 0030 0320     		movs	r0, #3
 8002 0032 FFF7FEFF 		bl	cc2400_set
 8003              	.LVL836:
2700:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);
 8004              		.loc 1 2700 0
 8005 0036 41F24B31 		movw	r1, #4939
 8006 003a 1420     		movs	r0, #20
 8007 003c FFF7FEFF 		bl	cc2400_set
 8008              	.LVL837:
2701:bluetooth_rxtx.c **** 	cc2400_set(GRMDM, 0x0f61);
 8009              		.loc 1 2701 0
 8010 0040 40F66171 		movw	r1, #3937
 8011 0044 2020     		movs	r0, #32
 8012 0046 FFF7FEFF 		bl	cc2400_set
 8013              	.LVL838:
2702:bluetooth_rxtx.c **** 	cc2400_set(FSDIV, tx_pkt.channel);
 8014              		.loc 1 2702 0
 8015 004a A188     		ldrh	r1, [r4, #4]
 8016 004c 0220     		movs	r0, #2
 8017 004e FFF7FEFF 		bl	cc2400_set
 8018              	.LVL839:
2703:bluetooth_rxtx.c **** 	cc2400_set(FREND, tx_pkt.pa_level);
 8019              		.loc 1 2703 0
ARM GAS  /tmp/ccLwKaeN.s 			page 213


 8020 0052 E179     		ldrb	r1, [r4, #7]	@ zero_extendqisi2
 8021 0054 0520     		movs	r0, #5
2689:bluetooth_rxtx.c **** 
 8022              		.loc 1 2689 0
 8023 0056 F6B2     		uxtb	r6, r6
 8024              	.LVL840:
 8025              		.loc 1 2703 0
 8026 0058 FFF7FEFF 		bl	cc2400_set
 8027              	.LVL841:
 8028              	.L821:
2704:bluetooth_rxtx.c **** 
2705:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 8029              		.loc 1 2705 0 discriminator 1
 8030 005c FFF7FEFF 		bl	cc2400_status
 8031              	.LVL842:
 8032 0060 4106     		lsls	r1, r0, #25
 8033 0062 FBD5     		bpl	.L821
2706:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 8034              		.loc 1 2706 0
 8035 0064 6120     		movs	r0, #97
 8036 0066 FFF7FEFF 		bl	cc2400_strobe
 8037              	.LVL843:
 8038              	.L822:
2707:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 8039              		.loc 1 2707 0 discriminator 1
 8040 006a FFF7FEFF 		bl	cc2400_status
 8041              	.LVL844:
 8042 006e 4207     		lsls	r2, r0, #29
 8043 0070 FBD5     		bpl	.L822
2708:bluetooth_rxtx.c **** 	TXLED_SET;
 8044              		.loc 1 2708 0
 8045 0072 4FF48072 		mov	r2, #256
 8046 0076 1B4B     		ldr	r3, .L833+8
 8047 0078 1A60     		str	r2, [r3]
2709:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2710:bluetooth_rxtx.c **** 		PAEN_SET;
 8048              		.loc 1 2710 0
 8049 007a 8022     		movs	r2, #128
 8050 007c 1A62     		str	r2, [r3, #32]
 8051              	.L823:
2711:bluetooth_rxtx.c **** #endif
2712:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 8052              		.loc 1 2712 0 discriminator 1
 8053 007e 0E20     		movs	r0, #14
 8054 0080 FFF7FEFF 		bl	cc2400_get
 8055              	.LVL845:
 8056 0084 00F01F00 		and	r0, r0, #31
 8057 0088 0F28     		cmp	r0, #15
 8058 008a F8D1     		bne	.L823
2713:bluetooth_rxtx.c **** 
2714:bluetooth_rxtx.c **** 	cc2400_fifo_write(tx_pkt.length, tx_pkt.data);
 8059              		.loc 1 2714 0
 8060 008c A079     		ldrb	r0, [r4, #6]	@ zero_extendqisi2
 8061 008e 1649     		ldr	r1, .L833+12
 8062 0090 FFF7FEFF 		bl	cc2400_fifo_write
 8063              	.LVL846:
2715:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
ARM GAS  /tmp/ccLwKaeN.s 			page 214


 8064              		.loc 1 2715 0
 8065 0094 6320     		movs	r0, #99
 8066 0096 FFF7FEFF 		bl	cc2400_strobe
 8067              	.LVL847:
 8068              	.L824:
2716:bluetooth_rxtx.c **** 
2717:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 8069              		.loc 1 2717 0 discriminator 1
 8070 009a 0E20     		movs	r0, #14
 8071 009c FFF7FEFF 		bl	cc2400_get
 8072              	.LVL848:
 8073 00a0 00F01F00 		and	r0, r0, #31
 8074 00a4 0F28     		cmp	r0, #15
 8075 00a6 F8D1     		bne	.L824
2718:bluetooth_rxtx.c **** 	TXLED_CLR;
 8076              		.loc 1 2718 0
 8077 00a8 4FF48072 		mov	r2, #256
 8078 00ac 0F4B     		ldr	r3, .L833+16
2719:bluetooth_rxtx.c **** 
2720:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 8079              		.loc 1 2720 0
 8080 00ae 6420     		movs	r0, #100
2718:bluetooth_rxtx.c **** 	TXLED_CLR;
 8081              		.loc 1 2718 0
 8082 00b0 1A60     		str	r2, [r3]
 8083              		.loc 1 2720 0
 8084 00b2 FFF7FEFF 		bl	cc2400_strobe
 8085              	.LVL849:
 8086              	.L825:
2721:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 8087              		.loc 1 2721 0 discriminator 1
 8088 00b6 FFF7FEFF 		bl	cc2400_status
 8089              	.LVL850:
 8090 00ba 4307     		lsls	r3, r0, #29
 8091 00bc FBD4     		bmi	.L825
2722:bluetooth_rxtx.c **** 
2723:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2724:bluetooth_rxtx.c **** 	PAEN_CLR;
 8092              		.loc 1 2724 0
 8093 00be 8022     		movs	r2, #128
 8094 00c0 0B4B     		ldr	r3, .L833+20
2725:bluetooth_rxtx.c **** #endif
2726:bluetooth_rxtx.c **** 
2727:bluetooth_rxtx.c **** 	// Restore state
2728:bluetooth_rxtx.c **** 	cc2400_set(SYNCH, synch);
 8095              		.loc 1 2728 0
 8096 00c2 4146     		mov	r1, r8
2724:bluetooth_rxtx.c **** #endif
 8097              		.loc 1 2724 0
 8098 00c4 1A60     		str	r2, [r3]
 8099              		.loc 1 2728 0
 8100 00c6 2D20     		movs	r0, #45
 8101 00c8 FFF7FEFF 		bl	cc2400_set
 8102              	.LVL851:
2729:bluetooth_rxtx.c **** 	cc2400_set(SYNCL, syncl);
 8103              		.loc 1 2729 0
 8104 00cc 3946     		mov	r1, r7
ARM GAS  /tmp/ccLwKaeN.s 			page 215


 8105 00ce 2C20     		movs	r0, #44
 8106 00d0 FFF7FEFF 		bl	cc2400_set
 8107              	.LVL852:
2730:bluetooth_rxtx.c **** 	requested_mode = prev_mode;
 8108              		.loc 1 2730 0
 8109 00d4 AE74     		strb	r6, [r5, #18]
 8110 00d6 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 8111              	.LVL853:
 8112              	.L834:
 8113 00da 00BF     		.align	2
 8114              	.L833:
 8115 00dc 00000000 		.word	.LANCHOR1
 8116 00e0 00000000 		.word	tx_pkt
 8117 00e4 38C00920 		.word	537509944
 8118 00e8 08000000 		.word	tx_pkt+8
 8119 00ec 3CC00920 		.word	537509948
 8120 00f0 5CC00920 		.word	537509980
 8121              		.cfi_endproc
 8122              	.LFE38:
 8124              		.section	.text.specan,"ax",%progbits
 8125              		.align	1
 8126              		.global	specan
 8127              		.syntax unified
 8128              		.thumb
 8129              		.thumb_func
 8130              		.fpu softvfp
 8132              	specan:
 8133              	.LFB39:
2731:bluetooth_rxtx.c **** }
2732:bluetooth_rxtx.c **** 
2733:bluetooth_rxtx.c **** /* spectrum analysis */
2734:bluetooth_rxtx.c **** void specan()
2735:bluetooth_rxtx.c **** {
 8134              		.loc 1 2735 0
 8135              		.cfi_startproc
 8136              		@ args = 0, pretend = 0, frame = 56
 8137              		@ frame_needed = 0, uses_anonymous_args = 0
 8138 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 8139              		.cfi_def_cfa_offset 32
 8140              		.cfi_offset 4, -32
 8141              		.cfi_offset 5, -28
 8142              		.cfi_offset 6, -24
 8143              		.cfi_offset 7, -20
 8144              		.cfi_offset 8, -16
 8145              		.cfi_offset 9, -12
 8146              		.cfi_offset 10, -8
 8147              		.cfi_offset 14, -4
 8148 0004 8EB0     		sub	sp, sp, #56
 8149              		.cfi_def_cfa_offset 88
 8150              	.LVL854:
2736:bluetooth_rxtx.c **** 	u16 f;
2737:bluetooth_rxtx.c **** 	u8 i = 0;
2738:bluetooth_rxtx.c **** 	u8 buf[DMA_SIZE];
2739:bluetooth_rxtx.c **** 
2740:bluetooth_rxtx.c **** 	RXLED_SET;
 8151              		.loc 1 2740 0
 8152 0006 1022     		movs	r2, #16
ARM GAS  /tmp/ccLwKaeN.s 			page 216


 8153 0008 3C4B     		ldr	r3, .L855
 8154 000a 1A60     		str	r2, [r3]
2741:bluetooth_rxtx.c **** 
2742:bluetooth_rxtx.c **** 	usb_queue_init();
 8155              		.loc 1 2742 0
 8156 000c FFF7FEFF 		bl	usb_queue_init
 8157              	.LVL855:
2743:bluetooth_rxtx.c **** 	clkn_start();
 8158              		.loc 1 2743 0
 8159 0010 FFF7FEFF 		bl	clkn_start
 8160              	.LVL856:
2744:bluetooth_rxtx.c **** 
2745:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2746:bluetooth_rxtx.c **** 	PAEN_SET;
 8161              		.loc 1 2746 0
 8162 0014 8022     		movs	r2, #128
 8163 0016 3A4B     		ldr	r3, .L855+4
2747:bluetooth_rxtx.c **** 	//HGM_SET;
2748:bluetooth_rxtx.c **** #endif
2749:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 8164              		.loc 1 2749 0
 8165 0018 42F62231 		movw	r1, #11042
2746:bluetooth_rxtx.c **** 	//HGM_SET;
 8166              		.loc 1 2746 0
 8167 001c 1A60     		str	r2, [r3]
 8168              		.loc 1 2749 0
 8169 001e 1220     		movs	r0, #18
 8170 0020 FFF7FEFF 		bl	cc2400_set
 8171              	.LVL857:
2750:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 8172              		.loc 1 2750 0
 8173 0024 41F24B31 		movw	r1, #4939
 8174 0028 1420     		movs	r0, #20
 8175 002a FFF7FEFF 		bl	cc2400_set
 8176              	.LVL858:
2751:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 8177              		.loc 1 2751 0
 8178 002e 40F20111 		movw	r1, #257
 8179 0032 2020     		movs	r0, #32
 8180 0034 FFF7FEFF 		bl	cc2400_set
 8181              	.LVL859:
2752:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 8182              		.loc 1 2752 0
 8183 0038 2921     		movs	r1, #41
 8184 003a 0320     		movs	r0, #3
 8185 003c FFF7FEFF 		bl	cc2400_set
 8186              	.LVL860:
 8187              	.L836:
2753:bluetooth_rxtx.c **** 	//FIXME maybe set RSSI.RSSI_FILT
2754:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 8188              		.loc 1 2754 0 discriminator 1
 8189 0040 FFF7FEFF 		bl	cc2400_status
 8190              	.LVL861:
 8191 0044 4106     		lsls	r1, r0, #25
 8192 0046 FBD5     		bpl	.L836
 8193              	.L849:
2755:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
ARM GAS  /tmp/ccLwKaeN.s 			page 217


 8194              		.loc 1 2755 0 discriminator 1
 8195 0048 FFF7FEFF 		bl	cc2400_status
 8196              	.LVL862:
 8197 004c 10F00404 		ands	r4, r0, #4
 8198 0050 FAD1     		bne	.L849
2756:bluetooth_rxtx.c **** 
2757:bluetooth_rxtx.c **** 	while (requested_mode == MODE_SPECAN) {
 8199              		.loc 1 2757 0
 8200 0052 DFF8B490 		ldr	r9, .L855+12
2758:bluetooth_rxtx.c **** 		for (f = low_freq; f < high_freq + 1; f++) {
 8201              		.loc 1 2758 0
 8202 0056 DFF8B480 		ldr	r8, .L855+16
 8203              	.LVL863:
 8204              	.L845:
2757:bluetooth_rxtx.c **** 		for (f = low_freq; f < high_freq + 1; f++) {
 8205              		.loc 1 2757 0
 8206 005a 99F81230 		ldrb	r3, [r9, #18]	@ zero_extendqisi2
 8207 005e 042B     		cmp	r3, #4
 8208 0060 05D0     		beq	.L846
2759:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
2760:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
2761:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
2762:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
2763:bluetooth_rxtx.c **** 
2764:bluetooth_rxtx.c **** 			/* give the CC2400 time to acquire RSSI reading */
2765:bluetooth_rxtx.c **** 			volatile u32 j = 500; while (--j); //FIXME crude delay
2766:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
2767:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
2768:bluetooth_rxtx.c **** 			buf[(3 * i) + 2] = cc2400_get(RSSI) >> 8;
2769:bluetooth_rxtx.c **** 			i++;
2770:bluetooth_rxtx.c **** 			if (i == 16) {
2771:bluetooth_rxtx.c **** 				enqueue(SPECAN, buf);
2772:bluetooth_rxtx.c **** 				i = 0;
2773:bluetooth_rxtx.c **** 
2774:bluetooth_rxtx.c **** 				handle_usb(clkn);
2775:bluetooth_rxtx.c **** 			}
2776:bluetooth_rxtx.c **** 
2777:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
2778:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
2779:bluetooth_rxtx.c **** 		}
2780:bluetooth_rxtx.c **** 	}
2781:bluetooth_rxtx.c **** 	RXLED_CLR;
 8209              		.loc 1 2781 0
 8210 0062 1022     		movs	r2, #16
 8211 0064 274B     		ldr	r3, .L855+8
 8212 0066 1A60     		str	r2, [r3]
2782:bluetooth_rxtx.c **** }
 8213              		.loc 1 2782 0
 8214 0068 0EB0     		add	sp, sp, #56
 8215              		.cfi_remember_state
 8216              		.cfi_def_cfa_offset 32
 8217              		@ sp needed
 8218 006a BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 8219              	.LVL864:
 8220              	.L846:
 8221              		.cfi_restore_state
2758:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
ARM GAS  /tmp/ccLwKaeN.s 			page 218


 8222              		.loc 1 2758 0
 8223 006e B8F85250 		ldrh	r5, [r8, #82]
 8224              	.LBB111:
2774:bluetooth_rxtx.c **** 			}
 8225              		.loc 1 2774 0
 8226 0072 DFF89CA0 		ldr	r10, .L855+20
 8227              	.LBE111:
2758:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 8228              		.loc 1 2758 0
 8229 0076 ADB2     		uxth	r5, r5
 8230              	.LVL865:
 8231              	.L839:
2758:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 8232              		.loc 1 2758 0 is_stmt 0 discriminator 1
 8233 0078 B8F85430 		ldrh	r3, [r8, #84]
 8234 007c 9BB2     		uxth	r3, r3
 8235 007e AB42     		cmp	r3, r5
 8236 0080 EBDB     		blt	.L845
 8237              	.LBB112:
2759:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
 8238              		.loc 1 2759 0 is_stmt 1
 8239 0082 691E     		subs	r1, r5, #1
 8240 0084 0220     		movs	r0, #2
 8241 0086 89B2     		uxth	r1, r1
 8242 0088 FFF7FEFF 		bl	cc2400_set
 8243              	.LVL866:
2760:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 8244              		.loc 1 2760 0
 8245 008c 6120     		movs	r0, #97
 8246 008e FFF7FEFF 		bl	cc2400_strobe
 8247              	.LVL867:
 8248              	.L840:
2761:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
 8249              		.loc 1 2761 0 discriminator 1
 8250 0092 FFF7FEFF 		bl	cc2400_status
 8251              	.LVL868:
 8252 0096 4207     		lsls	r2, r0, #29
 8253 0098 FBD5     		bpl	.L840
2762:bluetooth_rxtx.c **** 
 8254              		.loc 1 2762 0
 8255 009a 6220     		movs	r0, #98
 8256 009c FFF7FEFF 		bl	cc2400_strobe
 8257              	.LVL869:
2765:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
 8258              		.loc 1 2765 0
 8259 00a0 4FF4FA73 		mov	r3, #500
 8260 00a4 0093     		str	r3, [sp]
 8261              	.L841:
2765:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
 8262              		.loc 1 2765 0 is_stmt 0 discriminator 2
 8263 00a6 009E     		ldr	r6, [sp]
 8264 00a8 013E     		subs	r6, r6, #1
 8265 00aa 0096     		str	r6, [sp]
 8266 00ac 002E     		cmp	r6, #0
 8267 00ae FAD1     		bne	.L841
2766:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
 8268              		.loc 1 2766 0 is_stmt 1
ARM GAS  /tmp/ccLwKaeN.s 			page 219


 8269 00b0 04EB4407 		add	r7, r4, r4, lsl #1
 8270 00b4 0EAB     		add	r3, sp, #56
 8271 00b6 1F44     		add	r7, r7, r3
2768:bluetooth_rxtx.c **** 			i++;
 8272              		.loc 1 2768 0
 8273 00b8 0620     		movs	r0, #6
2766:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
 8274              		.loc 1 2766 0
 8275 00ba 2B0A     		lsrs	r3, r5, #8
 8276 00bc 07F8343C 		strb	r3, [r7, #-52]
2767:bluetooth_rxtx.c **** 			buf[(3 * i) + 2] = cc2400_get(RSSI) >> 8;
 8277              		.loc 1 2767 0
 8278 00c0 07F8335C 		strb	r5, [r7, #-51]
2768:bluetooth_rxtx.c **** 			i++;
 8279              		.loc 1 2768 0
 8280 00c4 FFF7FEFF 		bl	cc2400_get
 8281              	.LVL870:
2769:bluetooth_rxtx.c **** 			if (i == 16) {
 8282              		.loc 1 2769 0
 8283 00c8 0134     		adds	r4, r4, #1
 8284              	.LVL871:
 8285 00ca E4B2     		uxtb	r4, r4
 8286              	.LVL872:
2768:bluetooth_rxtx.c **** 			i++;
 8287              		.loc 1 2768 0
 8288 00cc 000A     		lsrs	r0, r0, #8
2770:bluetooth_rxtx.c **** 				enqueue(SPECAN, buf);
 8289              		.loc 1 2770 0
 8290 00ce 102C     		cmp	r4, #16
2768:bluetooth_rxtx.c **** 			i++;
 8291              		.loc 1 2768 0
 8292 00d0 07F8320C 		strb	r0, [r7, #-50]
2770:bluetooth_rxtx.c **** 				enqueue(SPECAN, buf);
 8293              		.loc 1 2770 0
 8294 00d4 08D1     		bne	.L842
2771:bluetooth_rxtx.c **** 				i = 0;
 8295              		.loc 1 2771 0
 8296 00d6 01A9     		add	r1, sp, #4
 8297 00d8 0420     		movs	r0, #4
 8298 00da FFF7FEFF 		bl	enqueue
 8299              	.LVL873:
2774:bluetooth_rxtx.c **** 			}
 8300              		.loc 1 2774 0
 8301 00de DAF80000 		ldr	r0, [r10]
 8302 00e2 FFF7FEFF 		bl	handle_usb
 8303              	.LVL874:
2772:bluetooth_rxtx.c **** 
 8304              		.loc 1 2772 0
 8305 00e6 3446     		mov	r4, r6
 8306              	.LVL875:
 8307              	.L842:
2777:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 8308              		.loc 1 2777 0
 8309 00e8 6420     		movs	r0, #100
 8310 00ea FFF7FEFF 		bl	cc2400_strobe
 8311              	.LVL876:
 8312              	.L843:
ARM GAS  /tmp/ccLwKaeN.s 			page 220


2778:bluetooth_rxtx.c **** 		}
 8313              		.loc 1 2778 0 discriminator 1
 8314 00ee FFF7FEFF 		bl	cc2400_status
 8315              	.LVL877:
 8316 00f2 4307     		lsls	r3, r0, #29
 8317 00f4 FBD4     		bmi	.L843
 8318              	.LBE112:
2758:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 8319              		.loc 1 2758 0 discriminator 2
 8320 00f6 0135     		adds	r5, r5, #1
 8321              	.LVL878:
 8322 00f8 ADB2     		uxth	r5, r5
 8323              	.LVL879:
 8324 00fa BDE7     		b	.L839
 8325              	.L856:
 8326              		.align	2
 8327              	.L855:
 8328 00fc 38C00920 		.word	537509944
 8329 0100 58C00920 		.word	537509976
 8330 0104 3CC00920 		.word	537509948
 8331 0108 00000000 		.word	.LANCHOR1
 8332 010c 00000000 		.word	.LANCHOR0
 8333 0110 00000000 		.word	clkn
 8334              		.cfi_endproc
 8335              	.LFE39:
 8337              		.section	.text.led_specan,"ax",%progbits
 8338              		.align	1
 8339              		.global	led_specan
 8340              		.syntax unified
 8341              		.thumb
 8342              		.thumb_func
 8343              		.fpu softvfp
 8345              	led_specan:
 8346              	.LFB40:
2783:bluetooth_rxtx.c **** 
2784:bluetooth_rxtx.c **** /* LED based spectrum analysis */
2785:bluetooth_rxtx.c **** void led_specan()
2786:bluetooth_rxtx.c **** {
 8347              		.loc 1 2786 0
 8348              		.cfi_startproc
 8349              		@ args = 0, pretend = 0, frame = 16
 8350              		@ frame_needed = 0, uses_anonymous_args = 0
 8351 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 8352              		.cfi_def_cfa_offset 20
 8353              		.cfi_offset 4, -20
 8354              		.cfi_offset 5, -16
 8355              		.cfi_offset 6, -12
 8356              		.cfi_offset 7, -8
 8357              		.cfi_offset 14, -4
 8358 0002 85B0     		sub	sp, sp, #20
 8359              		.cfi_def_cfa_offset 40
 8360              	.LVL880:
2787:bluetooth_rxtx.c **** 	int8_t lvl;
2788:bluetooth_rxtx.c **** 	u8 i = 0;
2789:bluetooth_rxtx.c **** 	u16 channels[3] = {2412, 2437, 2462};
 8361              		.loc 1 2789 0
 8362 0004 40F66C13 		movw	r3, #2412
ARM GAS  /tmp/ccLwKaeN.s 			page 221


 8363 0008 ADF80830 		strh	r3, [sp, #8]	@ movhi
 8364 000c 40F68513 		movw	r3, #2437
 8365 0010 ADF80A30 		strh	r3, [sp, #10]	@ movhi
 8366 0014 40F69E13 		movw	r3, #2462
2790:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
2791:bluetooth_rxtx.c **** 	//void (*clr[3]) = {TXLED_CLR, RXLED_CLR, USRLED_CLR};
2792:bluetooth_rxtx.c **** 
2793:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2794:bluetooth_rxtx.c **** 	PAEN_SET;
 8367              		.loc 1 2794 0
 8368 0018 8022     		movs	r2, #128
2789:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
 8369              		.loc 1 2789 0
 8370 001a ADF80C30 		strh	r3, [sp, #12]	@ movhi
 8371              		.loc 1 2794 0
 8372 001e 3F4B     		ldr	r3, .L884
2795:bluetooth_rxtx.c **** 	//HGM_SET;
2796:bluetooth_rxtx.c **** #endif
2797:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 8373              		.loc 1 2797 0
 8374 0020 42F62231 		movw	r1, #11042
2794:bluetooth_rxtx.c **** 	//HGM_SET;
 8375              		.loc 1 2794 0
 8376 0024 1A60     		str	r2, [r3]
 8377              		.loc 1 2797 0
 8378 0026 1220     		movs	r0, #18
 8379 0028 FFF7FEFF 		bl	cc2400_set
 8380              	.LVL881:
2798:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 8381              		.loc 1 2798 0
 8382 002c 41F24B31 		movw	r1, #4939
 8383 0030 1420     		movs	r0, #20
 8384 0032 FFF7FEFF 		bl	cc2400_set
 8385              	.LVL882:
2799:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 8386              		.loc 1 2799 0
 8387 0036 40F20111 		movw	r1, #257
 8388 003a 2020     		movs	r0, #32
 8389 003c FFF7FEFF 		bl	cc2400_set
 8390              	.LVL883:
2800:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 8391              		.loc 1 2800 0
 8392 0040 2921     		movs	r1, #41
 8393 0042 0320     		movs	r0, #3
 8394 0044 FFF7FEFF 		bl	cc2400_set
 8395              	.LVL884:
2801:bluetooth_rxtx.c **** 	cc2400_set(RSSI,    0x00F1); // RSSI Sample over 2 symbols
 8396              		.loc 1 2801 0
 8397 0048 F121     		movs	r1, #241
 8398 004a 0620     		movs	r0, #6
 8399 004c FFF7FEFF 		bl	cc2400_set
 8400              	.LVL885:
 8401              	.L858:
2802:bluetooth_rxtx.c **** 
2803:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 8402              		.loc 1 2803 0 discriminator 1
 8403 0050 FFF7FEFF 		bl	cc2400_status
ARM GAS  /tmp/ccLwKaeN.s 			page 222


 8404              	.LVL886:
 8405 0054 4106     		lsls	r1, r0, #25
 8406 0056 FBD5     		bpl	.L858
 8407              	.L876:
2804:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 8408              		.loc 1 2804 0 discriminator 1
 8409 0058 FFF7FEFF 		bl	cc2400_status
 8410              	.LVL887:
 8411 005c 10F00404 		ands	r4, r0, #4
 8412 0060 FAD1     		bne	.L876
2805:bluetooth_rxtx.c **** 
2806:bluetooth_rxtx.c **** 	while (requested_mode == MODE_LED_SPECAN) {
 8413              		.loc 1 2806 0
 8414 0062 2F4F     		ldr	r7, .L884+4
 8415              	.LBB113:
2807:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channels[i] - 1);
2808:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
2809:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
2810:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
2811:bluetooth_rxtx.c **** 
2812:bluetooth_rxtx.c **** 		/* give the CC2400 time to acquire RSSI reading */
2813:bluetooth_rxtx.c **** 		volatile u32 j = 500; while (--j); //FIXME crude delay
2814:bluetooth_rxtx.c **** 		lvl = (int8_t)((cc2400_get(RSSI) >> 8) & 0xff);
2815:bluetooth_rxtx.c **** 		if (lvl > rssi_threshold) {
2816:bluetooth_rxtx.c **** 			switch (i) {
2817:bluetooth_rxtx.c **** 				case 0:
2818:bluetooth_rxtx.c **** 					TXLED_SET;
2819:bluetooth_rxtx.c **** 					break;
2820:bluetooth_rxtx.c **** 				case 1:
2821:bluetooth_rxtx.c **** 					RXLED_SET;
2822:bluetooth_rxtx.c **** 					break;
2823:bluetooth_rxtx.c **** 				case 2:
2824:bluetooth_rxtx.c **** 					USRLED_SET;
2825:bluetooth_rxtx.c **** 					break;
2826:bluetooth_rxtx.c **** 			}
2827:bluetooth_rxtx.c **** 		}
2828:bluetooth_rxtx.c **** 		else {
2829:bluetooth_rxtx.c **** 			switch (i) {
2830:bluetooth_rxtx.c **** 				case 0:
2831:bluetooth_rxtx.c **** 					TXLED_CLR;
2832:bluetooth_rxtx.c **** 					break;
2833:bluetooth_rxtx.c **** 				case 1:
2834:bluetooth_rxtx.c **** 					RXLED_CLR;
 8416              		.loc 1 2834 0
 8417 0064 2F4D     		ldr	r5, .L884+8
2821:bluetooth_rxtx.c **** 					break;
 8418              		.loc 1 2821 0
 8419 0066 304E     		ldr	r6, .L884+12
 8420              	.LVL888:
 8421              	.L872:
 8422              	.LBE113:
2806:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channels[i] - 1);
 8423              		.loc 1 2806 0
 8424 0068 BB7C     		ldrb	r3, [r7, #18]	@ zero_extendqisi2
 8425 006a 072B     		cmp	r3, #7
 8426 006c 01D0     		beq	.L873
2835:bluetooth_rxtx.c **** 					break;
ARM GAS  /tmp/ccLwKaeN.s 			page 223


2836:bluetooth_rxtx.c **** 				case 2:
2837:bluetooth_rxtx.c **** 					USRLED_CLR;
2838:bluetooth_rxtx.c **** 					break;
2839:bluetooth_rxtx.c **** 			}
2840:bluetooth_rxtx.c **** 		}
2841:bluetooth_rxtx.c **** 
2842:bluetooth_rxtx.c **** 		i = (i+1) % 3;
2843:bluetooth_rxtx.c **** 
2844:bluetooth_rxtx.c **** 		handle_usb(clkn);
2845:bluetooth_rxtx.c **** 
2846:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
2847:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
2848:bluetooth_rxtx.c **** 	}
2849:bluetooth_rxtx.c **** }
 8427              		.loc 1 2849 0
 8428 006e 05B0     		add	sp, sp, #20
 8429              		.cfi_remember_state
 8430              		.cfi_def_cfa_offset 20
 8431              		@ sp needed
 8432 0070 F0BD     		pop	{r4, r5, r6, r7, pc}
 8433              	.LVL889:
 8434              	.L873:
 8435              		.cfi_restore_state
 8436              	.LBB114:
2807:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 8437              		.loc 1 2807 0
 8438 0072 04AB     		add	r3, sp, #16
 8439 0074 03EB4403 		add	r3, r3, r4, lsl #1
 8440 0078 33F8081C 		ldrh	r1, [r3, #-8]
 8441 007c 0220     		movs	r0, #2
 8442 007e 0139     		subs	r1, r1, #1
 8443 0080 89B2     		uxth	r1, r1
 8444 0082 FFF7FEFF 		bl	cc2400_set
 8445              	.LVL890:
2808:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
 8446              		.loc 1 2808 0
 8447 0086 6120     		movs	r0, #97
 8448 0088 FFF7FEFF 		bl	cc2400_strobe
 8449              	.LVL891:
 8450              	.L861:
2809:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 8451              		.loc 1 2809 0 discriminator 1
 8452 008c FFF7FEFF 		bl	cc2400_status
 8453              	.LVL892:
 8454 0090 4207     		lsls	r2, r0, #29
 8455 0092 FBD5     		bpl	.L861
2810:bluetooth_rxtx.c **** 
 8456              		.loc 1 2810 0
 8457 0094 6220     		movs	r0, #98
 8458 0096 FFF7FEFF 		bl	cc2400_strobe
 8459              	.LVL893:
2813:bluetooth_rxtx.c **** 		lvl = (int8_t)((cc2400_get(RSSI) >> 8) & 0xff);
 8460              		.loc 1 2813 0
 8461 009a 4FF4FA73 		mov	r3, #500
 8462 009e 0193     		str	r3, [sp, #4]
 8463              	.L862:
2813:bluetooth_rxtx.c **** 		lvl = (int8_t)((cc2400_get(RSSI) >> 8) & 0xff);
ARM GAS  /tmp/ccLwKaeN.s 			page 224


 8464              		.loc 1 2813 0 is_stmt 0 discriminator 2
 8465 00a0 019B     		ldr	r3, [sp, #4]
 8466 00a2 013B     		subs	r3, r3, #1
 8467 00a4 0193     		str	r3, [sp, #4]
 8468 00a6 002B     		cmp	r3, #0
 8469 00a8 FAD1     		bne	.L862
2814:bluetooth_rxtx.c **** 		if (lvl > rssi_threshold) {
 8470              		.loc 1 2814 0 is_stmt 1
 8471 00aa 0620     		movs	r0, #6
 8472 00ac FFF7FEFF 		bl	cc2400_get
 8473              	.LVL894:
2815:bluetooth_rxtx.c **** 			switch (i) {
 8474              		.loc 1 2815 0
 8475 00b0 1E4B     		ldr	r3, .L884+16
 8476 00b2 40F30720 		sbfx	r0, r0, #8, #8
 8477              	.LVL895:
 8478 00b6 93F85630 		ldrb	r3, [r3, #86]	@ zero_extendqisi2
 8479 00ba 5BB2     		sxtb	r3, r3
 8480 00bc 9842     		cmp	r0, r3
 8481 00be 20DD     		ble	.L863
2816:bluetooth_rxtx.c **** 				case 0:
 8482              		.loc 1 2816 0
 8483 00c0 012C     		cmp	r4, #1
 8484 00c2 1AD0     		beq	.L865
 8485 00c4 15D3     		bcc	.L866
 8486 00c6 022C     		cmp	r4, #2
 8487 00c8 19D0     		beq	.L867
 8488              	.L864:
2842:bluetooth_rxtx.c **** 
 8489              		.loc 1 2842 0
 8490 00ca 0323     		movs	r3, #3
 8491 00cc 0134     		adds	r4, r4, #1
 8492              	.LVL896:
 8493 00ce 94FBF3F3 		sdiv	r3, r4, r3
 8494 00d2 03EB4303 		add	r3, r3, r3, lsl #1
 8495 00d6 E41A     		subs	r4, r4, r3
2844:bluetooth_rxtx.c **** 
 8496              		.loc 1 2844 0
 8497 00d8 154B     		ldr	r3, .L884+20
2842:bluetooth_rxtx.c **** 
 8498              		.loc 1 2842 0
 8499 00da E4B2     		uxtb	r4, r4
 8500              	.LVL897:
2844:bluetooth_rxtx.c **** 
 8501              		.loc 1 2844 0
 8502 00dc 1868     		ldr	r0, [r3]
 8503 00de FFF7FEFF 		bl	handle_usb
 8504              	.LVL898:
2846:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 8505              		.loc 1 2846 0
 8506 00e2 6420     		movs	r0, #100
 8507 00e4 FFF7FEFF 		bl	cc2400_strobe
 8508              	.LVL899:
 8509              	.L871:
2847:bluetooth_rxtx.c **** 	}
 8510              		.loc 1 2847 0 discriminator 1
 8511 00e8 FFF7FEFF 		bl	cc2400_status
ARM GAS  /tmp/ccLwKaeN.s 			page 225


 8512              	.LVL900:
 8513 00ec 4307     		lsls	r3, r0, #29
 8514 00ee FBD4     		bmi	.L871
 8515 00f0 BAE7     		b	.L872
 8516              	.L866:
2818:bluetooth_rxtx.c **** 					break;
 8517              		.loc 1 2818 0
 8518 00f2 4FF48073 		mov	r3, #256
 8519              	.L883:
2821:bluetooth_rxtx.c **** 					break;
 8520              		.loc 1 2821 0
 8521 00f6 3360     		str	r3, [r6]
2822:bluetooth_rxtx.c **** 				case 2:
 8522              		.loc 1 2822 0
 8523 00f8 E7E7     		b	.L864
 8524              	.L865:
2821:bluetooth_rxtx.c **** 					break;
 8525              		.loc 1 2821 0
 8526 00fa 1023     		movs	r3, #16
 8527 00fc FBE7     		b	.L883
 8528              	.L867:
2824:bluetooth_rxtx.c **** 					break;
 8529              		.loc 1 2824 0
 8530 00fe 3460     		str	r4, [r6]
2825:bluetooth_rxtx.c **** 			}
 8531              		.loc 1 2825 0
 8532 0100 E3E7     		b	.L864
 8533              	.L863:
2829:bluetooth_rxtx.c **** 				case 0:
 8534              		.loc 1 2829 0
 8535 0102 012C     		cmp	r4, #1
 8536 0104 08D0     		beq	.L868
 8537 0106 03D3     		bcc	.L869
 8538 0108 022C     		cmp	r4, #2
 8539 010a DED1     		bne	.L864
2837:bluetooth_rxtx.c **** 					break;
 8540              		.loc 1 2837 0
 8541 010c 2C60     		str	r4, [r5]
2838:bluetooth_rxtx.c **** 			}
 8542              		.loc 1 2838 0
 8543 010e DCE7     		b	.L864
 8544              	.L869:
2831:bluetooth_rxtx.c **** 					break;
 8545              		.loc 1 2831 0
 8546 0110 4FF48073 		mov	r3, #256
 8547              	.L882:
2834:bluetooth_rxtx.c **** 					break;
 8548              		.loc 1 2834 0
 8549 0114 2B60     		str	r3, [r5]
2835:bluetooth_rxtx.c **** 				case 2:
 8550              		.loc 1 2835 0
 8551 0116 D8E7     		b	.L864
 8552              	.L868:
2834:bluetooth_rxtx.c **** 					break;
 8553              		.loc 1 2834 0
 8554 0118 1023     		movs	r3, #16
 8555 011a FBE7     		b	.L882
ARM GAS  /tmp/ccLwKaeN.s 			page 226


 8556              	.L885:
 8557              		.align	2
 8558              	.L884:
 8559 011c 58C00920 		.word	537509976
 8560 0120 00000000 		.word	.LANCHOR1
 8561 0124 3CC00920 		.word	537509948
 8562 0128 38C00920 		.word	537509944
 8563 012c 00000000 		.word	.LANCHOR0
 8564 0130 00000000 		.word	clkn
 8565              	.LBE114:
 8566              		.cfi_endproc
 8567              	.LFE40:
 8569              		.section	.text.startup.main,"ax",%progbits
 8570              		.align	1
 8571              		.global	main
 8572              		.syntax unified
 8573              		.thumb
 8574              		.thumb_func
 8575              		.fpu softvfp
 8577              	main:
 8578              	.LFB41:
2850:bluetooth_rxtx.c **** 
2851:bluetooth_rxtx.c **** int main()
2852:bluetooth_rxtx.c **** {
 8579              		.loc 1 2852 0
 8580              		.cfi_startproc
 8581              		@ Volatile: function does not return.
 8582              		@ args = 0, pretend = 0, frame = 0
 8583              		@ frame_needed = 0, uses_anonymous_args = 0
 8584 0000 08B5     		push	{r3, lr}
 8585              		.cfi_def_cfa_offset 8
 8586              		.cfi_offset 3, -8
 8587              		.cfi_offset 14, -4
2853:bluetooth_rxtx.c **** 	ubertooth_init();
 8588              		.loc 1 2853 0
 8589 0002 FFF7FEFF 		bl	ubertooth_init
 8590              	.LVL901:
2854:bluetooth_rxtx.c **** 	clkn_init();
 8591              		.loc 1 2854 0
 8592 0006 FFF7FEFF 		bl	clkn_init
 8593              	.LVL902:
2855:bluetooth_rxtx.c **** 	ubertooth_usb_init(vendor_request_handler);
 8594              		.loc 1 2855 0
 8595 000a 3A48     		ldr	r0, .L909
 8596 000c FFF7FEFF 		bl	ubertooth_usb_init
 8597              	.LVL903:
2856:bluetooth_rxtx.c **** 	cc2400_idle();
2857:bluetooth_rxtx.c **** 	dma_poweron();
2858:bluetooth_rxtx.c **** 
2859:bluetooth_rxtx.c **** 	debug_uart_init(0);
2860:bluetooth_rxtx.c **** 	debug_printf("\n\n****UBERTOOTH BOOT****\n%s\n", compile_info);
2861:bluetooth_rxtx.c **** 
2862:bluetooth_rxtx.c **** 	while (1) {
2863:bluetooth_rxtx.c **** 		handle_usb(clkn);
2864:bluetooth_rxtx.c **** 		if(requested_mode != mode) {
 8598              		.loc 1 2864 0
 8599 0010 394D     		ldr	r5, .L909+4
ARM GAS  /tmp/ccLwKaeN.s 			page 227


2856:bluetooth_rxtx.c **** 	cc2400_idle();
 8600              		.loc 1 2856 0
 8601 0012 FFF7FEFF 		bl	cc2400_idle
 8602              	.LVL904:
2857:bluetooth_rxtx.c **** 
 8603              		.loc 1 2857 0
 8604 0016 FFF7FEFF 		bl	dma_poweron
 8605              	.LVL905:
2859:bluetooth_rxtx.c **** 	debug_printf("\n\n****UBERTOOTH BOOT****\n%s\n", compile_info);
 8606              		.loc 1 2859 0
 8607 001a 0020     		movs	r0, #0
 8608 001c FFF7FEFF 		bl	debug_uart_init
 8609              	.LVL906:
2860:bluetooth_rxtx.c **** 
 8610              		.loc 1 2860 0
 8611 0020 3649     		ldr	r1, .L909+8
 8612 0022 3748     		ldr	r0, .L909+12
 8613 0024 FFF7FEFF 		bl	debug_printf
 8614              	.LVL907:
 8615 0028 2C46     		mov	r4, r5
2863:bluetooth_rxtx.c **** 		if(requested_mode != mode) {
 8616              		.loc 1 2863 0
 8617 002a 364E     		ldr	r6, .L909+16
 8618              	.L887:
 8619 002c 3068     		ldr	r0, [r6]
 8620 002e FFF7FEFF 		bl	handle_usb
 8621              	.LVL908:
 8622              		.loc 1 2864 0
 8623 0032 AA7C     		ldrb	r2, [r5, #18]	@ zero_extendqisi2
 8624 0034 6B7C     		ldrb	r3, [r5, #17]	@ zero_extendqisi2
 8625 0036 9A42     		cmp	r2, r3
 8626 0038 F8D0     		beq	.L887
2865:bluetooth_rxtx.c **** 			switch (requested_mode) {
 8627              		.loc 1 2865 0
 8628 003a AB7C     		ldrb	r3, [r5, #18]	@ zero_extendqisi2
 8629 003c 112B     		cmp	r3, #17
 8630 003e F5D8     		bhi	.L887
 8631 0040 DFE803F0 		tbb	[pc, r3]
 8632              	.L890:
 8633 0044 54       		.byte	(.L889-.L890)/2
 8634 0045 14       		.byte	(.L891-.L890)/2
 8635 0046 16       		.byte	(.L892-.L890)/2
 8636 0047 2B       		.byte	(.L893-.L890)/2
 8637 0048 40       		.byte	(.L894-.L890)/2
 8638 0049 32       		.byte	(.L895-.L890)/2
 8639 004a 3A       		.byte	(.L896-.L890)/2
 8640 004b 43       		.byte	(.L897-.L890)/2
 8641 004c 1B       		.byte	(.L898-.L890)/2
 8642 004d 1D       		.byte	(.L899-.L890)/2
 8643 004e 22       		.byte	(.L900-.L890)/2
 8644 004f 09       		.byte	(.L901-.L890)/2
 8645 0050 25       		.byte	(.L902-.L890)/2
 8646 0051 46       		.byte	(.L903-.L890)/2
 8647 0052 0F       		.byte	(.L904-.L890)/2
 8648 0053 4C       		.byte	(.L905-.L890)/2
 8649 0054 51       		.byte	(.L906-.L890)/2
 8650 0055 28       		.byte	(.L907-.L890)/2
ARM GAS  /tmp/ccLwKaeN.s 			page 228


 8651              		.p2align 1
 8652              	.L901:
2866:bluetooth_rxtx.c **** 				case MODE_RESET:
2867:bluetooth_rxtx.c **** 					/* Allow time for the USB command to return correctly */
2868:bluetooth_rxtx.c **** 					wait(1);
 8653              		.loc 1 2868 0
 8654 0056 0120     		movs	r0, #1
 8655 0058 FFF7FEFF 		bl	wait
 8656              	.LVL909:
2869:bluetooth_rxtx.c **** 					reset();
 8657              		.loc 1 2869 0
 8658 005c FFF7FEFF 		bl	reset
 8659              	.LVL910:
2870:bluetooth_rxtx.c **** 					break;
 8660              		.loc 1 2870 0
 8661 0060 E4E7     		b	.L887
 8662              	.L904:
2871:bluetooth_rxtx.c **** 				case MODE_AFH:
2872:bluetooth_rxtx.c **** 					mode = MODE_AFH;
 8663              		.loc 1 2872 0
 8664 0062 0E23     		movs	r3, #14
 8665              	.L908:
2873:bluetooth_rxtx.c **** 					bt_stream_rx();
2874:bluetooth_rxtx.c **** 					break;
2875:bluetooth_rxtx.c **** 				case MODE_RX_SYMBOLS:
2876:bluetooth_rxtx.c **** 					mode = MODE_RX_SYMBOLS;
 8666              		.loc 1 2876 0
 8667 0064 6374     		strb	r3, [r4, #17]
2877:bluetooth_rxtx.c **** 					bt_stream_rx();
 8668              		.loc 1 2877 0
 8669 0066 FFF7FEFF 		bl	bt_stream_rx
 8670              	.LVL911:
2878:bluetooth_rxtx.c **** 					break;
 8671              		.loc 1 2878 0
 8672 006a DFE7     		b	.L887
 8673              	.L891:
2876:bluetooth_rxtx.c **** 					bt_stream_rx();
 8674              		.loc 1 2876 0
 8675 006c 0123     		movs	r3, #1
 8676 006e F9E7     		b	.L908
 8677              	.L892:
2879:bluetooth_rxtx.c **** 				case MODE_TX_SYMBOLS:
2880:bluetooth_rxtx.c **** 					mode = MODE_TX_SYMBOLS;
 8678              		.loc 1 2880 0
 8679 0070 0223     		movs	r3, #2
 8680 0072 6374     		strb	r3, [r4, #17]
2881:bluetooth_rxtx.c **** 					br_transmit();
 8681              		.loc 1 2881 0
 8682 0074 FFF7FEFF 		bl	br_transmit
 8683              	.LVL912:
2882:bluetooth_rxtx.c **** 					break;
 8684              		.loc 1 2882 0
 8685 0078 D8E7     		b	.L887
 8686              	.L898:
2883:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW:
2884:bluetooth_rxtx.c **** 					mode = MODE_BT_FOLLOW;
 8687              		.loc 1 2884 0
ARM GAS  /tmp/ccLwKaeN.s 			page 229


 8688 007a 0823     		movs	r3, #8
 8689 007c F2E7     		b	.L908
 8690              	.L899:
2885:bluetooth_rxtx.c **** 					bt_stream_rx();
2886:bluetooth_rxtx.c **** 					break;
2887:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW_LE:
2888:bluetooth_rxtx.c **** 					mode = MODE_BT_FOLLOW_LE;
 8691              		.loc 1 2888 0
 8692 007e 0923     		movs	r3, #9
 8693 0080 6374     		strb	r3, [r4, #17]
 8694              	.LBB115:
 8695              	.LBB116:
2097:bluetooth_rxtx.c **** }
 8696              		.loc 1 2097 0
 8697 0082 FFF7FEFF 		bl	le_phy_main
 8698              	.LVL913:
 8699 0086 D1E7     		b	.L887
 8700              	.L900:
 8701              	.LBE116:
 8702              	.LBE115:
2889:bluetooth_rxtx.c **** 					bt_follow_le();
2890:bluetooth_rxtx.c **** 					break;
2891:bluetooth_rxtx.c **** 				case MODE_BT_PROMISC_LE:
2892:bluetooth_rxtx.c **** 					bt_promisc_le();
 8703              		.loc 1 2892 0
 8704 0088 FFF7FEFF 		bl	bt_promisc_le
 8705              	.LVL914:
2893:bluetooth_rxtx.c **** 					break;
 8706              		.loc 1 2893 0
 8707 008c CEE7     		b	.L887
 8708              	.L902:
2894:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE:
2895:bluetooth_rxtx.c **** 					bt_slave_le();
 8709              		.loc 1 2895 0
 8710 008e FFF7FEFF 		bl	bt_slave_le
 8711              	.LVL915:
2896:bluetooth_rxtx.c **** 					break;
 8712              		.loc 1 2896 0
 8713 0092 CBE7     		b	.L887
 8714              	.L907:
2897:bluetooth_rxtx.c **** 				case MODE_BT_TRANSMIT_LE:
2898:bluetooth_rxtx.c **** 					bt_transmit_le();
 8715              		.loc 1 2898 0
 8716 0094 FFF7FEFF 		bl	bt_transmit_le
 8717              	.LVL916:
2899:bluetooth_rxtx.c **** 					break;
 8718              		.loc 1 2899 0
 8719 0098 C8E7     		b	.L887
 8720              	.L893:
2900:bluetooth_rxtx.c **** 				case MODE_TX_TEST:
2901:bluetooth_rxtx.c **** 					mode = MODE_TX_TEST;
 8721              		.loc 1 2901 0
 8722 009a 0323     		movs	r3, #3
2902:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 8723              		.loc 1 2902 0
 8724 009c 1A49     		ldr	r1, .L909+20
 8725 009e 2846     		mov	r0, r5
ARM GAS  /tmp/ccLwKaeN.s 			page 230


2901:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 8726              		.loc 1 2901 0
 8727 00a0 6374     		strb	r3, [r4, #17]
 8728              		.loc 1 2902 0
 8729 00a2 FFF7FEFF 		bl	cc2400_txtest
 8730              	.LVL917:
2903:bluetooth_rxtx.c **** 					break;
 8731              		.loc 1 2903 0
 8732 00a6 C1E7     		b	.L887
 8733              	.L895:
2904:bluetooth_rxtx.c **** 				case MODE_RANGE_TEST:
2905:bluetooth_rxtx.c **** 					mode = MODE_RANGE_TEST;
 8734              		.loc 1 2905 0
 8735 00a8 0523     		movs	r3, #5
2906:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 8736              		.loc 1 2906 0
 8737 00aa 1748     		ldr	r0, .L909+20
2905:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 8738              		.loc 1 2905 0
 8739 00ac 6374     		strb	r3, [r4, #17]
 8740              		.loc 1 2906 0
 8741 00ae FFF7FEFF 		bl	cc2400_rangetest
 8742              	.LVL918:
2907:bluetooth_rxtx.c **** 					requested_mode = MODE_IDLE;
 8743              		.loc 1 2907 0
 8744 00b2 0023     		movs	r3, #0
 8745 00b4 A374     		strb	r3, [r4, #18]
2908:bluetooth_rxtx.c **** 					break;
 8746              		.loc 1 2908 0
 8747 00b6 B9E7     		b	.L887
 8748              	.L896:
2909:bluetooth_rxtx.c **** 				case MODE_REPEATER:
2910:bluetooth_rxtx.c **** 					mode = MODE_REPEATER;
 8749              		.loc 1 2910 0
 8750 00b8 0623     		movs	r3, #6
2911:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 8751              		.loc 1 2911 0
 8752 00ba 1348     		ldr	r0, .L909+20
2910:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 8753              		.loc 1 2910 0
 8754 00bc 6374     		strb	r3, [r4, #17]
 8755              		.loc 1 2911 0
 8756 00be FFF7FEFF 		bl	cc2400_repeater
 8757              	.LVL919:
2912:bluetooth_rxtx.c **** 					break;
 8758              		.loc 1 2912 0
 8759 00c2 B3E7     		b	.L887
 8760              	.L894:
2913:bluetooth_rxtx.c **** 				case MODE_SPECAN:
2914:bluetooth_rxtx.c **** 					specan();
 8761              		.loc 1 2914 0
 8762 00c4 FFF7FEFF 		bl	specan
 8763              	.LVL920:
2915:bluetooth_rxtx.c **** 					break;
 8764              		.loc 1 2915 0
 8765 00c8 B0E7     		b	.L887
 8766              	.L897:
ARM GAS  /tmp/ccLwKaeN.s 			page 231


2916:bluetooth_rxtx.c **** 				case MODE_LED_SPECAN:
2917:bluetooth_rxtx.c **** 					led_specan();
 8767              		.loc 1 2917 0
 8768 00ca FFF7FEFF 		bl	led_specan
 8769              	.LVL921:
2918:bluetooth_rxtx.c **** 					break;
 8770              		.loc 1 2918 0
 8771 00ce ADE7     		b	.L887
 8772              	.L903:
2919:bluetooth_rxtx.c **** 				case MODE_EGO:
2920:bluetooth_rxtx.c **** 					mode = MODE_EGO;
 8773              		.loc 1 2920 0
 8774 00d0 0D23     		movs	r3, #13
 8775 00d2 6374     		strb	r3, [r4, #17]
2921:bluetooth_rxtx.c **** 					ego_main(ego_mode);
 8776              		.loc 1 2921 0
 8777 00d4 207D     		ldrb	r0, [r4, #20]	@ zero_extendqisi2
 8778 00d6 FFF7FEFF 		bl	ego_main
 8779              	.LVL922:
2922:bluetooth_rxtx.c **** 					break;
 8780              		.loc 1 2922 0
 8781 00da A7E7     		b	.L887
 8782              	.L905:
2923:bluetooth_rxtx.c **** 				case MODE_RX_GENERIC:
2924:bluetooth_rxtx.c **** 					mode = MODE_RX_GENERIC;
 8783              		.loc 1 2924 0
 8784 00dc 0F23     		movs	r3, #15
 8785 00de 6374     		strb	r3, [r4, #17]
2925:bluetooth_rxtx.c **** 					rx_generic();
 8786              		.loc 1 2925 0
 8787 00e0 FFF7FEFF 		bl	rx_generic
 8788              	.LVL923:
2926:bluetooth_rxtx.c **** 					break;
 8789              		.loc 1 2926 0
 8790 00e4 A2E7     		b	.L887
 8791              	.L906:
2927:bluetooth_rxtx.c **** 				case MODE_TX_GENERIC:
2928:bluetooth_rxtx.c **** 					tx_generic();
 8792              		.loc 1 2928 0
 8793 00e6 FFF7FEFF 		bl	tx_generic
 8794              	.LVL924:
2929:bluetooth_rxtx.c **** 					break;
 8795              		.loc 1 2929 0
 8796 00ea 9FE7     		b	.L887
 8797              	.L889:
2930:bluetooth_rxtx.c **** 				case MODE_IDLE:
2931:bluetooth_rxtx.c **** 					cc2400_idle();
 8798              		.loc 1 2931 0
 8799 00ec FFF7FEFF 		bl	cc2400_idle
 8800              	.LVL925:
2932:bluetooth_rxtx.c **** 					break;
 8801              		.loc 1 2932 0
 8802 00f0 9CE7     		b	.L887
 8803              	.L910:
 8804 00f2 00BF     		.align	2
 8805              	.L909:
 8806 00f4 00000000 		.word	vendor_request_handler
ARM GAS  /tmp/ccLwKaeN.s 			page 232


 8807 00f8 00000000 		.word	.LANCHOR1
 8808 00fc A7000000 		.word	.LANCHOR2+167
 8809 0100 BB000000 		.word	.LC12
 8810 0104 00000000 		.word	clkn
 8811 0108 4C000000 		.word	.LANCHOR0+76
 8812              		.cfi_endproc
 8813              	.LFE41:
 8815              		.comm	unpacked,800,1
 8816              		.global	packet_cb
 8817              		.global	data_cb
 8818              		.global	le_jam_count
 8819              		.comm	le_promisc,264,4
 8820              		.comm	remapping,192,4
 8821              		.comm	pending_remapping,192,4
 8822              		.global	le
 8823              		.global	le_adv_len
 8824              		.global	le_adv_data
 8825              		.global	slave_mac_address
 8826              		.comm	tx_pkt,58,2
 8827              		.global	do_transmit
 8828              		.global	idx3
 8829              		.global	idx2
 8830              		.global	idx1
 8831              		.global	rssi_threshold
 8832              		.global	high_freq
 8833              		.global	low_freq
 8834              		.global	modulation
 8835              		.global	ego_mode
 8836              		.global	jam_mode
 8837              		.global	requested_mode
 8838              		.global	mode
 8839              		.global	status
 8840              		.global	dma_discard
 8841              		.global	idle_buf_channel
 8842              		.global	idle_buf_clk100ns
 8843              		.global	idle_buf_clkn_high
 8844              		.global	cancel_follow
 8845              		.global	le_adv_channel
 8846              		.global	requested_channel
 8847              		.global	hop_timeout
 8848              		.global	hop_direct_channel
 8849              		.global	channel
 8850              		.global	do_hop
 8851              		.global	hop_mode
 8852              		.global	compile_info
 8853              		.comm	rr,5,1
 8854              		.comm	used_channels,1,1
 8855              		.comm	afh_map,10,1
 8856              		.comm	afh_enabled,1,1
 8857              		.comm	syncword,8,8
 8858              		.comm	target,16,8
 8859              		.comm	clkn_next_drift_fix,4,4
 8860              		.comm	clkn_last_drift_fix,4,4
 8861              		.comm	clk_drift_correction,2,2
 8862              		.comm	clk_drift_ppm,2,2
 8863              		.comm	clk100ns_offset,2,2
 8864              		.comm	clkn_offset,4,4
ARM GAS  /tmp/ccLwKaeN.s 			page 233


 8865              		.comm	last_hop,4,4
 8866              		.comm	clkn,4,4
 8867              		.comm	rx_err,4,4
 8868              		.comm	rx_tc,4,4
 8869              		.comm	idle_rxbuf,4,4
 8870              		.comm	active_rxbuf,4,4
 8871              		.comm	rxbuf2,50,1
 8872              		.comm	rxbuf1,50,1
 8873              		.comm	cs_trigger,1,1
 8874              		.comm	cs_threshold_cur,1,1
 8875              		.comm	cs_threshold_req,1,1
 8876              		.comm	cs_no_squelch,1,1
 8877              		.comm	rssi_count,1,1
 8878              		.comm	rssi_min,1,1
 8879              		.comm	rssi_max,1,1
 8880              		.section	.rodata
 8881              		.align	2
 8882              		.set	.LANCHOR2,. + 0
 8885              	whitening_index:
 8886 0000 46       		.byte	70
 8887 0001 3E       		.byte	62
 8888 0002 78       		.byte	120
 8889 0003 6F       		.byte	111
 8890 0004 4D       		.byte	77
 8891 0005 2E       		.byte	46
 8892 0006 0F       		.byte	15
 8893 0007 65       		.byte	101
 8894 0008 42       		.byte	66
 8895 0009 27       		.byte	39
 8896 000a 1F       		.byte	31
 8897 000b 1A       		.byte	26
 8898 000c 50       		.byte	80
 8899 000d 53       		.byte	83
 8900 000e 7D       		.byte	125
 8901 000f 59       		.byte	89
 8902 0010 0A       		.byte	10
 8903 0011 23       		.byte	35
 8904 0012 08       		.byte	8
 8905 0013 36       		.byte	54
 8906 0014 7A       		.byte	122
 8907 0015 11       		.byte	17
 8908 0016 21       		.byte	33
 8909 0017 00       		.byte	0
 8910 0018 3A       		.byte	58
 8911 0019 73       		.byte	115
 8912 001a 06       		.byte	6
 8913 001b 5E       		.byte	94
 8914 001c 56       		.byte	86
 8915 001d 31       		.byte	49
 8916 001e 34       		.byte	52
 8917 001f 14       		.byte	20
 8918 0020 28       		.byte	40
 8919 0021 1B       		.byte	27
 8920 0022 54       		.byte	84
 8921 0023 5A       		.byte	90
 8922 0024 3F       		.byte	63
 8923 0025 70       		.byte	112
ARM GAS  /tmp/ccLwKaeN.s 			page 234


 8924 0026 2F       		.byte	47
 8925 0027 66       		.byte	102
 8928              	whitening:
 8929 0028 01       		.byte	1
 8930 0029 01       		.byte	1
 8931 002a 01       		.byte	1
 8932 002b 01       		.byte	1
 8933 002c 00       		.byte	0
 8934 002d 01       		.byte	1
 8935 002e 00       		.byte	0
 8936 002f 01       		.byte	1
 8937 0030 00       		.byte	0
 8938 0031 01       		.byte	1
 8939 0032 00       		.byte	0
 8940 0033 00       		.byte	0
 8941 0034 00       		.byte	0
 8942 0035 00       		.byte	0
 8943 0036 01       		.byte	1
 8944 0037 00       		.byte	0
 8945 0038 01       		.byte	1
 8946 0039 01       		.byte	1
 8947 003a 00       		.byte	0
 8948 003b 01       		.byte	1
 8949 003c 01       		.byte	1
 8950 003d 01       		.byte	1
 8951 003e 01       		.byte	1
 8952 003f 00       		.byte	0
 8953 0040 00       		.byte	0
 8954 0041 01       		.byte	1
 8955 0042 01       		.byte	1
 8956 0043 01       		.byte	1
 8957 0044 00       		.byte	0
 8958 0045 00       		.byte	0
 8959 0046 01       		.byte	1
 8960 0047 00       		.byte	0
 8961 0048 01       		.byte	1
 8962 0049 00       		.byte	0
 8963 004a 01       		.byte	1
 8964 004b 01       		.byte	1
 8965 004c 00       		.byte	0
 8966 004d 00       		.byte	0
 8967 004e 01       		.byte	1
 8968 004f 01       		.byte	1
 8969 0050 00       		.byte	0
 8970 0051 00       		.byte	0
 8971 0052 00       		.byte	0
 8972 0053 00       		.byte	0
 8973 0054 00       		.byte	0
 8974 0055 01       		.byte	1
 8975 0056 01       		.byte	1
 8976 0057 00       		.byte	0
 8977 0058 01       		.byte	1
 8978 0059 01       		.byte	1
 8979 005a 00       		.byte	0
 8980 005b 01       		.byte	1
 8981 005c 00       		.byte	0
 8982 005d 01       		.byte	1
ARM GAS  /tmp/ccLwKaeN.s 			page 235


 8983 005e 01       		.byte	1
 8984 005f 01       		.byte	1
 8985 0060 00       		.byte	0
 8986 0061 01       		.byte	1
 8987 0062 00       		.byte	0
 8988 0063 00       		.byte	0
 8989 0064 00       		.byte	0
 8990 0065 01       		.byte	1
 8991 0066 01       		.byte	1
 8992 0067 00       		.byte	0
 8993 0068 00       		.byte	0
 8994 0069 01       		.byte	1
 8995 006a 00       		.byte	0
 8996 006b 00       		.byte	0
 8997 006c 00       		.byte	0
 8998 006d 01       		.byte	1
 8999 006e 00       		.byte	0
 9000 006f 00       		.byte	0
 9001 0070 00       		.byte	0
 9002 0071 00       		.byte	0
 9003 0072 00       		.byte	0
 9004 0073 00       		.byte	0
 9005 0074 01       		.byte	1
 9006 0075 00       		.byte	0
 9007 0076 00       		.byte	0
 9008 0077 01       		.byte	1
 9009 0078 00       		.byte	0
 9010 0079 00       		.byte	0
 9011 007a 01       		.byte	1
 9012 007b 01       		.byte	1
 9013 007c 00       		.byte	0
 9014 007d 01       		.byte	1
 9015 007e 00       		.byte	0
 9016 007f 00       		.byte	0
 9017 0080 01       		.byte	1
 9018 0081 01       		.byte	1
 9019 0082 01       		.byte	1
 9020 0083 01       		.byte	1
 9021 0084 00       		.byte	0
 9022 0085 01       		.byte	1
 9023 0086 01       		.byte	1
 9024 0087 01       		.byte	1
 9025 0088 00       		.byte	0
 9026 0089 00       		.byte	0
 9027 008a 00       		.byte	0
 9028 008b 00       		.byte	0
 9029 008c 01       		.byte	1
 9030 008d 01       		.byte	1
 9031 008e 01       		.byte	1
 9032 008f 01       		.byte	1
 9033 0090 01       		.byte	1
 9034 0091 01       		.byte	1
 9035 0092 01       		.byte	1
 9036 0093 00       		.byte	0
 9037 0094 00       		.byte	0
 9038 0095 00       		.byte	0
 9039 0096 01       		.byte	1
ARM GAS  /tmp/ccLwKaeN.s 			page 236


 9040 0097 01       		.byte	1
 9041 0098 01       		.byte	1
 9042 0099 00       		.byte	0
 9043 009a 01       		.byte	1
 9044 009b 01       		.byte	1
 9045 009c 00       		.byte	0
 9046 009d 00       		.byte	0
 9047 009e 00       		.byte	0
 9048 009f 01       		.byte	1
 9049 00a0 00       		.byte	0
 9050 00a1 01       		.byte	1
 9051 00a2 00       		.byte	0
 9052 00a3 00       		.byte	0
 9053 00a4 01       		.byte	1
 9054 00a5 00       		.byte	0
 9055 00a6 01       		.byte	1
 9058              	compile_info:
 9059 00a7 75626572 		.ascii	"ubertooth git- (lab-pc-1@labpc1-Precision-3630-Towe"
 9059      746F6F74 
 9059      68206769 
 9059      742D2028 
 9059      6C61622D 
 9060 00da 72292046 		.ascii	"r) Fri Feb 28 12:42:31 CST 2020\000"
 9060      72692046 
 9060      65622032 
 9060      38203132 
 9060      3A34323A 
 9061 00fa 0000     		.space	2
 9064              	whitening_word:
 9065 00fc 40B2BCC3 		.word	-1011043776
 9066 0100 1F374A5F 		.word	1598699295
 9067 0104 85F69C9A 		.word	-1700989307
 9068 0108 C1D6C544 		.word	1153816257
 9069 010c 2059DEE1 		.word	-505521888
 9070 0110 8F1BA5AF 		.word	-1348134001
 9071 0114 427B4ECD 		.word	-850494654
 9072 0118 60EB6222 		.word	576908128
 9073 011c 902CEFF0 		.word	-252760944
 9074 0120 C78DD257 		.word	1473416647
 9075 0124 A13DA766 		.word	1722236321
 9076 0128 B0753111 		.word	288454064
 9077 012c 8940B2BC 		.word	-1129168759
 9078 0130 C31F374A 		.word	1245126595
 9079 0134 5F85F69C 		.word	-1661565601
 9080 0138 9AC1D6C5 		.word	-975781478
 9081 013c 442059DE 		.word	-564584380
 9082 0140 E18F1BA5 		.word	-1524920351
 9083 0144 AF427B4E 		.word	1316700847
 9084 0148 CD60EB62 		.word	1659592909
 9085 014c 22902CEF 		.word	-282292190
 9086 0150 F0C78DD2 		.word	-762460176
 9087 0154 57A13DA7 		.word	-1489133225
 9088 0158 66B07531 		.word	829796454
 9089 015c D257A13D 		.word	1033983954
 9090 0160 A766B075 		.word	1974494887
 9091 0164 31114896 		.word	-1773661903
 9092 0168 77F8E346 		.word	1189345399
ARM GAS  /tmp/ccLwKaeN.s 			page 237


 9093 016c E9ABD09E 		.word	-1630491671
 9094 0170 5333D8BA 		.word	-1160236205
 9095 0174 980824CB 		.word	-886830952
 9096 0178 3BFC71A3 		.word	-1552810949
 9097 017c F45568CF 		.word	-815245836
 9098 0180 A9196C5D 		.word	1567365545
 9099 0184 4C0492E5 		.word	-443415476
 9100 0188 1DFEB851 		.word	1371078173
 9101 018c 1BA5AF42 		.word	1118807323
 9102 0190 7B4ECD60 		.word	1624067707
 9103 0194 EB622290 		.word	-1876794645
 9104 0198 2CEFF0C7 		.word	-940511444
 9105 019c 8DD257A1 		.word	-1588079987
 9106 01a0 3DA766B0 		.word	-1335449795
 9107 01a4 75311148 		.word	1209086325
 9108 01a8 9677F8E3 		.word	-470255722
 9109 01ac 46E9ABD0 		.word	-794039994
 9110 01b0 9E5333D8 		.word	-667724898
 9111 01b4 BA980824 		.word	604543162
 9112 01b8 CB3BFC71 		.word	1912355787
 9113 01bc 6479873F 		.word	1065843044
 9114 01c0 6E94BE0A 		.word	180261998
 9115 01c4 ED393583 		.word	-2093663763
 9116 01c8 AD8B8940 		.word	1082756013
 9117 01cc B2BCC31F 		.word	532921522
 9118 01d0 374A5F85 		.word	-2057352649
 9119 01d4 F69C9AC1 		.word	-1046831882
 9120 01d8 D6C54420 		.word	541378006
 9121 01dc 59DEE18F 		.word	-1881022887
 9122 01e0 1BA5AF42 		.word	1118807323
 9123 01e4 7B4ECD60 		.word	1624067707
 9124 01e8 EB622290 		.word	-1876794645
 9125 01ec AD8B8940 		.word	1082756013
 9126 01f0 B2BCC31F 		.word	532921522
 9127 01f4 374A5F85 		.word	-2057352649
 9128 01f8 F69C9AC1 		.word	-1046831882
 9129 01fc D6C54420 		.word	541378006
 9130 0200 59DEE18F 		.word	-1881022887
 9131 0204 1BA5AF42 		.word	1118807323
 9132 0208 7B4ECD60 		.word	1624067707
 9133 020c EB622290 		.word	-1876794645
 9134 0210 2CEFF0C7 		.word	-940511444
 9135 0214 8DD257A1 		.word	-1588079987
 9136 0218 3DA766B0 		.word	-1335449795
 9137 021c F69C9AC1 		.word	-1046831882
 9138 0220 D6C54420 		.word	541378006
 9139 0224 59DEE18F 		.word	-1881022887
 9140 0228 1BA5AF42 		.word	1118807323
 9141 022c 7B4ECD60 		.word	1624067707
 9142 0230 EB622290 		.word	-1876794645
 9143 0234 2CEFF0C7 		.word	-940511444
 9144 0238 8DD257A1 		.word	-1588079987
 9145 023c 3DA766B0 		.word	-1335449795
 9146 0240 75311148 		.word	1209086325
 9147 0244 9677F8E3 		.word	-470255722
 9148 0248 46E9ABD0 		.word	-794039994
 9149 024c 3F6E94BE 		.word	-1097568705
ARM GAS  /tmp/ccLwKaeN.s 			page 238


 9150 0250 0AED3935 		.word	892988682
 9151 0254 83AD8B89 		.word	-1987334781
 9152 0258 40B2BCC3 		.word	-1011043776
 9153 025c 1F374A5F 		.word	1598699295
 9154 0260 85F69C9A 		.word	-1700989307
 9155 0264 C1D6C544 		.word	1153816257
 9156 0268 2059DEE1 		.word	-505521888
 9157 026c 8F1BA5AF 		.word	-1348134001
 9158 0270 427B4ECD 		.word	-850494654
 9159 0274 60EB6222 		.word	576908128
 9160 0278 902CEFF0 		.word	-252760944
 9161 027c 0824CB3B 		.word	1003168776
 9162 0280 FC71A3F4 		.word	-190615044
 9163 0284 5568CFA9 		.word	-1446025131
 9164 0288 196C5D4C 		.word	1281190937
 9165 028c 0492E51D 		.word	501584388
 9166 0290 FEB851FA 		.word	-95307522
 9167 0294 2AB4E7D4 		.word	-723012566
 9168 0298 0CB62E26 		.word	640595468
 9169 029c 02C9F20E 		.word	250792194
 9170 02a0 7FDC287D 		.word	2099829887
 9171 02a4 15DA736A 		.word	1785977365
 9172 02a8 065B1713 		.word	320297734
 9173 02ac C1D6C544 		.word	1153816257
 9174 02b0 2059DEE1 		.word	-505521888
 9175 02b4 8F1BA5AF 		.word	-1348134001
 9176 02b8 427B4ECD 		.word	-850494654
 9177 02bc 60EB6222 		.word	576908128
 9178 02c0 902CEFF0 		.word	-252760944
 9179 02c4 C78DD257 		.word	1473416647
 9180 02c8 A13DA766 		.word	1722236321
 9181 02cc B0753111 		.word	288454064
 9182 02d0 489677F8 		.word	-126380472
 9183 02d4 E346E9AB 		.word	-1410775325
 9184 02d8 D09E5333 		.word	861118160
 9185 02dc 9AC1D6C5 		.word	-975781478
 9186 02e0 442059DE 		.word	-564584380
 9187 02e4 E18F1BA5 		.word	-1524920351
 9188 02e8 AF427B4E 		.word	1316700847
 9189 02ec CD60EB62 		.word	1659592909
 9190 02f0 22902CEF 		.word	-282292190
 9191 02f4 F0C78DD2 		.word	-762460176
 9192 02f8 57A13DA7 		.word	-1489133225
 9193 02fc 66B07531 		.word	829796454
 9194 0300 11489677 		.word	2006337553
 9195 0304 F8E346E9 		.word	-381230088
 9196 0308 ABD09E53 		.word	1402917035
 9197 030c 5333D8BA 		.word	-1160236205
 9198 0310 980824CB 		.word	-886830952
 9199 0314 3BFC71A3 		.word	-1552810949
 9200 0318 F45568CF 		.word	-815245836
 9201 031c A9196C5D 		.word	1567365545
 9202 0320 4C0492E5 		.word	-443415476
 9203 0324 1DFEB851 		.word	1371078173
 9204 0328 FA2AB4E7 		.word	-407622918
 9205 032c D40CB62E 		.word	783682772
 9206 0330 2602C9F2 		.word	-221707738
ARM GAS  /tmp/ccLwKaeN.s 			page 239


 9207 0334 0E7FDC28 		.word	685539086
 9208 0338 7D15DA73 		.word	1943672189
 9209 033c 2CEFF0C7 		.word	-940511444
 9210 0340 8DD257A1 		.word	-1588079987
 9211 0344 3DA766B0 		.word	-1335449795
 9212 0348 75311148 		.word	1209086325
 9213 034c 9677F8E3 		.word	-470255722
 9214 0350 46E9ABD0 		.word	-794039994
 9215 0354 9E5333D8 		.word	-667724898
 9216 0358 BA980824 		.word	604543162
 9217 035c CB3BFC71 		.word	1912355787
 9218 0360 A3F45568 		.word	1750463651
 9219 0364 CFA9196C 		.word	1813621199
 9220 0368 5D4C0492 		.word	-1845212067
 9221 036c E51DFEB8 		.word	-1191305755
 9222 0370 51FA2AB4 		.word	-1272251823
 9223 0374 E7D40CB6 		.word	-1240673049
 9224 0378 2E2602C9 		.word	-922606034
 9225 037c F20E7FDC 		.word	-595652878
 9226 0380 287D15DA 		.word	-636125912
 9227 0384 736A065B 		.word	1527147123
 9228 0388 17138164 		.word	1686180631
 9229 038c 79873F6E 		.word	1849657209
 9230 0390 94BE0AED 		.word	-318062956
 9231 0394 393583AD 		.word	-1383910087
 9232 0398 8B8940B2 		.word	-1304393333
 9233 039c BE0AED39 		.word	971836094
 9234 03a0 3583AD8B 		.word	-1951562955
 9235 03a4 8940B2BC 		.word	-1129168759
 9236 03a8 C31F374A 		.word	1245126595
 9237 03ac 5F85F69C 		.word	-1661565601
 9238 03b0 9AC1D6C5 		.word	-975781478
 9239 03b4 442059DE 		.word	-564584380
 9240 03b8 E18F1BA5 		.word	-1524920351
 9241 03bc AF427B4E 		.word	1316700847
 9242 03c0 CD60EB62 		.word	1659592909
 9243 03c4 22902CEF 		.word	-282292190
 9244 03c8 F0C78DD2 		.word	-762460176
 9245 03cc 77F8E346 		.word	1189345399
 9246 03d0 E9ABD09E 		.word	-1630491671
 9247 03d4 5333D8BA 		.word	-1160236205
 9248 03d8 980824CB 		.word	-886830952
 9249 03dc 3BFC71A3 		.word	-1552810949
 9250 03e0 F45568CF 		.word	-815245836
 9251 03e4 A9196C5D 		.word	1567365545
 9252 03e8 4C0492E5 		.word	-443415476
 9253 03ec 1DFEB851 		.word	1371078173
 9254 03f0 FA2AB4E7 		.word	-407622918
 9255 03f4 D40CB62E 		.word	783682772
 9256 03f8 2602C9F2 		.word	-221707738
 9257 03fc D09E5333 		.word	861118160
 9258 0400 D8BA9808 		.word	144227032
 9259 0404 24CB3BFC 		.word	-63190236
 9260 0408 71A3F455 		.word	1442095985
 9261 040c 68CFA919 		.word	430559080
 9262 0410 6C5D4C04 		.word	72113516
 9263 0414 92E51DFE 		.word	-31595118
ARM GAS  /tmp/ccLwKaeN.s 			page 240


 9264 0418 B851FA2A 		.word	721047992
 9265 041c B4E7D40C 		.word	215279540
 9266 0420 B62E2602 		.word	36056758
 9267 0424 C9F20E7F 		.word	2131686089
 9268 0428 DC287D15 		.word	360523996
 9269 042c 196C5D4C 		.word	1281190937
 9270 0430 0492E51D 		.word	501584388
 9271 0434 FEB851FA 		.word	-95307522
 9272 0438 2AB4E7D4 		.word	-723012566
 9273 043c 0CB62E26 		.word	640595468
 9274 0440 02C9F20E 		.word	250792194
 9275 0444 7FDC287D 		.word	2099829887
 9276 0448 15DA736A 		.word	1785977365
 9277 044c 065B1713 		.word	320297734
 9278 0450 81647987 		.word	-2022087551
 9279 0454 3F6E94BE 		.word	-1097568705
 9280 0458 0AED3935 		.word	892988682
 9281 045c 427B4ECD 		.word	-850494654
 9282 0460 60EB6222 		.word	576908128
 9283 0464 902CEFF0 		.word	-252760944
 9284 0468 C78DD257 		.word	1473416647
 9285 046c A13DA766 		.word	1722236321
 9286 0470 B0753111 		.word	288454064
 9287 0474 489677F8 		.word	-126380472
 9288 0478 E346E9AB 		.word	-1410775325
 9289 047c D09E5333 		.word	861118160
 9290 0480 D8BA9808 		.word	144227032
 9291 0484 24CB3BFC 		.word	-63190236
 9292 0488 71A3F455 		.word	1442095985
 9293 048c 8B8940B2 		.word	-1304393333
 9294 0490 BCC31F37 		.word	924828604
 9295 0494 4A5F85F6 		.word	-159031478
 9296 0498 9C9AC1D6 		.word	-691955044
 9297 049c C5442059 		.word	1495286981
 9298 04a0 DEE18F1B 		.word	462414302
 9299 04a4 A5AF427B 		.word	2067967909
 9300 04a8 4ECD60EB 		.word	-345977522
 9301 04ac 6222902C 		.word	747643490
 9302 04b0 EFF0C78D 		.word	-1916276497
 9303 04b4 D257A13D 		.word	1033983954
 9304 04b8 A766B075 		.word	1974494887
 9305 04bc F45568CF 		.word	-815245836
 9306 04c0 A9196C5D 		.word	1567365545
 9307 04c4 4C0492E5 		.word	-443415476
 9308 04c8 1DFEB851 		.word	1371078173
 9309 04cc FA2AB4E7 		.word	-407622918
 9310 04d0 D40CB62E 		.word	783682772
 9311 04d4 2602C9F2 		.word	-221707738
 9312 04d8 0E7FDC28 		.word	685539086
 9313 04dc 7D15DA73 		.word	1943672189
 9314 04e0 6A065B17 		.word	391841386
 9315 04e4 13816479 		.word	2036629779
 9316 04e8 873F6E94 		.word	-1804714105
 9317 04ec 3DA766B0 		.word	-1335449795
 9318 04f0 75311148 		.word	1209086325
 9319 04f4 9677F8E3 		.word	-470255722
 9320 04f8 46E9ABD0 		.word	-794039994
ARM GAS  /tmp/ccLwKaeN.s 			page 241


 9321 04fc 9E5333D8 		.word	-667724898
 9322 0500 BA980824 		.word	604543162
 9323 0504 CB3BFC71 		.word	1912355787
 9324 0508 A3F45568 		.word	1750463651
 9325 050c CFA9196C 		.word	1813621199
 9326 0510 5D4C0492 		.word	-1845212067
 9327 0514 E51DFEB8 		.word	-1191305755
 9328 0518 51FA2AB4 		.word	-1272251823
 9329 051c 66B07531 		.word	829796454
 9330 0520 11489677 		.word	2006337553
 9331 0524 F8E346E9 		.word	-381230088
 9332 0528 ABD09E53 		.word	1402917035
 9333 052c 33D8BA98 		.word	-1732585421
 9334 0530 0824CB3B 		.word	1003168776
 9335 0534 FC71A3F4 		.word	-190615044
 9336 0538 5568CFA9 		.word	-1446025131
 9337 053c 196C5D4C 		.word	1281190937
 9338 0540 0492E51D 		.word	501584388
 9339 0544 FEB851FA 		.word	-95307522
 9340 0548 2AB4E7D4 		.word	-723012566
 9341 054c AF427B4E 		.word	1316700847
 9342 0550 CD60EB62 		.word	1659592909
 9343 0554 22902CEF 		.word	-282292190
 9344 0558 F0C78DD2 		.word	-762460176
 9345 055c 57A13DA7 		.word	-1489133225
 9346 0560 66B07531 		.word	829796454
 9347 0564 11489677 		.word	2006337553
 9348 0568 F8E346E9 		.word	-381230088
 9349 056c ABD09E53 		.word	1402917035
 9350 0570 33D8BA98 		.word	-1732585421
 9351 0574 0824CB3B 		.word	1003168776
 9352 0578 FC71A3F4 		.word	-190615044
 9353 057c 980824CB 		.word	-886830952
 9354 0580 3BFC71A3 		.word	-1552810949
 9355 0584 F45568CF 		.word	-815245836
 9356 0588 A9196C5D 		.word	1567365545
 9357 058c 4C0492E5 		.word	-443415476
 9358 0590 1DFEB851 		.word	1371078173
 9359 0594 FA2AB4E7 		.word	-407622918
 9360 0598 D40CB62E 		.word	783682772
 9361 059c 2602C9F2 		.word	-221707738
 9362 05a0 0E7FDC28 		.word	685539086
 9363 05a4 7D15DA73 		.word	1943672189
 9364 05a8 6A065B17 		.word	391841386
 9365 05ac 51FA2AB4 		.word	-1272251823
 9366 05b0 E7D40CB6 		.word	-1240673049
 9367 05b4 2E2602C9 		.word	-922606034
 9368 05b8 F20E7FDC 		.word	-595652878
 9369 05bc 287D15DA 		.word	-636125912
 9370 05c0 736A065B 		.word	1527147123
 9371 05c4 17138164 		.word	1686180631
 9372 05c8 79873F6E 		.word	1849657209
 9373 05cc 94BE0AED 		.word	-318062956
 9374 05d0 393583AD 		.word	-1383910087
 9375 05d4 8B8940B2 		.word	-1304393333
 9376 05d8 BCC31F37 		.word	924828604
 9377 05dc 0AED3935 		.word	892988682
ARM GAS  /tmp/ccLwKaeN.s 			page 242


 9378 05e0 83AD8B89 		.word	-1987334781
 9379 05e4 40B2BCC3 		.word	-1011043776
 9380 05e8 1F374A5F 		.word	1598699295
 9381 05ec 85F69C9A 		.word	-1700989307
 9382 05f0 C1D6C544 		.word	1153816257
 9383 05f4 2059DEE1 		.word	-505521888
 9384 05f8 8F1BA5AF 		.word	-1348134001
 9385 05fc 427B4ECD 		.word	-850494654
 9386 0600 60EB6222 		.word	576908128
 9387 0604 902CEFF0 		.word	-252760944
 9388 0608 C78DD257 		.word	1473416647
 9389 060c C31F374A 		.word	1245126595
 9390 0610 5F85F69C 		.word	-1661565601
 9391 0614 9AC1D6C5 		.word	-975781478
 9392 0618 442059DE 		.word	-564584380
 9393 061c E18F1BA5 		.word	-1524920351
 9394 0620 AF427B4E 		.word	1316700847
 9395 0624 CD60EB62 		.word	1659592909
 9396 0628 22902CEF 		.word	-282292190
 9397 062c F0C78DD2 		.word	-762460176
 9398 0630 57A13DA7 		.word	-1489133225
 9399 0634 66B07531 		.word	829796454
 9400 0638 11489677 		.word	2006337553
 9401 063c BCC31F37 		.word	924828604
 9402 0640 4A5F85F6 		.word	-159031478
 9403 0644 9C9AC1D6 		.word	-691955044
 9404 0648 C5442059 		.word	1495286981
 9405 064c DEE18F1B 		.word	462414302
 9406 0650 A5AF427B 		.word	2067967909
 9407 0654 4ECD60EB 		.word	-345977522
 9408 0658 6222902C 		.word	747643490
 9409 065c EFF0C78D 		.word	-1916276497
 9410 0660 D257A13D 		.word	1033983954
 9411 0664 A766B075 		.word	1974494887
 9412 0668 31114896 		.word	-1773661903
 9413 066c 75311148 		.word	1209086325
 9414 0670 9677F8E3 		.word	-470255722
 9415 0674 46E9ABD0 		.word	-794039994
 9416 0678 9E5333D8 		.word	-667724898
 9417 067c BA980824 		.word	604543162
 9418 0680 CB3BFC71 		.word	1912355787
 9419 0684 A3F45568 		.word	1750463651
 9420 0688 CFA9196C 		.word	1813621199
 9421 068c 5D4C0492 		.word	-1845212067
 9422 0690 E51DFEB8 		.word	-1191305755
 9423 0694 51FA2AB4 		.word	-1272251823
 9424 0698 E7D40CB6 		.word	-1240673049
 9425 069c 2E2602C9 		.word	-922606034
 9426 06a0 F20E7FDC 		.word	-595652878
 9427 06a4 287D15DA 		.word	-636125912
 9428 06a8 736A065B 		.word	1527147123
 9429 06ac 17138164 		.word	1686180631
 9430 06b0 79873F6E 		.word	1849657209
 9431 06b4 94BE0AED 		.word	-318062956
 9432 06b8 393583AD 		.word	-1383910087
 9433 06bc 8B8940B2 		.word	-1304393333
 9434 06c0 BCC31F37 		.word	924828604
ARM GAS  /tmp/ccLwKaeN.s 			page 243


 9435 06c4 4A5F85F6 		.word	-159031478
 9436 06c8 9C9AC1D6 		.word	-691955044
 9437 06cc E7D40CB6 		.word	-1240673049
 9438 06d0 2E2602C9 		.word	-922606034
 9439 06d4 F20E7FDC 		.word	-595652878
 9440 06d8 287D15DA 		.word	-636125912
 9441 06dc 736A065B 		.word	1527147123
 9442 06e0 17138164 		.word	1686180631
 9443 06e4 79873F6E 		.word	1849657209
 9444 06e8 94BE0AED 		.word	-318062956
 9445 06ec 393583AD 		.word	-1383910087
 9446 06f0 8B8940B2 		.word	-1304393333
 9447 06f4 BCC31F37 		.word	924828604
 9448 06f8 4A5F85F6 		.word	-159031478
 9449 06fc 60EB6222 		.word	576908128
 9450 0700 902CEFF0 		.word	-252760944
 9451 0704 C78DD257 		.word	1473416647
 9452 0708 A13DA766 		.word	1722236321
 9453 070c B0753111 		.word	288454064
 9454 0710 489677F8 		.word	-126380472
 9455 0714 E346E9AB 		.word	-1410775325
 9456 0718 D09E5333 		.word	861118160
 9457 071c D8BA9808 		.word	144227032
 9458 0720 24CB3BFC 		.word	-63190236
 9459 0724 71A3F455 		.word	1442095985
 9460 0728 68CFA919 		.word	430559080
 9461 072c A9196C5D 		.word	1567365545
 9462 0730 4C0492E5 		.word	-443415476
 9463 0734 1DFEB851 		.word	1371078173
 9464 0738 FA2AB4E7 		.word	-407622918
 9465 073c D40CB62E 		.word	783682772
 9466 0740 2602C9F2 		.word	-221707738
 9467 0744 0E7FDC28 		.word	685539086
 9468 0748 7D15DA73 		.word	1943672189
 9469 074c 6A065B17 		.word	391841386
 9470 0750 13816479 		.word	2036629779
 9471 0754 873F6E94 		.word	-1804714105
 9472 0758 BE0AED39 		.word	971836094
 9473 075c F20E7FDC 		.word	-595652878
 9474 0760 287D15DA 		.word	-636125912
 9475 0764 736A065B 		.word	1527147123
 9476 0768 17138164 		.word	1686180631
 9477 076c 79873F6E 		.word	1849657209
 9478 0770 94BE0AED 		.word	-318062956
 9479 0774 393583AD 		.word	-1383910087
 9480 0778 8B8940B2 		.word	-1304393333
 9481 077c BCC31F37 		.word	924828604
 9482 0780 4A5F85F6 		.word	-159031478
 9483 0784 9C9AC1D6 		.word	-691955044
 9484 0788 C5442059 		.word	1495286981
 9485 078c 3BFC71A3 		.word	-1552810949
 9486 0790 F45568CF 		.word	-815245836
 9487 0794 A9196C5D 		.word	1567365545
 9488 0798 4C0492E5 		.word	-443415476
 9489 079c 1DFEB851 		.word	1371078173
 9490 07a0 FA2AB4E7 		.word	-407622918
 9491 07a4 D40CB62E 		.word	783682772
ARM GAS  /tmp/ccLwKaeN.s 			page 244


 9492 07a8 2602C9F2 		.word	-221707738
 9493 07ac 0E7FDC28 		.word	685539086
 9494 07b0 7D15DA73 		.word	1943672189
 9495 07b4 6A065B17 		.word	391841386
 9496 07b8 13816479 		.word	2036629779
 9497 07bc 442059DE 		.word	-564584380
 9498 07c0 E18F1BA5 		.word	-1524920351
 9499 07c4 AF427B4E 		.word	1316700847
 9500 07c8 CD60EB62 		.word	1659592909
 9501 07cc 22902CEF 		.word	-282292190
 9502 07d0 F0C78DD2 		.word	-762460176
 9503 07d4 57A13DA7 		.word	-1489133225
 9504 07d8 66B07531 		.word	829796454
 9505 07dc 11489677 		.word	2006337553
 9506 07e0 F8E346E9 		.word	-381230088
 9507 07e4 ABD09E53 		.word	1402917035
 9508 07e8 33D8BA98 		.word	-1732585421
 9509 07ec 8DD257A1 		.word	-1588079987
 9510 07f0 3DA766B0 		.word	-1335449795
 9511 07f4 75311148 		.word	1209086325
 9512 07f8 9677F8E3 		.word	-470255722
 9513 07fc 46E9ABD0 		.word	-794039994
 9514 0800 9E5333D8 		.word	-667724898
 9515 0804 BA980824 		.word	604543162
 9516 0808 CB3BFC71 		.word	1912355787
 9517 080c A3F45568 		.word	1750463651
 9518 0810 CFA9196C 		.word	1813621199
 9519 0814 5D4C0492 		.word	-1845212067
 9520 0818 E51DFEB8 		.word	-1191305755
 9521 081c D6C54420 		.word	541378006
 9522 0820 59DEE18F 		.word	-1881022887
 9523 0824 1BA5AF42 		.word	1118807323
 9524 0828 7B4ECD60 		.word	1624067707
 9525 082c EB622290 		.word	-1876794645
 9526 0830 2CEFF0C7 		.word	-940511444
 9527 0834 8DD257A1 		.word	-1588079987
 9528 0838 3DA766B0 		.word	-1335449795
 9529 083c 75311148 		.word	1209086325
 9530 0840 9677F8E3 		.word	-470255722
 9531 0844 46E9ABD0 		.word	-794039994
 9532 0848 9E5333D8 		.word	-667724898
 9533 084c 1F374A5F 		.word	1598699295
 9534 0850 85F69C9A 		.word	-1700989307
 9535 0854 C1D6C544 		.word	1153816257
 9536 0858 2059DEE1 		.word	-505521888
 9537 085c 8F1BA5AF 		.word	-1348134001
 9538 0860 427B4ECD 		.word	-850494654
 9539 0864 60EB6222 		.word	576908128
 9540 0868 902CEFF0 		.word	-252760944
 9541 086c C78DD257 		.word	1473416647
 9542 0870 A13DA766 		.word	1722236321
 9543 0874 B0753111 		.word	288454064
 9544 0878 489677F8 		.word	-126380472
 9547              	hop_interval_lut:
 9548 087c 00       		.byte	0
 9549 087d 01       		.byte	1
 9550 087e 13       		.byte	19
ARM GAS  /tmp/ccLwKaeN.s 			page 245


 9551 087f 19       		.byte	25
 9552 0880 1C       		.byte	28
 9553 0881 0F       		.byte	15
 9554 0882 1F       		.byte	31
 9555 0883 10       		.byte	16
 9556 0884 0E       		.byte	14
 9557 0885 21       		.byte	33
 9558 0886 1A       		.byte	26
 9559 0887 1B       		.byte	27
 9560 0888 22       		.byte	34
 9561 0889 14       		.byte	20
 9562 088a 08       		.byte	8
 9563 088b 05       		.byte	5
 9564 088c 07       		.byte	7
 9565 088d 18       		.byte	24
 9566 088e 23       		.byte	35
 9567 088f 02       		.byte	2
 9568 0890 0D       		.byte	13
 9569 0891 1E       		.byte	30
 9570 0892 20       		.byte	32
 9571 0893 1D       		.byte	29
 9572 0894 11       		.byte	17
 9573 0895 03       		.byte	3
 9574 0896 0A       		.byte	10
 9575 0897 0B       		.byte	11
 9576 0898 04       		.byte	4
 9577 0899 17       		.byte	23
 9578 089a 15       		.byte	21
 9579 089b 06       		.byte	6
 9580 089c 16       		.byte	22
 9581 089d 09       		.byte	9
 9582 089e 0C       		.byte	12
 9583 089f 12       		.byte	18
 9584 08a0 24       		.byte	36
 9585 08a1 000000   		.space	3
 9586              	.LC0:
 9587 08a4 01000000 		.word	1
 9588 08a8 01000000 		.word	1
 9589 08ac 01000000 		.word	1
 9590 08b0 01000000 		.word	1
 9591              		.data
 9592              		.align	2
 9593              		.set	.LANCHOR0,. + 0
 9596              	le:
 9597 0000 D6BE898E 		.word	-1903575338
 9598 0004 7D6B     		.short	27517
 9599 0006 7191     		.short	-28303
 9600 0008 55555500 		.word	5592405
 9601 000c AAAAAA00 		.word	11184810
 9602 0010 00000000 		.word	0
 9603 0014 00       		.byte	0
 9604 0015 000000   		.space	3
 9605 0018 00000000 		.word	0
 9606 001c 00000000 		.space	24
 9606      00000000 
 9606      00000000 
 9606      00000000 
ARM GAS  /tmp/ccLwKaeN.s 			page 246


 9606      00000000 
 9607 0034 01000000 		.word	1
 9608 0038 00000000 		.space	12
 9608      00000000 
 9608      00000000 
 9609 0044 00000000 		.word	0
 9610 0048 00000000 		.word	0
 9613              	channel:
 9614 004c 6809     		.short	2408
 9617              	hop_timeout:
 9618 004e 9E00     		.short	158
 9621              	le_adv_channel:
 9622 0050 6209     		.short	2402
 9625              	low_freq:
 9626 0052 6009     		.short	2400
 9629              	high_freq:
 9630 0054 B309     		.short	2483
 9633              	rssi_threshold:
 9634 0056 E2       		.byte	-30
 9635 0057 00       		.space	1
 9638              	le_adv_len:
 9639 0058 03000000 		.word	3
 9642              	le_adv_data:
 9643 005c 02       		.byte	2
 9644 005d 01       		.byte	1
 9645 005e 05       		.byte	5
 9646 005f 00000000 		.space	18
 9646      00000000 
 9646      00000000 
 9646      00000000 
 9646      0000
 9649              	idx3:
 9650 0071 02       		.byte	2
 9653              	calc.4977:
 9654 0072 01       		.byte	1
 9657              	idx2:
 9658 0073 01       		.byte	1
 9661              	max_count.4998:
 9662 0074 0100     		.short	1
 9663              		.bss
 9664              		.align	2
 9665              		.set	.LANCHOR1,. + 0
 9668              	modulation:
 9669 0000 00       		.space	1
 9672              	status:
 9673 0001 00       		.space	1
 9676              	idle_buf_clkn_high:
 9677 0002 00       		.space	1
 9678 0003 00       		.space	1
 9681              	idle_buf_clk100ns:
 9682 0004 00000000 		.space	4
 9685              	idle_buf_channel:
 9686 0008 0000     		.space	2
 9689              	hop_mode:
 9690 000a 00       		.space	1
 9693              	do_hop:
 9694 000b 00       		.space	1
ARM GAS  /tmp/ccLwKaeN.s 			page 247


 9697              	hop_direct_channel:
 9698 000c 0000     		.space	2
 9701              	requested_channel:
 9702 000e 0000     		.space	2
 9705              	dma_discard:
 9706 0010 00       		.space	1
 9709              	mode:
 9710 0011 00       		.space	1
 9713              	requested_mode:
 9714 0012 00       		.space	1
 9717              	jam_mode:
 9718 0013 00       		.space	1
 9721              	ego_mode:
 9722 0014 00       		.space	1
 9723 0015 000000   		.space	3
 9726              	packet_cb:
 9727 0018 00000000 		.space	4
 9730              	slave_mac_address:
 9731 001c 00000000 		.space	6
 9731      0000
 9732 0022 0000     		.space	2
 9735              	cancel_follow:
 9736 0024 00000000 		.space	4
 9739              	do_transmit:
 9740 0028 00       		.space	1
 9743              	m.4947:
 9744 0029 00       		.space	1
 9747              	n.4948:
 9748 002a 00       		.space	1
 9751              	ch_count1:
 9752 002b 00       		.space	1
 9755              	mapped:
 9756 002c 00       		.space	1
 9757 002d 000000   		.space	3
 9760              	data_cb:
 9761 0030 00000000 		.space	4
 9764              	count3:
 9765 0034 00       		.space	1
 9768              	count2:
 9769 0035 00       		.space	1
 9770 0036 0000     		.space	2
 9773              	le_jam_count:
 9774 0038 00000000 		.space	4
 9777              	restart_jamming.4872:
 9778 003c 00000000 		.space	4
 9781              	time_array1:
 9782 0040 00000000 		.space	32
 9782      00000000 
 9782      00000000 
 9782      00000000 
 9782      00000000 
 9785              	count.4975:
 9786 0060 0000     		.space	2
 9787 0062 0000     		.space	2
 9790              	seq.4974:
 9791 0064 00000000 		.space	72
 9791      00000000 
ARM GAS  /tmp/ccLwKaeN.s 			page 248


 9791      00000000 
 9791      00000000 
 9791      00000000 
 9794              	prev_clk.4973:
 9795 00ac 00000000 		.space	4
 9798              	match.4980:
 9799 00b0 00       		.space	1
 9800 00b1 00       		.space	1
 9803              	sindex.4976:
 9804 00b2 0000     		.space	2
 9807              	interval.4978:
 9808 00b4 00000000 		.space	4
 9811              	step.4979:
 9812 00b8 00       		.space	1
 9813 00b9 00       		.space	1
 9816              	eindex:
 9817 00ba 0000     		.space	2
 9820              	obsv_hop_interval.4987:
 9821 00bc 0000     		.space	2
 9822 00be 0000     		.space	2
 9825              	first_ts.4981:
 9826 00c0 00000000 		.space	4
 9829              	time_array2:
 9830 00c4 00000000 		.space	32
 9830      00000000 
 9830      00000000 
 9830      00000000 
 9830      00000000 
 9833              	count1:
 9834 00e4 00       		.space	1
 9835 00e5 00       		.space	1
 9838              	time_array3:
 9839 00e6 00000000 		.space	32
 9839      00000000 
 9839      00000000 
 9839      00000000 
 9839      00000000 
 9842              	ta1.5002:
 9843 0106 00       		.space	1
 9846              	idx1:
 9847 0107 00       		.space	1
 9850              	hops.5007:
 9851 0108 00       		.space	1
 9854              	ta2.5003:
 9855 0109 00       		.space	1
 9858              	diff.4997:
 9859 010a 0000     		.space	2
 9862              	hops2.5008:
 9863 010c 00       		.space	1
 9866              	index.4995:
 9867 010d 00       		.space	1
 9870              	sync_count:
 9871 010e 00       		.space	1
 9874              	ta3.5004:
 9875 010f 00       		.space	1
 9878              	ch_hop.4996:
 9879 0110 00000000 		.space	64
ARM GAS  /tmp/ccLwKaeN.s 			page 249


 9879      00000000 
 9879      00000000 
 9879      00000000 
 9879      00000000 
 9882              	j.5006:
 9883 0150 00       		.space	1
 9884 0151 00       		.space	1
 9887              	max_val.5000:
 9888 0152 0000     		.space	2
 9891              	curr_count.4999:
 9892 0154 0000     		.space	2
 9895              	i.5005:
 9896 0156 00       		.space	1
 9897              		.section	.rodata.str1.1,"aMS",%progbits,1
 9898              	.LC2:
 9899 0000 6769742D 		.ascii	"git-\000"
 9899      00
 9900              	.LC3:
 9901 0005 41412073 		.ascii	"AA set\012\000"
 9901      65740A00 
 9902              	.LC4:
 9903 000d 486F7020 		.ascii	"Hop interval set: %d\012\000"
 9903      696E7465 
 9903      7276616C 
 9903      20736574 
 9903      3A202564 
 9904              	.LC5:
 9905 0023 5472616E 		.ascii	"Transmitting on index: %d\012\000"
 9905      736D6974 
 9905      74696E67 
 9905      206F6E20 
 9905      696E6465 
 9906              	.LC6:
 9907 003e 6964783A 		.ascii	"idx: %d cnt: %d \012\000"
 9907      20256420 
 9907      636E743A 
 9907      20256420 
 9907      0A00
 9908              	.LC7:
 9909 0050 4E657874 		.ascii	"Next index: %d\012\000"
 9909      20696E64 
 9909      65783A20 
 9909      25640A00 
 9910              	.LC8:
 9911 0060 486F7020 		.ascii	"Hop interval: %d\012\000"
 9911      696E7465 
 9911      7276616C 
 9911      3A202564 
 9911      0A00
 9912              	.LC9:
 9913 0072 496E6372 		.ascii	"Increment: %d Interval: %d %d out of %d\012\000"
 9913      656D656E 
 9913      743A2025 
 9913      6420496E 
 9913      74657276 
 9914              	.LC10:
 9915 009b 70726F6D 		.ascii	"promisc_follow_cb\012\000"
ARM GAS  /tmp/ccLwKaeN.s 			page 250


 9915      6973635F 
 9915      666F6C6C 
 9915      6F775F63 
 9915      620A00
 9916              	.LC11:
 9917 00ae 4368616E 		.ascii	"Channel: %d\012\000"
 9917      6E656C3A 
 9917      2025640A 
 9917      00
 9918              	.LC12:
 9919 00bb 0A0A2A2A 		.ascii	"\012\012****UBERTOOTH BOOT****\012%s\012\000"
 9919      2A2A5542 
 9919      4552544F 
 9919      4F544820 
 9919      424F4F54 
 9920              		.text
 9921              	.Letext0:
 9922              		.file 2 "/usr/lib/gcc/arm-none-eabi/6.3.1/include/stddef.h"
 9923              		.file 3 "/usr/include/newlib/sys/lock.h"
 9924              		.file 4 "/usr/include/newlib/sys/_types.h"
 9925              		.file 5 "/usr/include/newlib/sys/reent.h"
 9926              		.file 6 "/usr/lib/gcc/arm-none-eabi/6.3.1/include/stdint-gcc.h"
 9927              		.file 7 "../../host/libubertooth/src/ubertooth_interface.h"
 9928              		.file 8 "../common/ubertooth.h"
 9929              		.file 9 "ubertooth_rssi.h"
 9930              		.file 10 "ubertooth_cs.h"
 9931              		.file 11 "ubertooth_dma.h"
 9932              		.file 12 "ubertooth_clock.h"
 9933              		.file 13 "bluetooth.h"
 9934              		.file 14 "bluetooth_le.h"
 9935              		.file 15 "ego.h"
 9936              		.file 16 "debug_uart.h"
 9937              		.file 17 "cc2400_rangetest.h"
 9938              		.file 18 "ubertooth_usb.h"
 9939              		.file 19 "/usr/include/newlib/string.h"
ARM GAS  /tmp/ccLwKaeN.s 			page 251


DEFINED SYMBOLS
                            *ABS*:0000000000000000 bluetooth_rxtx.c
     /tmp/ccLwKaeN.s:16     .text.reverse8:0000000000000000 $t
     /tmp/ccLwKaeN.s:22     .text.reverse8:0000000000000000 reverse8
     /tmp/ccLwKaeN.s:71     .text.le_set_access_address:0000000000000000 $t
     /tmp/ccLwKaeN.s:77     .text.le_set_access_address:0000000000000000 le_set_access_address
     /tmp/ccLwKaeN.s:104    .text.le_set_access_address:0000000000000014 $d
     /tmp/ccLwKaeN.s:109    .text.cc2400_rx:0000000000000000 $t
     /tmp/ccLwKaeN.s:115    .text.cc2400_rx:0000000000000000 cc2400_rx
     /tmp/ccLwKaeN.s:228    .text.cc2400_rx:000000000000009c $d
     /tmp/ccLwKaeN.s:235    .text.cc2400_rx_sync:0000000000000000 $t
     /tmp/ccLwKaeN.s:241    .text.cc2400_rx_sync:0000000000000000 cc2400_rx_sync
     /tmp/ccLwKaeN.s:367    .text.cc2400_rx_sync:00000000000000a8 $d
     /tmp/ccLwKaeN.s:374    .text.enqueue:0000000000000000 $t
     /tmp/ccLwKaeN.s:380    .text.enqueue:0000000000000000 enqueue
     /tmp/ccLwKaeN.s:489    .text.enqueue:0000000000000080 $d
                            *COM*:0000000000000004 clkn
                            *COM*:0000000000000001 rssi_min
                            *COM*:0000000000000001 rssi_max
                            *COM*:0000000000000001 rssi_count
     /tmp/ccLwKaeN.s:499    .text.cc2400_idle:0000000000000000 $t
     /tmp/ccLwKaeN.s:505    .text.cc2400_idle:0000000000000000 cc2400_idle
     /tmp/ccLwKaeN.s:620    .text.cc2400_idle:000000000000009c $d
                            *COM*:0000000000000010 target
     /tmp/ccLwKaeN.s:628    .text.cb_follow_le:0000000000000000 $t
     /tmp/ccLwKaeN.s:635    .text.cb_follow_le:0000000000000000 cb_follow_le
     /tmp/ccLwKaeN.s:857    .text.cb_follow_le:00000000000000f8 $d
                            *COM*:0000000000000320 unpacked
                            *COM*:0000000000000004 idle_rxbuf
     /tmp/ccLwKaeN.s:868    .text.vendor_request_handler:0000000000000000 $t
     /tmp/ccLwKaeN.s:874    .text.vendor_request_handler:0000000000000000 vendor_request_handler
     /tmp/ccLwKaeN.s:900    .text.vendor_request_handler:0000000000000012 $d
     /tmp/ccLwKaeN.s:974    .text.vendor_request_handler:00000000000000a6 $t
     /tmp/ccLwKaeN.s:1571   .text.vendor_request_handler:0000000000000364 $d
                            *COM*:0000000000000005 rr
                            *COM*:0000000000000001 cs_threshold_req
     /tmp/ccLwKaeN.s:1589   .text.vendor_request_handler:00000000000003a0 $t
     /tmp/ccLwKaeN.s:2172   .text.vendor_request_handler:000000000000062c $d
                            *COM*:0000000000000004 clkn_offset
                            *COM*:0000000000000002 clk100ns_offset
                            *COM*:000000000000000a afh_map
                            *COM*:0000000000000001 used_channels
                            *COM*:0000000000000001 afh_enabled
                            *COM*:0000000000000002 clk_drift_ppm
                            *COM*:0000000000000004 clkn_next_drift_fix
                            *COM*:0000000000000002 clk_drift_correction
                            *COM*:0000000000000004 clkn_last_drift_fix
                            *COM*:000000000000003a tx_pkt
     /tmp/ccLwKaeN.s:2191   .text.vendor_request_handler:0000000000000670 $t
     /tmp/ccLwKaeN.s:2328   .text.vendor_request_handler:0000000000000700 $d
     /tmp/ccLwKaeN.s:2337   .text.enqueue_with_ts:0000000000000000 $t
     /tmp/ccLwKaeN.s:2344   .text.enqueue_with_ts:0000000000000000 enqueue_with_ts
     /tmp/ccLwKaeN.s:2418   .text.enqueue_with_ts:0000000000000050 $d
     /tmp/ccLwKaeN.s:2424   .text.TIMER0_IRQHandler:0000000000000000 $t
     /tmp/ccLwKaeN.s:2431   .text.TIMER0_IRQHandler:0000000000000000 TIMER0_IRQHandler
     /tmp/ccLwKaeN.s:2650   .text.TIMER0_IRQHandler:0000000000000130 $d
                            *COM*:0000000000000004 last_hop
ARM GAS  /tmp/ccLwKaeN.s 			page 252


     /tmp/ccLwKaeN.s:2667   .text.EINT3_IRQHandler:0000000000000000 $t
     /tmp/ccLwKaeN.s:2674   .text.EINT3_IRQHandler:0000000000000000 EINT3_IRQHandler
     /tmp/ccLwKaeN.s:2705   .text.EINT3_IRQHandler:0000000000000024 $d
                            *COM*:0000000000000001 cs_trigger
     /tmp/ccLwKaeN.s:2713   .text.legacy_DMA_IRQHandler:0000000000000000 $t
     /tmp/ccLwKaeN.s:2720   .text.legacy_DMA_IRQHandler:0000000000000000 legacy_DMA_IRQHandler
     /tmp/ccLwKaeN.s:2846   .text.legacy_DMA_IRQHandler:00000000000000a8 $d
                            *COM*:0000000000000004 active_rxbuf
                            *COM*:0000000000000004 rx_tc
                            *COM*:0000000000000004 rx_err
     /tmp/ccLwKaeN.s:2865   .text.DMA_IRQHandler:0000000000000000 $t
     /tmp/ccLwKaeN.s:2872   .text.DMA_IRQHandler:0000000000000000 DMA_IRQHandler
     /tmp/ccLwKaeN.s:2935   .text.DMA_IRQHandler:0000000000000048 $d
     /tmp/ccLwKaeN.s:2947   .text.le_transmit:0000000000000000 $t
     /tmp/ccLwKaeN.s:2954   .text.le_transmit:0000000000000000 le_transmit
     /tmp/ccLwKaeN.s:3188   .text.le_transmit:0000000000000150 $d
     /tmp/ccLwKaeN.s:3197   .text.le_jam:0000000000000000 $t
     /tmp/ccLwKaeN.s:3204   .text.le_jam:0000000000000000 le_jam
     /tmp/ccLwKaeN.s:3288   .text.le_jam:0000000000000074 $d
     /tmp/ccLwKaeN.s:3293   .text.reset_le:0000000000000000 $t
     /tmp/ccLwKaeN.s:3300   .text.reset_le:0000000000000000 reset_le
     /tmp/ccLwKaeN.s:3362   .text.reset_le:0000000000000040 $d
     /tmp/ccLwKaeN.s:3371   .text.reset_le_promisc:0000000000000000 $t
     /tmp/ccLwKaeN.s:3378   .text.reset_le_promisc:0000000000000000 reset_le_promisc
     /tmp/ccLwKaeN.s:3402   .text.reset_le_promisc:000000000000001c $d
                            *COM*:0000000000000108 le_promisc
     /tmp/ccLwKaeN.s:3407   .text.rearrange_channel:0000000000000000 $t
     /tmp/ccLwKaeN.s:3414   .text.rearrange_channel:0000000000000000 rearrange_channel
     /tmp/ccLwKaeN.s:3476   .text.rearrange_channel:0000000000000054 $d
                            *COM*:00000000000000c0 remapping
     /tmp/ccLwKaeN.s:3482   .text.connection_follow_cb:0000000000000000 $t
     /tmp/ccLwKaeN.s:3489   .text.connection_follow_cb:0000000000000000 connection_follow_cb
     /tmp/ccLwKaeN.s:3571   .text.connection_follow_cb:0000000000000068 $d
     /tmp/ccLwKaeN.s:3582   .text.bt_follow_le:0000000000000000 $t
     /tmp/ccLwKaeN.s:3589   .text.bt_follow_le:0000000000000000 bt_follow_le
     /tmp/ccLwKaeN.s:3603   .text.le_promisc_state:0000000000000000 $t
     /tmp/ccLwKaeN.s:3610   .text.le_promisc_state:0000000000000000 le_promisc_state
     /tmp/ccLwKaeN.s:3664   .text.hop:0000000000000000 $t
     /tmp/ccLwKaeN.s:3671   .text.hop:0000000000000000 hop
     /tmp/ccLwKaeN.s:3958   .text.hop:00000000000001e8 $d
     /tmp/ccLwKaeN.s:3971   .text.bt_stream_rx:0000000000000000 $t
     /tmp/ccLwKaeN.s:3978   .text.bt_stream_rx:0000000000000000 bt_stream_rx
     /tmp/ccLwKaeN.s:4211   .text.bt_stream_rx:0000000000000140 $d
                            *COM*:0000000000000001 cs_no_squelch
                            *COM*:0000000000000001 cs_threshold_cur
     /tmp/ccLwKaeN.s:4227   .text.br_transmit:0000000000000000 $t
     /tmp/ccLwKaeN.s:4234   .text.br_transmit:0000000000000000 br_transmit
     /tmp/ccLwKaeN.s:4669   .text.br_transmit:000000000000025c $d
     /tmp/ccLwKaeN.s:4682   .text.bt_generic_le:0000000000000000 $t
     /tmp/ccLwKaeN.s:4689   .text.bt_generic_le:0000000000000000 bt_generic_le
     /tmp/ccLwKaeN.s:5042   .text.bt_generic_le:00000000000001c4 $d
     /tmp/ccLwKaeN.s:5061   .text.bt_le_sync:0000000000000000 $t
     /tmp/ccLwKaeN.s:5068   .text.bt_le_sync:0000000000000000 bt_le_sync
     /tmp/ccLwKaeN.s:5616   .text.bt_le_sync:00000000000002ec $d
                            *COM*:0000000000000032 rxbuf1
     /tmp/ccLwKaeN.s:5639   .text.bt_le_sync:000000000000033c $t
     /tmp/ccLwKaeN.s:5746   .text.bt_le_sync:00000000000003d0 $d
ARM GAS  /tmp/ccLwKaeN.s 			page 253


     /tmp/ccLwKaeN.s:5758   .text.promisc_recover_hop_interval:0000000000000000 $t
     /tmp/ccLwKaeN.s:5765   .text.promisc_recover_hop_interval:0000000000000000 promisc_recover_hop_interval
     /tmp/ccLwKaeN.s:6273   .text.promisc_recover_hop_interval:0000000000000360 $d
     /tmp/ccLwKaeN.s:6286   .text.promisc_recover_hop_interval:0000000000000388 $t
     /tmp/ccLwKaeN.s:6739   .text.promisc_recover_hop_interval:00000000000006d0 $d
     /tmp/ccLwKaeN.s:6750   .text.promisc_recover_hop_interval:00000000000006f0 $t
     /tmp/ccLwKaeN.s:6832   .text.promisc_recover_hop_interval:0000000000000754 $d
     /tmp/ccLwKaeN.s:6840   .text.promisc_follow_cb:0000000000000000 $t
     /tmp/ccLwKaeN.s:6847   .text.promisc_follow_cb:0000000000000000 promisc_follow_cb
     /tmp/ccLwKaeN.s:6952   .text.promisc_follow_cb:0000000000000068 $d
     /tmp/ccLwKaeN.s:6964   .text.see_aa:0000000000000000 $t
     /tmp/ccLwKaeN.s:6971   .text.see_aa:0000000000000000 see_aa
     /tmp/ccLwKaeN.s:7048   .text.see_aa:0000000000000050 $d
     /tmp/ccLwKaeN.s:7055   .text.cb_le_promisc:0000000000000000 $t
     /tmp/ccLwKaeN.s:7062   .text.cb_le_promisc:0000000000000000 cb_le_promisc
     /tmp/ccLwKaeN.s:7400   .text.cb_le_promisc:00000000000001ac $d
     /tmp/ccLwKaeN.s:7413   .text.bt_promisc_le:0000000000000000 $t
     /tmp/ccLwKaeN.s:7420   .text.bt_promisc_le:0000000000000000 bt_promisc_le
     /tmp/ccLwKaeN.s:7511   .text.bt_promisc_le:0000000000000070 $d
     /tmp/ccLwKaeN.s:7520   .text.bt_slave_le:0000000000000000 $t
     /tmp/ccLwKaeN.s:7527   .text.bt_slave_le:0000000000000000 bt_slave_le
     /tmp/ccLwKaeN.s:7671   .text.bt_slave_le:00000000000000ac $d
     /tmp/ccLwKaeN.s:7685   .text.bt_transmit_le:0000000000000000 $t
     /tmp/ccLwKaeN.s:7692   .text.bt_transmit_le:0000000000000000 bt_transmit_le
     /tmp/ccLwKaeN.s:7753   .text.bt_transmit_le:0000000000000044 $d
     /tmp/ccLwKaeN.s:7761   .text.rx_generic_sync:0000000000000000 $t
     /tmp/ccLwKaeN.s:7768   .text.rx_generic_sync:0000000000000000 rx_generic_sync
     /tmp/ccLwKaeN.s:7892   .text.rx_generic_sync:0000000000000094 $d
     /tmp/ccLwKaeN.s:7900   .text.rx_generic:0000000000000000 $t
     /tmp/ccLwKaeN.s:7907   .text.rx_generic:0000000000000000 rx_generic
     /tmp/ccLwKaeN.s:7941   .text.rx_generic:000000000000001c $d
     /tmp/ccLwKaeN.s:7946   .text.tx_generic:0000000000000000 $t
     /tmp/ccLwKaeN.s:7953   .text.tx_generic:0000000000000000 tx_generic
     /tmp/ccLwKaeN.s:8115   .text.tx_generic:00000000000000dc $d
     /tmp/ccLwKaeN.s:8125   .text.specan:0000000000000000 $t
     /tmp/ccLwKaeN.s:8132   .text.specan:0000000000000000 specan
     /tmp/ccLwKaeN.s:8328   .text.specan:00000000000000fc $d
     /tmp/ccLwKaeN.s:8338   .text.led_specan:0000000000000000 $t
     /tmp/ccLwKaeN.s:8345   .text.led_specan:0000000000000000 led_specan
     /tmp/ccLwKaeN.s:8559   .text.led_specan:000000000000011c $d
     /tmp/ccLwKaeN.s:8570   .text.startup.main:0000000000000000 $t
     /tmp/ccLwKaeN.s:8577   .text.startup.main:0000000000000000 main
     /tmp/ccLwKaeN.s:8633   .text.startup.main:0000000000000044 $d
     /tmp/ccLwKaeN.s:8651   .text.startup.main:0000000000000056 $t
     /tmp/ccLwKaeN.s:8806   .text.startup.main:00000000000000f4 $d
     /tmp/ccLwKaeN.s:9726   .bss:0000000000000018 packet_cb
     /tmp/ccLwKaeN.s:9760   .bss:0000000000000030 data_cb
     /tmp/ccLwKaeN.s:9773   .bss:0000000000000038 le_jam_count
                            *COM*:00000000000000c0 pending_remapping
     /tmp/ccLwKaeN.s:9596   .data:0000000000000000 le
     /tmp/ccLwKaeN.s:9638   .data:0000000000000058 le_adv_len
     /tmp/ccLwKaeN.s:9642   .data:000000000000005c le_adv_data
     /tmp/ccLwKaeN.s:9730   .bss:000000000000001c slave_mac_address
     /tmp/ccLwKaeN.s:9739   .bss:0000000000000028 do_transmit
     /tmp/ccLwKaeN.s:9649   .data:0000000000000071 idx3
     /tmp/ccLwKaeN.s:9657   .data:0000000000000073 idx2
     /tmp/ccLwKaeN.s:9846   .bss:0000000000000107 idx1
ARM GAS  /tmp/ccLwKaeN.s 			page 254


     /tmp/ccLwKaeN.s:9633   .data:0000000000000056 rssi_threshold
     /tmp/ccLwKaeN.s:9629   .data:0000000000000054 high_freq
     /tmp/ccLwKaeN.s:9625   .data:0000000000000052 low_freq
     /tmp/ccLwKaeN.s:9668   .bss:0000000000000000 modulation
     /tmp/ccLwKaeN.s:9721   .bss:0000000000000014 ego_mode
     /tmp/ccLwKaeN.s:9717   .bss:0000000000000013 jam_mode
     /tmp/ccLwKaeN.s:9713   .bss:0000000000000012 requested_mode
     /tmp/ccLwKaeN.s:9709   .bss:0000000000000011 mode
     /tmp/ccLwKaeN.s:9672   .bss:0000000000000001 status
     /tmp/ccLwKaeN.s:9705   .bss:0000000000000010 dma_discard
     /tmp/ccLwKaeN.s:9685   .bss:0000000000000008 idle_buf_channel
     /tmp/ccLwKaeN.s:9681   .bss:0000000000000004 idle_buf_clk100ns
     /tmp/ccLwKaeN.s:9676   .bss:0000000000000002 idle_buf_clkn_high
     /tmp/ccLwKaeN.s:9735   .bss:0000000000000024 cancel_follow
     /tmp/ccLwKaeN.s:9621   .data:0000000000000050 le_adv_channel
     /tmp/ccLwKaeN.s:9701   .bss:000000000000000e requested_channel
     /tmp/ccLwKaeN.s:9617   .data:000000000000004e hop_timeout
     /tmp/ccLwKaeN.s:9697   .bss:000000000000000c hop_direct_channel
     /tmp/ccLwKaeN.s:9613   .data:000000000000004c channel
     /tmp/ccLwKaeN.s:9693   .bss:000000000000000b do_hop
     /tmp/ccLwKaeN.s:9689   .bss:000000000000000a hop_mode
     /tmp/ccLwKaeN.s:9058   .rodata:00000000000000a7 compile_info
                            *COM*:0000000000000008 syncword
                            *COM*:0000000000000032 rxbuf2
     /tmp/ccLwKaeN.s:8881   .rodata:0000000000000000 $d
     /tmp/ccLwKaeN.s:8885   .rodata:0000000000000000 whitening_index
     /tmp/ccLwKaeN.s:8928   .rodata:0000000000000028 whitening
     /tmp/ccLwKaeN.s:9064   .rodata:00000000000000fc whitening_word
     /tmp/ccLwKaeN.s:9547   .rodata:000000000000087c hop_interval_lut
     /tmp/ccLwKaeN.s:9592   .data:0000000000000000 $d
     /tmp/ccLwKaeN.s:9653   .data:0000000000000072 calc.4977
     /tmp/ccLwKaeN.s:9661   .data:0000000000000074 max_count.4998
     /tmp/ccLwKaeN.s:9664   .bss:0000000000000000 $d
     /tmp/ccLwKaeN.s:9743   .bss:0000000000000029 m.4947
     /tmp/ccLwKaeN.s:9747   .bss:000000000000002a n.4948
     /tmp/ccLwKaeN.s:9751   .bss:000000000000002b ch_count1
     /tmp/ccLwKaeN.s:9755   .bss:000000000000002c mapped
     /tmp/ccLwKaeN.s:9764   .bss:0000000000000034 count3
     /tmp/ccLwKaeN.s:9768   .bss:0000000000000035 count2
     /tmp/ccLwKaeN.s:9777   .bss:000000000000003c restart_jamming.4872
     /tmp/ccLwKaeN.s:9781   .bss:0000000000000040 time_array1
     /tmp/ccLwKaeN.s:9785   .bss:0000000000000060 count.4975
     /tmp/ccLwKaeN.s:9790   .bss:0000000000000064 seq.4974
     /tmp/ccLwKaeN.s:9794   .bss:00000000000000ac prev_clk.4973
     /tmp/ccLwKaeN.s:9798   .bss:00000000000000b0 match.4980
     /tmp/ccLwKaeN.s:9803   .bss:00000000000000b2 sindex.4976
     /tmp/ccLwKaeN.s:9807   .bss:00000000000000b4 interval.4978
     /tmp/ccLwKaeN.s:9811   .bss:00000000000000b8 step.4979
     /tmp/ccLwKaeN.s:9816   .bss:00000000000000ba eindex
     /tmp/ccLwKaeN.s:9820   .bss:00000000000000bc obsv_hop_interval.4987
     /tmp/ccLwKaeN.s:9825   .bss:00000000000000c0 first_ts.4981
     /tmp/ccLwKaeN.s:9829   .bss:00000000000000c4 time_array2
     /tmp/ccLwKaeN.s:9833   .bss:00000000000000e4 count1
     /tmp/ccLwKaeN.s:9838   .bss:00000000000000e6 time_array3
     /tmp/ccLwKaeN.s:9842   .bss:0000000000000106 ta1.5002
     /tmp/ccLwKaeN.s:9850   .bss:0000000000000108 hops.5007
     /tmp/ccLwKaeN.s:9854   .bss:0000000000000109 ta2.5003
ARM GAS  /tmp/ccLwKaeN.s 			page 255


     /tmp/ccLwKaeN.s:9858   .bss:000000000000010a diff.4997
     /tmp/ccLwKaeN.s:9862   .bss:000000000000010c hops2.5008
     /tmp/ccLwKaeN.s:9866   .bss:000000000000010d index.4995
     /tmp/ccLwKaeN.s:9870   .bss:000000000000010e sync_count
     /tmp/ccLwKaeN.s:9874   .bss:000000000000010f ta3.5004
     /tmp/ccLwKaeN.s:9878   .bss:0000000000000110 ch_hop.4996
     /tmp/ccLwKaeN.s:9882   .bss:0000000000000150 j.5006
     /tmp/ccLwKaeN.s:9887   .bss:0000000000000152 max_val.5000
     /tmp/ccLwKaeN.s:9891   .bss:0000000000000154 curr_count.4999
     /tmp/ccLwKaeN.s:9895   .bss:0000000000000156 i.5005
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
rbit
cc2400_set
cs_threshold_calc_and_set
clkn_start
cc2400_status
cc2400_strobe
usb_enqueue
memcpy
rssi_get_avg
clkn_stop
dio_ssp_stop
cs_reset
rssi_reset
btle_channel_index
btle_crcgen_lut
__aeabi_llsl
get_part_num
get_device_serial
cc2400_get
set_isp
strlen
precalc
bootloader_ctrl
usb_queue_init
debug_printf
dequeue
btle_channel_index_to_phys
memset
le_DMA_IRQHandler
debug_dma_active
cc2400_fifo_write
le_phy_main
next_hop
le_map_channel
btle_next_hop
dio_ssp_init
dma_init_rx_symbols
dio_ssp_start
cs_trigger_enable
cs_trigger_disable
rssi_iir_update
handle_usb
rssi_add
dma_init_le
ARM GAS  /tmp/ccLwKaeN.s 			page 256


__aeabi_i2d
__aeabi_dadd
__aeabi_ddiv
__aeabi_d2uiz
__aeabi_dmul
__aeabi_dsub
abs
btle_reverse_crc
btle_calc_crc
cc2400_fifo_read
ubertooth_init
clkn_init
ubertooth_usb_init
dma_poweron
debug_uart_init
wait
reset
cc2400_txtest
cc2400_rangetest
cc2400_repeater
ego_main
